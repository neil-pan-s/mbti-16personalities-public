import{Z as Mh,p as Us,a3 as Fh,a0 as Bs,K as Xa,a1 as xt,a2 as $s,T as Lh,q as Qa,aa as fi,W as Uh,D as Bh,ab as $h}from"./app-CkFHfTSb.js";import{v as Wh}from"./C4ykfLOU.js";import{E as pc}from"./BwnZxTdu.js";import{E as jh}from"./BSm8QL3Z.js";var L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yc(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var gc;function k(){return gc.apply(null,arguments)}function Yh(e){gc=e}function Et(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ir(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function te(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Zo(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(te(e,t))return!1;return!0}function Ke(e){return e===void 0}function Xt(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Jn(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function _c(e,t){var r=[],n,s=e.length;for(n=0;n<s;++n)r.push(t(e[n],n));return r}function nr(e,t){for(var r in t)te(t,r)&&(e[r]=t[r]);return te(t,"toString")&&(e.toString=t.toString),te(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Ft(e,t,r,n){return $c(e,t,r,n,!0).utc()}function Hh(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function K(e){return e._pf==null&&(e._pf=Hh()),e._pf}var No;Array.prototype.some?No=Array.prototype.some:No=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Xo(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=K(e),r=No.call(t.parsedDateParts,function(s){return s!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function Zi(e){var t=Ft(NaN);return e!=null?nr(K(t),e):K(t).userInvalidated=!0,t}var eu=k.momentProperties=[],Ws=!1;function Qo(e,t){var r,n,s,i=eu.length;if(Ke(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ke(t._i)||(e._i=t._i),Ke(t._f)||(e._f=t._f),Ke(t._l)||(e._l=t._l),Ke(t._strict)||(e._strict=t._strict),Ke(t._tzm)||(e._tzm=t._tzm),Ke(t._isUTC)||(e._isUTC=t._isUTC),Ke(t._offset)||(e._offset=t._offset),Ke(t._pf)||(e._pf=K(t)),Ke(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=eu[r],s=t[n],Ke(s)||(e[n]=s);return e}function zn(e){Qo(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ws===!1&&(Ws=!0,k.updateOffset(this),Ws=!1)}function bt(e){return e instanceof zn||e!=null&&e._isAMomentObject!=null}function mc(e){k.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function yt(e,t){var r=!0;return nr(function(){if(k.deprecationHandler!=null&&k.deprecationHandler(null,e),r){var n=[],s,i,o,u=arguments.length;for(i=0;i<u;i++){if(s="",typeof arguments[i]=="object"){s+=`
[`+i+"] ";for(o in arguments[0])te(arguments[0],o)&&(s+=o+": "+arguments[0][o]+", ");s=s.slice(0,-2)}else s=arguments[i];n.push(s)}mc(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var tu={};function vc(e,t){k.deprecationHandler!=null&&k.deprecationHandler(e,t),tu[e]||(mc(t),tu[e]=!0)}k.suppressDeprecationWarnings=!1;k.deprecationHandler=null;function Lt(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function qh(e){var t,r;for(r in e)te(e,r)&&(t=e[r],Lt(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ro(e,t){var r=nr({},e),n;for(n in t)te(t,n)&&(Ir(e[n])&&Ir(t[n])?(r[n]={},nr(r[n],e[n]),nr(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)te(e,n)&&!te(t,n)&&Ir(e[n])&&(r[n]=nr({},r[n]));return r}function ea(e){e!=null&&this.set(e)}var Do;Object.keys?Do=Object.keys:Do=function(e){var t,r=[];for(t in e)te(e,t)&&r.push(t);return r};var Gh={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Kh(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Lt(n)?n.call(t,r):n}function Pt(e,t,r){var n=""+Math.abs(e),s=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}var ta=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,li=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,js={},Xr={};function j(e,t,r,n){var s=n;typeof n=="string"&&(s=function(){return this[n]()}),e&&(Xr[e]=s),t&&(Xr[t[0]]=function(){return Pt(s.apply(this,arguments),t[1],t[2])}),r&&(Xr[r]=function(){return this.localeData().ordinal(s.apply(this,arguments),e)})}function Vh(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Jh(e){var t=e.match(ta),r,n;for(r=0,n=t.length;r<n;r++)Xr[t[r]]?t[r]=Xr[t[r]]:t[r]=Vh(t[r]);return function(s){var i="",o;for(o=0;o<n;o++)i+=Lt(t[o])?t[o].call(s,e):t[o];return i}}function Oi(e,t){return e.isValid()?(t=wc(t,e.localeData()),js[t]=js[t]||Jh(t),js[t](e)):e.localeData().invalidDate()}function wc(e,t){var r=5;function n(s){return t.longDateFormat(s)||s}for(li.lastIndex=0;r>=0&&li.test(e);)e=e.replace(li,n),li.lastIndex=0,r-=1;return e}var zh={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Zh(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(ta).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var Xh="Invalid date";function Qh(){return this._invalidDate}var ed="%d",td=/\d{1,2}/;function rd(e){return this._ordinal.replace("%d",e)}var nd={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function id(e,t,r,n){var s=this._relativeTime[r];return Lt(s)?s(e,t,r,n):s.replace(/%d/i,e)}function sd(e,t){var r=this._relativeTime[e>0?"future":"past"];return Lt(r)?r(t):r.replace(/%s/i,t)}var ru={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function gt(e){return typeof e=="string"?ru[e]||ru[e.toLowerCase()]:void 0}function ra(e){var t={},r,n;for(n in e)te(e,n)&&(r=gt(n),r&&(t[r]=e[n]));return t}var od={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function ad(e){var t=[],r;for(r in e)te(e,r)&&t.push({unit:r,priority:od[r]});return t.sort(function(n,s){return n.priority-s.priority}),t}var Ec=/\d/,tt=/\d\d/,bc=/\d{3}/,na=/\d{4}/,Xi=/[+-]?\d{6}/,pe=/\d\d?/,Sc=/\d\d\d\d?/,Ac=/\d\d\d\d\d\d?/,Qi=/\d{1,3}/,ia=/\d{1,4}/,es=/[+-]?\d{1,6}/,an=/\d+/,ts=/[+-]?\d+/,ud=/Z|[+-]\d\d:?\d\d/gi,rs=/Z|[+-]\d\d(?::?\d\d)?/gi,cd=/[+-]?\d+(\.\d{1,3})?/,Zn=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,un=/^[1-9]\d?/,sa=/^([1-9]\d|\d)/,Ci;Ci={};function F(e,t,r){Ci[e]=Lt(t)?t:function(n,s){return n&&r?r:t}}function fd(e,t){return te(Ci,e)?Ci[e](t._strict,t._locale):new RegExp(ld(e))}function ld(e){return zt(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,s,i){return r||n||s||i}))}function zt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function lt(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function J(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=lt(t)),r}var Co={};function ce(e,t){var r,n=t,s;for(typeof e=="string"&&(e=[e]),Xt(t)&&(n=function(i,o){o[t]=J(i)}),s=e.length,r=0;r<s;r++)Co[e[r]]=n}function Xn(e,t){ce(e,function(r,n,s,i){s._w=s._w||{},t(r,s._w,s,i)})}function hd(e,t,r){t!=null&&te(Co,e)&&Co[e](t,r._a,r,e)}function ns(e){return e%4===0&&e%100!==0||e%400===0}var Ue=0,Vt=1,Nt=2,Ne=3,wt=4,Jt=5,Sr=6,dd=7,pd=8;j("Y",0,0,function(){var e=this.year();return e<=9999?Pt(e,4):"+"+e});j(0,["YY",2],0,function(){return this.year()%100});j(0,["YYYY",4],0,"year");j(0,["YYYYY",5],0,"year");j(0,["YYYYYY",6,!0],0,"year");F("Y",ts);F("YY",pe,tt);F("YYYY",ia,na);F("YYYYY",es,Xi);F("YYYYYY",es,Xi);ce(["YYYYY","YYYYYY"],Ue);ce("YYYY",function(e,t){t[Ue]=e.length===2?k.parseTwoDigitYear(e):J(e)});ce("YY",function(e,t){t[Ue]=k.parseTwoDigitYear(e)});ce("Y",function(e,t){t[Ue]=parseInt(e,10)});function Fn(e){return ns(e)?366:365}k.parseTwoDigitYear=function(e){return J(e)+(J(e)>68?1900:2e3)};var Ic=cn("FullYear",!0);function yd(){return ns(this.year())}function cn(e,t){return function(r){return r!=null?(Tc(this,e,r),k.updateOffset(this,t),this):Un(this,e)}}function Un(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function Tc(e,t,r){var n,s,i,o,u;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,s=e._isUTC,t){case"Milliseconds":return void(s?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(s?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(s?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(s?n.setUTCHours(r):n.setHours(r));case"Date":return void(s?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}i=r,o=e.month(),u=e.date(),u=u===29&&o===1&&!ns(i)?28:u,s?n.setUTCFullYear(i,o,u):n.setFullYear(i,o,u)}}function gd(e){return e=gt(e),Lt(this[e])?this[e]():this}function _d(e,t){if(typeof e=="object"){e=ra(e);var r=ad(e),n,s=r.length;for(n=0;n<s;n++)this[r[n].unit](e[r[n].unit])}else if(e=gt(e),Lt(this[e]))return this[e](t);return this}function md(e,t){return(e%t+t)%t}var Ie;Array.prototype.indexOf?Ie=Array.prototype.indexOf:Ie=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function oa(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=md(t,12);return e+=(t-r)/12,r===1?ns(e)?29:28:31-r%7%2}j("M",["MM",2],"Mo",function(){return this.month()+1});j("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});j("MMMM",0,0,function(e){return this.localeData().months(this,e)});F("M",pe,un);F("MM",pe,tt);F("MMM",function(e,t){return t.monthsShortRegex(e)});F("MMMM",function(e,t){return t.monthsRegex(e)});ce(["M","MM"],function(e,t){t[Vt]=J(e)-1});ce(["MMM","MMMM"],function(e,t,r,n){var s=r._locale.monthsParse(e,n,r._strict);s!=null?t[Vt]=s:K(r).invalidMonth=e});var vd="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Oc="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),xc=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,wd=Zn,Ed=Zn;function bd(e,t){return e?Et(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||xc).test(t)?"format":"standalone"][e.month()]:Et(this._months)?this._months:this._months.standalone}function Sd(e,t){return e?Et(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[xc.test(t)?"format":"standalone"][e.month()]:Et(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ad(e,t,r){var n,s,i,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Ft([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(s=Ie.call(this._shortMonthsParse,o),s!==-1?s:null):(s=Ie.call(this._longMonthsParse,o),s!==-1?s:null):t==="MMM"?(s=Ie.call(this._shortMonthsParse,o),s!==-1?s:(s=Ie.call(this._longMonthsParse,o),s!==-1?s:null)):(s=Ie.call(this._longMonthsParse,o),s!==-1?s:(s=Ie.call(this._shortMonthsParse,o),s!==-1?s:null))}function Id(e,t,r){var n,s,i;if(this._monthsParseExact)return Ad.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(s=Ft([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function Nc(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=J(t);else if(t=e.localeData().monthsParse(t),!Xt(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,oa(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function Rc(e){return e!=null?(Nc(this,e),k.updateOffset(this,!0),this):Un(this,"Month")}function Td(){return oa(this.year(),this.month())}function Od(e){return this._monthsParseExact?(te(this,"_monthsRegex")||Dc.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(te(this,"_monthsShortRegex")||(this._monthsShortRegex=wd),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function xd(e){return this._monthsParseExact?(te(this,"_monthsRegex")||Dc.call(this),e?this._monthsStrictRegex:this._monthsRegex):(te(this,"_monthsRegex")||(this._monthsRegex=Ed),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Dc(){function e(h,a){return a.length-h.length}var t=[],r=[],n=[],s,i,o,u;for(s=0;s<12;s++)i=Ft([2e3,s]),o=zt(this.monthsShort(i,"")),u=zt(this.months(i,"")),t.push(o),r.push(u),n.push(u),n.push(o);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Nd(e,t,r,n,s,i,o){var u;return e<100&&e>=0?(u=new Date(e+400,t,r,n,s,i,o),isFinite(u.getFullYear())&&u.setFullYear(e)):u=new Date(e,t,r,n,s,i,o),u}function Bn(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Pi(e,t,r){var n=7+t-r,s=(7+Bn(e,0,n).getUTCDay()-t)%7;return-s+n-1}function Cc(e,t,r,n,s){var i=(7+r-n)%7,o=Pi(e,n,s),u=1+7*(t-1)+i+o,h,a;return u<=0?(h=e-1,a=Fn(h)+u):u>Fn(e)?(h=e+1,a=u-Fn(e)):(h=e,a=u),{year:h,dayOfYear:a}}function $n(e,t,r){var n=Pi(e.year(),t,r),s=Math.floor((e.dayOfYear()-n-1)/7)+1,i,o;return s<1?(o=e.year()-1,i=s+Zt(o,t,r)):s>Zt(e.year(),t,r)?(i=s-Zt(e.year(),t,r),o=e.year()+1):(o=e.year(),i=s),{week:i,year:o}}function Zt(e,t,r){var n=Pi(e,t,r),s=Pi(e+1,t,r);return(Fn(e)-n+s)/7}j("w",["ww",2],"wo","week");j("W",["WW",2],"Wo","isoWeek");F("w",pe,un);F("ww",pe,tt);F("W",pe,un);F("WW",pe,tt);Xn(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=J(e)});function Rd(e){return $n(e,this._week.dow,this._week.doy).week}var Dd={dow:0,doy:6};function Cd(){return this._week.dow}function Pd(){return this._week.doy}function kd(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Md(e){var t=$n(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}j("d",0,"do","day");j("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});j("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});j("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});j("e",0,0,"weekday");j("E",0,0,"isoWeekday");F("d",pe);F("e",pe);F("E",pe);F("dd",function(e,t){return t.weekdaysMinRegex(e)});F("ddd",function(e,t){return t.weekdaysShortRegex(e)});F("dddd",function(e,t){return t.weekdaysRegex(e)});Xn(["dd","ddd","dddd"],function(e,t,r,n){var s=r._locale.weekdaysParse(e,n,r._strict);s!=null?t.d=s:K(r).invalidWeekday=e});Xn(["d","e","E"],function(e,t,r,n){t[n]=J(e)});function Fd(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Ld(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function aa(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Ud="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Pc="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Bd="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),$d=Zn,Wd=Zn,jd=Zn;function Yd(e,t){var r=Et(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?aa(r,this._week.dow):e?r[e.day()]:r}function Hd(e){return e===!0?aa(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function qd(e){return e===!0?aa(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Gd(e,t,r){var n,s,i,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Ft([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(s=Ie.call(this._weekdaysParse,o),s!==-1?s:null):t==="ddd"?(s=Ie.call(this._shortWeekdaysParse,o),s!==-1?s:null):(s=Ie.call(this._minWeekdaysParse,o),s!==-1?s:null):t==="dddd"?(s=Ie.call(this._weekdaysParse,o),s!==-1||(s=Ie.call(this._shortWeekdaysParse,o),s!==-1)?s:(s=Ie.call(this._minWeekdaysParse,o),s!==-1?s:null)):t==="ddd"?(s=Ie.call(this._shortWeekdaysParse,o),s!==-1||(s=Ie.call(this._weekdaysParse,o),s!==-1)?s:(s=Ie.call(this._minWeekdaysParse,o),s!==-1?s:null)):(s=Ie.call(this._minWeekdaysParse,o),s!==-1||(s=Ie.call(this._weekdaysParse,o),s!==-1)?s:(s=Ie.call(this._shortWeekdaysParse,o),s!==-1?s:null))}function Kd(e,t,r){var n,s,i;if(this._weekdaysParseExact)return Gd.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(s=Ft([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Vd(e){if(!this.isValid())return e!=null?this:NaN;var t=Un(this,"Day");return e!=null?(e=Fd(e,this.localeData()),this.add(e-t,"d")):t}function Jd(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function zd(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Ld(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Zd(e){return this._weekdaysParseExact?(te(this,"_weekdaysRegex")||ua.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(te(this,"_weekdaysRegex")||(this._weekdaysRegex=$d),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Xd(e){return this._weekdaysParseExact?(te(this,"_weekdaysRegex")||ua.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(te(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Wd),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Qd(e){return this._weekdaysParseExact?(te(this,"_weekdaysRegex")||ua.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(te(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=jd),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ua(){function e(c,d){return d.length-c.length}var t=[],r=[],n=[],s=[],i,o,u,h,a;for(i=0;i<7;i++)o=Ft([2e3,1]).day(i),u=zt(this.weekdaysMin(o,"")),h=zt(this.weekdaysShort(o,"")),a=zt(this.weekdays(o,"")),t.push(u),r.push(h),n.push(a),s.push(u),s.push(h),s.push(a);t.sort(e),r.sort(e),n.sort(e),s.sort(e),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function ca(){return this.hours()%12||12}function ep(){return this.hours()||24}j("H",["HH",2],0,"hour");j("h",["hh",2],0,ca);j("k",["kk",2],0,ep);j("hmm",0,0,function(){return""+ca.apply(this)+Pt(this.minutes(),2)});j("hmmss",0,0,function(){return""+ca.apply(this)+Pt(this.minutes(),2)+Pt(this.seconds(),2)});j("Hmm",0,0,function(){return""+this.hours()+Pt(this.minutes(),2)});j("Hmmss",0,0,function(){return""+this.hours()+Pt(this.minutes(),2)+Pt(this.seconds(),2)});function kc(e,t){j(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}kc("a",!0);kc("A",!1);function Mc(e,t){return t._meridiemParse}F("a",Mc);F("A",Mc);F("H",pe,sa);F("h",pe,un);F("k",pe,un);F("HH",pe,tt);F("hh",pe,tt);F("kk",pe,tt);F("hmm",Sc);F("hmmss",Ac);F("Hmm",Sc);F("Hmmss",Ac);ce(["H","HH"],Ne);ce(["k","kk"],function(e,t,r){var n=J(e);t[Ne]=n===24?0:n});ce(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ce(["h","hh"],function(e,t,r){t[Ne]=J(e),K(r).bigHour=!0});ce("hmm",function(e,t,r){var n=e.length-2;t[Ne]=J(e.substr(0,n)),t[wt]=J(e.substr(n)),K(r).bigHour=!0});ce("hmmss",function(e,t,r){var n=e.length-4,s=e.length-2;t[Ne]=J(e.substr(0,n)),t[wt]=J(e.substr(n,2)),t[Jt]=J(e.substr(s)),K(r).bigHour=!0});ce("Hmm",function(e,t,r){var n=e.length-2;t[Ne]=J(e.substr(0,n)),t[wt]=J(e.substr(n))});ce("Hmmss",function(e,t,r){var n=e.length-4,s=e.length-2;t[Ne]=J(e.substr(0,n)),t[wt]=J(e.substr(n,2)),t[Jt]=J(e.substr(s))});function tp(e){return(e+"").toLowerCase().charAt(0)==="p"}var rp=/[ap]\.?m?\.?/i,np=cn("Hours",!0);function ip(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var Fc={calendar:Gh,longDateFormat:zh,invalidDate:Xh,ordinal:ed,dayOfMonthOrdinalParse:td,relativeTime:nd,months:vd,monthsShort:Oc,week:Dd,weekdays:Ud,weekdaysMin:Bd,weekdaysShort:Pc,meridiemParse:rp},_e={},En={},Wn;function sp(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function nu(e){return e&&e.toLowerCase().replace("_","-")}function op(e){for(var t=0,r,n,s,i;t<e.length;){for(i=nu(e[t]).split("-"),r=i.length,n=nu(e[t+1]),n=n?n.split("-"):null;r>0;){if(s=is(i.slice(0,r).join("-")),s)return s;if(n&&n.length>=r&&sp(i,n)>=r-1)break;r--}t++}return Wn}function ap(e){return!!(e&&e.match("^[^/\\\\]*$"))}function is(e){var t=null,r;if(_e[e]===void 0&&typeof module<"u"&&module&&module.exports&&ap(e))try{t=Wn._abbr,r=require,r("./locale/"+e),ar(t)}catch{_e[e]=null}return _e[e]}function ar(e,t){var r;return e&&(Ke(t)?r=Qt(e):r=fa(e,t),r?Wn=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Wn._abbr}function fa(e,t){if(t!==null){var r,n=Fc;if(t.abbr=e,_e[e]!=null)vc("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=_e[e]._config;else if(t.parentLocale!=null)if(_e[t.parentLocale]!=null)n=_e[t.parentLocale]._config;else if(r=is(t.parentLocale),r!=null)n=r._config;else return En[t.parentLocale]||(En[t.parentLocale]=[]),En[t.parentLocale].push({name:e,config:t}),null;return _e[e]=new ea(Ro(n,t)),En[e]&&En[e].forEach(function(s){fa(s.name,s.config)}),ar(e),_e[e]}else return delete _e[e],null}function up(e,t){if(t!=null){var r,n,s=Fc;_e[e]!=null&&_e[e].parentLocale!=null?_e[e].set(Ro(_e[e]._config,t)):(n=is(e),n!=null&&(s=n._config),t=Ro(s,t),n==null&&(t.abbr=e),r=new ea(t),r.parentLocale=_e[e],_e[e]=r),ar(e)}else _e[e]!=null&&(_e[e].parentLocale!=null?(_e[e]=_e[e].parentLocale,e===ar()&&ar(e)):_e[e]!=null&&delete _e[e]);return _e[e]}function Qt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Wn;if(!Et(e)){if(t=is(e),t)return t;e=[e]}return op(e)}function cp(){return Do(_e)}function la(e){var t,r=e._a;return r&&K(e).overflow===-2&&(t=r[Vt]<0||r[Vt]>11?Vt:r[Nt]<1||r[Nt]>oa(r[Ue],r[Vt])?Nt:r[Ne]<0||r[Ne]>24||r[Ne]===24&&(r[wt]!==0||r[Jt]!==0||r[Sr]!==0)?Ne:r[wt]<0||r[wt]>59?wt:r[Jt]<0||r[Jt]>59?Jt:r[Sr]<0||r[Sr]>999?Sr:-1,K(e)._overflowDayOfYear&&(t<Ue||t>Nt)&&(t=Nt),K(e)._overflowWeeks&&t===-1&&(t=dd),K(e)._overflowWeekday&&t===-1&&(t=pd),K(e).overflow=t),e}var fp=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lp=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,hp=/Z|[+-]\d\d(?::?\d\d)?/,hi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ys=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],dp=/^\/?Date\((-?\d+)/i,pp=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yp={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Lc(e){var t,r,n=e._i,s=fp.exec(n)||lp.exec(n),i,o,u,h,a=hi.length,c=Ys.length;if(s){for(K(e).iso=!0,t=0,r=a;t<r;t++)if(hi[t][1].exec(s[1])){o=hi[t][0],i=hi[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(s[3]){for(t=0,r=c;t<r;t++)if(Ys[t][1].exec(s[3])){u=(s[2]||" ")+Ys[t][0];break}if(u==null){e._isValid=!1;return}}if(!i&&u!=null){e._isValid=!1;return}if(s[4])if(hp.exec(s[4]))h="Z";else{e._isValid=!1;return}e._f=o+(u||"")+(h||""),da(e)}else e._isValid=!1}function gp(e,t,r,n,s,i){var o=[_p(e),Oc.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(s,10)];return i&&o.push(parseInt(i,10)),o}function _p(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function mp(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function vp(e,t,r){if(e){var n=Pc.indexOf(e),s=new Date(t[0],t[1],t[2]).getDay();if(n!==s)return K(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function wp(e,t,r){if(e)return yp[e];if(t)return 0;var n=parseInt(r,10),s=n%100,i=(n-s)/100;return i*60+s}function Uc(e){var t=pp.exec(mp(e._i)),r;if(t){if(r=gp(t[4],t[3],t[2],t[5],t[6],t[7]),!vp(t[1],r,e))return;e._a=r,e._tzm=wp(t[8],t[9],t[10]),e._d=Bn.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),K(e).rfc2822=!0}else e._isValid=!1}function Ep(e){var t=dp.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(Lc(e),e._isValid===!1)delete e._isValid;else return;if(Uc(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:k.createFromInputFallback(e)}k.createFromInputFallback=yt("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Gr(e,t,r){return e??t??r}function bp(e){var t=new Date(k.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function ha(e){var t,r,n=[],s,i,o;if(!e._d){for(s=bp(e),e._w&&e._a[Nt]==null&&e._a[Vt]==null&&Sp(e),e._dayOfYear!=null&&(o=Gr(e._a[Ue],s[Ue]),(e._dayOfYear>Fn(o)||e._dayOfYear===0)&&(K(e)._overflowDayOfYear=!0),r=Bn(o,0,e._dayOfYear),e._a[Vt]=r.getUTCMonth(),e._a[Nt]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=s[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Ne]===24&&e._a[wt]===0&&e._a[Jt]===0&&e._a[Sr]===0&&(e._nextDay=!0,e._a[Ne]=0),e._d=(e._useUTC?Bn:Nd).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ne]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(K(e).weekdayMismatch=!0)}}function Sp(e){var t,r,n,s,i,o,u,h,a;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,o=4,r=Gr(t.GG,e._a[Ue],$n(de(),1,4).year),n=Gr(t.W,1),s=Gr(t.E,1),(s<1||s>7)&&(h=!0)):(i=e._locale._week.dow,o=e._locale._week.doy,a=$n(de(),i,o),r=Gr(t.gg,e._a[Ue],a.year),n=Gr(t.w,a.week),t.d!=null?(s=t.d,(s<0||s>6)&&(h=!0)):t.e!=null?(s=t.e+i,(t.e<0||t.e>6)&&(h=!0)):s=i),n<1||n>Zt(r,i,o)?K(e)._overflowWeeks=!0:h!=null?K(e)._overflowWeekday=!0:(u=Cc(r,n,s,i,o),e._a[Ue]=u.year,e._dayOfYear=u.dayOfYear)}k.ISO_8601=function(){};k.RFC_2822=function(){};function da(e){if(e._f===k.ISO_8601){Lc(e);return}if(e._f===k.RFC_2822){Uc(e);return}e._a=[],K(e).empty=!0;var t=""+e._i,r,n,s,i,o,u=t.length,h=0,a,c;for(s=wc(e._f,e._locale).match(ta)||[],c=s.length,r=0;r<c;r++)i=s[r],n=(t.match(fd(i,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&K(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),h+=n.length),Xr[i]?(n?K(e).empty=!1:K(e).unusedTokens.push(i),hd(i,n,e)):e._strict&&!n&&K(e).unusedTokens.push(i);K(e).charsLeftOver=u-h,t.length>0&&K(e).unusedInput.push(t),e._a[Ne]<=12&&K(e).bigHour===!0&&e._a[Ne]>0&&(K(e).bigHour=void 0),K(e).parsedDateParts=e._a.slice(0),K(e).meridiem=e._meridiem,e._a[Ne]=Ap(e._locale,e._a[Ne],e._meridiem),a=K(e).era,a!==null&&(e._a[Ue]=e._locale.erasConvertYear(a,e._a[Ue])),ha(e),la(e)}function Ap(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Ip(e){var t,r,n,s,i,o,u=!1,h=e._f.length;if(h===0){K(e).invalidFormat=!0,e._d=new Date(NaN);return}for(s=0;s<h;s++)i=0,o=!1,t=Qo({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[s],da(t),Xo(t)&&(o=!0),i+=K(t).charsLeftOver,i+=K(t).unusedTokens.length*10,K(t).score=i,u?i<n&&(n=i,r=t):(n==null||i<n||o)&&(n=i,r=t,o&&(u=!0));nr(e,r||t)}function Tp(e){if(!e._d){var t=ra(e._i),r=t.day===void 0?t.date:t.day;e._a=_c([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),ha(e)}}function Op(e){var t=new zn(la(Bc(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Bc(e){var t=e._i,r=e._f;return e._locale=e._locale||Qt(e._l),t===null||r===void 0&&t===""?Zi({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),bt(t)?new zn(la(t)):(Jn(t)?e._d=t:Et(r)?Ip(e):r?da(e):xp(e),Xo(e)||(e._d=null),e))}function xp(e){var t=e._i;Ke(t)?e._d=new Date(k.now()):Jn(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Ep(e):Et(t)?(e._a=_c(t.slice(0),function(r){return parseInt(r,10)}),ha(e)):Ir(t)?Tp(e):Xt(t)?e._d=new Date(t):k.createFromInputFallback(e)}function $c(e,t,r,n,s){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ir(e)&&Zo(e)||Et(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=s,i._l=r,i._i=e,i._f=t,i._strict=n,Op(i)}function de(e,t,r,n){return $c(e,t,r,n,!1)}var Np=yt("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=de.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Zi()}),Rp=yt("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=de.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Zi()});function Wc(e,t){var r,n;if(t.length===1&&Et(t[0])&&(t=t[0]),!t.length)return de();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Dp(){var e=[].slice.call(arguments,0);return Wc("isBefore",e)}function Cp(){var e=[].slice.call(arguments,0);return Wc("isAfter",e)}var Pp=function(){return Date.now?Date.now():+new Date},bn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function kp(e){var t,r=!1,n,s=bn.length;for(t in e)if(te(e,t)&&!(Ie.call(bn,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<s;++n)if(e[bn[n]]){if(r)return!1;parseFloat(e[bn[n]])!==J(e[bn[n]])&&(r=!0)}return!0}function Mp(){return this._isValid}function Fp(){return St(NaN)}function ss(e){var t=ra(e),r=t.year||0,n=t.quarter||0,s=t.month||0,i=t.week||t.isoWeek||0,o=t.day||0,u=t.hour||0,h=t.minute||0,a=t.second||0,c=t.millisecond||0;this._isValid=kp(t),this._milliseconds=+c+a*1e3+h*6e4+u*1e3*60*60,this._days=+o+i*7,this._months=+s+n*3+r*12,this._data={},this._locale=Qt(),this._bubble()}function xi(e){return e instanceof ss}function Po(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Lp(e,t,r){var n=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),i=0,o;for(o=0;o<n;o++)J(e[o])!==J(t[o])&&i++;return i+s}function jc(e,t){j(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Pt(~~(r/60),2)+t+Pt(~~r%60,2)})}jc("Z",":");jc("ZZ","");F("Z",rs);F("ZZ",rs);ce(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=pa(rs,e)});var Up=/([\+\-]|\d\d)/gi;function pa(e,t){var r=(t||"").match(e),n,s,i;return r===null?null:(n=r[r.length-1]||[],s=(n+"").match(Up)||["-",0,0],i=+(s[1]*60)+J(s[2]),i===0?0:s[0]==="+"?i:-i)}function ya(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(bt(e)||Jn(e)?e.valueOf():de(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),k.updateOffset(r,!1),r):de(e).local()}function ko(e){return-Math.round(e._d.getTimezoneOffset())}k.updateOffset=function(){};function Bp(e,t,r){var n=this._offset||0,s;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=pa(rs,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(s=ko(this)),this._offset=e,this._isUTC=!0,s!=null&&this.add(s,"m"),n!==e&&(!t||this._changeInProgress?qc(this,St(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,k.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:ko(this)}function $p(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Wp(e){return this.utcOffset(0,e)}function jp(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(ko(this),"m")),this}function Yp(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=pa(ud,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Hp(e){return this.isValid()?(e=e?de(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function qp(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Gp(){if(!Ke(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Qo(e,this),e=Bc(e),e._a?(t=e._isUTC?Ft(e._a):de(e._a),this._isDSTShifted=this.isValid()&&Lp(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Kp(){return this.isValid()?!this._isUTC:!1}function Vp(){return this.isValid()?this._isUTC:!1}function Yc(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Jp=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,zp=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function St(e,t){var r=e,n=null,s,i,o;return xi(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Xt(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Jp.exec(e))?(s=n[1]==="-"?-1:1,r={y:0,d:J(n[Nt])*s,h:J(n[Ne])*s,m:J(n[wt])*s,s:J(n[Jt])*s,ms:J(Po(n[Sr]*1e3))*s}):(n=zp.exec(e))?(s=n[1]==="-"?-1:1,r={y:gr(n[2],s),M:gr(n[3],s),w:gr(n[4],s),d:gr(n[5],s),h:gr(n[6],s),m:gr(n[7],s),s:gr(n[8],s)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=Zp(de(r.from),de(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),i=new ss(r),xi(e)&&te(e,"_locale")&&(i._locale=e._locale),xi(e)&&te(e,"_isValid")&&(i._isValid=e._isValid),i}St.fn=ss.prototype;St.invalid=Fp;function gr(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function iu(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Zp(e,t){var r;return e.isValid()&&t.isValid()?(t=ya(t,e),e.isBefore(t)?r=iu(e,t):(r=iu(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function Hc(e,t){return function(r,n){var s,i;return n!==null&&!isNaN(+n)&&(vc(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),s=St(r,n),qc(this,s,e),this}}function qc(e,t,r,n){var s=t._milliseconds,i=Po(t._days),o=Po(t._months);e.isValid()&&(n=n??!0,o&&Nc(e,Un(e,"Month")+o*r),i&&Tc(e,"Date",Un(e,"Date")+i*r),s&&e._d.setTime(e._d.valueOf()+s*r),n&&k.updateOffset(e,i||o))}var Xp=Hc(1,"add"),Qp=Hc(-1,"subtract");function Gc(e){return typeof e=="string"||e instanceof String}function ey(e){return bt(e)||Jn(e)||Gc(e)||Xt(e)||ry(e)||ty(e)||e===null||e===void 0}function ty(e){var t=Ir(e)&&!Zo(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,i,o=n.length;for(s=0;s<o;s+=1)i=n[s],r=r||te(e,i);return t&&r}function ry(e){var t=Et(e),r=!1;return t&&(r=e.filter(function(n){return!Xt(n)&&Gc(e)}).length===0),t&&r}function ny(e){var t=Ir(e)&&!Zo(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,i;for(s=0;s<n.length;s+=1)i=n[s],r=r||te(e,i);return t&&r}function iy(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function sy(e,t){arguments.length===1&&(arguments[0]?ey(arguments[0])?(e=arguments[0],t=void 0):ny(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||de(),n=ya(r,this).startOf("day"),s=k.calendarFormat(this,n)||"sameElse",i=t&&(Lt(t[s])?t[s].call(this,r):t[s]);return this.format(i||this.localeData().calendar(s,this,de(r)))}function oy(){return new zn(this)}function ay(e,t){var r=bt(e)?e:de(e);return this.isValid()&&r.isValid()?(t=gt(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function uy(e,t){var r=bt(e)?e:de(e);return this.isValid()&&r.isValid()?(t=gt(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function cy(e,t,r,n){var s=bt(e)?e:de(e),i=bt(t)?t:de(t);return this.isValid()&&s.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(s,r):!this.isBefore(s,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function fy(e,t){var r=bt(e)?e:de(e),n;return this.isValid()&&r.isValid()?(t=gt(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function ly(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function hy(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function dy(e,t,r){var n,s,i;if(!this.isValid())return NaN;if(n=ya(e,this),!n.isValid())return NaN;switch(s=(n.utcOffset()-this.utcOffset())*6e4,t=gt(t),t){case"year":i=Ni(this,n)/12;break;case"month":i=Ni(this,n);break;case"quarter":i=Ni(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-s)/864e5;break;case"week":i=(this-n-s)/6048e5;break;default:i=this-n}return r?i:lt(i)}function Ni(e,t){if(e.date()<t.date())return-Ni(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),s,i;return t-n<0?(s=e.clone().add(r-1,"months"),i=(t-n)/(n-s)):(s=e.clone().add(r+1,"months"),i=(t-n)/(s-n)),-(r+i)||0}k.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";k.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function py(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function yy(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Oi(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Lt(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Oi(r,"Z")):Oi(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function gy(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,s,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+s+i)}function _y(e){e||(e=this.isUtc()?k.defaultFormatUtc:k.defaultFormat);var t=Oi(this,e);return this.localeData().postformat(t)}function my(e,t){return this.isValid()&&(bt(e)&&e.isValid()||de(e).isValid())?St({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function vy(e){return this.from(de(),e)}function wy(e,t){return this.isValid()&&(bt(e)&&e.isValid()||de(e).isValid())?St({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Ey(e){return this.to(de(),e)}function Kc(e){var t;return e===void 0?this._locale._abbr:(t=Qt(e),t!=null&&(this._locale=t),this)}var Vc=yt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function Jc(){return this._locale}var ki=1e3,Qr=60*ki,Mi=60*Qr,zc=(365*400+97)*24*Mi;function en(e,t){return(e%t+t)%t}function Zc(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-zc:new Date(e,t,r).valueOf()}function Xc(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-zc:Date.UTC(e,t,r)}function by(e){var t,r;if(e=gt(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Xc:Zc,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=en(t+(this._isUTC?0:this.utcOffset()*Qr),Mi);break;case"minute":t=this._d.valueOf(),t-=en(t,Qr);break;case"second":t=this._d.valueOf(),t-=en(t,ki);break}return this._d.setTime(t),k.updateOffset(this,!0),this}function Sy(e){var t,r;if(e=gt(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Xc:Zc,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Mi-en(t+(this._isUTC?0:this.utcOffset()*Qr),Mi)-1;break;case"minute":t=this._d.valueOf(),t+=Qr-en(t,Qr)-1;break;case"second":t=this._d.valueOf(),t+=ki-en(t,ki)-1;break}return this._d.setTime(t),k.updateOffset(this,!0),this}function Ay(){return this._d.valueOf()-(this._offset||0)*6e4}function Iy(){return Math.floor(this.valueOf()/1e3)}function Ty(){return new Date(this.valueOf())}function Oy(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function xy(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ny(){return this.isValid()?this.toISOString():null}function Ry(){return Xo(this)}function Dy(){return nr({},K(this))}function Cy(){return K(this).overflow}function Py(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}j("N",0,0,"eraAbbr");j("NN",0,0,"eraAbbr");j("NNN",0,0,"eraAbbr");j("NNNN",0,0,"eraName");j("NNNNN",0,0,"eraNarrow");j("y",["y",1],"yo","eraYear");j("y",["yy",2],0,"eraYear");j("y",["yyy",3],0,"eraYear");j("y",["yyyy",4],0,"eraYear");F("N",ga);F("NN",ga);F("NNN",ga);F("NNNN",Hy);F("NNNNN",qy);ce(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var s=r._locale.erasParse(e,n,r._strict);s?K(r).era=s:K(r).invalidEra=e});F("y",an);F("yy",an);F("yyy",an);F("yyyy",an);F("yo",Gy);ce(["y","yy","yyy","yyyy"],Ue);ce(["yo"],function(e,t,r,n){var s;r._locale._eraYearOrdinalRegex&&(s=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Ue]=r._locale.eraYearOrdinalParse(e,s):t[Ue]=parseInt(e,10)});function ky(e,t){var r,n,s,i=this._eras||Qt("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":s=k(i[r].since).startOf("day"),i[r].since=s.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":s=k(i[r].until).startOf("day").valueOf(),i[r].until=s.valueOf();break}}return i}function My(e,t,r){var n,s,i=this.eras(),o,u,h;for(e=e.toUpperCase(),n=0,s=i.length;n<s;++n)if(o=i[n].name.toUpperCase(),u=i[n].abbr.toUpperCase(),h=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(u===e)return i[n];break;case"NNNN":if(o===e)return i[n];break;case"NNNNN":if(h===e)return i[n];break}else if([o,u,h].indexOf(e)>=0)return i[n]}function Fy(e,t){var r=e.since<=e.until?1:-1;return t===void 0?k(e.since).year():k(e.since).year()+(t-e.offset)*r}function Ly(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Uy(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function By(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function $y(){var e,t,r,n,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e)if(r=s[e].since<=s[e].until?1:-1,n=this.clone().startOf("day").valueOf(),s[e].since<=n&&n<=s[e].until||s[e].until<=n&&n<=s[e].since)return(this.year()-k(s[e].since).year())*r+s[e].offset;return this.year()}function Wy(e){return te(this,"_erasNameRegex")||_a.call(this),e?this._erasNameRegex:this._erasRegex}function jy(e){return te(this,"_erasAbbrRegex")||_a.call(this),e?this._erasAbbrRegex:this._erasRegex}function Yy(e){return te(this,"_erasNarrowRegex")||_a.call(this),e?this._erasNarrowRegex:this._erasRegex}function ga(e,t){return t.erasAbbrRegex(e)}function Hy(e,t){return t.erasNameRegex(e)}function qy(e,t){return t.erasNarrowRegex(e)}function Gy(e,t){return t._eraYearOrdinalRegex||an}function _a(){var e=[],t=[],r=[],n=[],s,i,o,u,h,a=this.eras();for(s=0,i=a.length;s<i;++s)o=zt(a[s].name),u=zt(a[s].abbr),h=zt(a[s].narrow),t.push(o),e.push(u),r.push(h),n.push(o),n.push(u),n.push(h);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}j(0,["gg",2],0,function(){return this.weekYear()%100});j(0,["GG",2],0,function(){return this.isoWeekYear()%100});function os(e,t){j(0,[e,e.length],0,t)}os("gggg","weekYear");os("ggggg","weekYear");os("GGGG","isoWeekYear");os("GGGGG","isoWeekYear");F("G",ts);F("g",ts);F("GG",pe,tt);F("gg",pe,tt);F("GGGG",ia,na);F("gggg",ia,na);F("GGGGG",es,Xi);F("ggggg",es,Xi);Xn(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=J(e)});Xn(["gg","GG"],function(e,t,r,n){t[n]=k.parseTwoDigitYear(e)});function Ky(e){return Qc.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Vy(e){return Qc.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Jy(){return Zt(this.year(),1,4)}function zy(){return Zt(this.isoWeekYear(),1,4)}function Zy(){var e=this.localeData()._week;return Zt(this.year(),e.dow,e.doy)}function Xy(){var e=this.localeData()._week;return Zt(this.weekYear(),e.dow,e.doy)}function Qc(e,t,r,n,s){var i;return e==null?$n(this,n,s).year:(i=Zt(e,n,s),t>i&&(t=i),Qy.call(this,e,t,r,n,s))}function Qy(e,t,r,n,s){var i=Cc(e,t,r,n,s),o=Bn(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}j("Q",0,"Qo","quarter");F("Q",Ec);ce("Q",function(e,t){t[Vt]=(J(e)-1)*3});function e0(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}j("D",["DD",2],"Do","date");F("D",pe,un);F("DD",pe,tt);F("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ce(["D","DD"],Nt);ce("Do",function(e,t){t[Nt]=J(e.match(pe)[0])});var ef=cn("Date",!0);j("DDD",["DDDD",3],"DDDo","dayOfYear");F("DDD",Qi);F("DDDD",bc);ce(["DDD","DDDD"],function(e,t,r){r._dayOfYear=J(e)});function t0(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}j("m",["mm",2],0,"minute");F("m",pe,sa);F("mm",pe,tt);ce(["m","mm"],wt);var r0=cn("Minutes",!1);j("s",["ss",2],0,"second");F("s",pe,sa);F("ss",pe,tt);ce(["s","ss"],Jt);var n0=cn("Seconds",!1);j("S",0,0,function(){return~~(this.millisecond()/100)});j(0,["SS",2],0,function(){return~~(this.millisecond()/10)});j(0,["SSS",3],0,"millisecond");j(0,["SSSS",4],0,function(){return this.millisecond()*10});j(0,["SSSSS",5],0,function(){return this.millisecond()*100});j(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});j(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});j(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});j(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});F("S",Qi,Ec);F("SS",Qi,tt);F("SSS",Qi,bc);var ir,tf;for(ir="SSSS";ir.length<=9;ir+="S")F(ir,an);function i0(e,t){t[Sr]=J(("0."+e)*1e3)}for(ir="S";ir.length<=9;ir+="S")ce(ir,i0);tf=cn("Milliseconds",!1);j("z",0,0,"zoneAbbr");j("zz",0,0,"zoneName");function s0(){return this._isUTC?"UTC":""}function o0(){return this._isUTC?"Coordinated Universal Time":""}var C=zn.prototype;C.add=Xp;C.calendar=sy;C.clone=oy;C.diff=dy;C.endOf=Sy;C.format=_y;C.from=my;C.fromNow=vy;C.to=wy;C.toNow=Ey;C.get=gd;C.invalidAt=Cy;C.isAfter=ay;C.isBefore=uy;C.isBetween=cy;C.isSame=fy;C.isSameOrAfter=ly;C.isSameOrBefore=hy;C.isValid=Ry;C.lang=Vc;C.locale=Kc;C.localeData=Jc;C.max=Rp;C.min=Np;C.parsingFlags=Dy;C.set=_d;C.startOf=by;C.subtract=Qp;C.toArray=Oy;C.toObject=xy;C.toDate=Ty;C.toISOString=yy;C.inspect=gy;typeof Symbol<"u"&&Symbol.for!=null&&(C[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});C.toJSON=Ny;C.toString=py;C.unix=Iy;C.valueOf=Ay;C.creationData=Py;C.eraName=Ly;C.eraNarrow=Uy;C.eraAbbr=By;C.eraYear=$y;C.year=Ic;C.isLeapYear=yd;C.weekYear=Ky;C.isoWeekYear=Vy;C.quarter=C.quarters=e0;C.month=Rc;C.daysInMonth=Td;C.week=C.weeks=kd;C.isoWeek=C.isoWeeks=Md;C.weeksInYear=Zy;C.weeksInWeekYear=Xy;C.isoWeeksInYear=Jy;C.isoWeeksInISOWeekYear=zy;C.date=ef;C.day=C.days=Vd;C.weekday=Jd;C.isoWeekday=zd;C.dayOfYear=t0;C.hour=C.hours=np;C.minute=C.minutes=r0;C.second=C.seconds=n0;C.millisecond=C.milliseconds=tf;C.utcOffset=Bp;C.utc=Wp;C.local=jp;C.parseZone=Yp;C.hasAlignedHourOffset=Hp;C.isDST=qp;C.isLocal=Kp;C.isUtcOffset=Vp;C.isUtc=Yc;C.isUTC=Yc;C.zoneAbbr=s0;C.zoneName=o0;C.dates=yt("dates accessor is deprecated. Use date instead.",ef);C.months=yt("months accessor is deprecated. Use month instead",Rc);C.years=yt("years accessor is deprecated. Use year instead",Ic);C.zone=yt("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",$p);C.isDSTShifted=yt("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Gp);function a0(e){return de(e*1e3)}function u0(){return de.apply(null,arguments).parseZone()}function rf(e){return e}var re=ea.prototype;re.calendar=Kh;re.longDateFormat=Zh;re.invalidDate=Qh;re.ordinal=rd;re.preparse=rf;re.postformat=rf;re.relativeTime=id;re.pastFuture=sd;re.set=qh;re.eras=ky;re.erasParse=My;re.erasConvertYear=Fy;re.erasAbbrRegex=jy;re.erasNameRegex=Wy;re.erasNarrowRegex=Yy;re.months=bd;re.monthsShort=Sd;re.monthsParse=Id;re.monthsRegex=xd;re.monthsShortRegex=Od;re.week=Rd;re.firstDayOfYear=Pd;re.firstDayOfWeek=Cd;re.weekdays=Yd;re.weekdaysMin=qd;re.weekdaysShort=Hd;re.weekdaysParse=Kd;re.weekdaysRegex=Zd;re.weekdaysShortRegex=Xd;re.weekdaysMinRegex=Qd;re.isPM=tp;re.meridiem=ip;function Fi(e,t,r,n){var s=Qt(),i=Ft().set(n,t);return s[r](i,e)}function nf(e,t,r){if(Xt(e)&&(t=e,e=void 0),e=e||"",t!=null)return Fi(e,t,r,"month");var n,s=[];for(n=0;n<12;n++)s[n]=Fi(e,n,r,"month");return s}function ma(e,t,r,n){typeof e=="boolean"?(Xt(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Xt(t)&&(r=t,t=void 0),t=t||"");var s=Qt(),i=e?s._week.dow:0,o,u=[];if(r!=null)return Fi(t,(r+i)%7,n,"day");for(o=0;o<7;o++)u[o]=Fi(t,(o+i)%7,n,"day");return u}function c0(e,t){return nf(e,t,"months")}function f0(e,t){return nf(e,t,"monthsShort")}function l0(e,t,r){return ma(e,t,r,"weekdays")}function h0(e,t,r){return ma(e,t,r,"weekdaysShort")}function d0(e,t,r){return ma(e,t,r,"weekdaysMin")}ar("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=J(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});k.lang=yt("moment.lang is deprecated. Use moment.locale instead.",ar);k.langData=yt("moment.langData is deprecated. Use moment.localeData instead.",Qt);var $t=Math.abs;function p0(){var e=this._data;return this._milliseconds=$t(this._milliseconds),this._days=$t(this._days),this._months=$t(this._months),e.milliseconds=$t(e.milliseconds),e.seconds=$t(e.seconds),e.minutes=$t(e.minutes),e.hours=$t(e.hours),e.months=$t(e.months),e.years=$t(e.years),this}function sf(e,t,r,n){var s=St(t,r);return e._milliseconds+=n*s._milliseconds,e._days+=n*s._days,e._months+=n*s._months,e._bubble()}function y0(e,t){return sf(this,e,t,1)}function g0(e,t){return sf(this,e,t,-1)}function su(e){return e<0?Math.floor(e):Math.ceil(e)}function _0(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,s,i,o,u,h;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=su(Mo(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,s=lt(e/1e3),n.seconds=s%60,i=lt(s/60),n.minutes=i%60,o=lt(i/60),n.hours=o%24,t+=lt(o/24),h=lt(of(t)),r+=h,t-=su(Mo(h)),u=lt(r/12),r%=12,n.days=t,n.months=r,n.years=u,this}function of(e){return e*4800/146097}function Mo(e){return e*146097/4800}function m0(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=gt(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+of(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Mo(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function er(e){return function(){return this.as(e)}}var af=er("ms"),v0=er("s"),w0=er("m"),E0=er("h"),b0=er("d"),S0=er("w"),A0=er("M"),I0=er("Q"),T0=er("y"),O0=af;function x0(){return St(this)}function N0(e){return e=gt(e),this.isValid()?this[e+"s"]():NaN}function Dr(e){return function(){return this.isValid()?this._data[e]:NaN}}var R0=Dr("milliseconds"),D0=Dr("seconds"),C0=Dr("minutes"),P0=Dr("hours"),k0=Dr("days"),M0=Dr("months"),F0=Dr("years");function L0(){return lt(this.days()/7)}var qt=Math.round,Kr={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function U0(e,t,r,n,s){return s.relativeTime(t||1,!!r,e,n)}function B0(e,t,r,n){var s=St(e).abs(),i=qt(s.as("s")),o=qt(s.as("m")),u=qt(s.as("h")),h=qt(s.as("d")),a=qt(s.as("M")),c=qt(s.as("w")),d=qt(s.as("y")),_=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||o<=1&&["m"]||o<r.m&&["mm",o]||u<=1&&["h"]||u<r.h&&["hh",u]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(_=_||c<=1&&["w"]||c<r.w&&["ww",c]),_=_||a<=1&&["M"]||a<r.M&&["MM",a]||d<=1&&["y"]||["yy",d],_[2]=t,_[3]=+e>0,_[4]=n,U0.apply(null,_)}function $0(e){return e===void 0?qt:typeof e=="function"?(qt=e,!0):!1}function W0(e,t){return Kr[e]===void 0?!1:t===void 0?Kr[e]:(Kr[e]=t,e==="s"&&(Kr.ss=t-1),!0)}function j0(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Kr,s,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Kr,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),s=this.localeData(),i=B0(this,!r,n,s),r&&(i=s.pastFuture(+this,i)),s.postformat(i)}var Hs=Math.abs;function Br(e){return(e>0)-(e<0)||+e}function as(){if(!this.isValid())return this.localeData().invalidDate();var e=Hs(this._milliseconds)/1e3,t=Hs(this._days),r=Hs(this._months),n,s,i,o,u=this.asSeconds(),h,a,c,d;return u?(n=lt(e/60),s=lt(n/60),e%=60,n%=60,i=lt(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=u<0?"-":"",a=Br(this._months)!==Br(u)?"-":"",c=Br(this._days)!==Br(u)?"-":"",d=Br(this._milliseconds)!==Br(u)?"-":"",h+"P"+(i?a+i+"Y":"")+(r?a+r+"M":"")+(t?c+t+"D":"")+(s||n||e?"T":"")+(s?d+s+"H":"")+(n?d+n+"M":"")+(e?d+o+"S":"")):"P0D"}var X=ss.prototype;X.isValid=Mp;X.abs=p0;X.add=y0;X.subtract=g0;X.as=m0;X.asMilliseconds=af;X.asSeconds=v0;X.asMinutes=w0;X.asHours=E0;X.asDays=b0;X.asWeeks=S0;X.asMonths=A0;X.asQuarters=I0;X.asYears=T0;X.valueOf=O0;X._bubble=_0;X.clone=x0;X.get=N0;X.milliseconds=R0;X.seconds=D0;X.minutes=C0;X.hours=P0;X.days=k0;X.weeks=L0;X.months=M0;X.years=F0;X.humanize=j0;X.toISOString=as;X.toString=as;X.toJSON=as;X.locale=Kc;X.localeData=Jc;X.toIsoString=yt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",as);X.lang=Vc;j("X",0,0,"unix");j("x",0,0,"valueOf");F("x",ts);F("X",cd);ce("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ce("x",function(e,t,r){r._d=new Date(J(e))});//! moment.js
k.version="2.30.1";Yh(de);k.fn=C;k.min=Dp;k.max=Cp;k.now=Pp;k.utc=Ft;k.unix=a0;k.months=c0;k.isDate=Jn;k.locale=ar;k.invalid=Zi;k.duration=St;k.isMoment=bt;k.weekdays=l0;k.parseZone=u0;k.localeData=Qt;k.isDuration=xi;k.monthsShort=f0;k.weekdaysMin=d0;k.defineLocale=fa;k.updateLocale=up;k.locales=cp;k.weekdaysShort=h0;k.normalizeUnits=gt;k.relativeTimeRounding=$0;k.relativeTimeThreshold=W0;k.calendarFormat=iy;k.prototype=C;k.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var Qe={},Qn={},Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.COMMUNITY_SITE_URL=Ye.IS_DEBUG_MODE=Ye.getProtocol=Ye.setProtocol=Ye.getSdkName=Ye.setSdkName=void 0;var uf="@cloudbase/js-sdk";function Y0(e){uf=e}Ye.setSdkName=Y0;function H0(){return uf}Ye.getSdkName=H0;var cf=typeof location<"u"&&location.protocol==="http:"?"http:":"https:";function q0(e){cf=e}Ye.setProtocol=q0;function G0(){return cf}Ye.getProtocol=G0;Ye.IS_DEBUG_MODE=!1;Ye.COMMUNITY_SITE_URL="https://support.qq.com/products/148793";var us={};Object.defineProperty(us,"__esModule",{value:!0});us.ERRORS=void 0;us.ERRORS={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"};(function(e){var t=L&&L.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i),Object.defineProperty(n,o,{enumerable:!0,get:function(){return s[i]}})}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=L&&L.__exportStar||function(n,s){for(var i in n)i!=="default"&&!s.hasOwnProperty(i)&&t(s,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(Ye,e),r(us,e)})(Qn);var ff={},sn={},Li;(function(e){e.local="local",e.none="none",e.session="session"})(Li||(Li={}));var lf=function(){function e(){}return e}(),K0=function(){function e(){}return e}();function Fo(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),s="";for(var i in r)s===""?!n&&(t+="?"):s+="&",s+=i+"="+encodeURIComponent(r[i]);return t+=s,/^http(s)?\:\/\//.test(t)?t:""+e+t}const V0=Object.freeze(Object.defineProperty({__proto__:null,AbstractSDKRequest:lf,AbstractStorage:K0,get StorageType(){return Li},formatUrl:Fo},Symbol.toStringTag,{value:"Module"})),hf=yc(V0);var H={},df={exports:{}};function J0(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qs={exports:{}};const z0={},Z0=Object.freeze(Object.defineProperty({__proto__:null,default:z0},Symbol.toStringTag,{value:"Module"})),X0=yc(Z0);var ou;function ei(){return ou||(ou=1,function(e,t){(function(r,n){e.exports=n()})(L,function(){var r=r||function(n,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof L<"u"&&L.crypto&&(i=L.crypto),!i&&typeof J0=="function")try{i=X0}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},u=Object.create||function(){function E(){}return function(O){var T;return E.prototype=O,T=new E,E.prototype=null,T}}(),h={},a=h.lib={},c=a.Base=function(){return{extend:function(E){var O=u(this);return E&&O.mixIn(E),(!O.hasOwnProperty("init")||this.init===O.init)&&(O.init=function(){O.$super.init.apply(this,arguments)}),O.init.prototype=O,O.$super=this,O},create:function(){var E=this.extend();return E.init.apply(E,arguments),E},init:function(){},mixIn:function(E){for(var O in E)E.hasOwnProperty(O)&&(this[O]=E[O]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=a.WordArray=c.extend({init:function(E,O){E=this.words=E||[],O!=s?this.sigBytes=O:this.sigBytes=E.length*4},toString:function(E){return(E||m).stringify(this)},concat:function(E){var O=this.words,T=E.words,M=this.sigBytes,P=E.sigBytes;if(this.clamp(),M%4)for(var B=0;B<P;B++){var G=T[B>>>2]>>>24-B%4*8&255;O[M+B>>>2]|=G<<24-(M+B)%4*8}else for(var z=0;z<P;z+=4)O[M+z>>>2]=T[z>>>2];return this.sigBytes+=P,this},clamp:function(){var E=this.words,O=this.sigBytes;E[O>>>2]&=4294967295<<32-O%4*8,E.length=n.ceil(O/4)},clone:function(){var E=c.clone.call(this);return E.words=this.words.slice(0),E},random:function(E){for(var O=[],T=0;T<E;T+=4)O.push(o());return new d.init(O,E)}}),_=h.enc={},m=_.Hex={stringify:function(E){for(var O=E.words,T=E.sigBytes,M=[],P=0;P<T;P++){var B=O[P>>>2]>>>24-P%4*8&255;M.push((B>>>4).toString(16)),M.push((B&15).toString(16))}return M.join("")},parse:function(E){for(var O=E.length,T=[],M=0;M<O;M+=2)T[M>>>3]|=parseInt(E.substr(M,2),16)<<24-M%8*4;return new d.init(T,O/2)}},S=_.Latin1={stringify:function(E){for(var O=E.words,T=E.sigBytes,M=[],P=0;P<T;P++){var B=O[P>>>2]>>>24-P%4*8&255;M.push(String.fromCharCode(B))}return M.join("")},parse:function(E){for(var O=E.length,T=[],M=0;M<O;M++)T[M>>>2]|=(E.charCodeAt(M)&255)<<24-M%4*8;return new d.init(T,O)}},b=_.Utf8={stringify:function(E){try{return decodeURIComponent(escape(S.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(E){return S.parse(unescape(encodeURIComponent(E)))}},A=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(E){typeof E=="string"&&(E=b.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},_process:function(E){var O,T=this._data,M=T.words,P=T.sigBytes,B=this.blockSize,G=B*4,z=P/G;E?z=n.ceil(z):z=n.max((z|0)-this._minBufferSize,0);var Se=z*B,ye=n.min(Se*4,P);if(Se){for(var ve=0;ve<Se;ve+=B)this._doProcessBlock(M,ve);O=M.splice(0,Se),T.sigBytes-=ye}return new d.init(O,ye)},clone:function(){var E=c.clone.call(this);return E._data=this._data.clone(),E},_minBufferSize:0});a.Hasher=A.extend({cfg:c.extend(),init:function(E){this.cfg=this.cfg.extend(E),this.reset()},reset:function(){A.reset.call(this),this._doReset()},update:function(E){return this._append(E),this._process(),this},finalize:function(E){E&&this._append(E);var O=this._doFinalize();return O},blockSize:16,_createHelper:function(E){return function(O,T){return new E.init(T).finalize(O)}},_createHmacHelper:function(E){return function(O,T){return new I.HMAC.init(E,T).finalize(O)}}});var I=h.algo={};return h}(Math);return r})}(qs)),qs.exports}var Gs={exports:{}},au;function Q0(){return au||(au=1,function(e,t){(function(r,n){e.exports=n(ei())})(L,function(r){return function(n){var s=r,i=s.lib,o=i.WordArray,u=i.Hasher,h=s.algo,a=[],c=[];(function(){function m(I){for(var E=n.sqrt(I),O=2;O<=E;O++)if(!(I%O))return!1;return!0}function S(I){return(I-(I|0))*4294967296|0}for(var b=2,A=0;A<64;)m(b)&&(A<8&&(a[A]=S(n.pow(b,1/2))),c[A]=S(n.pow(b,1/3)),A++),b++})();var d=[],_=h.SHA256=u.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(m,S){for(var b=this._hash.words,A=b[0],I=b[1],E=b[2],O=b[3],T=b[4],M=b[5],P=b[6],B=b[7],G=0;G<64;G++){if(G<16)d[G]=m[S+G]|0;else{var z=d[G-15],Se=(z<<25|z>>>7)^(z<<14|z>>>18)^z>>>3,ye=d[G-2],ve=(ye<<15|ye>>>17)^(ye<<13|ye>>>19)^ye>>>10;d[G]=Se+d[G-7]+ve+d[G-16]}var ne=T&M^~T&P,Me=A&I^A&E^I&E,Be=(A<<30|A>>>2)^(A<<19|A>>>13)^(A<<10|A>>>22),At=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),fe=B+At+ne+c[G]+d[G],$e=Be+Me;B=P,P=M,M=T,T=O+fe|0,O=E,E=I,I=A,A=fe+$e|0}b[0]=b[0]+A|0,b[1]=b[1]+I|0,b[2]=b[2]+E|0,b[3]=b[3]+O|0,b[4]=b[4]+T|0,b[5]=b[5]+M|0,b[6]=b[6]+P|0,b[7]=b[7]+B|0},_doFinalize:function(){var m=this._data,S=m.words,b=this._nDataBytes*8,A=m.sigBytes*8;return S[A>>>5]|=128<<24-A%32,S[(A+64>>>9<<4)+14]=n.floor(b/4294967296),S[(A+64>>>9<<4)+15]=b,m.sigBytes=S.length*4,this._process(),this._hash},clone:function(){var m=u.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA256=u._createHelper(_),s.HmacSHA256=u._createHmacHelper(_)}(Math),r.SHA256})}(Gs)),Gs.exports}var Ks={exports:{}},uu;function eg(){return uu||(uu=1,function(e,t){(function(r,n){e.exports=n(ei())})(L,function(r){(function(){var n=r,s=n.lib,i=s.Base,o=n.enc,u=o.Utf8,h=n.algo;h.HMAC=i.extend({init:function(a,c){a=this._hasher=new a.init,typeof c=="string"&&(c=u.parse(c));var d=a.blockSize,_=d*4;c.sigBytes>_&&(c=a.finalize(c)),c.clamp();for(var m=this._oKey=c.clone(),S=this._iKey=c.clone(),b=m.words,A=S.words,I=0;I<d;I++)b[I]^=1549556828,A[I]^=909522486;m.sigBytes=S.sigBytes=_,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var c=this._hasher,d=c.finalize(a);c.reset();var _=c.finalize(this._oKey.clone().concat(d));return _}})})()})}(Ks)),Ks.exports}(function(e,t){(function(r,n,s){e.exports=n(ei(),Q0(),eg())})(L,function(r){return r.HmacSHA256})})(df);var tg=df.exports,pf={exports:{}};(function(e,t){(function(r,n){e.exports=n(ei())})(L,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,o=n.enc;o.Base64={stringify:function(h){var a=h.words,c=h.sigBytes,d=this._map;h.clamp();for(var _=[],m=0;m<c;m+=3)for(var S=a[m>>>2]>>>24-m%4*8&255,b=a[m+1>>>2]>>>24-(m+1)%4*8&255,A=a[m+2>>>2]>>>24-(m+2)%4*8&255,I=S<<16|b<<8|A,E=0;E<4&&m+E*.75<c;E++)_.push(d.charAt(I>>>6*(3-E)&63));var O=d.charAt(64);if(O)for(;_.length%4;)_.push(O);return _.join("")},parse:function(h){var a=h.length,c=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var _=0;_<c.length;_++)d[c.charCodeAt(_)]=_}var m=c.charAt(64);if(m){var S=h.indexOf(m);S!==-1&&(a=S)}return u(h,a,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function u(h,a,c){for(var d=[],_=0,m=0;m<a;m++)if(m%4){var S=c[h.charCodeAt(m-1)]<<m%4*2,b=c[h.charCodeAt(m)]>>>6-m%4*2,A=S|b;d[_>>>2]|=A<<24-_%4*8,_++}return i.create(d,_)}}(),r.enc.Base64})})(pf);var rg=pf.exports,yf={exports:{}};(function(e,t){(function(r,n){e.exports=n(ei())})(L,function(r){return r.enc.Utf8})})(yf);var ng=yf.exports,va=L&&L.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(H,"__esModule",{value:!0});H.transformPhone=H.sleep=H.printGroupLog=H.throwError=H.printInfo=H.printError=H.printWarn=H.execCallback=H.createPromiseCallback=H.removeParam=H.getHash=H.getQuery=H.toQueryString=H.createSign=H.formatUrl=H.genSeqId=H.isFormData=H.isInstanceOf=H.isNull=H.isPalinObject=H.isUndefined=H.isString=H.isArray=void 0;var ig=va(tg),sg=va(rg),cu=va(ng),cs=Qn;function og(e){return Object.prototype.toString.call(e)==="[object Array]"}H.isArray=og;function ag(e){return typeof e=="string"}H.isString=ag;function ug(e){return typeof e>"u"}H.isUndefined=ug;function cg(e){return Object.prototype.toString.call(e)==="[object Object]"}H.isPalinObject=cg;function fg(e){return Object.prototype.toString.call(e)==="[object Null]"}H.isNull=fg;function lg(e,t){return e instanceof t}H.isInstanceOf=lg;function hg(e){return Object.prototype.toString.call(e)==="[object FormData]"}H.isFormData=hg;function dg(){return Math.random().toString(16).slice(2)}H.genSeqId=dg;function pg(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),s="";for(var i in r)s===""?!n&&(t+="?"):s+="&",s+=i+"="+encodeURIComponent(r[i]);return t+=s,/^http(s)?\:\/\//.test(t)?t:""+e+t}H.formatUrl=pg;function Vs(e){var t=sg.default.stringify(e);return t=t.replace(/=+$/,""),t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t}function yg(e,t){var r={alg:"HS256",typ:"JWT"},n=Vs(cu.default.parse(JSON.stringify(r))),s=Vs(cu.default.parse(JSON.stringify(e))),i=n+"."+s,o=Vs(ig.default(i,t));return i+"."+o}H.createSign=yg;function gg(e){e===void 0&&(e={});var t=[];for(var r in e)t.push(r+"="+encodeURIComponent(e[r]));return t.join("&")}H.toQueryString=gg;function _g(e,t){if(typeof window>"u")return!1;var r=t||window.location.search,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=r.substr(r.indexOf("?")+1).match(n);return s!=null?s[2]:""}H.getQuery=_g;H.getHash=function(e){if(typeof window>"u")return"";var t=window.location.hash.match(new RegExp("[#?&/]"+e+"=([^&#]*)"));return t?t[1]:""};function mg(e,t){var r=t.split("?")[0],n,s=[],i=t.indexOf("?")!==-1?t.split("?")[1]:"";if(i!==""){s=i.split("&");for(var o=s.length-1;o>=0;o-=1)n=s[o].split("=")[0],n===e&&s.splice(o,1);r=r+"?"+s.join("&")}return r}H.removeParam=mg;function vg(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,s){e=function(i,o){return i?s(i):n(o)}});return e.promise=r,e}H.createPromiseCallback=vg;function wg(e,t,r){if(r===void 0&&(r=null),e&&typeof e=="function")return e(t,r);if(t)throw t;return r}H.execCallback=wg;function Eg(e,t){console.warn("["+cs.getSdkName()+"]["+e+"]:"+t)}H.printWarn=Eg;function bg(e,t){console.error({code:e,msg:"["+cs.getSdkName()+"]["+e+"]:"+t})}H.printError=bg;function Sg(e,t){console.log("["+cs.getSdkName()+"]["+e+"]:"+t)}H.printInfo=Sg;function Ag(e,t){throw new Error(JSON.stringify({code:e,msg:"["+cs.getSdkName()+"]["+e+"]:"+t}))}H.throwError=Ag;function Ig(e){var t=e.title,r=e.subtitle,n=r===void 0?"":r,s=e.content,i=s===void 0?[]:s,o=e.printTrace,u=o===void 0?!1:o,h=e.collapsed,a=h===void 0?!1:h;a?console.groupCollapsed(t,n):console.group(t,n);for(var c=0,d=i;c<d.length;c++){var _=d[c],m=_.type,S=_.body;switch(m){case"info":console.log(S);break;case"warn":console.warn(S);break;case"error":console.error(S);break}}u&&console.trace("stack trace:"),console.groupEnd()}H.printGroupLog=Ig;H.sleep=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})};function Tg(e){return"+86"+e}H.transformPhone=Tg;var Og=L&&L.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ot=L&&L.__assign||function(){return ot=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ot.apply(this,arguments)},xg=L&&L.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Ng=L&&L.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(sn,"__esModule",{value:!0});sn.WebRequest=sn.genAdapter=void 0;var Rg=hf,Js=H,Dg=Ye,gf=function(e){Og(t,e);function t(r){var n=e.call(this)||this,s=r.timeout,i=r.timeoutMsg,o=r.restrictedMethods;return n._timeout=s||0,n._timeoutMsg=i||"",n._restrictedMethods=o||["get","post","upload","download"],n}return t.prototype.get=function(r){return this._request(ot(ot({},r),{method:"get"}),this._restrictedMethods.includes("get"))},t.prototype.post=function(r){return this._request(ot(ot({},r),{method:"post"}),this._restrictedMethods.includes("post"))},t.prototype.put=function(r){return this._request(ot(ot({},r),{method:"put"}))},t.prototype.upload=function(r){var n=r.data,s=r.file,i=r.name,o=new FormData;for(var u in n)o.append(u,n[u]);return o.append("key",i),o.append("file",s),this._request(ot(ot({},r),{data:o,method:"post"}),this._restrictedMethods.includes("upload"))},t.prototype.download=function(r){return xg(this,void 0,void 0,function(){var n,s,i,o;return Ng(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.get(ot(ot({},r),{headers:{},responseType:"blob"}))];case 1:return n=u.sent().data,s=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),o=document.createElement("a"),o.href=s,o.setAttribute("download",i),o.style.display="none",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(s),document.body.removeChild(o),[3,3];case 2:return u.sent(),[3,3];case 3:return[2,new Promise(function(h){h({statusCode:200,tempFilePath:r.url})})]}})})},t.prototype._request=function(r,n){var s=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(o){var u=r.url,h=r.headers,a=h===void 0?{}:h,c=r.data,d=r.responseType,_=r.withCredentials,m=r.body,S=r.onUploadProgress,b=Js.formatUrl(Dg.getProtocol(),u,i==="get"?c:{}),A=new XMLHttpRequest;A.open(i,b),d&&(A.responseType=d);for(var I in a)A.setRequestHeader(I,a[I]);var E;S&&A.upload.addEventListener("progress",S),A.onreadystatechange=function(){var T={};if(A.readyState===4){var M=A.getAllResponseHeaders(),P=M.trim().split(/[\r\n]+/),B={};P.forEach(function(G){var z=G.split(": "),Se=z.shift().toLowerCase(),ye=z.join(": ");B[Se]=ye}),T.header=B,T.statusCode=A.status;try{T.data=d==="blob"?A.response:JSON.parse(A.responseText)}catch{T.data=d==="blob"?A.response:A.responseText}clearTimeout(E),o(T)}},n&&s._timeout&&(E=setTimeout(function(){console.warn(s._timeoutMsg),A.abort()},s._timeout));var O;Js.isFormData(c)?O=c:a["content-type"]==="application/x-www-form-urlencoded"?O=Js.toQueryString(c):m?O=m:O=c?JSON.stringify(c):void 0,_&&(A.withCredentials=!0),A.send(O)})},t}(Rg.AbstractSDKRequest);sn.WebRequest=gf;function Cg(){var e={root:window,reqClass:gf,wsClass:WebSocket,localStorage,sessionStorage};return e}sn.genAdapter=Cg;(function(e){var t=L&&L.__createBinding||(Object.create?function(a,c,d,_){_===void 0&&(_=d),Object.defineProperty(a,_,{enumerable:!0,get:function(){return c[d]}})}:function(a,c,d,_){_===void 0&&(_=d),a[_]=c[d]}),r=L&&L.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),n=L&&L.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var d in a)d!=="default"&&Object.hasOwnProperty.call(a,d)&&t(c,a,d);return r(c,a),c};Object.defineProperty(e,"__esModule",{value:!0}),e.useDefaultAdapter=e.useAdapters=e.RUNTIME=void 0;var s=n(sn),i=H,o;(function(a){a.WEB="web",a.WX_MP="wx_mp"})(o=e.RUNTIME||(e.RUNTIME={}));function u(a){for(var c=i.isArray(a)?a:[a],d=0,_=c;d<_.length;d++){var m=_[d],S=m.isMatch,b=m.genAdapter,A=m.runtime;if(S())return{adapter:b(),runtime:A}}}e.useAdapters=u;function h(){return{adapter:s.genAdapter(),runtime:o.WEB}}e.useDefaultAdapter=h})(ff);var fs={},di={},Pg=L&&L.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pi=L&&L.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},yi=L&&L.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(fs,"__esModule",{value:!0});fs.CloudbaseCache=void 0;var kg=hf,vt=H,Ot=Qn,gi=function(e){Pg(t,e);function t(r){var n=e.call(this)||this;return n._root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return t.prototype.setItem=function(r,n){this._root.tcbCacheObject[r]=n},t.prototype.getItem=function(r){return this._root.tcbCacheObject[r]},t.prototype.removeItem=function(r){delete this._root.tcbCacheObject[r]},t.prototype.clear=function(){delete this._root.tcbCacheObject},t}(kg.AbstractStorage);function zs(e,t){switch(e){case"local":return t.localStorage?t.localStorage:(vt.printWarn(Ot.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new gi(t.root));case"none":return new gi(t.root);case"session":return t.sessionStorage?t.sessionStorage:(vt.printWarn(Ot.ERRORS.INVALID_PARAMS,"sessionStorage is not supported on current platform"),new gi(t.root));default:return t.localStorage?t.localStorage:(vt.printWarn(Ot.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new gi(t.root))}}var Mg=function(){function e(t){this.keys={};var r=t.persistence,n=t.platformInfo,s=n===void 0?{}:n,i=t.keys,o=i===void 0?{}:i,u=t.alwaysLocalKeys,h=u===void 0?[]:u;this._platformInfo=s,this._alwaysLocalKeys=h,this._storage||(this._persistence=s.adapter.primaryStorage||r,this._storage=zs(this._persistence,s.adapter),this.keys=o)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this._storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this._persistence},enumerable:!1,configurable:!0}),e.prototype.updatePersistence=function(t){if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use updatePersistenceAsync insteed");return}if(t!==this._persistence){var r=this._persistence==="local";this._persistence=t;var n=zs(t,this._platformInfo.adapter);for(var s in this.keys){var i=this.keys[s];if(!(r&&this._alwaysLocalKeys.includes(s))){var o=this._storage.getItem(i);!vt.isUndefined(o)&&!vt.isNull(o)&&(n.setItem(i,o),this._storage.removeItem(i))}}this._storage=n}},e.prototype.updatePersistenceAsync=function(t){return pi(this,void 0,void 0,function(){var r,n,s,i,o,u,h,a;return yi(this,function(c){switch(c.label){case 0:if(t===this._persistence)return[2];r=this._persistence==="local",this._persistence=t,n=zs(t,this._platformInfo.adapter),s=[];for(i in this.keys)s.push(i);o=0,c.label=1;case 1:return o<s.length?(u=s[o],h=this.keys[u],r&&this._alwaysLocalKeys.includes(u)?[3,4]:[4,this._storage.getItem(h)]):[3,5];case 2:return a=c.sent(),!vt.isUndefined(a)&&!vt.isNull(a)?(n.setItem(h,a),[4,this._storage.removeItem(h)]):[3,4];case 3:c.sent(),c.label=4;case 4:return o++,[3,1];case 5:return this._storage=n,[2]}})})},e.prototype.setStore=function(t,r,n){if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this._storage)try{var s={version:n||"localCachev1",content:r};this._storage.setItem(t,JSON.stringify(s))}catch(i){throw new Error(JSON.stringify({code:Ot.ERRORS.OPERATION_FAIL,msg:"["+Ot.getSdkName()+"]["+Ot.ERRORS.OPERATION_FAIL+"]setStore failed",info:i}))}},e.prototype.setStoreAsync=function(t,r,n){return pi(this,void 0,void 0,function(){var s;return yi(this,function(i){switch(i.label){case 0:if(!this._storage)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),s={version:n||"localCachev1",content:r},[4,this._storage.setItem(t,JSON.stringify(s))];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(t,r){var n;if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=di)===null||n===void 0)&&n.tcb_token))return di.tcb_token;if(!this._storage)return""}catch{return""}r=r||"localCachev1";var s=this._storage.getItem(t);if(!s)return"";if(s.indexOf(r)>=0){var i=JSON.parse(s);return i.content}else return""},e.prototype.getStoreAsync=function(t,r){var n;return pi(this,void 0,void 0,function(){var s,i;return yi(this,function(o){switch(o.label){case 0:try{if(typeof process<"u"&&(!((n=di)===null||n===void 0)&&n.tcb_token))return[2,di.tcb_token];if(!this._storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this._storage.getItem(t)];case 1:return s=o.sent(),s?s.indexOf(r)>=0?(i=JSON.parse(s),[2,i.content]):[2,""]:[2,""]}})})},e.prototype.removeStore=function(t){if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this._storage.removeItem(t)},e.prototype.removeStoreAsync=function(t){return pi(this,void 0,void 0,function(){return yi(this,function(r){switch(r.label){case 0:return[4,this._storage.removeItem(t)];case 1:return r.sent(),[2]}})})},e}();fs.CloudbaseCache=Mg;var Je={},Fg=L&&L.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Lg=L&&L.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,s++)n[s]=i[o];return n};Object.defineProperty(Je,"__esModule",{value:!0});Je.removeEventListener=Je.activateEvent=Je.addEventListener=Je.CloudbaseEventEmitter=Je.IErrorEvent=Je.CloudbaseEvent=void 0;var fu=H;function Ug(e,t,r){r[e]=r[e]||[],r[e].push(t)}function Bg(e,t,r){if(r!=null&&r[e]){var n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var wa=function(){function e(t,r){this.data=r||null,this.name=t}return e}();Je.CloudbaseEvent=wa;var _f=function(e){Fg(t,e);function t(r,n){var s=e.call(this,"error",{error:r,data:n})||this;return s.error=r,s}return t}(wa);Je.IErrorEvent=_f;var mf=function(){function e(){this._listeners={}}return e.prototype.on=function(t,r){return Ug(t,r,this._listeners),this},e.prototype.off=function(t,r){return Bg(t,r,this._listeners),this},e.prototype.fire=function(t,r){if(fu.isInstanceOf(t,_f))return console.error(t.error),this;var n=fu.isString(t)?new wa(t,r||{}):t,s=n.name;if(this._listens(s)){n.target=this;for(var i=this._listeners[s]?Lg(this._listeners[s]):[],o=0,u=i;o<u.length;o++){var h=u[o];h.call(this,n)}}return this},e.prototype._listens=function(t){return this._listeners[t]&&this._listeners[t].length>0},e}();Je.CloudbaseEventEmitter=mf;var Ea=new mf;function $g(e,t){Ea.on(e,t)}Je.addEventListener=$g;function Wg(e,t){t===void 0&&(t={}),Ea.fire(e,t)}Je.activateEvent=Wg;function jg(e,t){Ea.off(e,t)}Je.removeEventListener=jg;var vf={},ls={},Yg=L&&L.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Hg=L&&L.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(ls,"__esModule",{value:!0});ls.catchErrorsDecorator=void 0;var lu=H,qg=Qn,Ln=!1;typeof navigator<"u"&&navigator.userAgent&&(Ln=navigator.userAgent.indexOf("Firefox")!==-1);var Gg=Ln?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,wf=/https?\:\/\/.+\:\d*\/.*\.js\:\d+\:\d+/;function Kg(e){var t=e.mode,r=t===void 0?"async":t,n=e.customInfo,s=n===void 0?{}:n,i=e.title,o=e.messages,u=o===void 0?[]:o;return function(h,a,c){if(qg.IS_DEBUG_MODE){var d=s.className||h.constructor.name,_=s.methodName||a,m=c.value,S=Vg(new Error);r==="sync"?c.value=function(){for(var b=[],A=0;A<arguments.length;A++)b[A]=arguments[A];var I=hu({err:new Error,className:d,methodName:_,sourceLink:S});try{return m.apply(this,b)}catch(P){var E=P,O=P.message,T={title:i||d+"."+_+" failed",content:[{type:"error",body:P}]};if(O&&/^\{.*\}$/.test(O)){var M=JSON.parse(O);T.subtitle=O,M.code&&(I?(I.code=M.code,I.msg=M.msg):(P.code=M.code,P.message=M.msg),E=I||P,T.content=u.map(function(B){return{type:"info",body:B}}))}throw lu.printGroupLog(T),E}}:c.value=function(){for(var b=[],A=0;A<arguments.length;A++)b[A]=arguments[A];return Yg(this,void 0,void 0,function(){var I,E,O,T,M,P;return Hg(this,function(B){switch(B.label){case 0:I=hu({err:new Error,className:d,methodName:_,sourceLink:S}),B.label=1;case 1:return B.trys.push([1,3,,4]),[4,m.apply(this,b)];case 2:return[2,B.sent()];case 3:throw E=B.sent(),O=E,T=E.message,M={title:i||d+"."+_+" failed",content:[{type:"error",body:E}]},T&&/^\{.*\}$/.test(T)&&(P=JSON.parse(T),M.subtitle=P,P.code&&(I?(I.code=P.code,I.message=P.msg):(E.code=P.code,E.message=P.msg),O=I||E,M.content=u.map(function(G){return{type:"info",body:G}}))),lu.printGroupLog(M),O;case 4:return[2]}})})}}}}ls.catchErrorsDecorator=Kg;function Vg(e){var t="",r=e.stack.split(`
`),n=r.findIndex(function(i){return Gg.test(i)});if(n!==-1){var s=wf.exec(r[n+1]||"");t=s?s[0]:""}return t}function hu(e){var t=e.err,r=e.className,n=e.methodName,s=e.sourceLink;if(!s)return null;var i=t.stack.split(`
`),o=Ln?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp(r+"\\.descriptor.value\\s*\\[as\\s"+n+"\\]\\s*\\(.*\\)$"),u=Ln?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp(r+"\\.descriptor.value\\s*\\[as\\s"+n+"\\]"),h=i.findIndex(function(d){return o.test(d)}),a;if(h!==-1){var c=i.filter(function(d,_){return _>h});c.unshift(i[h].replace(u,r+"."+n).replace(wf,s)),a=new Error,a.stack=(Ln?"@debugger":"Error")+`
`+c.join(`
`)}return a}(function(e){var t=L&&L.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i),Object.defineProperty(n,o,{enumerable:!0,get:function(){return s[i]}})}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=L&&L.__exportStar||function(n,s){for(var i in n)i!=="default"&&!s.hasOwnProperty(i)&&t(s,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(ls,e)})(vf);var Jg=L&&L.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zg=L&&L.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),fn=L&&L.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Jg(t,e,r);return zg(t,e),t};Object.defineProperty(Qe,"__esModule",{value:!0});var tr=Qe.helpers=be=Qe.utils=ba=Qe.events=Ef=Qe.cache=Cr=Qe.adapters=Ee=Qe.constants=void 0,Zg=fn(Qn),Ee=Qe.constants=Zg,Xg=fn(ff),Cr=Qe.adapters=Xg,Qg=fn(fs),Ef=Qe.cache=Qg,e_=fn(Je),ba=Qe.events=e_,t_=fn(H),be=Qe.utils=t_,r_=fn(vf);tr=Qe.helpers=r_;var n_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ui=function(){return Ui=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ui.apply(this,arguments)},i_=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},s_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};function o_(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}function a_(){return typeof App>"u"&&typeof getApp>"u"&&!wx.onAppHide&&!wx.offAppHide&&!wx.onAppShow&&!wx.offAppShow}var u_=function(e){n_(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this,s=r.timeout,i=r.timeoutMsg,o=r.restrictedMethods;return n._timeout=s||0,n._timeoutMsg=i||"",n._restrictedMethods=o||["get","post","upload","download"],n}return t.prototype.post=function(r){var n=this;return new Promise(function(s,i){var o=r.url,u=r.data,h=r.headers,a=wx.request({url:Fo("https:",o),data:u,timeout:n._timeout,method:"POST",header:h,success:function(c){s(c)},fail:function(c){i(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!n._timeout||n._restrictedMethods.indexOf("post")===-1)){var d=c.errMsg;if(d==="request:fail timeout"){console.warn(n._timeoutMsg);try{a.abort()}catch{}}}}})})},t.prototype.upload=function(r){var n=this,s=this;return new Promise(function(i){return i_(n,void 0,void 0,function(){var o,u,h,a,c,d;return s_(this,function(_){return o=r.url,u=r.file,h=r.data,a=r.headers,c=r.onUploadProgress,d=wx.uploadFile({url:o,filePath:u,name:"file",formData:Ui({},h),header:a,timeout:this._timeout,success:function(m){var S={statusCode:m.statusCode,data:m.data||{}};m.statusCode===200&&h.success_action_status&&(S.statusCode=parseInt(h.success_action_status,10)),i(S)},fail:function(m){i(m)},complete:function(m){if(!(!m||!m.errMsg)&&!(!s._timeout||s._restrictedMethods.indexOf("upload")===-1)){var S=m.errMsg;if(S==="request:fail timeout"){console.warn(s._timeoutMsg);try{d.abort()}catch{}}}}}),c&&d.onProgressUpdate(function(m){c(m)}),[2]})})})},t.prototype.download=function(r){var n=this,s=this;return new Promise(function(i,o){var u=r.url,h=r.headers,a=wx.downloadFile({url:Fo("https:",u),header:h,timeout:n._timeout,success:function(c){c.statusCode===200&&c.tempFilePath?i({statusCode:200,tempFilePath:c.tempFilePath}):i(c)},fail:function(c){o(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!s._timeout||s._restrictedMethods.indexOf("download")===-1)){var d=c.errMsg;if(d==="request:fail timeout"){console.warn(s._timeoutMsg);try{a.abort()}catch{}}}}})})},t}(lf),c_={setItem:function(e,t){wx.setStorageSync(e,t)},getItem:function(e){return wx.getStorageSync(e)},removeItem:function(e){wx.removeStorageSync(e)},clear:function(){wx.clearStorageSync()}},f_=function(){function e(t,r){r===void 0&&(r={});var n=wx.connectSocket(Ui({url:t},r)),s={set onopen(i){n.onOpen(i)},set onmessage(i){n.onMessage(i)},set onclose(i){n.onClose(i)},set onerror(i){n.onError(i)},send:function(i){return n.send({data:i})},close:function(i,o){return n.close({code:i,reason:o})},get readyState(){return n.readyState},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};return s}return e}();function l_(){var e={root:{},reqClass:u_,wsClass:f_,localStorage:c_,primaryStorage:Li.local,getAppSign:function(){var t=wx.getAccountInfoSync();return a_()?t&&t.plugin?t.plugin.appId:"":t&&t.miniProgram?t.miniProgram.appId:""}};return e}var h_={genAdapter:l_,isMatch:o_,runtime:"wx_mp"},Lo=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,s++)n[s]=i[o];return n},Bi=Ee.ERRORS,du={};function d_(e,t){var r=t.name,n=t.namespace,s=t.entity,i=t.injectEvents,o=t.IIFE,u=o===void 0?!1:o;if(du[r]||n&&e[n])throw new Error(JSON.stringify({code:Bi.INVALID_OPERATION,msg:"Duplicate component "+r}));if(u){if(!s||typeof s!="function")throw new Error(JSON.stringify({code:Bi.INVALID_PARAMS,msg:"IIFE component's entity must be a function"}));s.call(e)}if(du[r]=t,n?e.prototype[n]=s:bf(e.prototype,s),i){var h=i.bus,a=i.events;if(!h||!a||a.length===0)return;var c=e.prototype.fire||function(){};e.prototype.events||(e.prototype.events={});var d=e.prototype.events||{};d[r]?e.prototype.events[r].events=Lo(e.prototype.events[r].events,a):e.prototype.events[r]={bus:h,events:a},e.prototype.fire=function(_,m){c(_,m);for(var S in this.events){var b=this.events[S],A=b.bus,I=b.events;if(I.includes(_)){A.fire(_,m);break}}}}}function bf(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var r=t;return new Date(r.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=bf(e[n],t[n]));return e}function p_(e,t){var r=t.entity,n=t.target;if(!e.prototype.hasOwnProperty(n))throw new Error(JSON.stringify({code:Bi.INVALID_OPERATION,msg:"target:"+n+" is not exist"}));var s=e.prototype[n];if(typeof s!="function")throw new Error(JSON.stringify({code:Bi.INVALID_OPERATION,msg:"target:"+n+" is not a function which is the only type supports hook"}));e.prototype[n]=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.call.apply(r,Lo([this],i)),s.call.apply(s,Lo([this],i))}}var at={},Vr=function(){return Vr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Vr.apply(this,arguments)},y_="access_token",g_="access_token_expire",__="refresh_token",m_="anonymous_uuid",v_="login_type",w_="user_info",pu=Ef.CloudbaseCache,Ri={},Uo={};function yu(e){var t=e.env,r=e.persistence,n=e.platformInfo,s=y_+"_"+t,i=g_+"_"+t,o=__+"_"+t,u=m_+"_"+t,h=v_+"_"+t,a=w_+"_"+t,c={accessTokenKey:s,accessTokenExpireKey:i,refreshTokenKey:o,anonymousUuidKey:u,loginTypeKey:h,userInfoKey:a};Ri[t]?Ri[t].updatePersistence(r):Ri[t]=new pu(Vr(Vr({},e),{keys:c,platformInfo:n,alwaysLocalKeys:["anonymousUuidKey"]})),Uo[t]=Uo[t]||new pu(Vr(Vr({},e),{keys:c,platformInfo:n,persistence:"local"}))}function Sf(e){return Ri[e]}function Af(e){return Uo[e]}var E_=Ee.setSdkName,b_=Ee.setProtocol,If="",Tf="@cloudbase/js-sdk";function S_(e){If=e}function A_(){return If}function I_(e){Tf=e,E_(e)}function T_(){return Tf}var O_="2020-01-10",Of=typeof location<"u"&&location.protocol==="http:"?"http:":"https:",xf=(typeof process<"u","//tcb-api.tencentcloudapi.com/web");function Nf(e,t){xf=e,t&&(Of=t,b_(t))}function x_(e,t,r){var n=t?"//"+e+"."+t+".tcb-api.tencentcloudapi.com/web":"//"+e+".ap-shanghai.tcb-api.tencentcloudapi.com/web";Nf(n,r)}function N_(){return{BASE_URL:xf,PROTOCOL:Of}}var Bo;(function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.CUSTOM="CUSTOM",e.NULL="NULL"})(Bo||(Bo={}));var gu={LOGIN_STATE_CHANGED:"loginStateChanged",LOGIN_STATE_EXPIRED:"loginStateExpire",LOGIN_TYPE_CHANGED:"loginTypeChanged",ANONYMOUS_CONVERTED:"anonymousConverted",ACCESS_TOKEN_REFRESHD:"refreshAccessToken"},ht=function(){return ht=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ht.apply(this,arguments)},Wt=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},jt=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Sn=Ee.ERRORS,R_=be.genSeqId,D_=be.isFormData,C_=be.formatUrl,P_=be.createSign,k_=Cr.RUNTIME,_u=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"];function Zs(e,t,r){var n=e[t];e[t]=function(s){var i={},o={};r.forEach(function(h){var a=h.call(e,s),c=a.data,d=a.headers;Object.assign(i,c),Object.assign(o,d)});var u=s.data;return u&&function(){if(D_(u)){for(var h in i)u.append(h,i[h]);return}s.data=ht(ht({},u),i)}(),s.headers=ht(ht({},s.headers||{}),o),n.call(e,s)}}function Xs(){var e=R_();return{data:{seqId:e},headers:{"X-SDK-Version":"@cloudbase/js-sdk/"+A_(),"x-seqid":e}}}var M_=function(){function e(t){this._throwWhenRequestFail=!1,this.config=t,this._reqClass=new at.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:"[@cloudbase/js-sdk] "+this.config.timeout/1e3+"s",restrictedMethods:["post"]}),this._throwWhenRequestFail=t.throw||!1,this._cache=Sf(this.config.env),this._localCache=Af(this.config.env),Zs(this._reqClass,"post",[Xs]),Zs(this._reqClass,"upload",[Xs]),Zs(this._reqClass,"download",[Xs])}return e.prototype.post=function(t){return Wt(this,void 0,void 0,function(){var r;return jt(this,function(n){switch(n.label){case 0:return[4,this._reqClass.post(t)];case 1:return r=n.sent(),[2,r]}})})},e.prototype.upload=function(t){return Wt(this,void 0,void 0,function(){var r;return jt(this,function(n){switch(n.label){case 0:return[4,this._reqClass.upload(t)];case 1:return r=n.sent(),[2,r]}})})},e.prototype.download=function(t){return Wt(this,void 0,void 0,function(){var r;return jt(this,function(n){switch(n.label){case 0:return[4,this._reqClass.download(t)];case 1:return r=n.sent(),[2,r]}})})},e.prototype.refreshAccessToken=function(){return Wt(this,void 0,void 0,function(){var t,r,n;return jt(this,function(s){switch(s.label){case 0:this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken()),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._refreshAccessTokenPromise];case 2:return t=s.sent(),[3,4];case 3:return n=s.sent(),r=n,[3,4];case 4:if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,r)throw r;return[2,t]}})})},e.prototype.getAccessToken=function(){return Wt(this,void 0,void 0,function(){var t,r,n,s,i,o,u,h,a,c;return jt(this,function(d){switch(d.label){case 0:return t=this._cache.keys,r=t.accessTokenKey,n=t.accessTokenExpireKey,s=t.refreshTokenKey,[4,this._cache.getStoreAsync(s)];case 1:if(i=d.sent(),!i)throw new Error(JSON.stringify({code:Sn.OPERATION_FAIL,msg:"refresh token is not exist, your local data might be messed up, please retry after clear localStorage or sessionStorage"}));return[4,this._cache.getStoreAsync(r)];case 2:return o=d.sent(),h=Number,[4,this._cache.getStoreAsync(n)];case 3:return u=h.apply(void 0,[d.sent()]),a=!0,c=this._shouldRefreshAccessTokenHook,c?[4,this._shouldRefreshAccessTokenHook(o,u)]:[3,5];case 4:c=!d.sent(),d.label=5;case 5:return c&&(a=!1),(!o||!u||u<Date.now())&&a?[4,this.refreshAccessToken()]:[3,7];case 6:return[2,d.sent()];case 7:return[2,{accessToken:o,accessTokenExpire:u}]}})})},e.prototype.request=function(t,r,n){return Wt(this,void 0,void 0,function(){var s,i,o,u,h,a,c,d,d,_,m,S,b,A,I,E,O,T,M,P,B,G,z,Se,ye,ve,ne,Me;return jt(this,function(Be){switch(Be.label){case 0:return s="x-tcb-trace_"+this.config.env,i="application/x-www-form-urlencoded",o=ht({action:t,dataVersion:O_,env:this.config.env},r),_u.indexOf(t)!==-1?[3,3]:(u=this._cache.keys.refreshTokenKey,[4,this._cache.getStoreAsync(u)]);case 1:return h=Be.sent(),h?(a=o,[4,this.getAccessToken()]):[3,3];case 2:a.access_token=Be.sent().accessToken,Be.label=3;case 3:if(t==="storage.uploadFile"){c=new FormData;for(d in c)c.hasOwnProperty(d)&&c[d]!==void 0&&c.append(d,o[d]);i="multipart/form-data"}else{i="application/json;charset=UTF-8",c={};for(d in o)o[d]!==void 0&&(c[d]=o[d])}return _={headers:{"content-type":i}},n!=null&&n.onUploadProgress&&(_.onUploadProgress=n.onUploadProgress),this.config.region&&(_.headers["X-TCB-Region"]=this.config.region),m=this._localCache.getStore(s),m&&(_.headers["X-TCB-Trace"]=m),at.runtime!==k_.WEB&&(S=this.config,b=S.appSign,A=S.appSecret,I=Date.now(),E=A.appAccessKey,O=A.appAccessKeyId,T=P_({data:{},timestamp:I,appAccessKeyId:O,appSign:b},E),_.headers["X-TCB-App-Source"]="timestamp="+I+";appAccessKeyId="+O+";appSign="+b+";sign="+T),M=r.parse,P=r.inQuery,B=r.search,G={env:this.config.env},M&&(G.parse=!0),P&&(G=ht(ht({},P),G)),z=N_(),Se=z.BASE_URL,ye=z.PROTOCOL,ve=C_(ye,Se,G),B&&(ve+=B),[4,this.post(ht({url:ve,data:c},_))];case 4:if(ne=Be.sent(),Me=ne.header&&ne.header["x-tcb-trace"],Me&&this._localCache.setStore(s,Me),Number(ne.status)!==200&&Number(ne.statusCode)!==200||!ne.data)throw new Error("network request error");return[2,ne]}})})},e.prototype.send=function(t,r){return r===void 0&&(r={}),Wt(this,void 0,void 0,function(){var n;return jt(this,function(s){switch(s.label){case 0:return[4,this.request(t,r,{onUploadProgress:r.onUploadProgress})];case 1:return n=s.sent(),n.data.code==="ACCESS_TOKEN_EXPIRED"&&_u.indexOf(t)===-1?[4,this.refreshAccessToken()]:[3,4];case 2:return s.sent(),[4,this.request(t,r,{onUploadProgress:r.onUploadProgress})];case 3:n=s.sent(),s.label=4;case 4:if(n.data.code&&this._throwWhenRequestFail)throw new Error(JSON.stringify({code:Sn.OPERATION_FAIL,msg:"["+n.data.code+"] "+n.data.message}));return[2,n.data]}})})},e.prototype._refreshAccessToken=function(t){return t===void 0&&(t=1),Wt(this,void 0,void 0,function(){var r,n,s,i,o,u,h,a,c,d,_,m,S,b;return jt(this,function(A){switch(A.label){case 0:return r=this._cache.keys,n=r.accessTokenKey,s=r.accessTokenExpireKey,i=r.refreshTokenKey,o=r.loginTypeKey,u=r.anonymousUuidKey,[4,this._cache.removeStoreAsync(n)];case 1:return A.sent(),[4,this._cache.removeStoreAsync(s)];case 2:return A.sent(),[4,this._cache.getStoreAsync(i)];case 3:if(h=A.sent(),!h)throw new Error(JSON.stringify({code:Sn.INVALID_OPERATION,msg:"not login"}));return a={refresh_token:h},[4,this.request("auth.fetchAccessTokenWithRefreshToken",a)];case 4:return c=A.sent(),c.data.code?(d=c.data.code,d==="SIGN_PARAM_INVALID"||d==="REFRESH_TOKEN_EXPIRED"||d==="INVALID_REFRESH_TOKEN"?[4,this._cache.getStoreAsync(o)]:[3,11]):[3,12];case 5:return _=A.sent()===Bo.ANONYMOUS,_&&d==="INVALID_REFRESH_TOKEN"?[4,this._cache.getStoreAsync(u)]:[3,9];case 6:return m=A.sent(),[4,this._cache.getStoreAsync(i)];case 7:return S=A.sent(),[4,this.send("auth.signInAnonymously",{anonymous_uuid:m,refresh_token:S})];case 8:if(b=A.sent(),this._setRefreshToken(b.refresh_token),t>=1)return[2,this._refreshAccessToken(--t)];throw new Error(JSON.stringify({code:Sn.OPERATION_FAIL,message:" refresh token "}));case 9:return on.fire(gu.LOGIN_STATE_EXPIRED),[4,this._cache.removeStoreAsync(i)];case 10:A.sent(),A.label=11;case 11:throw new Error(JSON.stringify({code:Sn.NETWORK_ERROR,msg:"refresh access_token failed"+c.data.code}));case 12:return c.data.access_token?(on.fire(gu.ACCESS_TOKEN_REFRESHD),[4,this._cache.setStoreAsync(n,c.data.access_token)]):[3,15];case 13:return A.sent(),[4,this._cache.setStoreAsync(s,c.data.access_token_expire+Date.now())];case 14:return A.sent(),[2,{accessToken:c.data.access_token,accessTokenExpire:c.data.access_token_expire}];case 15:return c.data.refresh_token?[4,this._cache.removeStoreAsync(i)]:[3,19];case 16:return A.sent(),[4,this._cache.setStoreAsync(i,c.data.refresh_token)];case 17:return A.sent(),[4,this._refreshAccessToken()];case 18:A.sent(),A.label=19;case 19:return[2]}})})},e.prototype._setRefreshToken=function(t){return Wt(this,void 0,void 0,function(){var r,n,s,i;return jt(this,function(o){switch(o.label){case 0:return r=this._cache.keys,n=r.accessTokenKey,s=r.accessTokenExpireKey,i=r.refreshTokenKey,[4,this._cache.removeStoreAsync(n)];case 1:return o.sent(),[4,this._cache.removeStoreAsync(s)];case 2:return o.sent(),[4,this._cache.setStoreAsync(i,t)];case 3:return o.sent(),[2]}})})},e}(),Rf={};function F_(e){Rf[e.env]=new M_(ht(ht({},e),{throw:!0}))}function L_(e){return Rf[e]}var $i=function(){return $i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},$i.apply(this,arguments)},mu=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},$r=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},U_=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},B_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},$_=Cr.useAdapters,W_=Cr.useDefaultAdapter,j_=Cr.RUNTIME,_r=Ee.ERRORS,vu=Ee.COMMUNITY_SITE_URL,wu=be.printWarn,Eu=tr.catchErrorsDecorator,Y_={timeout:15e3,persistence:"local"},bu=1e3*60*10,Su=100,Au={},H_=function(){function e(t){this._config=t||this._config,this.authInstance=null}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return at},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cache",{get:function(){return Sf(this._config.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCache",{get:function(){return Af(this._config.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){return L_(this._config.env)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){if(!t.env)throw new Error(JSON.stringify({code:_r.INVALID_PARAMS,msg:"env must not be specified"}));if(at.adapter||this._useDefaultAdapter(),this.requestClient=new at.adapter.reqClass({timeout:t.timeout||5e3,timeoutMsg:"["+T_()+"][REQUEST TIMEOUT] request had been abort since didn't finished within"+t.timeout/1e3+"s"}),at.runtime!==j_.WEB){if(!t.appSecret)throw new Error(JSON.stringify({code:_r.INVALID_PARAMS,msg:"invalid appSecret"}));var r=at.adapter.getAppSign?at.adapter.getAppSign():"";if(t.appSign&&r&&t.appSign!==r)throw new Error(JSON.stringify({code:_r.INVALID_PARAMS,msg:"invalid appSign"}));if(r&&(t.appSign=r),!t.appSign)throw new Error(JSON.stringify({code:_r.INVALID_PARAMS,msg:"invalid appSign"}))}this._config=$i($i({},Y_),t),this._config.timeout=this._formatTimeout(this._config.timeout);var n=this._config,s=n.env,i=n.persistence,o=n.debug,u=n.timeout,h=n.appSecret,a=n.appSign;yu({env:s,persistence:i,debug:o,platformInfo:this.platform}),F_({env:s,region:t.region||"",timeout:u,appSecret:h,appSign:a}),t.region&&x_(s,t.region||"");var c=new e(this._config);return c.requestClient=this.requestClient,c},e.prototype.updateConfig=function(t){var r=t.persistence,n=t.debug;this._config.persistence=r,this._config.debug=n,yu({env:this._config.env,persistence:r,debug:n,platformInfo:this.platform})},e.prototype.registerExtension=function(t){Au[t.name]=t},e.prototype.invokeExtension=function(t,r){return U_(this,void 0,void 0,function(){var n;return B_(this,function(s){switch(s.label){case 0:if(n=Au[t],!n)throw new Error(JSON.stringify({code:_r.INVALID_PARAMS,msg:"extension:"+t+" must be registered before invoke"}));return[4,n.invoke(r,this)];case 1:return[2,s.sent()]}})})},e.prototype.useAdapters=function(t){var r=$_(t)||{},n=r.adapter,s=r.runtime;n&&(at.adapter=n),s&&(at.runtime=s)},e.prototype.registerHook=function(t){p_(e,t)},e.prototype.registerComponent=function(t){d_(e,t)},e.prototype.registerVersion=function(t){S_(t)},e.prototype.registerSdkName=function(t){I_(t)},e.prototype.registerEndPoint=function(t,r){Nf(t,r)},e.prototype._useDefaultAdapter=function(){var t=W_(),r=t.adapter,n=t.runtime;at.adapter=r,at.runtime=n},e.prototype._formatTimeout=function(t){switch(!0){case t>bu:return wu(_r.INVALID_PARAMS,"timeout is greater than maximum value[10min]"),bu;case t<Su:return wu(_r.INVALID_PARAMS,"timeout is less than maximum value[100ms]"),Su;default:return t}},mu([Eu({mode:"sync",title:"Cloudbase ",messages:["","  1 -  cloudbase.init() ","  2 - https://docs.cloudbase.net/api-reference/webv2/adapter.html#jie-ru-liu-cheng",""+vu]}),$r("design:type",Function),$r("design:paramtypes",[Object]),$r("design:returntype",e)],e.prototype,"init",null),mu([Eu({title:"",messages:["","  1 -  invokeExtension() ","  2 -  registerExtension() ",""+vu]}),$r("design:type",Function),$r("design:paramtypes",[String,Object]),$r("design:returntype",Promise)],e.prototype,"invokeExtension",null),e}(),on=new H_;on.useAdapters(h_);const q_="@cloudbase/js-sdk",G_="1.7.2",K_="cloudbase javascript sdk",V_="dist/index.cjs.js",J_="dist/index.esm.js",z_="miniprogram_dist",Z_="./index.d.ts",X_={lint:'eslint --fix "./src/**/*.ts" "./database/**/*.ts"',build:"rm -rf dist/ && gulp build","build:cdn":"gulp cdn","build:miniapp":"gulp miniapp","build:e2e":"rm -rf dist/ && NODE_ENV=e2e gulp e2e"},Q_={access:"public"},em={type:"git",url:"https://github.com/TencentCloudBase/cloudbase-js-sdk"},tm=["tcb","cloudbase","Cloudbase","serverless","Serverless","javascript","JavaScript"],rm=["miniprogram_dist","**/dist/","/index.d.ts","**/package.json"],nm=["app","auth","database","functions","storage"],im="",sm="ISC",om={"@cloudbase/analytics":"^1.1.1-alpha.0","@cloudbase/app":"^1.4.1","@cloudbase/auth":"^1.6.1","@cloudbase/database":"0.9.18-next","@cloudbase/functions":"^1.3.4","@cloudbase/realtime":"^1.1.4-alpha.0","@cloudbase/storage":"^1.3.4","@cloudbase/types":"^1.1.3-alpha.0","@cloudbase/utilities":"^1.3.4"},am={"@babel/core":"^7.9.0","@babel/plugin-proposal-class-properties":"^7.8.3","@babel/plugin-transform-runtime":"^7.9.0","@babel/preset-env":"^7.9.5","@babel/preset-typescript":"^7.9.0","@typescript-eslint/eslint-plugin":"^3.8.0","@typescript-eslint/parser":"^3.8.0","awesome-typescript-loader":"^5.2.1","babel-loader":"^8.1.0",eslint:"^7.6.0","eslint-config-alloy":"^3.7.4",gulp:"^4.0.2","gulp-clean":"^0.4.0","gulp-rename":"^2.0.0","gulp-sourcemaps":"^2.6.5","gulp-typescript":"^6.0.0-alpha.1","json-loader":"^0.5.7","merge-stream":"^2.0.0","package-json-cleanup-loader":"^1.0.3",typescript:"^3.8.3",webpack:"4.41.3","webpack-cli":"^3.3.11","webpack-node-externals":"^1.7.2","webpack-stream":"^5.2.1","webpack-visualizer-plugin":"^0.1.11"},um=["last 2 version","> 1%","not dead","chrome 53"],cm="29ca0bf24318daa1fbb230910edf0b1545e17e7f",fm={name:q_,version:G_,description:K_,main:V_,module:J_,miniprogram:z_,typings:Z_,scripts:X_,publishConfig:Q_,repository:em,keywords:tm,files:rm,components:nm,author:im,license:sm,dependencies:om,devDependencies:am,browserslist:um,gitHead:cm};var lm=fm.version;on.registerVersion(lm);try{window.cloudbase=on}catch{}var An=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},In=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},ln=function(){function e(t){this._config=t,this._cache=t.cache,this._request=t.request}return e.prototype.checkLocalLoginState=function(){return An(this,void 0,void 0,function(){var t,r,n,s,i,o;return In(this,function(u){switch(u.label){case 0:return t=this._cache.keys,r=t.accessTokenKey,n=t.accessTokenExpireKey,[4,this._cache.getStoreAsync(r)];case 1:return s=u.sent(),[4,this._cache.getStoreAsync(n)];case 2:return i=u.sent(),s?i&&i>Date.now()?(o=new kt({envId:this._config.env,cache:this._cache,request:this._request}),[4,o.checkLocalStateAsync()]):[3,4]:[3,7];case 3:return u.sent(),[2,o];case 4:return[4,this._cache.removeStoreAsync(r)];case 5:return u.sent(),[4,this._cache.removeStoreAsync(n)];case 6:u.sent(),u.label=7;case 7:return[2]}})})},e.prototype.setRefreshToken=function(t){return An(this,void 0,void 0,function(){var r,n,s,i;return In(this,function(o){switch(o.label){case 0:return r=this._cache.keys,n=r.accessTokenKey,s=r.accessTokenExpireKey,i=r.refreshTokenKey,[4,this._cache.removeStoreAsync(n)];case 1:return o.sent(),[4,this._cache.removeStoreAsync(s)];case 2:return o.sent(),[4,this._cache.setStoreAsync(i,t)];case 3:return o.sent(),[2]}})})},e.prototype.setAccessToken=function(t,r){return An(this,void 0,void 0,function(){var n,s,i;return In(this,function(o){switch(o.label){case 0:return n=this._cache.keys,s=n.accessTokenKey,i=n.accessTokenExpireKey,[4,this._cache.setStoreAsync(s,t)];case 1:return o.sent(),[4,this._cache.setStoreAsync(i,r)];case 2:return o.sent(),[2]}})})},e.prototype.refreshUserInfo=function(){return An(this,void 0,void 0,function(){var t,r;return In(this,function(n){switch(n.label){case 0:return t="auth.getUserInfo",[4,this._request.send(t,{})];case 1:return r=n.sent().data,[4,this.setLocalUserInfo(r)];case 2:return n.sent(),[2,r]}})})},e.prototype.setLocalUserInfo=function(t){return An(this,void 0,void 0,function(){var r;return In(this,function(n){switch(n.label){case 0:return r=this._cache.keys.userInfoKey,[4,this._cache.setStoreAsync(r,t)];case 1:return n.sent(),[2]}})})},e}(),Oe;(function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.NULL="NULL",e.PHONE="PHONE"})(Oe||(Oe={}));var hm=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qs=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},Yt=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Wr=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},jr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},eo=Ee.getSdkName,_i=Ee.ERRORS,to=Ee.COMMUNITY_SITE_URL,Iu=Cr.RUNTIME,dm=be.getQuery,pm=be.getHash,Tu=be.removeParam,ym=be.printWarn,ro=tr.catchErrorsDecorator,gm=function(e){hm(t,e);function t(r,n,s,i){var o=e.call(this,r)||this;return o._runtime=r.runtime,o._appid=n,o._scope=s,o._state=i||"weixin",o}return t.prototype.signIn=function(){return Wr(this,void 0,void 0,function(){return jr(this,function(r){return[2,ym(_i.OPERATION_FAIL,"API signIn has been deprecated, please use signInWithRedirect insteed")]})})},t.prototype.signInWithRedirect=function(){return Wr(this,void 0,void 0,function(){return jr(this,function(r){return[2,this._redirect()]})})},t.prototype.getRedirectResult=function(r){return Wr(this,void 0,void 0,function(){var n;return jr(this,function(s){return n=Ou(),n?[2,this._signInWithCode(n,r)]:[2,null]})})},t.prototype.getLinkRedirectResult=function(r){return r===void 0&&(r={}),Wr(this,void 0,void 0,function(){var n,s,i,o,u,h;return jr(this,function(a){return n=r.withUnionId,s=n===void 0?!1:n,i=Ou(),i?(o=this._appid,u=function(c){switch(c){case"snsapi_login":return"WECHAT-OPEN";default:return"WECHAT-PUBLIC"}}(this._scope),h=this._runtime===Iu.WX_MP?"1":"0",[2,this._request.send("auth.linkWithWeixinCode",{payload:{appid:o,loginType:u,code:i,hybridMiniapp:h,withUnionId:s}})]):[2,null]})})},t.prototype._redirect=function(){var r=Tu("code",location.href);r=Tu("state",r),r=encodeURIComponent(r);var n="//open.weixin.qq.com/connect/oauth2/authorize";this._scope==="snsapi_login"&&(n="//open.weixin.qq.com/connect/qrconnect");try{location.href=n+"?appid="+this._appid+"&redirect_uri="+r+"&response_type=code&scope="+this._scope+"&state="+this._state+"#wechat_redirect"}catch(s){throw new Error("["+eo()+"]["+_i.UNKOWN_ERROR+"]"+s)}},t.prototype._signInWithCode=function(r,n){return Wr(this,void 0,void 0,function(){var s,i,o,u,h,a,c,d;return jr(this,function(_){switch(_.label){case 0:return s=this._cache.keys,i=s.accessTokenKey,o=s.accessTokenExpireKey,u=s.refreshTokenKey,h=function(m){switch(m){case"snsapi_login":return"WECHAT-OPEN";default:return"WECHAT-PUBLIC"}}(this._scope),[4,this._getRefreshTokenByWXCode(this._appid,h,r,n)];case 1:return a=_.sent(),c=a.refreshToken,[4,this._cache.setStoreAsync(u,c)];case 2:return _.sent(),a.accessToken?[4,this._cache.setStoreAsync(i,a.accessToken)]:[3,4];case 3:_.sent(),_.label=4;case 4:return a.accessTokenExpire?[4,this._cache.setStoreAsync(o,String(a.accessTokenExpire+Date.now()))]:[3,6];case 5:_.sent(),_.label=6;case 6:return me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.WECHAT,persistence:this._config.persistence}),[4,this.refreshUserInfo()];case 7:return _.sent(),d=new kt({envId:this._config.env,cache:this._cache,request:this._request}),[4,d.checkLocalStateAsync()];case 8:return _.sent(),[2,d]}})})},t.prototype._getRefreshTokenByWXCode=function(r,n,s,i){return i===void 0&&(i={}),Wr(this,void 0,void 0,function(){var o,u,h,a,c,d,_;return jr(this,function(m){return o=i.withUnionId,u=o===void 0?!1:o,h=i.createUser,a=h===void 0?!0:h,c=this._scope==="snsapi_base"?!1:i.syncUserInfo||!1,d="auth.signIn",_=this._runtime===Iu.WX_MP?"1":"0",[2,this._request.send(d,{appid:r,loginType:n,hybridMiniapp:_,syncUserInfo:c,loginCredential:s,withUnionId:u,createUser:a}).then(function(S){if(S.code)throw new Error("["+eo()+"]["+_i.OPERATION_FAIL+"] failed login via wechat: "+S.code);if(S.refresh_token)return{refreshToken:S.refresh_token,accessToken:S.access_token,accessTokenExpire:S.access_token_expire};throw new Error("["+eo()+"]["+_i.OPERATION_FAIL+"] action:getJwt not return refreshToken")})]})})},Qs([ro({title:"",messages:["","  1 -  auth().weixinAuthProvider().signInWithRedirect() ",""+to]}),Yt("design:type",Function),Yt("design:paramtypes",[]),Yt("design:returntype",Promise)],t.prototype,"signInWithRedirect",null),Qs([ro({title:"",messages:["","  1 -  auth().weixinAuthProvider().getRedirectResult() ","  2 - ","  3 -  AppId  AppSecret ",""+to]}),Yt("design:type",Function),Yt("design:paramtypes",[Object]),Yt("design:returntype",Promise)],t.prototype,"getRedirectResult",null),Qs([ro({title:"",messages:["","  1 -  auth().weixinAuthProvider().getLinkRedirectResult() ","  2 - ","  3 -  AppId  AppSecret ",""+to]}),Yt("design:type",Function),Yt("design:paramtypes",[Object]),Yt("design:returntype",Promise)],t.prototype,"getLinkRedirectResult",null),t}(ln);function Ou(){return dm("code")||pm("code")}var _m=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),mm=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},no=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Tn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},On=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},io=Ee.ERRORS,vm=Ee.COMMUNITY_SITE_URL,xu=be.throwError,wm=be.isString,Em=ba.addEventListener,bm=tr.catchErrorsDecorator,Sm=function(e){_m(t,e);function t(r){var n=e.call(this,r)||this;return n._onConverted=n._onConverted.bind(n),Em(ue.ANONYMOUS_CONVERTED,n._onConverted),n}return t.prototype.signIn=function(){return Tn(this,void 0,void 0,function(){var r,n,s,i,o,u,h;return On(this,function(a){switch(a.label){case 0:return[4,this._cache.updatePersistenceAsync("local")];case 1:return a.sent(),r=this._cache.keys,n=r.anonymousUuidKey,s=r.refreshTokenKey,[4,this._cache.getStoreAsync(n)];case 2:return i=a.sent(),[4,this._cache.getStoreAsync(s)];case 3:return o=a.sent(),[4,this._request.send("auth.signInAnonymously",{anonymous_uuid:i,refresh_token:o})];case 4:return u=a.sent(),u.uuid&&u.refresh_token?[4,this._setAnonymousUUID(u.uuid)]:[3,10];case 5:return a.sent(),[4,this.setRefreshToken(u.refresh_token)];case 6:return a.sent(),[4,this._request.refreshAccessToken()];case 7:return a.sent(),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.ANONYMOUS,persistence:"local"}),me.fire(ue.LOGIN_STATE_CHANGED),h=new kt({envId:this._config.env,cache:this._cache,request:this._request}),[4,h.checkLocalStateAsync()];case 8:return a.sent(),[4,h.user.refresh()];case 9:return a.sent(),[2,h];case 10:throw new Error(JSON.stringify({code:io.OPERATION_FAIL,msg:JSON.stringify(u)||"anonymous signIn failed"}))}})})},t.prototype.linkAndRetrieveDataWithTicket=function(r){return Tn(this,void 0,void 0,function(){var n,s,i,o,u,h,a;return On(this,function(c){switch(c.label){case 0:return wm(r)||xu(io.INVALID_PARAMS,"ticket must be a string"),n=this._cache.keys,s=n.anonymousUuidKey,i=n.refreshTokenKey,[4,this._cache.getStoreAsync(s)];case 1:return o=c.sent(),[4,this._cache.getStoreAsync(i)];case 2:return u=c.sent(),[4,this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:o,refresh_token:u,ticket:r})];case 3:return h=c.sent(),h.refresh_token?[4,this._clearAnonymousUUID()]:[3,8];case 4:return c.sent(),[4,this.setRefreshToken(h.refresh_token)];case 5:return c.sent(),[4,this._request.refreshAccessToken()];case 6:return c.sent(),me.fire(ue.ANONYMOUS_CONVERTED,{env:this._config.env}),me.fire(ue.LOGIN_TYPE_CHANGED,{loginType:Oe.CUSTOM,persistence:"local"}),a=new kt({envId:this._config.env,cache:this._cache,request:this._request}),[4,a.checkLocalStateAsync()];case 7:return c.sent(),[2,a];case 8:xu(io.OPERATION_FAIL,JSON.stringify(h)||"linkAndRetrieveDataWithTicket failed"),c.label=9;case 9:return[2]}})})},t.prototype._setAnonymousUUID=function(r){return Tn(this,void 0,void 0,function(){var n,s,i;return On(this,function(o){switch(o.label){case 0:return n=this._cache.keys,s=n.anonymousUuidKey,i=n.loginTypeKey,[4,this._cache.removeStoreAsync(s)];case 1:return o.sent(),[4,this._cache.setStoreAsync(s,r)];case 2:return o.sent(),[4,this._cache.setStoreAsync(i,Oe.ANONYMOUS)];case 3:return o.sent(),[2]}})})},t.prototype._clearAnonymousUUID=function(){return Tn(this,void 0,void 0,function(){return On(this,function(r){switch(r.label){case 0:return[4,this._cache.removeStoreAsync(this._cache.keys.anonymousUuidKey)];case 1:return r.sent(),[2]}})})},t.prototype._onConverted=function(r){return Tn(this,void 0,void 0,function(){var n;return On(this,function(s){switch(s.label){case 0:return n=r.data.env,n!==this._config.env?[2]:[4,this._cache.updatePersistenceAsync(this._config.persistence)];case 1:return s.sent(),[2]}})})},mm([bm({title:"",messages:["","  1 - ","  2 -  auth().anonymouseProvider().signIn() ",""+vm]}),no("design:type",Function),no("design:paramtypes",[]),no("design:returntype",Promise)],t.prototype,"signIn",null),t}(ln),Am=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Im=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},so=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Tm=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Om=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Nu=Ee.ERRORS,xm=Ee.COMMUNITY_SITE_URL,Nm=be.isString,Rm=tr.catchErrorsDecorator,Dm=function(e){Am(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r){return Tm(this,void 0,void 0,function(){var n,s,i,o,u,h,a;return Om(this,function(c){switch(c.label){case 0:if(!Nm(r))throw new Error(JSON.stringify({code:Nu.INVALID_PARAMS,msg:"ticket must be a string"}));return n=this._cache.keys.refreshTokenKey,o=(i=this._request).send,u=["auth.signInWithTicket"],h={ticket:r},[4,this._cache.getStoreAsync(n)];case 1:return[4,o.apply(i,u.concat([(h.refresh_token=c.sent()||"",h)]))];case 2:return s=c.sent(),s.refresh_token?[4,this.setRefreshToken(s.refresh_token)]:[3,7];case 3:return c.sent(),[4,this._request.refreshAccessToken()];case 4:return c.sent(),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.CUSTOM,persistence:this._config.persistence}),me.fire(ue.LOGIN_STATE_CHANGED),[4,this.refreshUserInfo()];case 5:return c.sent(),a=new kt({envId:this._config.env,cache:this._cache,request:this._request}),[4,a.checkLocalStateAsync()];case 6:return c.sent(),[2,a];case 7:throw new Error(JSON.stringify({code:Nu.OPERATION_FAIL,msg:"custom signIn failed"}))}})})},Im([Rm({title:"",messages:["","  1 - ","  2 -  auth().customAuthProvider().signIn() ","  3 - ticket ","  4 -  ticket ",""+xm]}),so("design:type",Function),so("design:paramtypes",[String]),so("design:returntype",Promise)],t.prototype,"signIn",null),t}(ln),Cm=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xn=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},We=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Nn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Rn=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},oo=be.throwError,Pm=be.isString,ao=Ee.ERRORS,Dn=Ee.COMMUNITY_SITE_URL,Cn=tr.catchErrorsDecorator,km=function(e){Cm(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r,n){return Nn(this,void 0,void 0,function(){var s,i,o,u,h;return Rn(this,function(a){switch(a.label){case 0:return Pm(r)||oo(ao.INVALID_PARAMS,"email must be a string"),s=this._cache.keys.refreshTokenKey,[4,this._request.send("auth.signIn",{loginType:"EMAIL",email:r,password:n,refresh_token:this._cache.getStore(s)||""})];case 1:return i=a.sent(),o=i.refresh_token,u=i.access_token,h=i.access_token_expire,o?[4,this.setRefreshToken(o)]:[3,8];case 2:return a.sent(),u&&h?[4,this.setAccessToken(u,h)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,this._request.refreshAccessToken()];case 5:a.sent(),a.label=6;case 6:return[4,this.refreshUserInfo()];case 7:return a.sent(),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.EMAIL,persistence:this._config.persistence}),[2,new kt({envId:this._config.env,cache:this._cache,request:this._request})];case 8:i.code?oo(ao.OPERATION_FAIL,"Email login fail["+i.code+"] "+i.message):oo(ao.OPERATION_FAIL,"Email login fail"),a.label=9;case 9:return[2]}})})},t.prototype.signUp=function(r,n){return Nn(this,void 0,void 0,function(){return Rn(this,function(s){return[2,this._request.send("auth.signUpWithEmailAndPassword",{email:r,password:n})]})})},t.prototype.resetPassword=function(r){return Nn(this,void 0,void 0,function(){return Rn(this,function(n){return[2,this._request.send("auth.sendPasswordResetEmail",{email:r})]})})},t.prototype.resetPasswordWithToken=function(r,n){return Nn(this,void 0,void 0,function(){return Rn(this,function(s){return[2,this._request.send("auth.resetPasswordWithToken",{token:r,newPassword:n})]})})},t.prototype.activate=function(r){return Nn(this,void 0,void 0,function(){return Rn(this,function(n){return[2,this._request.send("auth.activateEndUserMail",{token:r})]})})},xn([Cn({title:"",messages:["","  1 -  auth().emailAuthProvider() ","  2 - ","  3 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String,String]),We("design:returntype",Promise)],t.prototype,"signIn",null),xn([Cn({title:"",messages:["","  1 -  auth().signUpWithEmailAndPassword() ","  2 - ","  3 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String,String]),We("design:returntype",Promise)],t.prototype,"signUp",null),xn([Cn({title:"",messages:["","  1 -  auth().sendPasswordResetEmail() ","  2 - ","  3 - ","  4 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String]),We("design:returntype",Promise)],t.prototype,"resetPassword",null),xn([Cn({title:"",messages:["","  1 - ","  2 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String,String]),We("design:returntype",Promise)],t.prototype,"resetPasswordWithToken",null),xn([Cn({title:"",messages:["","  1 - ","  2 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String]),We("design:returntype",Promise)],t.prototype,"activate",null),t}(ln),Mm=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fm=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},uo=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Lm=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Um=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Bm=be.printWarn,mi=Ee.ERRORS,$m=Ee.COMMUNITY_SITE_URL,Wm=tr.catchErrorsDecorator,jm=function(e){Mm(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r,n){return Lm(this,void 0,void 0,function(){var s,i,o,u,h,a,c,d,_;return Um(this,function(m){switch(m.label){case 0:if(typeof r!="string")throw new Error(JSON.stringify({code:mi.INVALID_PARAMS,msg:"username must be a string"}));return typeof n!="string"&&(n="",Bm(mi.INVALID_PARAMS,"password is empty")),s=this._cache.keys.refreshTokenKey,u=(o=this._request).send,h=["auth.signIn"],a={loginType:Oe.USERNAME,username:r,password:n},[4,this._cache.getStoreAsync(s)];case 1:return[4,u.apply(o,h.concat([(a.refresh_token=m.sent()||"",a)]))];case 2:return i=m.sent(),c=i.refresh_token,d=i.access_token_expire,_=i.access_token,c?[4,this.setRefreshToken(c)]:[3,9];case 3:return m.sent(),_&&d?[4,this.setAccessToken(_,d)]:[3,5];case 4:return m.sent(),[3,7];case 5:return[4,this._request.refreshAccessToken()];case 6:m.sent(),m.label=7;case 7:return[4,this.refreshUserInfo()];case 8:return m.sent(),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.USERNAME,persistence:this._config.persistence}),[2,new kt({envId:this._config.env,cache:this._cache,request:this._request})];case 9:throw i.code?new Error(JSON.stringify({code:mi.OPERATION_FAIL,msg:"login by username failed:["+i.code+"] "+i.message})):new Error(JSON.stringify({code:mi.OPERATION_FAIL,msg:"login by username failed"}));case 10:return[2]}})})},Fm([Wm({title:"",messages:["","  1 -  auth().signInWithUsernameAndPassword() ","  2 - ","  3 - ",""+$m]}),uo("design:type",Function),uo("design:paramtypes",[String,String]),uo("design:returntype",Promise)],t.prototype,"signIn",null),t}(ln),Ym=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),co=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},Ht=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},fo=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},lo=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},vi=be.throwError,ho=be.isString,Hm=be.transformPhone,wi=Ee.ERRORS,po=Ee.COMMUNITY_SITE_URL,yo=tr.catchErrorsDecorator,Di={SIGNIN:"SIGNIN",SIGNUP:"SIGNUP",FORCERESETPWD:"FORCERESETPWD"},qm=function(e){Ym(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r){return fo(this,void 0,void 0,function(){var n,s,i,o,u,h,a,c,d;return lo(this,function(_){switch(_.label){case 0:return n=r.phoneNumber,s=r.phoneCode,i=r.password,o=r.signMethod,ho(n)||vi(wi.INVALID_PARAMS,"phoneNumber must be a string"),!ho(s)&&!ho(i)&&vi(wi.INVALID_PARAMS,"phoneCode or password must be a string"),o||(o=Di.SIGNIN),u=this._cache.keys.refreshTokenKey,[4,this._request.send("auth.signIn",{loginType:Oe.PHONE,phoneNumber:Hm(n),phoneCode:s,password:i,refresh_token:this._cache.getStore(u)||"",signMethod:o})];case 1:return h=_.sent(),a=h.refresh_token,c=h.access_token,d=h.access_token_expire,a?[4,this.setRefreshToken(a)]:[3,8];case 2:return _.sent(),c&&d?[4,this.setAccessToken(c,d)]:[3,4];case 3:return _.sent(),[3,6];case 4:return[4,this._request.refreshAccessToken()];case 5:_.sent(),_.label=6;case 6:return[4,this.refreshUserInfo()];case 7:return _.sent(),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.PHONE,persistence:this._config.persistence}),[2,new kt({envId:this._config.env,cache:this._cache,request:this._request})];case 8:h.code?vi(wi.OPERATION_FAIL,"Phone login fail["+h.code+"] "+h.message):vi(wi.OPERATION_FAIL,"Phone login fail"),_.label=9;case 9:return[2]}})})},t.prototype.signUp=function(r,n,s){return fo(this,void 0,void 0,function(){return lo(this,function(i){return[2,this.signIn({phoneNumber:r,phoneCode:n,password:s,signMethod:Di.SIGNUP})]})})},t.prototype.forceResetPwd=function(r,n,s){return fo(this,void 0,void 0,function(){return lo(this,function(i){return[2,this.signIn({phoneNumber:r,phoneCode:n,password:s,signMethod:Di.FORCERESETPWD})]})})},co([yo({title:"",messages:["","  1 -  auth().SmsAuthProvider() ","  2 - ","  3 - /",""+po]}),Ht("design:type",Function),Ht("design:paramtypes",[Object]),Ht("design:returntype",Promise)],t.prototype,"signIn",null),co([yo({title:"",messages:["","  1 -  auth().signUpWithPhoneCode() ","  2 - ",""+po]}),Ht("design:type",Function),Ht("design:paramtypes",[String,String,String]),Ht("design:returntype",Promise)],t.prototype,"signUp",null),co([yo({title:"",messages:["","  1 -  auth().forceResetPwd() ","  2 - ",""+po]}),Ht("design:type",Function),Ht("design:paramtypes",[String,String,String]),Ht("design:returntype",Promise)],t.prototype,"forceResetPwd",null),t}(ln),Re=function(){return Re=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Re.apply(this,arguments)},Ce=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},Y=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},oe=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},ae=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Gm=ba.CloudbaseEventEmitter,Km=Cr.RUNTIME,$o=be.printWarn,Sa=be.throwError,Wo=be.transformPhone,tn=Ee.ERRORS,Pe=Ee.COMMUNITY_SITE_URL,ke=tr.catchErrorsDecorator,Vm="auth",me=new Gm,Jm=function(){function e(t){var r=t.cache,n=t.request;this._cache=r,this._request=n,this._setUserInfo()}return e.prototype.checkLocalInfo=function(){return oe(this,void 0,void 0,function(){return ae(this,function(t){return this.uid=this._getLocalUserInfo("uid"),this.loginType=this._getLocalUserInfo("loginType"),this.openid=this._getLocalUserInfo("wxOpenId"),this.wxOpenId=this._getLocalUserInfo("wxOpenId"),this.wxPublicId=this._getLocalUserInfo("wxPublicId"),this.unionId=this._getLocalUserInfo("wxUnionId"),this.qqMiniOpenId=this._getLocalUserInfo("qqMiniOpenId"),this.customUserId=this._getLocalUserInfo("customUserId"),this.nickName=this._getLocalUserInfo("nickName"),this.gender=this._getLocalUserInfo("gender"),this.avatarUrl=this._getLocalUserInfo("avatarUrl"),this.email=this._getLocalUserInfo("email"),this.hasPassword=!!this._getLocalUserInfo("hasPassword"),this.phone=this._getLocalUserInfo("phone"),this.username=this._getLocalUserInfo("username"),this.location={country:this._getLocalUserInfo("country"),province:this._getLocalUserInfo("province"),city:this._getLocalUserInfo("city")},[2]})})},e.prototype.checkLocalInfoAsync=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u,h,a,c,d,_,m,S,b,A,I,E;return ae(this,function(O){switch(O.label){case 0:return t=this,[4,this._getLocalUserInfoAsync("uid")];case 1:return t.uid=O.sent(),r=this,[4,this._getLocalUserInfoAsync("loginType")];case 2:return r.loginType=O.sent(),n=this,[4,this._getLocalUserInfoAsync("wxOpenId")];case 3:return n.openid=O.sent(),s=this,[4,this._getLocalUserInfoAsync("wxOpenId")];case 4:return s.wxOpenId=O.sent(),i=this,[4,this._getLocalUserInfoAsync("wxPublicId")];case 5:return i.wxPublicId=O.sent(),o=this,[4,this._getLocalUserInfoAsync("wxUnionId")];case 6:return o.unionId=O.sent(),u=this,[4,this._getLocalUserInfoAsync("qqMiniOpenId")];case 7:return u.qqMiniOpenId=O.sent(),h=this,[4,this._getLocalUserInfoAsync("customUserId")];case 8:return h.customUserId=O.sent(),a=this,[4,this._getLocalUserInfoAsync("nickName")];case 9:return a.nickName=O.sent(),c=this,[4,this._getLocalUserInfoAsync("gender")];case 10:return c.gender=O.sent(),d=this,[4,this._getLocalUserInfoAsync("avatarUrl")];case 11:return d.avatarUrl=O.sent(),_=this,[4,this._getLocalUserInfoAsync("email")];case 12:return _.email=O.sent(),m=this,S=Boolean,[4,this._getLocalUserInfoAsync("hasPassword")];case 13:return m.hasPassword=S.apply(void 0,[O.sent()]),b=this,[4,this._getLocalUserInfoAsync("phone")];case 14:return b.phone=O.sent(),A=this,[4,this._getLocalUserInfoAsync("username")];case 15:return A.username=O.sent(),I=this,E={},[4,this._getLocalUserInfoAsync("country")];case 16:return E.country=O.sent(),[4,this._getLocalUserInfoAsync("province")];case 17:return E.province=O.sent(),[4,this._getLocalUserInfoAsync("city")];case 18:return I.location=(E.city=O.sent(),E),[2]}})})},e.prototype.linkWithTicket=function(t){if(typeof t!="string")throw new Error("ticket must be string");return this._request.send("auth.linkWithTicket",{ticket:t})},e.prototype.linkWithRedirect=function(t){t.signInWithRedirect()},e.prototype.getLinkedUidList=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o;return ae(this,function(u){switch(u.label){case 0:return[4,this._request.send("auth.getLinkedUidList",{})];case 1:for(t=u.sent().data,r=!1,n=t.users,s=0,i=n;s<i.length;s++)if(o=i[s],o.wxOpenId&&o.wxPublicId){r=!0;break}return[2,{users:n,hasPrimaryUid:r}]}})})},e.prototype.setPrimaryUid=function(t){return this._request.send("auth.setPrimaryUid",{uid:t})},e.prototype.unlink=function(t){return this._request.send("auth.unlink",{platform:t})},e.prototype.update=function(t){return oe(this,void 0,void 0,function(){var r,n,s,i,o,u,h;return ae(this,function(a){switch(a.label){case 0:return r=t.nickName,n=t.gender,s=t.avatarUrl,i=t.province,o=t.country,u=t.city,[4,this._request.send("auth.updateUserInfo",{nickName:r,gender:n,avatarUrl:s,province:i,country:o,city:u})];case 1:return h=a.sent().data,this._setLocalUserInfo(h),[2]}})})},e.prototype.updatePassword=function(t,r){return this._request.send("auth.updatePassword",{oldPassword:r,newPassword:t})},e.prototype.updateEmail=function(t,r){return this._request.send("auth.updateEmail",{newEmail:t,password:r})},e.prototype.updateUsername=function(t){return typeof t!="string"&&Sa(tn.INVALID_PARAMS,"username must be a string"),this._request.send("auth.updateUsername",{username:t})},e.prototype.refresh=function(){return oe(this,void 0,void 0,function(){var t,r;return ae(this,function(n){switch(n.label){case 0:return t="auth.getUserInfo",[4,this._request.send(t,{})];case 1:return r=n.sent().data,this._setLocalUserInfo(r),[2,r]}})})},e.prototype.linkWithPhoneNumber=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this._request.send("auth.linkOrUpdatePhoneNumber",{phoneNumber:Wo(t),phoneCode:r})]})})},e.prototype.updatePhoneNumber=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this._request.send("auth.linkOrUpdatePhoneNumber",{phoneNumber:Wo(t),phoneCode:r})]})})},e.prototype._getLocalUserInfo=function(t){var r=this._cache.keys.userInfoKey,n=this._cache.getStore(r);return n[t]},e.prototype._getLocalUserInfoAsync=function(t){return oe(this,void 0,void 0,function(){var r,n;return ae(this,function(s){switch(s.label){case 0:return r=this._cache.keys.userInfoKey,[4,this._cache.getStoreAsync(r)];case 1:return n=s.sent(),[2,n[t]]}})})},e.prototype._setUserInfo=function(){var t=this,r=this._cache.keys.userInfoKey,n=this._cache.getStore(r);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl","phone","username"].forEach(function(s){t[s]=n[s]}),this.location={country:n.country,province:n.province,city:n.city}},e.prototype._setLocalUserInfo=function(t){var r=this._cache.keys.userInfoKey;this._cache.setStore(r,t),this._setUserInfo()},Ce([ke({title:"",messages:["","  1 -  User.linkWithTicket() ","  2 - ","  3 - ticket ","  4 -  ticket ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"linkWithTicket",null),Ce([ke({title:"",messages:["","  1 -  User.linkWithRedirect() ","  2 - ","  3 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",void 0)],e.prototype,"linkWithRedirect",null),Ce([ke({title:"",messages:["","  1 -  User.getLinkedUidList() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getLinkedUidList",null),Ce([ke({title:"",messages:["","  1 -  User.setPrimaryUid() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"setPrimaryUid",null),Ce([ke({title:"",messages:["","  1 -  User.unlink() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"unlink",null),Ce([ke({title:"",messages:["","  1 -  User.update() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"update",null),Ce([ke({title:"",messages:["","  1 -  User.updatePassword() ","  3 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",void 0)],e.prototype,"updatePassword",null),Ce([ke({title:"",messages:["","  1 -  User.updateEmail() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",void 0)],e.prototype,"updateEmail",null),Ce([ke({title:"",messages:["","  1 -  User.updateUsername() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"updateUsername",null),Ce([ke({title:"",messages:["","  1 -  User.refresh() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"refresh",null),Ce([ke({title:"",messages:["","  1 -  auth().linkWithPhoneNumber() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",Promise)],e.prototype,"linkWithPhoneNumber",null),Ce([ke({title:"",messages:["","  1 - ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",Promise)],e.prototype,"updatePhoneNumber",null),e}(),kt=function(){function e(t){var r=t.envId,n=t.cache,s=t.request;r||Sa(tn.INVALID_PARAMS,"envId is not defined"),this._cache=n,this.user=new Jm({cache:n,request:s})}return e.prototype.checkLocalState=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u;return ae(this,function(h){return t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=t.accessTokenExpireKey,i=this._cache.getStore(r),o=this._cache.getStore(n),u=this._cache.getStore(s),this.credential={refreshToken:i,accessToken:o,accessTokenExpire:u},this._loginType=this._cache.getStore(this._cache.keys.loginTypeKey),this.user.checkLocalInfo(),[2]})})},e.prototype.checkLocalStateAsync=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u,h;return ae(this,function(a){switch(a.label){case 0:return t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=t.accessTokenExpireKey,[4,this._cache.getStoreAsync(r)];case 1:return i=a.sent(),[4,this._cache.getStoreAsync(n)];case 2:return o=a.sent(),[4,this._cache.getStoreAsync(s)];case 3:return u=a.sent(),this.credential={refreshToken:i,accessToken:o,accessTokenExpire:u},h=this,[4,this._cache.getStoreAsync(this._cache.keys.loginTypeKey)];case 4:return h._loginType=a.sent(),[4,this.user.checkLocalInfoAsync()];case 5:return a.sent(),[2]}})})},Object.defineProperty(e.prototype,"isAnonymousAuth",{get:function(){return this.loginType===Oe.ANONYMOUS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCustomAuth",{get:function(){return this.loginType===Oe.CUSTOM},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWeixinAuth",{get:function(){return this.loginType===Oe.WECHAT||this.loginType===Oe.WECHAT_OPEN||this.loginType===Oe.WECHAT_PUBLIC},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUsernameAuth",{get:function(){return this.loginType===Oe.USERNAME},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loginType",{get:function(){return this._loginType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPhoneAuth",{get:function(){return this.loginType===Oe.PHONE},enumerable:!1,configurable:!0}),e}(),zm=function(){function e(t){this._config=t,this._cache=t.cache,this._request=t.request,this._runtime=t.runtime||Km.WEB,me.on(ue.LOGIN_TYPE_CHANGED,this._onLoginTypeChanged.bind(this))}return Object.defineProperty(e.prototype,"currentUser",{get:function(){if(this._cache.mode==="async"){$o(tn.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrenUser insteed");return}var t=this.hasLoginState();return t&&t.user||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loginType",{get:function(){return this._cache.getStore(this._cache.keys.loginTypeKey)},enumerable:!1,configurable:!0}),e.prototype.getCurrenUser=function(){return oe(this,void 0,void 0,function(){var t;return ae(this,function(r){switch(r.label){case 0:return[4,this.getLoginState()];case 1:return t=r.sent(),t?[4,t.user.checkLocalInfoAsync()]:[3,3];case 2:return r.sent(),[2,t.user||null];case 3:return[2,null]}})})},e.prototype.getLoginType=function(){return oe(this,void 0,void 0,function(){return ae(this,function(t){switch(t.label){case 0:return[4,this._cache.getStoreAsync(this._cache.keys.loginTypeKey)];case 1:return[2,t.sent()]}})})},e.prototype.getAccessToken=function(){return oe(this,void 0,void 0,function(){var t;return ae(this,function(r){switch(r.label){case 0:return t={},[4,this._request.getAccessToken()];case 1:return[2,(t.accessToken=r.sent().accessToken,t.env=this._config.env,t)]}})})},e.prototype.weixinAuthProvider=function(t){var r=t.appid,n=t.scope,s=t.state;return this._weixinAuthProvider||(this._weixinAuthProvider=new gm(Re(Re({},this._config),{cache:this._cache,request:this._request,runtime:this._runtime}),r,n,s)),this._weixinAuthProvider},e.prototype.anonymousAuthProvider=function(){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new Sm(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._anonymousAuthProvider},e.prototype.customAuthProvider=function(){return this._customAuthProvider||(this._customAuthProvider=new Dm(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._customAuthProvider},e.prototype.emailAuthProvider=function(){return this._emailAuthProvider||(this._emailAuthProvider=new km(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._emailAuthProvider},e.prototype.usernameAuthProvider=function(){return this._usernameAuthProvider||(this._usernameAuthProvider=new jm(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._usernameAuthProvider},e.prototype.phoneAuthProvider=function(){return this._phoneAuthProvider||(this._phoneAuthProvider=new qm(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._phoneAuthProvider},e.prototype.signInWithUsernameAndPassword=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.usernameAuthProvider().signIn(t,r)]})})},e.prototype.isUsernameRegistered=function(t){return oe(this,void 0,void 0,function(){var r;return ae(this,function(n){switch(n.label){case 0:return typeof t!="string"&&Sa(tn.INVALID_PARAMS,"username must be a string"),[4,this._request.send("auth.isUsernameRegistered",{username:t})];case 1:return r=n.sent().data,[2,r==null?void 0:r.isRegistered]}})})},e.prototype.signInWithEmailAndPassword=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.emailAuthProvider().signIn(t,r)]})})},e.prototype.signUpWithEmailAndPassword=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.emailAuthProvider().signUp(t,r)]})})},e.prototype.sendPasswordResetEmail=function(t){return oe(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.emailAuthProvider().resetPassword(t)]})})},e.prototype.signOut=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u;return ae(this,function(h){switch(h.label){case 0:return t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=t.accessTokenExpireKey,i="auth.logout",[4,this._cache.getStoreAsync(r)];case 1:return o=h.sent(),o?[4,this._request.send(i,{refresh_token:o})]:[2];case 2:return u=h.sent(),this._cache.removeStoreAsync(r),this._cache.removeStoreAsync(n),this._cache.removeStoreAsync(s),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Oe.NULL,persistence:this._config.persistence}),[2,u]}})})},e.prototype.onLoginStateChanged=function(t){return oe(this,void 0,void 0,function(){var r,n=this;return ae(this,function(s){switch(s.label){case 0:return me.on(ue.LOGIN_STATE_CHANGED,function(){return oe(n,void 0,void 0,function(){var i;return ae(this,function(o){switch(o.label){case 0:return[4,this.getLoginState()];case 1:return i=o.sent(),t.call(this,i),[2]}})})}),[4,this.getLoginState()];case 1:return r=s.sent(),t.call(this,r),[2]}})})},e.prototype.onLoginStateExpired=function(t){me.on(ue.LOGIN_STATE_EXPIRED,t.bind(this))},e.prototype.onAccessTokenRefreshed=function(t){me.on(ue.ACCESS_TOKEN_REFRESHD,t.bind(this))},e.prototype.onAnonymousConverted=function(t){me.on(ue.ANONYMOUS_CONVERTED,t.bind(this))},e.prototype.onLoginTypeChanged=function(t){var r=this;me.on(ue.LOGIN_TYPE_CHANGED,function(){return oe(r,void 0,void 0,function(){var n;return ae(this,function(s){switch(s.label){case 0:return[4,this.getLoginState()];case 1:return n=s.sent(),t.call(this,n),[2]}})})})},e.prototype.hasLoginState=function(){if(this._cache.mode==="async"){$o(tn.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed");return}var t=this._cache.keys.refreshTokenKey,r=this._cache.getStore(t);if(r){var n=new kt({envId:this._config.env,cache:this._cache,request:this._request});return n.checkLocalState(),n}else return null},e.prototype.getLoginState=function(){return oe(this,void 0,void 0,function(){var t,r,n;return ae(this,function(s){switch(s.label){case 0:return t=this._cache.keys.refreshTokenKey,[4,this._cache.getStoreAsync(t)];case 1:return r=s.sent(),r?(n=new kt({envId:this._config.env,cache:this._cache,request:this._request}),[4,n.checkLocalStateAsync()]):[3,3];case 2:return s.sent(),[2,n];case 3:return[2,null]}})})},e.prototype.shouldRefreshAccessToken=function(t){this._request._shouldRefreshAccessTokenHook=t.bind(this)},e.prototype.getUserInfo=function(){return oe(this,void 0,void 0,function(){var t,r;return ae(this,function(n){switch(n.label){case 0:return t="auth.getUserInfo",[4,this._request.send(t,{})];case 1:return r=n.sent(),r.code?[2,r]:[2,Re(Re({},r.data),{requestId:r.seqId})]}})})},e.prototype.getAuthHeader=function(){var t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=this._cache.getStore(r),i=this._cache.getStore(n);return{"x-cloudbase-credentials":i+"/@@/"+s}},e.prototype.getAuthHeaderAsync=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i;return ae(this,function(o){switch(o.label){case 0:return[4,this._request.refreshAccessToken()];case 1:return o.sent(),t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,[4,this._cache.getStoreAsync(r)];case 2:return s=o.sent(),[4,this._cache.getStoreAsync(n)];case 3:return i=o.sent(),[2,{"x-cloudbase-credentials":i+"/@@/"+s}]}})})},e.prototype.sendPhoneCode=function(t){return oe(this,void 0,void 0,function(){var r;return ae(this,function(n){switch(n.label){case 0:return[4,this._request.send("auth.sendPhoneCode",{phoneNumber:Wo(t)})];case 1:return r=n.sent().data,[2,r.SendStatus==="Ok"]}})})},e.prototype.signUpWithPhoneCode=function(t,r,n){return oe(this,void 0,void 0,function(){return ae(this,function(s){return[2,this.phoneAuthProvider().signUp(t,r,n)]})})},e.prototype.signInWithPhoneCodeOrPassword=function(t){return oe(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.phoneAuthProvider().signIn(t)]})})},e.prototype.forceResetPwdByPhoneCode=function(t){return oe(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.phoneAuthProvider().signIn(Re(Re({},t),{signMethod:Di.FORCERESETPWD}))]})})},e.prototype._onLoginTypeChanged=function(t){return oe(this,void 0,void 0,function(){var r,n,s,i;return ae(this,function(o){switch(o.label){case 0:return r=t.data,n=r.loginType,s=r.persistence,i=r.env,i!==this._config.env?[2]:[4,this._cache.updatePersistenceAsync(s)];case 1:return o.sent(),[4,this._cache.setStoreAsync(this._cache.keys.loginTypeKey,n)];case 2:return o.sent(),[2]}})})},Ce([ke({title:"",messages:["","  1 -  auth().getCurrenUser() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getCurrenUser",null),Ce([ke({title:"",messages:["","  1 -  auth().isUsernameRegistered() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"isUsernameRegistered",null),Ce([ke({title:"",messages:["","  1 -  auth().signOut() ","  2 - signOut",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"signOut",null),Ce([ke({title:"",messages:["","  1 -  auth().getLoginState() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getLoginState",null),Ce([ke({title:"",messages:["","  1 - ","  2 -  auth().getUserInfo() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getUserInfo",null),Ce([ke({title:"",messages:["","  1 - ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"sendPhoneCode",null),e}(),ue={LOGIN_STATE_CHANGED:"loginStateChanged",LOGIN_STATE_EXPIRED:"loginStateExpire",LOGIN_TYPE_CHANGED:"loginTypeChanged",ANONYMOUS_CONVERTED:"anonymousConverted",ACCESS_TOKEN_REFRESHD:"refreshAccessToken"},Zm={name:Vm,namespace:"auth",injectEvents:{bus:me,events:[ue.LOGIN_TYPE_CHANGED,ue.LOGIN_STATE_EXPIRED,ue.LOGIN_STATE_CHANGED,ue.ACCESS_TOKEN_REFRESHD,ue.ANONYMOUS_CONVERTED]},entity:function(e){if(e===void 0&&(e={region:"",persistence:"local"}),this.authInstance)return $o(tn.INVALID_OPERATION,"every cloudbase instance should has only one auth object"),this.authInstance;var t=this.platform,r=t.adapter,n=t.runtime,s=e.persistence||r.primaryStorage;s&&s!==this.config.persistence&&this.updateConfig({persistence:s});var i=this.config,o=i.env,u=i.persistence,h=i.debug;return this.authInstance=new zm({env:o,region:e.region,persistence:u,debug:h,cache:this.cache,request:this.request,runtime:n}),this.authInstance}};try{cloudbase.registerComponent(Zm)}catch{}var mr,Gt;(function(e){e.DocIDError="ID",e.CollNameError="",e.OpStrError="",e.DirectionError="",e.IntergerError="must be integer",e.QueryParamTypeError="",e.QueryParamValueError="undefined"})(Gt||(Gt={}));var he={String:"String",Number:"Number",Object:"Object",Array:"Array",Boolean:"Boolean",Null:"Null",GeoPoint:"GeoPoint",GeoLineString:"GeoLineString",GeoPolygon:"GeoPolygon",GeoMultiPoint:"GeoMultiPoint",GeoMultiLineString:"GeoMultiLineString",GeoMultiPolygon:"GeoMultiPolygon",Timestamp:"Date",Command:"Command",ServerDate:"ServerDate",BsonDate:"BsonDate"},Xm=["desc","asc"],Qm=["<","<=","==",">=",">"],Er;(function(e){e.lt="<",e.gt=">",e.lte="<=",e.gte=">=",e.eq="=="})(Er||(Er={}));mr={},mr[Er.eq]="$eq",mr[Er.lt]="$lt",mr[Er.lte]="$lte",mr[Er.gt]="$gt",mr[Er.gte]="$gte";var Ct;(function(e){e.WHERE="WHERE",e.DOC="DOC"})(Ct||(Ct={}));var ev=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ei=[],Ru={},tv=function(){function e(t){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:t}})}return e}(),rt=function(e){ev(t,e);function t(r,n){var s=this;if(n!==Ru)throw new TypeError("InternalSymbol cannot be constructed with new operator");return s=e.call(this,r)||this,s}return t.for=function(r){for(var n=0,s=Ei.length;n<s;n++)if(Ei[n].target===r)return Ei[n].instance;var i=new t(r,Ru);return Ei.push({target:r,instance:i}),i},t}(tv),jn=rt.for("UNSET_FIELD_NAME"),Df=rt.for("UPDATE_COMMAND"),Cf=rt.for("QUERY_COMMAND"),Pf=rt.for("LOGIC_COMMAND"),kf=rt.for("GEO_POINT"),rv=rt.for("SYMBOL_GEO_LINE_STRING"),nv=rt.for("SYMBOL_GEO_POLYGON"),iv=rt.for("SYMBOL_GEO_MULTI_POINT"),sv=rt.for("SYMBOL_GEO_MULTI_LINE_STRING"),ov=rt.for("SYMBOL_GEO_MULTI_POLYGON"),Mf=rt.for("SERVER_DATE"),Ff=rt.for("REGEXP"),Lf=function(){function e(t){var r=(t===void 0?{}:t).offset,n=r===void 0?0:r;this.offset=n}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return Mf},enumerable:!0,configurable:!0}),e.prototype.parse=function(){return{$date:{offset:this.offset}}},e}();function av(e){return new Lf(e)}var go=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},hs=function(){function e(){}return e.formatResDocumentData=function(t){return t.map(function(r){return e.formatField(r)})},e.formatField=function(t){var r=Object.keys(t),n={};return Array.isArray(t)&&(n=[]),r.forEach(function(s){var i=t[s],o=e.whichType(i),u;switch(o){case he.GeoPoint:u=new Xe(i.coordinates[0],i.coordinates[1]);break;case he.GeoLineString:u=new Rt(i.coordinates.map(function(h){return new Xe(h[0],h[1])}));break;case he.GeoPolygon:u=new Tr(i.coordinates.map(function(h){return new Rt(h.map(function(a){var c=go(a,2),d=c[0],_=c[1];return new Xe(d,_)}))}));break;case he.GeoMultiPoint:u=new Wi(i.coordinates.map(function(h){return new Xe(h[0],h[1])}));break;case he.GeoMultiLineString:u=new ji(i.coordinates.map(function(h){return new Rt(h.map(function(a){var c=go(a,2),d=c[0],_=c[1];return new Xe(d,_)}))}));break;case he.GeoMultiPolygon:u=new Yn(i.coordinates.map(function(h){return new Tr(h.map(function(a){return new Rt(a.map(function(c){var d=go(c,2),_=d[0],m=d[1];return new Xe(_,m)}))}))}));break;case he.Timestamp:u=new Date(i.$timestamp*1e3);break;case he.Object:case he.Array:u=e.formatField(i);break;case he.ServerDate:u=new Date(i.$date);break;default:u=i}Array.isArray(n)?n.push(u):n[s]=u}),n},e.whichType=function(t){var r=Object.prototype.toString.call(t).slice(8,-1);if(r===he.Timestamp)return he.BsonDate;if(r===he.Object){if(t instanceof Xe)return he.GeoPoint;if(t instanceof Date)return he.Timestamp;if(t instanceof Lf)return he.ServerDate;t.$timestamp?r=he.Timestamp:t.$date?r=he.ServerDate:Xe.validate(t)?r=he.GeoPoint:Rt.validate(t)?r=he.GeoLineString:Tr.validate(t)?r=he.GeoPolygon:Wi.validate(t)?r=he.GeoMultiPoint:ji.validate(t)?r=he.GeoMultiLineString:Yn.validate(t)&&(r=he.GeoMultiPolygon)}return r},e.generateDocId=function(){for(var t="ABCDEFabcdef0123456789",r="",n=0;n<24;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},e}(),sr=function(){function e(){}return e.isGeopoint=function(t,r){if(hs.whichType(r)!==he.Number)throw new Error("Geo Point must be number type");var n=Math.abs(r);if(t==="latitude"&&n>90)throw new Error("latitude should be a number ranges from -90 to 90");if(t==="longitude"&&n>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0},e.isInteger=function(t,r){if(!Number.isInteger(r))throw new Error(t+Gt.IntergerError);return!0},e.isFieldOrder=function(t){if(Xm.indexOf(t)===-1)throw new Error(Gt.DirectionError);return!0},e.isFieldPath=function(t){if(!/^[a-zA-Z0-9-_\.]/.test(t))throw new Error;return!0},e.isOperator=function(t){if(Qm.indexOf(t)===-1)throw new Error(Gt.OpStrError);return!0},e.isCollName=function(t){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(t))throw new Error(Gt.CollNameError);return!0},e.isDocID=function(t){if(!/^([a-fA-F0-9]){24}$/.test(t))throw new Error(Gt.DocIDError);return!0},e}(),Mt=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},ur=function(e){return Mt(e)==="object"},uv=function(e){return Mt(e)==="string"},dt=function(e){return Mt(e)==="number"},Te=function(e){return Array.isArray(e)},Uf=function(e){return Mt(e)==="date"},Aa=function(e){return Mt(e)==="regexp"},Bf=function(e){return e&&e._internalType instanceof rt},Xe=function(){function e(t,r){sr.isGeopoint("longitude",t),sr.isGeopoint("latitude",r),this.longitude=t,this.latitude=r}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Point",coordinates:[this.longitude,this.latitude]},r},e.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},e.prototype.toReadableString=function(){return"["+this.longitude+","+this.latitude+"]"},e.validate=function(t){return t.type==="Point"&&Te(t.coordinates)&&sr.isGeopoint("longitude",t.coordinates[0])&&sr.isGeopoint("latitude",t.coordinates[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return kf},enumerable:!0,configurable:!0}),e}(),cv=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Rt=function(){function e(t){if(!Te(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length<2)throw new Error('"points" must contain 2 points at least');t.forEach(function(r){if(!(r instanceof Xe))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"LineString",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="LineString"||!Te(t.coordinates))return!1;try{for(var s=cv(t.coordinates),i=s.next();!i.done;i=s.next()){var o=i.value;if(!dt(o[0])||!dt(o[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!0},e.isClosed=function(t){var r=t.points[0],n=t.points[t.points.length-1];if(r.latitude===n.latitude&&r.longitude===n.longitude)return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return rv},enumerable:!0,configurable:!0}),e}(),Du=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Tr=function(){function e(t){if(!Te(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Rt))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]");if(!Rt.isClosed(r))throw new Error("LineString "+r.points.map(function(n){return n.toReadableString()})+" is not a closed cycle")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Polygon",coordinates:this.lines.map(function(n){return n.points.map(function(s){return[s.longitude,s.latitude]})})},r},e.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,s,i;if(t.type!=="Polygon"||!Te(t.coordinates))return!1;try{for(var o=Du(t.coordinates),u=o.next();!u.done;u=o.next()){var h=u.value;if(!this.isCloseLineString(h))return!1;try{for(var a=(s=void 0,Du(h)),c=a.next();!c.done;c=a.next()){var d=c.value;if(!dt(d[0])||!dt(d[1]))return!1}}catch(_){s={error:_}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}}catch(_){r={error:_}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},e.isCloseLineString=function(t){var r=t[0],n=t[t.length-1];return!(r[0]!==n[0]||r[1]!==n[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return ov},enumerable:!0,configurable:!0}),e}(),fv=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Wi=function(){function e(t){if(!Te(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length===0)throw new Error('"points" must contain 1 point at least');t.forEach(function(r){if(!(r instanceof Xe))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPoint",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"MultiPoint",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="MultiPoint"||!Te(t.coordinates))return!1;try{for(var s=fv(t.coordinates),i=s.next();!i.done;i=s.next()){var o=i.value;if(!dt(o[0])||!dt(o[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return iv},enumerable:!0,configurable:!0}),e}(),Cu=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ji=function(){function e(t){if(!Te(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Rt))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiLineString",coordinates:this.lines.map(function(n){return n.points.map(function(s){return[s.longitude,s.latitude]})})},r},e.prototype.toJSON=function(){return{type:"MultiLineString",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,s,i;if(t.type!=="MultiLineString"||!Te(t.coordinates))return!1;try{for(var o=Cu(t.coordinates),u=o.next();!u.done;u=o.next()){var h=u.value;try{for(var a=(s=void 0,Cu(h)),c=a.next();!c.done;c=a.next()){var d=c.value;if(!dt(d[0])||!dt(d[1]))return!1}}catch(_){s={error:_}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}}catch(_){r={error:_}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return sv},enumerable:!0,configurable:!0}),e}(),bi=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yn=function(){function e(t){var r,n;if(!Te(t))throw new TypeError('"polygons" must be of type Polygon[]. Received type '+typeof t);if(t.length===0)throw new Error("MultiPolygon must contain 1 polygon at least");try{for(var s=bi(t),i=s.next();!i.done;i=s.next()){var o=i.value;if(!(o instanceof Tr))throw new TypeError('"polygon" must be of type Polygon[]. Received type '+typeof o+"[]")}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.polygons=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPolygon",coordinates:this.polygons.map(function(n){return n.lines.map(function(s){return s.points.map(function(i){return[i.longitude,i.latitude]})})})},r},e.prototype.toJSON=function(){return{type:"MultiPolygon",coordinates:this.polygons.map(function(t){return t.lines.map(function(r){return r.points.map(function(n){return[n.longitude,n.latitude]})})})}},e.validate=function(t){var r,n,s,i,o,u;if(t.type!=="MultiPolygon"||!Te(t.coordinates))return!1;try{for(var h=bi(t.coordinates),a=h.next();!a.done;a=h.next()){var c=a.value;try{for(var d=(s=void 0,bi(c)),_=d.next();!_.done;_=d.next()){var m=_.value;try{for(var S=(o=void 0,bi(m)),b=S.next();!b.done;b=S.next()){var A=b.value;if(!dt(A[0])||!dt(A[1]))return!1}}catch(I){o={error:I}}finally{try{b&&!b.done&&(u=S.return)&&u.call(S)}finally{if(o)throw o.error}}}}catch(I){s={error:I}}finally{try{_&&!_.done&&(i=d.return)&&i.call(d)}finally{if(s)throw s.error}}}}catch(I){r={error:I}}finally{try{a&&!a.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return nv},enumerable:!0,configurable:!0}),e}();const lv=Object.freeze(Object.defineProperty({__proto__:null,LineString:Rt,MultiLineString:ji,MultiPoint:Wi,MultiPolygon:Yn,Point:Xe,Polygon:Tr},Symbol.toStringTag,{value:"Module"}));var Kt=function(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,s){e=function(i,o){return i?s(i):n(o)}});return e.promise=r,e},Z;(function(e){e.SET="set",e.REMOVE="remove",e.INC="inc",e.MUL="mul",e.PUSH="push",e.PULL="pull",e.PULL_ALL="pullAll",e.POP="pop",e.SHIFT="shift",e.UNSHIFT="unshift",e.ADD_TO_SET="addToSet",e.BIT="bit",e.RENAME="rename",e.MAX="max",e.MIN="min"})(Z||(Z={}));var xe=function(){function e(t,r,n){this._internalType=Df,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||jn}return e.prototype._setFieldName=function(t){var r=new e(this.operator,this.operands,t);return r},e}();function Pu(e){return e&&e instanceof xe&&e._internalType===Df}var et;(function(e){e.AND="and",e.OR="or",e.NOT="not",e.NOR="nor"})(et||(et={}));var Ar=function(){function e(t,r,n){if(this._internalType=Pf,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||jn,this.fieldName!==jn)if(Array.isArray(r)){r=r.slice(),this.operands=r;for(var s=0,i=r.length;s<i;s++){var o=r[s];(Yi(o)||Hi(o))&&(r[s]=o._setFieldName(this.fieldName))}}else{var o=r;(Yi(o)||Hi(o))&&(r=o._setFieldName(this.fieldName))}}return e.prototype._setFieldName=function(t){var r=this.operands.map(function(s){return s instanceof e?s._setFieldName(t):s}),n=new e(this.operator,r,t);return n},e.prototype.and=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(et.AND,t,this.fieldName)},e.prototype.or=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(et.OR,t,this.fieldName)},e}();function Yi(e){return e&&e instanceof Ar&&e._internalType===Pf}var hv=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),q;(function(e){e.EQ="eq",e.NEQ="neq",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte",e.IN="in",e.NIN="nin",e.ALL="all",e.ELEM_MATCH="elemMatch",e.EXISTS="exists",e.SIZE="size",e.MOD="mod",e.GEO_NEAR="geoNear",e.GEO_WITHIN="geoWithin",e.GEO_INTERSECTS="geoIntersects"})(q||(q={}));var De=function(e){hv(t,e);function t(r,n,s){var i=e.call(this,r,n,s)||this;return i.operator=r,i._internalType=Cf,i}return t.prototype.toJSON=function(){var r,n;switch(this.operator){case q.IN:case q.NIN:return r={},r["$"+this.operator]=this.operands,r;default:return n={},n["$"+this.operator]=this.operands[0],n}},t.prototype._setFieldName=function(r){var n=new t(this.operator,this.operands,r);return n},t.prototype.eq=function(r){var n=new t(q.EQ,[r],this.fieldName);return this.and(n)},t.prototype.neq=function(r){var n=new t(q.NEQ,[r],this.fieldName);return this.and(n)},t.prototype.gt=function(r){var n=new t(q.GT,[r],this.fieldName);return this.and(n)},t.prototype.gte=function(r){var n=new t(q.GTE,[r],this.fieldName);return this.and(n)},t.prototype.lt=function(r){var n=new t(q.LT,[r],this.fieldName);return this.and(n)},t.prototype.lte=function(r){var n=new t(q.LTE,[r],this.fieldName);return this.and(n)},t.prototype.in=function(r){var n=new t(q.IN,r,this.fieldName);return this.and(n)},t.prototype.nin=function(r){var n=new t(q.NIN,r,this.fieldName);return this.and(n)},t.prototype.geoNear=function(r){if(!(r.geometry instanceof Xe))throw new TypeError('"geometry" must be of type Point. Received type '+typeof r.geometry);if(r.maxDistance!==void 0&&!dt(r.maxDistance))throw new TypeError('"maxDistance" must be of type Number. Received type '+typeof r.maxDistance);if(r.minDistance!==void 0&&!dt(r.minDistance))throw new TypeError('"minDistance" must be of type Number. Received type '+typeof r.minDistance);var n=new t(q.GEO_NEAR,[r],this.fieldName);return this.and(n)},t.prototype.geoWithin=function(r){if(!(r.geometry instanceof Yn)&&!(r.geometry instanceof Tr))throw new TypeError('"geometry" must be of type Polygon or MultiPolygon. Received type '+typeof r.geometry);var n=new t(q.GEO_WITHIN,[r],this.fieldName);return this.and(n)},t.prototype.geoIntersects=function(r){if(!(r.geometry instanceof Xe)&&!(r.geometry instanceof Rt)&&!(r.geometry instanceof Tr)&&!(r.geometry instanceof Wi)&&!(r.geometry instanceof ji)&&!(r.geometry instanceof Yn))throw new TypeError('"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type '+typeof r.geometry);var n=new t(q.GEO_INTERSECTS,[r],this.fieldName);return this.and(n)},t}(Ar);function Hi(e){return e&&e instanceof De&&e._internalType===Cf}function ku(e){return Hi(e)}var fr={};for(var cr in q)fr[cr]="$"+cr;for(var cr in et)fr[cr]="$"+cr;for(var cr in Z)fr[cr]="$"+cr;fr[q.NEQ]="$ne";fr[Z.REMOVE]="$unset";fr[Z.SHIFT]="$pop";fr[Z.UNSHIFT]="$push";function Jr(e){return fr[e]||"$"+e}var jo=function(){return jo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},jo.apply(this,arguments)},dv=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},Mu=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(dv(arguments[t]));return e};function Hn(e){return Yo(e,[e])}function Yo(e,t){if(Bf(e))switch(e._internalType){case kf:return e.toJSON();case Mf:return e.parse();case Ff:return e.parse();default:return e.toJSON?e.toJSON():e}else{if(Uf(e))return{$date:+e};if(Aa(e))return{$regex:e.source,$options:e.flags};if(Te(e))return e.map(function(s){if(t.indexOf(s)>-1)throw new Error("Cannot convert circular structure to JSON");return Yo(s,Mu(t,[s]))});if(ur(e)){var r=jo({},e);for(var n in r){if(t.indexOf(r[n])>-1)throw new Error("Cannot convert circular structure to JSON");r[n]=Yo(r[n],Mu(t,[r[n]]))}return r}else return e}}var Ho=function(){return Ho=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ho.apply(this,arguments)},pv=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},Fu=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(pv(arguments[t]));return e};function $f(e,t,r,n){var s=Ho({},e);for(var i in e)if(!/^\$/.test(i)){var o=e[i];if(o&&ur(o)&&!t(o)){if(n.indexOf(o)>-1)throw new Error("Cannot convert circular structure to JSON");var u=Fu(r,[i]),h=Fu(n,[o]),a=$f(o,t,u,h);s[i]=a;var c=!1;for(var d in a)/^\$/.test(d)?c=!0:(s[i+"."+d]=a[d],delete s[i][d]);c||delete s[i]}}return s}function Wf(e){return $f(e,qo,[],[e])}function Lu(e,t,r){t[r]||delete e[r];for(var n in t)e[n]?Te(e[n])?e[n].push(t[n]):ur(e[n])?ur(t[n])?Object.assign(e[n],t[n]):(console.warn("unmergable condition, query is object but condition is "+Mt(t)+", can only overwrite",t,r),e[n]=t[n]):(console.warn("to-merge query is of type "+Mt(e)+", can only overwrite",e,t,r),e[n]=t[n]):e[n]=t[n]}function qo(e){return Bf(e)||Uf(e)||Aa(e)}function or(e){return Hn(e)}var Ia=function(){function e(){}return e.encode=function(t){var r=new e;return r.encodeUpdate(t)},e.prototype.encodeUpdate=function(t){return Pu(t)?this.encodeUpdateCommand(t):Mt(t)==="object"?this.encodeUpdateObject(t):t},e.prototype.encodeUpdateCommand=function(t){if(t.fieldName===jn)throw new Error("Cannot encode a comparison command with unset field name");switch(t.operator){case Z.PUSH:case Z.PULL:case Z.PULL_ALL:case Z.POP:case Z.SHIFT:case Z.UNSHIFT:case Z.ADD_TO_SET:return this.encodeArrayUpdateCommand(t);default:return this.encodeFieldUpdateCommand(t)}},e.prototype.encodeFieldUpdateCommand=function(t){var r,n,s,i,o=Jr(t.operator);switch(t.operator){case Z.REMOVE:return r={},r[o]=(n={},n[t.fieldName]="",n),r;default:return s={},s[o]=(i={},i[t.fieldName]=t.operands[0],i),s}},e.prototype.encodeArrayUpdateCommand=function(t){var r,n,s,i,o,u,h,a,c,d,_=Jr(t.operator);switch(t.operator){case Z.PUSH:{var m=void 0;return Te(t.operands)?m={$each:t.operands.map(or)}:m=t.operands,r={},r[_]=(n={},n[t.fieldName]=m,n),r}case Z.UNSHIFT:{var m={$each:t.operands.map(or),$position:0};return s={},s[_]=(i={},i[t.fieldName]=m,i),s}case Z.POP:return o={},o[_]=(u={},u[t.fieldName]=1,u),o;case Z.SHIFT:return h={},h[_]=(a={},a[t.fieldName]=-1,a),h;default:return c={},c[_]=(d={},d[t.fieldName]=or(t.operands),d),c}},e.prototype.encodeUpdateObject=function(t){var r=Wf(t);for(var n in r)if(!/^\$/.test(n)){var s=r[n];if(Pu(s)){r[n]=s._setFieldName(n);var i=this.encodeUpdateCommand(r[n]);Lu(r,i,n)}else{r[n]=s=or(s);var o=new xe(Z.SET,[s],n),i=this.encodeUpdateCommand(o);Lu(r,i,n)}}return r},e}(),_o={};function jf(e){if(!je.wsClientClass)throw new Error("to use realtime you must import realtime module first");var t=e.config.env;return _o[t]||(_o[t]=new je.wsClientClass({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,request:new je.reqClass(e.config)}}})),_o[t]}var qi=function(){return qi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},qi.apply(this,arguments)},Uu=function(){function e(t,r,n,s){var i=this;s===void 0&&(s={}),this.watch=function(o){var u=jf(i._db);return u.watch(qi(qi({},o),{envId:i._db.config.env,collectionName:i._coll,query:JSON.stringify({_id:i.id})}))},this._db=t,this._coll=r,this.id=n,this.request=new je.reqClass(this._db.config),this.projection=s}return e.prototype.create=function(t,r){r=r||Kt();var n={collectionName:this._coll,data:Hn(t)};return this.id&&(n._id=this.id),this.request.send("database.addDocument",n).then(function(s){s.code?r(0,s):r(0,{id:s.data._id,requestId:s.requestId})}).catch(function(s){r(s)}),r.promise},e.prototype.set=function(t,r){if(r=r||Kt(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docId"});if(!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:""});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"_id"});var n=!1,s=function(u){if(typeof u=="object")for(var h in u)u[h]instanceof xe?n=!0:typeof u[h]=="object"&&s(u[h])};if(s(t),n)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});var i=!1,o={collectionName:this._coll,queryType:Ct.DOC,data:Hn(t),multi:!1,merge:i,upsert:!0};return this.id&&(o.query={_id:this.id}),this.request.send("database.updateDocument",o).then(function(u){u.code?r(0,u):r(0,{updated:u.data.updated,upsertedId:u.data.upserted_id,requestId:u.requestId})}).catch(function(u){r(u)}),r.promise},e.prototype.update=function(t,r){if(r=r||Kt(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:""});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"_id"});var n={_id:this.id},s=!0,i={collectionName:this._coll,data:Ia.encode(t),query:n,queryType:Ct.DOC,multi:!1,merge:s,upsert:!1};return this.request.send("database.updateDocument",i).then(function(o){o.code?r(0,o):r(0,{updated:o.data.updated,upsertedId:o.data.upserted_id,requestId:o.requestId})}).catch(function(o){r(o)}),r.promise},e.prototype.remove=function(t){t=t||Kt();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Ct.DOC,multi:!1};return this.request.send("database.deleteDocument",n).then(function(s){s.code?t(0,s):t(0,{deleted:s.data.deleted,requestId:s.requestId})}).catch(function(s){t(s)}),t.promise},e.prototype.get=function(t){t=t||Kt();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Ct.DOC,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",n).then(function(s){if(s.code)t(0,s);else{var i=hs.formatResDocumentData(s.data.list);t(0,{data:i,requestId:s.requestId,total:s.TotalCount,limit:s.Limit,offset:s.Offset})}}).catch(function(s){t(s)}),t.promise},e.prototype.field=function(t){for(var r in t)t[r]?t[r]=1:t[r]=0;return new e(this._db,this._coll,this.id,t)},e}(),Go=function(){function e(){}return e.encode=function(t){var r=new yv;return r.encodeQuery(t)},e}(),yv=function(){function e(){}return e.prototype.encodeQuery=function(t,r){var n;return qo(t)?Yi(t)?this.encodeLogicCommand(t):Hi(t)?this.encodeQueryCommand(t):(n={},n[r]=this.encodeQueryObject(t),n):ur(t)?this.encodeQueryObject(t):t},e.prototype.encodeRegExp=function(t){return{$regex:t.source,$options:t.flags}},e.prototype.encodeLogicCommand=function(t){var r,n,s,i,o,u,h,a=this;switch(t.operator){case et.NOR:case et.AND:case et.OR:{var c=Jr(t.operator),d=t.operands.map(function(S){return a.encodeQuery(S,t.fieldName)});return r={},r[c]=d,r}case et.NOT:{var c=Jr(t.operator),_=t.operands[0];if(Aa(_))return n={},n[t.fieldName]=(s={},s[c]=this.encodeRegExp(_),s),n;var d=this.encodeQuery(_)[t.fieldName];return i={},i[t.fieldName]=(o={},o[c]=d,o),i}default:{var c=Jr(t.operator);if(t.operands.length===1){var m=this.encodeQuery(t.operands[0]);return u={},u[c]=m,u}else{var d=t.operands.map(this.encodeQuery.bind(this));return h={},h[c]=d,h}}}},e.prototype.encodeQueryCommand=function(t){return ku(t)?this.encodeComparisonCommand(t):this.encodeComparisonCommand(t)},e.prototype.encodeComparisonCommand=function(t){var r,n,s,i,o,u,h,a,c;if(t.fieldName===jn)throw new Error("Cannot encode a comparison command with unset field name");var d=Jr(t.operator);switch(t.operator){case q.EQ:case q.NEQ:case q.LT:case q.LTE:case q.GT:case q.GTE:case q.ELEM_MATCH:case q.EXISTS:case q.SIZE:case q.MOD:return r={},r[t.fieldName]=(n={},n[d]=or(t.operands[0]),n),r;case q.IN:case q.NIN:case q.ALL:return s={},s[t.fieldName]=(i={},i[d]=or(t.operands),i),s;case q.GEO_NEAR:{var _=t.operands[0];return o={},o[t.fieldName]={$nearSphere:{$geometry:_.geometry.toJSON(),$maxDistance:_.maxDistance,$minDistance:_.minDistance}},o}case q.GEO_WITHIN:{var _=t.operands[0];return u={},u[t.fieldName]={$geoWithin:{$geometry:_.geometry.toJSON()}},u}case q.GEO_INTERSECTS:{var _=t.operands[0];return h={},h[t.fieldName]={$geoIntersects:{$geometry:_.geometry.toJSON()}},h}default:return a={},a[t.fieldName]=(c={},c[d]=or(t.operands[0]),c),a}},e.prototype.encodeQueryObject=function(t){var r=Wf(t);for(var n in r){var s=r[n];if(Yi(s)){r[n]=s._setFieldName(n);var i=this.encodeLogicCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else if(ku(s)){r[n]=s._setFieldName(n);var i=this.encodeComparisonCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else qo(s)&&(r[n]=or(s))}return r},e.prototype.mergeConditionAfterEncode=function(t,r,n){r[n]||delete t[n];for(var s in r)t[s]?Te(t[s])?t[s]=t[s].concat(r[s]):ur(t[s])?ur(r[s])?Object.assign(t,r):(console.warn("unmergable condition, query is object but condition is "+Mt(r)+", can only overwrite",r,n),t[s]=r[s]):(console.warn("to-merge query is of type "+Mt(t)+", can only overwrite",t,r,n),t[s]=r[s]):t[s]=r[s]},e}(),br=function(){return br=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},br.apply(this,arguments)},gv=function(){function e(t,r,n,s,i){var o=this;this.watch=function(u){var h=jf(o._db);return h.watch(br(br({},u),{envId:o._db.config.env,collectionName:o._coll,query:JSON.stringify(o._fieldFilters||{}),limit:o._queryOptions.limit,orderBy:o._fieldOrders?o._fieldOrders.reduce(function(a,c){return a[c.field]=c.direction,a},{}):void 0}))},this._db=t,this._coll=r,this._fieldFilters=n,this._fieldOrders=s||[],this._queryOptions=i||{},this._request=new je.reqClass(this._db.config)}return e.prototype.get=function(t){t=t||Kt();var r=[];this._fieldOrders&&this._fieldOrders.forEach(function(s){r.push(s)});var n={collectionName:this._coll,queryType:Ct.WHERE};return this._fieldFilters&&(n.query=this._fieldFilters),r.length>0&&(n.order=r),this._queryOptions.offset&&(n.offset=this._queryOptions.offset),this._queryOptions.limit?n.limit=this._queryOptions.limit<1e3?this._queryOptions.limit:1e3:n.limit=100,this._queryOptions.projection&&(n.projection=this._queryOptions.projection),this._request.send("database.queryDocument",n).then(function(s){if(s.code)t(0,s);else{var i=hs.formatResDocumentData(s.data.list),o={data:i,requestId:s.requestId};s.TotalCount&&(o.total=s.TotalCount),s.Limit&&(o.limit=s.Limit),s.Offset&&(o.offset=s.Offset),t(0,o)}}).catch(function(s){t(s)}),t.promise},e.prototype.count=function(t){t=t||Kt();var r={collectionName:this._coll,queryType:Ct.WHERE};return this._fieldFilters&&(r.query=this._fieldFilters),this._request.send("database.countDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,total:n.data.total})}).catch(function(n){t(n)}),t.promise},e.prototype.where=function(t){if(Object.prototype.toString.call(t).slice(8,-1)!=="Object")throw Error(Gt.QueryParamTypeError);var r=Object.keys(t),n=r.some(function(s){return t[s]!==void 0});if(r.length&&!n)throw Error(Gt.QueryParamValueError);return new e(this._db,this._coll,Go.encode(t),this._fieldOrders,this._queryOptions)},e.prototype.orderBy=function(t,r){sr.isFieldPath(t),sr.isFieldOrder(r);var n={field:t,direction:r},s=this._fieldOrders.concat(n);return new e(this._db,this._coll,this._fieldFilters,s,this._queryOptions)},e.prototype.limit=function(t){sr.isInteger("limit",t);var r=br({},this._queryOptions);return r.limit=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.skip=function(t){sr.isInteger("offset",t);var r=br({},this._queryOptions);return r.offset=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.update=function(t,r){if(r=r||Kt(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:""});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"_id"});var n={collectionName:this._coll,query:this._fieldFilters,queryType:Ct.WHERE,multi:!0,merge:!0,upsert:!1,data:Ia.encode(t)};return this._request.send("database.updateDocument",n).then(function(s){s.code?r(0,s):r(0,{requestId:s.requestId,updated:s.data.updated,upsertId:s.data.upsert_id})}).catch(function(s){r(s)}),r.promise},e.prototype.field=function(t){for(var r in t)t[r]?typeof t[r]!="object"&&(t[r]=1):t[r]=0;var n=br({},this._queryOptions);return n.projection=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,n)},e.prototype.remove=function(t){t=t||Kt(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");var r={collectionName:this._coll,query:Go.encode(this._fieldFilters),queryType:Ct.WHERE,multi:!0};return this._request.send("database.deleteDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,deleted:n.data.deleted})}).catch(function(n){t(n)}),t.promise},e}();function _v(e,t){return t={exports:{}},e(t,t.exports),t.exports}var mv=Sv,vv=Iv,wv=xv,Dt=[],ct=[],Ev=typeof Uint8Array<"u"?Uint8Array:Array,mo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yr=0,bv=mo.length;Yr<bv;++Yr)Dt[Yr]=mo[Yr],ct[mo.charCodeAt(Yr)]=Yr;ct[45]=62;ct[95]=63;function Yf(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function Sv(e){var t=Yf(e),r=t[0],n=t[1];return(r+n)*3/4-n}function Av(e,t,r){return(t+r)*3/4-r}function Iv(e){var t,r=Yf(e),n=r[0],s=r[1],i=new Ev(Av(e,n,s)),o=0,u=s>0?n-4:n,h;for(h=0;h<u;h+=4)t=ct[e.charCodeAt(h)]<<18|ct[e.charCodeAt(h+1)]<<12|ct[e.charCodeAt(h+2)]<<6|ct[e.charCodeAt(h+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=t&255;return s===2&&(t=ct[e.charCodeAt(h)]<<2|ct[e.charCodeAt(h+1)]>>4,i[o++]=t&255),s===1&&(t=ct[e.charCodeAt(h)]<<10|ct[e.charCodeAt(h+1)]<<4|ct[e.charCodeAt(h+2)]>>2,i[o++]=t>>8&255,i[o++]=t&255),i}function Tv(e){return Dt[e>>18&63]+Dt[e>>12&63]+Dt[e>>6&63]+Dt[e&63]}function Ov(e,t,r){for(var n,s=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(Tv(n));return s.join("")}function xv(e){for(var t,r=e.length,n=r%3,s=[],i=16383,o=0,u=r-n;o<u;o+=i)s.push(Ov(e,o,o+i>u?u:o+i));return n===1?(t=e[r-1],s.push(Dt[t>>2]+Dt[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],s.push(Dt[t>>10]+Dt[t>>4&63]+Dt[t<<2&63]+"=")),s.join("")}var vo={byteLength:mv,toByteArray:vv,fromByteArray:wv};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Nv=function(t,r,n,s,i){var o,u,h=i*8-s-1,a=(1<<h)-1,c=a>>1,d=-7,_=n?i-1:0,m=n?-1:1,S=t[r+_];for(_+=m,o=S&(1<<-d)-1,S>>=-d,d+=h;d>0;o=o*256+t[r+_],_+=m,d-=8);for(u=o&(1<<-d)-1,o>>=-d,d+=s;d>0;u=u*256+t[r+_],_+=m,d-=8);if(o===0)o=1-c;else{if(o===a)return u?NaN:(S?-1:1)*(1/0);u=u+Math.pow(2,s),o=o-c}return(S?-1:1)*u*Math.pow(2,o-s)},Rv=function(t,r,n,s,i,o){var u,h,a,c=o*8-i-1,d=(1<<c)-1,_=d>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=s?0:o-1,b=s?1:-1,A=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(h=isNaN(r)?1:0,u=d):(u=Math.floor(Math.log(r)/Math.LN2),r*(a=Math.pow(2,-u))<1&&(u--,a*=2),u+_>=1?r+=m/a:r+=m*Math.pow(2,1-_),r*a>=2&&(u++,a/=2),u+_>=d?(h=0,u=d):u+_>=1?(h=(r*a-1)*Math.pow(2,i),u=u+_):(h=r*Math.pow(2,_-1)*Math.pow(2,i),u=0));i>=8;t[n+S]=h&255,S+=b,h/=256,i-=8);for(u=u<<i|h,c+=i;c>0;t[n+S]=u&255,S+=b,u/=256,c-=8);t[n+S-b]|=A*128},Hr={read:Nv,write:Rv},ds=_v(function(e,t){var r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=I,t.INSPECT_MAX_BYTES=50;var n=2147483647;t.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var y=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(y,f),y.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function i(y){if(y>n)throw new RangeError('The value "'+y+'" is invalid for option "size"');var f=new Uint8Array(y);return Object.setPrototypeOf(f,o.prototype),f}function o(y,f,l){if(typeof y=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return c(y)}return u(y,f,l)}o.poolSize=8192;function u(y,f,l){if(typeof y=="string")return d(y,f);if(ArrayBuffer.isView(y))return m(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(y));if(it(y,ArrayBuffer)||y&&it(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(it(y,SharedArrayBuffer)||y&&it(y.buffer,SharedArrayBuffer)))return S(y,f,l);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var g=y.valueOf&&y.valueOf();if(g!=null&&g!==y)return o.from(g,f,l);var v=b(y);if(v)return v;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return o.from(y[Symbol.toPrimitive]("string"),f,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(y))}o.from=function(y,f,l){return u(y,f,l)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function h(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function a(y,f,l){return h(y),y<=0?i(y):f!==void 0?typeof l=="string"?i(y).fill(f,l):i(y).fill(f):i(y)}o.alloc=function(y,f,l){return a(y,f,l)};function c(y){return h(y),i(y<0?0:A(y)|0)}o.allocUnsafe=function(y){return c(y)},o.allocUnsafeSlow=function(y){return c(y)};function d(y,f){if((typeof f!="string"||f==="")&&(f="utf8"),!o.isEncoding(f))throw new TypeError("Unknown encoding: "+f);var l=E(y,f)|0,g=i(l),v=g.write(y,f);return v!==l&&(g=g.slice(0,v)),g}function _(y){for(var f=y.length<0?0:A(y.length)|0,l=i(f),g=0;g<f;g+=1)l[g]=y[g]&255;return l}function m(y){if(it(y,Uint8Array)){var f=new Uint8Array(y);return S(f.buffer,f.byteOffset,f.byteLength)}return _(y)}function S(y,f,l){if(f<0||y.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<f+(l||0))throw new RangeError('"length" is outside of buffer bounds');var g;return f===void 0&&l===void 0?g=new Uint8Array(y):l===void 0?g=new Uint8Array(y,f):g=new Uint8Array(y,f,l),Object.setPrototypeOf(g,o.prototype),g}function b(y){if(o.isBuffer(y)){var f=A(y.length)|0,l=i(f);return l.length===0||y.copy(l,0,0,f),l}if(y.length!==void 0)return typeof y.length!="number"||gn(y.length)?i(0):_(y);if(y.type==="Buffer"&&Array.isArray(y.data))return _(y.data)}function A(y){if(y>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return y|0}function I(y){return+y!=y&&(y=0),o.alloc(+y)}o.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==o.prototype},o.compare=function(f,l){if(it(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),it(l,Uint8Array)&&(l=o.from(l,l.offset,l.byteLength)),!o.isBuffer(f)||!o.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===l)return 0;for(var g=f.length,v=l.length,N=0,R=Math.min(g,v);N<R;++N)if(f[N]!==l[N]){g=f[N],v=l[N];break}return g<v?-1:v<g?1:0},o.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(f,l){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return o.alloc(0);var g;if(l===void 0)for(l=0,g=0;g<f.length;++g)l+=f[g].length;var v=o.allocUnsafe(l),N=0;for(g=0;g<f.length;++g){var R=f[g];if(it(R,Uint8Array))N+R.length>v.length?o.from(R).copy(v,N):Uint8Array.prototype.set.call(v,R,N);else if(o.isBuffer(R))R.copy(v,N);else throw new TypeError('"list" argument must be an Array of Buffers');N+=R.length}return v};function E(y,f){if(o.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||it(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(y));var l=y.length,g=arguments.length>2&&arguments[2]===!0;if(!g&&l===0)return 0;for(var v=!1;;)switch(f){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return yn(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l*2;case"hex":return l>>>1;case"base64":return ii(y).length;default:if(v)return g?-1:yn(y).length;f=(""+f).toLowerCase(),v=!0}}o.byteLength=E;function O(y,f,l){var g=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((l===void 0||l>this.length)&&(l=this.length),l<=0)||(l>>>=0,f>>>=0,l<=f))return"";for(y||(y="utf8");;)switch(y){case"hex":return $e(this,f,l);case"utf8":case"utf-8":return ne(this,f,l);case"ascii":return At(this,f,l);case"latin1":case"binary":return fe(this,f,l);case"base64":return ve(this,f,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,f,l);default:if(g)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),g=!0}}o.prototype._isBuffer=!0;function T(y,f,l){var g=y[f];y[f]=y[l],y[l]=g}o.prototype.swap16=function(){var f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<f;l+=2)T(this,l,l+1);return this},o.prototype.swap32=function(){var f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<f;l+=4)T(this,l,l+3),T(this,l+1,l+2);return this},o.prototype.swap64=function(){var f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<f;l+=8)T(this,l,l+7),T(this,l+1,l+6),T(this,l+2,l+5),T(this,l+3,l+4);return this},o.prototype.toString=function(){var f=this.length;return f===0?"":arguments.length===0?ne(this,0,f):O.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(f){if(!o.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:o.compare(this,f)===0},o.prototype.inspect=function(){var f="",l=t.INSPECT_MAX_BYTES;return f=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(f+=" ... "),"<Buffer "+f+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(f,l,g,v,N){if(it(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),!o.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(f));if(l===void 0&&(l=0),g===void 0&&(g=f?f.length:0),v===void 0&&(v=0),N===void 0&&(N=this.length),l<0||g>f.length||v<0||N>this.length)throw new RangeError("out of range index");if(v>=N&&l>=g)return 0;if(v>=N)return-1;if(l>=g)return 1;if(l>>>=0,g>>>=0,v>>>=0,N>>>=0,this===f)return 0;for(var R=N-v,V=g-l,se=Math.min(R,V),ee=this.slice(v,N),Ae=f.slice(l,g),ge=0;ge<se;++ge)if(ee[ge]!==Ae[ge]){R=ee[ge],V=Ae[ge];break}return R<V?-1:V<R?1:0};function M(y,f,l,g,v){if(y.length===0)return-1;if(typeof l=="string"?(g=l,l=0):l>2147483647?l=2147483647:l<-2147483648&&(l=-2147483648),l=+l,gn(l)&&(l=v?0:y.length-1),l<0&&(l=y.length+l),l>=y.length){if(v)return-1;l=y.length-1}else if(l<0)if(v)l=0;else return-1;if(typeof f=="string"&&(f=o.from(f,g)),o.isBuffer(f))return f.length===0?-1:P(y,f,l,g,v);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(y,f,l):Uint8Array.prototype.lastIndexOf.call(y,f,l):P(y,[f],l,g,v);throw new TypeError("val must be string, number or Buffer")}function P(y,f,l,g,v){var N=1,R=y.length,V=f.length;if(g!==void 0&&(g=String(g).toLowerCase(),g==="ucs2"||g==="ucs-2"||g==="utf16le"||g==="utf-16le")){if(y.length<2||f.length<2)return-1;N=2,R/=2,V/=2,l/=2}function se(_n,mn){return N===1?_n[mn]:_n.readUInt16BE(mn*N)}var ee;if(v){var Ae=-1;for(ee=l;ee<R;ee++)if(se(y,ee)===se(f,Ae===-1?0:ee-Ae)){if(Ae===-1&&(Ae=ee),ee-Ae+1===V)return Ae*N}else Ae!==-1&&(ee-=ee-Ae),Ae=-1}else for(l+V>R&&(l=R-V),ee=l;ee>=0;ee--){for(var ge=!0,hr=0;hr<V;hr++)if(se(y,ee+hr)!==se(f,hr)){ge=!1;break}if(ge)return ee}return-1}o.prototype.includes=function(f,l,g){return this.indexOf(f,l,g)!==-1},o.prototype.indexOf=function(f,l,g){return M(this,f,l,g,!0)},o.prototype.lastIndexOf=function(f,l,g){return M(this,f,l,g,!1)};function B(y,f,l,g){l=Number(l)||0;var v=y.length-l;g?(g=Number(g),g>v&&(g=v)):g=v;var N=f.length;g>N/2&&(g=N/2);for(var R=0;R<g;++R){var V=parseInt(f.substr(R*2,2),16);if(gn(V))return R;y[l+R]=V}return R}function G(y,f,l,g){return lr(yn(f,y.length-l),y,l,g)}function z(y,f,l,g){return lr(Os(f),y,l,g)}function Se(y,f,l,g){return lr(ii(f),y,l,g)}function ye(y,f,l,g){return lr(xs(f,y.length-l),y,l,g)}o.prototype.write=function(f,l,g,v){if(l===void 0)v="utf8",g=this.length,l=0;else if(g===void 0&&typeof l=="string")v=l,g=this.length,l=0;else if(isFinite(l))l=l>>>0,isFinite(g)?(g=g>>>0,v===void 0&&(v="utf8")):(v=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var N=this.length-l;if((g===void 0||g>N)&&(g=N),f.length>0&&(g<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");v||(v="utf8");for(var R=!1;;)switch(v){case"hex":return B(this,f,l,g);case"utf8":case"utf-8":return G(this,f,l,g);case"ascii":case"latin1":case"binary":return z(this,f,l,g);case"base64":return Se(this,f,l,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye(this,f,l,g);default:if(R)throw new TypeError("Unknown encoding: "+v);v=(""+v).toLowerCase(),R=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ve(y,f,l){return f===0&&l===y.length?vo.fromByteArray(y):vo.fromByteArray(y.slice(f,l))}function ne(y,f,l){l=Math.min(y.length,l);for(var g=[],v=f;v<l;){var N=y[v],R=null,V=N>239?4:N>223?3:N>191?2:1;if(v+V<=l){var se,ee,Ae,ge;switch(V){case 1:N<128&&(R=N);break;case 2:se=y[v+1],(se&192)===128&&(ge=(N&31)<<6|se&63,ge>127&&(R=ge));break;case 3:se=y[v+1],ee=y[v+2],(se&192)===128&&(ee&192)===128&&(ge=(N&15)<<12|(se&63)<<6|ee&63,ge>2047&&(ge<55296||ge>57343)&&(R=ge));break;case 4:se=y[v+1],ee=y[v+2],Ae=y[v+3],(se&192)===128&&(ee&192)===128&&(Ae&192)===128&&(ge=(N&15)<<18|(se&63)<<12|(ee&63)<<6|Ae&63,ge>65535&&ge<1114112&&(R=ge))}}R===null?(R=65533,V=1):R>65535&&(R-=65536,g.push(R>>>10&1023|55296),R=56320|R&1023),g.push(R),v+=V}return Be(g)}var Me=4096;function Be(y){var f=y.length;if(f<=Me)return String.fromCharCode.apply(String,y);for(var l="",g=0;g<f;)l+=String.fromCharCode.apply(String,y.slice(g,g+=Me));return l}function At(y,f,l){var g="";l=Math.min(y.length,l);for(var v=f;v<l;++v)g+=String.fromCharCode(y[v]&127);return g}function fe(y,f,l){var g="";l=Math.min(y.length,l);for(var v=f;v<l;++v)g+=String.fromCharCode(y[v]);return g}function $e(y,f,l){var g=y.length;(!f||f<0)&&(f=0),(!l||l<0||l>g)&&(l=g);for(var v="",N=f;N<l;++N)v+=si[y[N]];return v}function Q(y,f,l){for(var g=y.slice(f,l),v="",N=0;N<g.length-1;N+=2)v+=String.fromCharCode(g[N]+g[N+1]*256);return v}o.prototype.slice=function(f,l){var g=this.length;f=~~f,l=l===void 0?g:~~l,f<0?(f+=g,f<0&&(f=0)):f>g&&(f=g),l<0?(l+=g,l<0&&(l=0)):l>g&&(l=g),l<f&&(l=f);var v=this.subarray(f,l);return Object.setPrototypeOf(v,o.prototype),v};function U(y,f,l){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+f>l)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(f,l,g){f=f>>>0,l=l>>>0,g||U(f,l,this.length);for(var v=this[f],N=1,R=0;++R<l&&(N*=256);)v+=this[f+R]*N;return v},o.prototype.readUintBE=o.prototype.readUIntBE=function(f,l,g){f=f>>>0,l=l>>>0,g||U(f,l,this.length);for(var v=this[f+--l],N=1;l>0&&(N*=256);)v+=this[f+--l]*N;return v},o.prototype.readUint8=o.prototype.readUInt8=function(f,l){return f=f>>>0,l||U(f,1,this.length),this[f]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(f,l){return f=f>>>0,l||U(f,2,this.length),this[f]|this[f+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(f,l){return f=f>>>0,l||U(f,2,this.length),this[f]<<8|this[f+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(f,l){return f=f>>>0,l||U(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(f,l){return f=f>>>0,l||U(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},o.prototype.readIntLE=function(f,l,g){f=f>>>0,l=l>>>0,g||U(f,l,this.length);for(var v=this[f],N=1,R=0;++R<l&&(N*=256);)v+=this[f+R]*N;return N*=128,v>=N&&(v-=Math.pow(2,8*l)),v},o.prototype.readIntBE=function(f,l,g){f=f>>>0,l=l>>>0,g||U(f,l,this.length);for(var v=l,N=1,R=this[f+--v];v>0&&(N*=256);)R+=this[f+--v]*N;return N*=128,R>=N&&(R-=Math.pow(2,8*l)),R},o.prototype.readInt8=function(f,l){return f=f>>>0,l||U(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},o.prototype.readInt16LE=function(f,l){f=f>>>0,l||U(f,2,this.length);var g=this[f]|this[f+1]<<8;return g&32768?g|4294901760:g},o.prototype.readInt16BE=function(f,l){f=f>>>0,l||U(f,2,this.length);var g=this[f+1]|this[f]<<8;return g&32768?g|4294901760:g},o.prototype.readInt32LE=function(f,l){return f=f>>>0,l||U(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},o.prototype.readInt32BE=function(f,l){return f=f>>>0,l||U(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},o.prototype.readFloatLE=function(f,l){return f=f>>>0,l||U(f,4,this.length),Hr.read(this,f,!0,23,4)},o.prototype.readFloatBE=function(f,l){return f=f>>>0,l||U(f,4,this.length),Hr.read(this,f,!1,23,4)},o.prototype.readDoubleLE=function(f,l){return f=f>>>0,l||U(f,8,this.length),Hr.read(this,f,!0,52,8)},o.prototype.readDoubleBE=function(f,l){return f=f>>>0,l||U(f,8,this.length),Hr.read(this,f,!1,52,8)};function Le(y,f,l,g,v,N){if(!o.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>v||f<N)throw new RangeError('"value" argument is out of bounds');if(l+g>y.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(f,l,g,v){if(f=+f,l=l>>>0,g=g>>>0,!v){var N=Math.pow(2,8*g)-1;Le(this,f,l,g,N,0)}var R=1,V=0;for(this[l]=f&255;++V<g&&(R*=256);)this[l+V]=f/R&255;return l+g},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(f,l,g,v){if(f=+f,l=l>>>0,g=g>>>0,!v){var N=Math.pow(2,8*g)-1;Le(this,f,l,g,N,0)}var R=g-1,V=1;for(this[l+R]=f&255;--R>=0&&(V*=256);)this[l+R]=f/V&255;return l+g},o.prototype.writeUint8=o.prototype.writeUInt8=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,1,255,0),this[l]=f&255,l+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,65535,0),this[l]=f&255,this[l+1]=f>>>8,l+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,65535,0),this[l]=f>>>8,this[l+1]=f&255,l+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,4294967295,0),this[l+3]=f>>>24,this[l+2]=f>>>16,this[l+1]=f>>>8,this[l]=f&255,l+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,4294967295,0),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4},o.prototype.writeIntLE=function(f,l,g,v){if(f=+f,l=l>>>0,!v){var N=Math.pow(2,8*g-1);Le(this,f,l,g,N-1,-N)}var R=0,V=1,se=0;for(this[l]=f&255;++R<g&&(V*=256);)f<0&&se===0&&this[l+R-1]!==0&&(se=1),this[l+R]=(f/V>>0)-se&255;return l+g},o.prototype.writeIntBE=function(f,l,g,v){if(f=+f,l=l>>>0,!v){var N=Math.pow(2,8*g-1);Le(this,f,l,g,N-1,-N)}var R=g-1,V=1,se=0;for(this[l+R]=f&255;--R>=0&&(V*=256);)f<0&&se===0&&this[l+R+1]!==0&&(se=1),this[l+R]=(f/V>>0)-se&255;return l+g},o.prototype.writeInt8=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,1,127,-128),f<0&&(f=255+f+1),this[l]=f&255,l+1},o.prototype.writeInt16LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,32767,-32768),this[l]=f&255,this[l+1]=f>>>8,l+2},o.prototype.writeInt16BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,32767,-32768),this[l]=f>>>8,this[l+1]=f&255,l+2},o.prototype.writeInt32LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,2147483647,-2147483648),this[l]=f&255,this[l+1]=f>>>8,this[l+2]=f>>>16,this[l+3]=f>>>24,l+4},o.prototype.writeInt32BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4};function ri(y,f,l,g,v,N){if(l+g>y.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("Index out of range")}function nt(y,f,l,g,v){return f=+f,l=l>>>0,v||ri(y,f,l,4),Hr.write(y,f,l,g,23,4),l+4}o.prototype.writeFloatLE=function(f,l,g){return nt(this,f,l,!0,g)},o.prototype.writeFloatBE=function(f,l,g){return nt(this,f,l,!1,g)};function pn(y,f,l,g,v){return f=+f,l=l>>>0,v||ri(y,f,l,8),Hr.write(y,f,l,g,52,8),l+8}o.prototype.writeDoubleLE=function(f,l,g){return pn(this,f,l,!0,g)},o.prototype.writeDoubleBE=function(f,l,g){return pn(this,f,l,!1,g)},o.prototype.copy=function(f,l,g,v){if(!o.isBuffer(f))throw new TypeError("argument should be a Buffer");if(g||(g=0),!v&&v!==0&&(v=this.length),l>=f.length&&(l=f.length),l||(l=0),v>0&&v<g&&(v=g),v===g||f.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("sourceEnd out of bounds");v>this.length&&(v=this.length),f.length-l<v-g&&(v=f.length-l+g);var N=v-g;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(l,g,v):Uint8Array.prototype.set.call(f,this.subarray(g,v),l),N},o.prototype.fill=function(f,l,g,v){if(typeof f=="string"){if(typeof l=="string"?(v=l,l=0,g=this.length):typeof g=="string"&&(v=g,g=this.length),v!==void 0&&typeof v!="string")throw new TypeError("encoding must be a string");if(typeof v=="string"&&!o.isEncoding(v))throw new TypeError("Unknown encoding: "+v);if(f.length===1){var N=f.charCodeAt(0);(v==="utf8"&&N<128||v==="latin1")&&(f=N)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(l<0||this.length<l||this.length<g)throw new RangeError("Out of range index");if(g<=l)return this;l=l>>>0,g=g===void 0?this.length:g>>>0,f||(f=0);var R;if(typeof f=="number")for(R=l;R<g;++R)this[R]=f;else{var V=o.isBuffer(f)?f:o.from(f,v),se=V.length;if(se===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(R=0;R<g-l;++R)this[R+l]=V[R%se]}return this};var ni=/[^+/0-9A-Za-z-_]/g;function Ts(y){if(y=y.split("=")[0],y=y.trim().replace(ni,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function yn(y,f){f=f||1/0;for(var l,g=y.length,v=null,N=[],R=0;R<g;++R){if(l=y.charCodeAt(R),l>55295&&l<57344){if(!v){if(l>56319){(f-=3)>-1&&N.push(239,191,189);continue}else if(R+1===g){(f-=3)>-1&&N.push(239,191,189);continue}v=l;continue}if(l<56320){(f-=3)>-1&&N.push(239,191,189),v=l;continue}l=(v-55296<<10|l-56320)+65536}else v&&(f-=3)>-1&&N.push(239,191,189);if(v=null,l<128){if((f-=1)<0)break;N.push(l)}else if(l<2048){if((f-=2)<0)break;N.push(l>>6|192,l&63|128)}else if(l<65536){if((f-=3)<0)break;N.push(l>>12|224,l>>6&63|128,l&63|128)}else if(l<1114112){if((f-=4)<0)break;N.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else throw new Error("Invalid code point")}return N}function Os(y){for(var f=[],l=0;l<y.length;++l)f.push(y.charCodeAt(l)&255);return f}function xs(y,f){for(var l,g,v,N=[],R=0;R<y.length&&!((f-=2)<0);++R)l=y.charCodeAt(R),g=l>>8,v=l%256,N.push(v),N.push(g);return N}function ii(y){return vo.toByteArray(Ts(y))}function lr(y,f,l,g){for(var v=0;v<g&&!(v+l>=f.length||v>=y.length);++v)f[v+l]=y[v];return v}function it(y,f){return y instanceof f||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===f.name}function gn(y){return y!==y}var si=function(){for(var y="0123456789abcdef",f=new Array(256),l=0;l<16;++l)for(var g=l*16,v=0;v<16;++v)f[g+v]=y[l]+y[v];return f}()}),ie=ds.Buffer;ds.SlowBuffer;ds.INSPECT_MAX_BYTES;ds.kMaxLength;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ko=function(t,r){return Ko=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},Ko(t,r)};function ps(e,t){Ko(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Or=function(e){ps(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),t}(Error),we=function(e){ps(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),t}(TypeError);function Si(e){return e&&e.Math==Math&&e}function Hf(){return Si(typeof globalThis=="object"&&globalThis)||Si(typeof window=="object"&&window)||Si(typeof self=="object"&&self)||Si(typeof global=="object"&&global)||Function("return this")()}function Dv(){var e=Hf();return typeof e.navigator=="object"&&e.navigator.product==="ReactNative"}var Cv=function(t){var r=Dv()?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=ie.alloc(t),s=0;s<t;++s)n[s]=Math.floor(Math.random()*256);return n},Pv=function(){{if(typeof window<"u"){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues)return function(t){return e.getRandomValues(ie.alloc(t))}}return typeof global<"u"&&global.crypto&&global.crypto.getRandomValues?function(t){return global.crypto.getRandomValues(ie.alloc(t))}:Cv}},qf=Pv();function kv(e){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e))}function Ta(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function Mv(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Fv(e){return ti(e)&&Object.prototype.toString.call(e)==="[object Date]"}function ti(e){return typeof e=="object"&&e!==null}function ys(e,t){var r=!1;function n(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];return r||(console.warn(t),r=!0),e.apply(this,s)}return n}function Gi(e){if(ArrayBuffer.isView(e))return ie.from(e.buffer,e.byteOffset,e.byteLength);if(kv(e))return ie.from(e);throw new we("Must use either Buffer or TypedArray")}var Lv=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,Gf=function(e){return typeof e=="string"&&Lv.test(e)},Vo=function(e){if(!Gf(e))throw new we('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var t=e.replace(/-/g,"");return ie.from(t,"hex")},Bu=function(e,t){return t===void 0&&(t=!0),t?e.toString("hex",0,4)+"-"+e.toString("hex",4,6)+"-"+e.toString("hex",6,8)+"-"+e.toString("hex",8,10)+"-"+e.toString("hex",10,16):e.toString("hex")},Uv=Math.pow(2,53),Bv=-Math.pow(2,53),Kf=4,xr=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(t!=null&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!(t instanceof ArrayBuffer)&&!Array.isArray(t))throw new we("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=r??e.BSON_BINARY_SUBTYPE_DEFAULT,t==null?(this.buffer=ie.alloc(e.BUFFER_SIZE),this.position=0):(typeof t=="string"?this.buffer=ie.from(t,"binary"):Array.isArray(t)?this.buffer=ie.from(t):this.buffer=Gi(t),this.position=this.buffer.byteLength)}return e.prototype.put=function(t){if(typeof t=="string"&&t.length!==1)throw new we("only accepts single character String");if(typeof t!="number"&&t.length!==1)throw new we("only accepts single character Uint8Array or Array");var r;if(typeof t=="string"?r=t.charCodeAt(0):typeof t=="number"?r=t:r=t[0],r<0||r>255)throw new we("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=ie.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},e.prototype.write=function(t,r){if(r=typeof r=="number"?r:this.position,this.buffer.length<r+t.length){var n=ie.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(Gi(t),r),this.position=r+t.byteLength>this.position?r+t.length:this.position):typeof t=="string"&&(this.buffer.write(t,r,t.length,"binary"),this.position=r+t.length>this.position?r+t.length:this.position)},e.prototype.read=function(t,r){return r=r&&r>0?r:this.position,this.buffer.slice(t,t+r)},e.prototype.value=function(t){return t=!!t,t&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},e.prototype.length=function(){return this.position},e.prototype.toJSON=function(){return this.buffer.toString("base64")},e.prototype.toString=function(t){return this.buffer.toString(t)},e.prototype.toExtendedJSON=function(t){t=t||{};var r=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return t.legacy?{$binary:r,$type:n.length===1?"0"+n:n}:{$binary:{base64:r,subType:n.length===1?"0"+n:n}}},e.prototype.toUUID=function(){if(this.sub_type===e.SUBTYPE_UUID)return new $u(this.buffer.slice(0,this.position));throw new Or('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(e.SUBTYPE_UUID,'" is currently supported.'))},e.fromExtendedJSON=function(t,r){r=r||{};var n,s;if("$binary"in t?r.legacy&&typeof t.$binary=="string"&&"$type"in t?(s=t.$type?parseInt(t.$type,16):0,n=ie.from(t.$binary,"base64")):typeof t.$binary!="string"&&(s=t.$binary.subType?parseInt(t.$binary.subType,16):0,n=ie.from(t.$binary.base64,"base64")):"$uuid"in t&&(s=4,n=Vo(t.$uuid)),!n)throw new we("Unexpected Binary Extended JSON format ".concat(JSON.stringify(t)));return s===Kf?new $u(n):new e(n,s)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.value(!0);return'new Binary(Buffer.from("'.concat(t.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_ENCRYPTED=6,e.SUBTYPE_COLUMN=7,e.SUBTYPE_USER_DEFINED=128,e}();Object.defineProperty(xr.prototype,"_bsontype",{value:"Binary"});var wo=16,$u=function(e){ps(t,e);function t(r){var n=this,s,i;if(r==null)s=t.generate();else if(r instanceof t)s=ie.from(r.buffer),i=r.__id;else if(ArrayBuffer.isView(r)&&r.byteLength===wo)s=Gi(r);else if(typeof r=="string")s=Vo(r);else throw new we("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");return n=e.call(this,s,Kf)||this,n.__id=i,n}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer},set:function(r){this.buffer=r,t.cacheHexString&&(this.__id=Bu(r))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(r){if(r===void 0&&(r=!0),t.cacheHexString&&this.__id)return this.__id;var n=Bu(this.id,r);return t.cacheHexString&&(this.__id=n),n},t.prototype.toString=function(r){return r?this.id.toString(r):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(r){if(!r)return!1;if(r instanceof t)return r.id.equals(this.id);try{return new t(r).id.equals(this.id)}catch{return!1}},t.prototype.toBinary=function(){return new xr(this.id,xr.SUBTYPE_UUID)},t.generate=function(){var r=qf(wo);return r[6]=r[6]&15|64,r[8]=r[8]&63|128,ie.from(r)},t.isValid=function(r){return r?r instanceof t?!0:typeof r=="string"?Gf(r):Ta(r)?r.length!==wo?!1:(r[6]&240)===64&&(r[8]&128)===128:!1:!1},t.createFromHexString=function(r){var n=Vo(r);return new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},t}(xr),gs=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.code=t,this.scope=r}return e.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},e.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},e.fromExtendedJSON=function(t){return new e(t.$code,t.$scope)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toJSON();return'new Code("'.concat(String(t.code),'"').concat(t.scope?", ".concat(JSON.stringify(t.scope)):"",")")},e}();Object.defineProperty(gs.prototype,"_bsontype",{value:"Code"});function $v(e){return ti(e)&&e.$id!=null&&typeof e.$ref=="string"&&(e.$db==null||typeof e.$db=="string")}var qn=function(){function e(t,r,n,s){if(!(this instanceof e))return new e(t,r,n,s);var i=t.split(".");i.length===2&&(n=i.shift(),t=i.shift()),this.collection=t,this.oid=r,this.db=n,this.fields=s||{}}return Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(t.$db=this.db),t},e.prototype.toExtendedJSON=function(t){t=t||{};var r={$ref:this.collection,$id:this.oid};return t.legacy||(this.db&&(r.$db=this.db),r=Object.assign(r,this.fields)),r},e.fromExtendedJSON=function(t){var r=Object.assign({},t);return delete r.$ref,delete r.$id,delete r.$db,new e(t.$ref,t.$id,t.$db,r)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(t),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},e}();Object.defineProperty(qn.prototype,"_bsontype",{value:"DBRef"});var st=void 0;try{st=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var Wu=65536,Wv=1<<24,zr=Wu*Wu,Vf=zr*zr,ju=Vf/2,Yu={},Hu={},W=function(){function e(t,r,n){if(t===void 0&&(t=0),!(this instanceof e))return new e(t,r,n);typeof t=="bigint"?Object.assign(this,e.fromBigInt(t,!!r)):typeof t=="string"?Object.assign(this,e.fromString(t,!!r)):(this.low=t|0,this.high=r|0,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return e.fromBits=function(t,r,n){return new e(t,r,n)},e.fromInt=function(t,r){var n,s,i;return r?(t>>>=0,(i=0<=t&&t<256)&&(s=Hu[t],s)?s:(n=e.fromBits(t,(t|0)<0?-1:0,!0),i&&(Hu[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(s=Yu[t],s)?s:(n=e.fromBits(t,t<0?-1:0,!1),i&&(Yu[t]=n),n))},e.fromNumber=function(t,r){if(isNaN(t))return r?e.UZERO:e.ZERO;if(r){if(t<0)return e.UZERO;if(t>=Vf)return e.MAX_UNSIGNED_VALUE}else{if(t<=-ju)return e.MIN_VALUE;if(t+1>=ju)return e.MAX_VALUE}return t<0?e.fromNumber(-t,r).neg():e.fromBits(t%zr|0,t/zr|0,r)},e.fromBigInt=function(t,r){return e.fromString(t.toString(),r)},e.fromString=function(t,r,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e.ZERO;if(typeof r=="number"?(n=r,r=!1):r=!!r,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return e.fromString(t.substring(1),r,n).neg();for(var i=e.fromNumber(Math.pow(n,8)),o=e.ZERO,u=0;u<t.length;u+=8){var h=Math.min(8,t.length-u),a=parseInt(t.substring(u,u+h),n);if(h<8){var c=e.fromNumber(Math.pow(n,h));o=o.mul(c).add(e.fromNumber(a))}else o=o.mul(i),o=o.add(e.fromNumber(a))}return o.unsigned=r,o},e.fromBytes=function(t,r,n){return n?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.isLong=function(t){return ti(t)&&t.__isLong__===!0},e.fromValue=function(t,r){return typeof t=="number"?e.fromNumber(t,r):typeof t=="string"?e.fromString(t,r):e.fromBits(t.low,t.high,typeof r=="boolean"?r:t.unsigned)},e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var r=this.high>>>16,n=this.high&65535,s=this.low>>>16,i=this.low&65535,o=t.high>>>16,u=t.high&65535,h=t.low>>>16,a=t.low&65535,c=0,d=0,_=0,m=0;return m+=i+a,_+=m>>>16,m&=65535,_+=s+h,d+=_>>>16,_&=65535,d+=n+u,c+=d>>>16,d&=65535,c+=r+o,c&=65535,e.fromBits(_<<16|m,c<<16|d,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),n=t.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},e.prototype.comp=function(t){return this.compare(t)},e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw Error("division by zero");if(st){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?st.div_u:st.div_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,st.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var n,s,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return e.UZERO;if(t.gt(this.shru(1)))return e.UONE;i=e.UZERO}else{if(this.eq(e.MIN_VALUE)){if(t.eq(e.ONE)||t.eq(e.NEG_ONE))return e.MIN_VALUE;if(t.eq(e.MIN_VALUE))return e.ONE;var o=this.shr(1);return n=o.div(t).shl(1),n.eq(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(s=this.sub(t.mul(n)),i=n.add(s.div(t)),i)}else if(t.eq(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=e.ZERO}for(s=this;s.gte(t);){n=Math.max(1,Math.floor(s.toNumber()/t.toNumber()));for(var u=Math.ceil(Math.log(n)/Math.LN2),h=u<=48?1:Math.pow(2,u-48),a=e.fromNumber(n),c=a.mul(t);c.isNegative()||c.gt(s);)n-=h,a=e.fromNumber(n,this.unsigned),c=a.mul(t);a.isZero()&&(a=e.ONE),i=i.add(a),s=s.sub(c)}return i},e.prototype.div=function(t){return this.divide(t)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},e.prototype.eq=function(t){return this.equals(t)},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(e.MIN_VALUE)?64:this.neg().getNumBitsAbs();var t=this.high!==0?this.high:this.low,r;for(r=31;r>0&&!(t&1<<r);r--);return this.high!==0?r+33:r+1},e.prototype.greaterThan=function(t){return this.comp(t)>0},e.prototype.gt=function(t){return this.greaterThan(t)},e.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},e.prototype.gte=function(t){return this.greaterThanOrEqual(t)},e.prototype.ge=function(t){return this.greaterThanOrEqual(t)},e.prototype.isEven=function(){return(this.low&1)===0},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isOdd=function(){return(this.low&1)===1},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isZero=function(){return this.high===0&&this.low===0},e.prototype.lessThan=function(t){return this.comp(t)<0},e.prototype.lt=function(t){return this.lessThan(t)},e.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},e.prototype.lte=function(t){return this.lessThanOrEqual(t)},e.prototype.modulo=function(t){if(e.isLong(t)||(t=e.fromValue(t)),st){var r=(this.unsigned?st.rem_u:st.rem_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,st.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},e.prototype.mod=function(t){return this.modulo(t)},e.prototype.rem=function(t){return this.modulo(t)},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),st){var r=st.mul(this.low,this.high,t.low,t.high);return e.fromBits(r,st.get_high(),this.unsigned)}if(t.isZero())return e.ZERO;if(this.eq(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.eq(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(e.TWO_PWR_24)&&t.lt(e.TWO_PWR_24))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,u=t.high>>>16,h=t.high&65535,a=t.low>>>16,c=t.low&65535,d=0,_=0,m=0,S=0;return S+=o*c,m+=S>>>16,S&=65535,m+=i*c,_+=m>>>16,m&=65535,m+=o*a,_+=m>>>16,m&=65535,_+=s*c,d+=_>>>16,_&=65535,_+=i*a,d+=_>>>16,_&=65535,_+=o*h,d+=_>>>16,_&=65535,d+=n*c+s*a+i*h+o*u,d&=65535,e.fromBits(m<<16|S,d<<16|_,this.unsigned)},e.prototype.mul=function(t){return this.multiply(t)},e.prototype.negate=function(){return!this.unsigned&&this.eq(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=function(){return this.negate()},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.notEquals=function(t){return!this.equals(t)},e.prototype.neq=function(t){return this.notEquals(t)},e.prototype.ne=function(t){return this.notEquals(t)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=function(t){return this.shiftLeft(t)},e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=function(t){return this.shiftRight(t)},e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),t&=63,t===0)return this;var r=this.high;if(t<32){var n=this.low;return e.fromBits(n>>>t|r<<32-t,r>>>t,this.unsigned)}else return t===32?e.fromBits(r,0,this.unsigned):e.fromBits(r>>>t-32,0,this.unsigned)},e.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},e.prototype.shru=function(t){return this.shiftRightUnsigned(t)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.neg())},e.prototype.sub=function(t){return this.subtract(t)},e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*zr+(this.low>>>0):this.high*zr+(this.low>>>0)},e.prototype.toBigInt=function(){return BigInt(this.toString())},e.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},e.prototype.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},e.prototype.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]},e.prototype.toSigned=function(){return this.unsigned?e.fromBits(this.low,this.high,!1):this},e.prototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(e.MIN_VALUE)){var r=e.fromNumber(t),n=this.div(r),s=n.mul(r).sub(this);return n.toString(t)+s.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var i=e.fromNumber(Math.pow(t,6),this.unsigned),o=this,u="";;){var h=o.div(i),a=o.sub(h.mul(i)).toInt()>>>0,c=a.toString(t);if(o=h,o.isZero())return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}},e.prototype.toUnsigned=function(){return this.unsigned?this:e.fromBits(this.low,this.high,!0)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.eqz=function(){return this.isZero()},e.prototype.le=function(t){return this.lessThanOrEqual(t)},e.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var n=e.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},e.TWO_PWR_24=e.fromInt(Wv),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e}();Object.defineProperty(W.prototype,"__isLong__",{value:!0});Object.defineProperty(W.prototype,"_bsontype",{value:"Long"});var jv=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Yv=/^(\+|-)?(Infinity|inf)$/i,Hv=/^(\+|-)?NaN$/i,Pn=6111,Eo=-6176,qu=6176,qv=34,bo=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Gu=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Ku=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Gv=/^([-+])?(\d+)?$/,Kv=31,Vu=16383,Vv=30,Jv=31;function Ju(e){return!isNaN(parseInt(e,10))}function zv(e){var t=W.fromNumber(1e9),r=W.fromNumber(0);if(!e.parts[0]&&!e.parts[1]&&!e.parts[2]&&!e.parts[3])return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=r.shiftLeft(32),r=r.add(new W(e.parts[n],0)),e.parts[n]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function Zv(e,t){if(!e&&!t)return{high:W.fromNumber(0),low:W.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new W(e.getLowBits(),0),s=t.shiftRightUnsigned(32),i=new W(t.getLowBits(),0),o=r.multiply(s),u=r.multiply(i),h=n.multiply(s),a=n.multiply(i);return o=o.add(u.shiftRightUnsigned(32)),u=new W(u.getLowBits(),0).add(h).add(a.shiftRightUnsigned(32)),o=o.add(u.shiftRightUnsigned(32)),a=u.shiftLeft(32).add(new W(a.getLowBits(),0)),{high:o,low:a}}function Xv(e,t){var r=e.high>>>0,n=t.high>>>0;if(r<n)return!0;if(r===n){var s=e.low>>>0,i=t.low>>>0;if(s<i)return!0}return!1}function qr(e,t){throw new we('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var Oa=function(){function e(t){if(!(this instanceof e))return new e(t);if(typeof t=="string")this.bytes=e.fromString(t).bytes;else if(Ta(t)){if(t.byteLength!==16)throw new we("Decimal128 must take a Buffer of 16 bytes");this.bytes=t}else throw new we("Decimal128 must take a Buffer or string")}return e.fromString=function(t){var r=!1,n=!1,s=!1,i=0,o=0,u=0,h=0,a=0,c=[0],d=0,_=0,m=0,S=0,b=0,A=0,I=new W(0,0),E=new W(0,0),O=0,T=0;if(t.length>=7e3)throw new we(""+t+" not a valid Decimal128 string");var M=t.match(jv),P=t.match(Yv),B=t.match(Hv);if(!M&&!P&&!B||t.length===0)throw new we(""+t+" not a valid Decimal128 string");if(M){var G=M[2],z=M[4],Se=M[5],ye=M[6];z&&ye===void 0&&qr(t,"missing exponent power"),z&&G===void 0&&qr(t,"missing exponent base"),z===void 0&&(Se||ye)&&qr(t,"missing e before exponent")}if((t[T]==="+"||t[T]==="-")&&(r=t[T++]==="-"),!Ju(t[T])&&t[T]!=="."){if(t[T]==="i"||t[T]==="I")return new e(ie.from(r?Gu:Ku));if(t[T]==="N")return new e(ie.from(bo))}for(;Ju(t[T])||t[T]===".";){if(t[T]==="."){n&&qr(t,"contains multiple periods"),n=!0,T=T+1;continue}d<34&&(t[T]!=="0"||s)&&(s||(a=o),s=!0,c[_++]=parseInt(t[T],10),d=d+1),s&&(u=u+1),n&&(h=h+1),o=o+1,T=T+1}if(n&&!o)throw new we(""+t+" not a valid Decimal128 string");if(t[T]==="e"||t[T]==="E"){var ve=t.substr(++T).match(Gv);if(!ve||!ve[2])return new e(ie.from(bo));b=parseInt(ve[0],10),T=T+ve[0].length}if(t[T])return new e(ie.from(bo));if(m=0,!d)m=0,S=0,c[0]=0,u=1,d=1,i=0;else if(S=d-1,i=u,i!==1)for(;c[a+i-1]===0;)i=i-1;for(b<=h&&h-b>16384?b=Eo:b=b-h;b>Pn;){if(S=S+1,S-m>qv){var ne=c.join("");if(ne.match(/^0+$/)){b=Pn;break}qr(t,"overflow")}b=b-1}for(;b<Eo||d<u;){if(S===0&&i<d){b=Eo,i=0;break}if(d<u?u=u-1:S=S-1,b<Pn)b=b+1;else{var ne=c.join("");if(ne.match(/^0+$/)){b=Pn;break}qr(t,"overflow")}}if(S-m+1<i){var Me=o;n&&(a=a+1,Me=Me+1),r&&(a=a+1,Me=Me+1);var Be=parseInt(t[a+S+1],10),At=0;if(Be>=5&&(At=1,Be===5)){for(At=c[S]%2===1?1:0,A=a+S+2;A<Me;A++)if(parseInt(t[A],10)){At=1;break}}if(At){for(var fe=S;fe>=0;fe--)if(++c[fe]>9&&(c[fe]=0,fe===0))if(b<Pn)b=b+1,c[fe]=1;else return new e(ie.from(r?Gu:Ku))}}if(I=W.fromNumber(0),E=W.fromNumber(0),i===0)I=W.fromNumber(0),E=W.fromNumber(0);else if(S-m<17){var fe=m;for(E=W.fromNumber(c[fe++]),I=new W(0,0);fe<=S;fe++)E=E.multiply(W.fromNumber(10)),E=E.add(W.fromNumber(c[fe]))}else{var fe=m;for(I=W.fromNumber(c[fe++]);fe<=S-17;fe++)I=I.multiply(W.fromNumber(10)),I=I.add(W.fromNumber(c[fe]));for(E=W.fromNumber(c[fe++]);fe<=S;fe++)E=E.multiply(W.fromNumber(10)),E=E.add(W.fromNumber(c[fe]))}var $e=Zv(I,W.fromString("100000000000000000"));$e.low=$e.low.add(E),Xv($e.low,E)&&($e.high=$e.high.add(W.fromNumber(1))),O=b+qu;var Q={low:W.fromNumber(0),high:W.fromNumber(0)};$e.high.shiftRightUnsigned(49).and(W.fromNumber(1)).equals(W.fromNumber(1))?(Q.high=Q.high.or(W.fromNumber(3).shiftLeft(61)),Q.high=Q.high.or(W.fromNumber(O).and(W.fromNumber(16383).shiftLeft(47))),Q.high=Q.high.or($e.high.and(W.fromNumber(0x7fffffffffff)))):(Q.high=Q.high.or(W.fromNumber(O&16383).shiftLeft(49)),Q.high=Q.high.or($e.high.and(W.fromNumber(562949953421311)))),Q.low=$e.low,r&&(Q.high=Q.high.or(W.fromString("9223372036854775808")));var U=ie.alloc(16);return T=0,U[T++]=Q.low.low&255,U[T++]=Q.low.low>>8&255,U[T++]=Q.low.low>>16&255,U[T++]=Q.low.low>>24&255,U[T++]=Q.low.high&255,U[T++]=Q.low.high>>8&255,U[T++]=Q.low.high>>16&255,U[T++]=Q.low.high>>24&255,U[T++]=Q.high.low&255,U[T++]=Q.high.low>>8&255,U[T++]=Q.high.low>>16&255,U[T++]=Q.high.low>>24&255,U[T++]=Q.high.high&255,U[T++]=Q.high.high>>8&255,U[T++]=Q.high.high>>16&255,U[T++]=Q.high.high>>24&255,new e(U)},e.prototype.toString=function(){for(var t,r=0,n=new Array(36),s=0;s<n.length;s++)n[s]=0;var i=0,o=!1,u,h={parts:[0,0,0,0]},a,c,d=[];i=0;var _=this.bytes,m=_[i++]|_[i++]<<8|_[i++]<<16|_[i++]<<24,S=_[i++]|_[i++]<<8|_[i++]<<16|_[i++]<<24,b=_[i++]|_[i++]<<8|_[i++]<<16|_[i++]<<24,A=_[i++]|_[i++]<<8|_[i++]<<16|_[i++]<<24;i=0;var I={low:new W(m,S),high:new W(b,A)};I.high.lessThan(W.ZERO)&&d.push("-");var E=A>>26&Kv;if(E>>3===3){if(E===Vv)return d.join("")+"Infinity";if(E===Jv)return"NaN";t=A>>15&Vu,u=8+(A>>14&1)}else u=A>>14&7,t=A>>17&Vu;var O=t-qu;if(h.parts[0]=(A&16383)+((u&15)<<14),h.parts[1]=b,h.parts[2]=S,h.parts[3]=m,h.parts[0]===0&&h.parts[1]===0&&h.parts[2]===0&&h.parts[3]===0)o=!0;else for(c=3;c>=0;c--){var T=0,M=zv(h);if(h=M.quotient,T=M.rem.low,!!T)for(a=8;a>=0;a--)n[c*9+a]=T%10,T=Math.floor(T/10)}if(o)r=1,n[i]=0;else for(r=36;!n[i];)r=r-1,i=i+1;var P=r-1+O;if(P>=34||P<=-7||O>0){if(r>34)return d.push("".concat(0)),O>0?d.push("E+".concat(O)):O<0&&d.push("E".concat(O)),d.join("");d.push("".concat(n[i++])),r=r-1,r&&d.push(".");for(var s=0;s<r;s++)d.push("".concat(n[i++]));d.push("E"),P>0?d.push("+".concat(P)):d.push("".concat(P))}else if(O>=0)for(var s=0;s<r;s++)d.push("".concat(n[i++]));else{var B=r+O;if(B>0)for(var s=0;s<B;s++)d.push("".concat(n[i++]));else d.push("0");for(d.push(".");B++<0;)d.push("0");for(var s=0;s<r-Math.max(B-1,0);s++)d.push("".concat(n[i++]))}return d.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},e}();Object.defineProperty(Oa.prototype,"_bsontype",{value:"Decimal128"});var _s=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toJSON=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},e.fromExtendedJSON=function(t,r){var n=parseFloat(t.$numberDouble);return r&&r.relaxed?n:new e(n)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toExtendedJSON();return"new Double(".concat(t.$numberDouble,")")},e}();Object.defineProperty(_s.prototype,"_bsontype",{value:"Double"});var ms=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t|0}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},e.fromExtendedJSON=function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},e}();Object.defineProperty(ms.prototype,"_bsontype",{value:"Int32"});var xa=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$maxKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MaxKey()"},e}();Object.defineProperty(xa.prototype,"_bsontype",{value:"MaxKey"});var Na=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$minKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MinKey()"},e}();Object.defineProperty(Na.prototype,"_bsontype",{value:"MinKey"});var Qv=new RegExp("^[0-9a-fA-F]{24}$"),vr=null,It=Symbol("id"),pt=function(){function e(t){if(!(this instanceof e))return new e(t);var r;if(typeof t=="object"&&t&&"id"in t){if(typeof t.id!="string"&&!ArrayBuffer.isView(t.id))throw new we("Argument passed in must have an id that is of type string or Buffer");"toHexString"in t&&typeof t.toHexString=="function"?r=ie.from(t.toHexString(),"hex"):r=t.id}else r=t;if(r==null||typeof r=="number")this[It]=e.generate(typeof r=="number"?r:void 0);else if(ArrayBuffer.isView(r)&&r.byteLength===12)this[It]=r instanceof ie?r:Gi(r);else if(typeof r=="string")if(r.length===12){var n=ie.from(r);if(n.byteLength===12)this[It]=n;else throw new we("Argument passed in must be a string of 12 bytes")}else if(r.length===24&&Qv.test(r))this[It]=ie.from(r,"hex");else throw new we("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new we("Argument passed in does not match the accepted types");e.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(e.prototype,"id",{get:function(){return this[It]},set:function(t){this[It]=t,e.cacheHexString&&(this.__id=t.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(){if(e.cacheHexString&&this.__id)return this.__id;var t=this.id.toString("hex");return e.cacheHexString&&!this.__id&&(this.__id=t),t},e.getInc=function(){return e.index=(e.index+1)%16777215},e.generate=function(t){typeof t!="number"&&(t=Math.floor(Date.now()/1e3));var r=e.getInc(),n=ie.alloc(12);return n.writeUInt32BE(t,0),vr===null&&(vr=qf(5)),n[4]=vr[0],n[5]=vr[1],n[6]=vr[2],n[7]=vr[3],n[8]=vr[4],n[11]=r&255,n[10]=r>>8&255,n[9]=r>>16&255,n},e.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(t){if(t==null)return!1;if(t instanceof e)return this[It][11]===t[It][11]&&this[It].equals(t[It]);if(typeof t=="string"&&e.isValid(t)&&t.length===12&&Ta(this.id))return t===ie.prototype.toString.call(this.id,"latin1");if(typeof t=="string"&&e.isValid(t)&&t.length===24)return t.toLowerCase()===this.toHexString();if(typeof t=="string"&&e.isValid(t)&&t.length===12)return ie.from(t).equals(this.id);if(typeof t=="object"&&"toHexString"in t&&typeof t.toHexString=="function"){var r=t.toHexString(),n=this.toHexString().toLowerCase();return typeof r=="string"&&r.toLowerCase()===n}return!1},e.prototype.getTimestamp=function(){var t=new Date,r=this.id.readUInt32BE(0);return t.setTime(Math.floor(r)*1e3),t},e.createPk=function(){return new e},e.createFromTime=function(t){var r=ie.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(t,0),new e(r)},e.createFromHexString=function(t){if(typeof t>"u"||t!=null&&t.length!==24)throw new we("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new e(ie.from(t,"hex"))},e.isValid=function(t){if(t==null)return!1;try{return new e(t),!0}catch{return!1}},e.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},e.fromExtendedJSON=function(t){return new e(t.$oid)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},e.index=Math.floor(Math.random()*16777215),e}();Object.defineProperty(pt.prototype,"generate",{value:ys(function(e){return pt.generate(e)},"Please use the static `ObjectId.generate(time)` instead")});Object.defineProperty(pt.prototype,"getInc",{value:ys(function(){return pt.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(pt.prototype,"get_inc",{value:ys(function(){return pt.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(pt,"get_inc",{value:ys(function(){return pt.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(pt.prototype,"_bsontype",{value:"ObjectID"});function ew(e){return e.split("").sort().join("")}var Gn=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(this.pattern=t,this.options=ew(r??""),this.pattern.indexOf("\0")!==-1)throw new Or("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(this.options.indexOf("\0")!==-1)throw new Or("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var n=0;n<this.options.length;n++)if(!(this.options[n]==="i"||this.options[n]==="m"||this.options[n]==="x"||this.options[n]==="l"||this.options[n]==="s"||this.options[n]==="u"))throw new Or("The regular expression option [".concat(this.options[n],"] is not supported"))}return e.parseOptions=function(t){return t?t.split("").sort().join(""):""},e.prototype.toExtendedJSON=function(t){return t=t||{},t.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},e.fromExtendedJSON=function(t){if("$regex"in t)if(typeof t.$regex!="string"){if(t.$regex._bsontype==="BSONRegExp")return t}else return new e(t.$regex,e.parseOptions(t.$options));if("$regularExpression"in t)return new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options));throw new we("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(t)))},e}();Object.defineProperty(Gn.prototype,"_bsontype",{value:"BSONRegExp"});var Ra=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value},e.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(){return{$symbol:this.value}},e.fromExtendedJSON=function(t){return new e(t.$symbol)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e}();Object.defineProperty(Ra.prototype,"_bsontype",{value:"Symbol"});var tw=W,Jf=function(e){ps(t,e);function t(r,n){var s=this;return s instanceof t?(W.isLong(r)?s=e.call(this,r.low,r.high,!0)||this:ti(r)&&typeof r.t<"u"&&typeof r.i<"u"?s=e.call(this,r.i,r.t,!0)||this:s=e.call(this,r,n,!0)||this,Object.defineProperty(s,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),s):new t(r,n)}return t.prototype.toJSON=function(){return{$timestamp:this.toString()}},t.fromInt=function(r){return new t(W.fromInt(r,!0))},t.fromNumber=function(r){return new t(W.fromNumber(r,!0))},t.fromBits=function(r,n){return new t(r,n)},t.fromString=function(r,n){return new t(W.fromString(r,!0,n))},t.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},t.fromExtendedJSON=function(r){return new t(r.$timestamp)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},t.MAX_VALUE=W.MAX_UNSIGNED_VALUE,t}(tw);function rw(e){return ti(e)&&Reflect.has(e,"_bsontype")&&typeof e._bsontype=="string"}var zf=2147483647,Zf=-2147483648,Xf=9223372036854776e3,Qf=-9223372036854776e3,nw={$oid:pt,$binary:xr,$uuid:xr,$symbol:Ra,$numberInt:ms,$numberDecimal:Oa,$numberDouble:_s,$numberLong:W,$minKey:Na,$maxKey:xa,$regex:Gn,$regularExpression:Gn,$timestamp:Jf};function el(e,t){if(t===void 0&&(t={}),typeof e=="number"){if(t.relaxed||t.legacy)return e;if(Math.floor(e)===e){if(e>=Zf&&e<=zf)return new ms(e);if(e>=Qf&&e<=Xf)return W.fromNumber(e)}return new _s(e)}if(e==null||typeof e!="object")return e;if(e.$undefined)return null;for(var r=Object.keys(e).filter(function(d){return d.startsWith("$")&&e[d]!=null}),n=0;n<r.length;n++){var s=nw[r[n]];if(s)return s.fromExtendedJSON(e,t)}if(e.$date!=null){var i=e.$date,o=new Date;return t.legacy?typeof i=="number"?o.setTime(i):typeof i=="string"&&o.setTime(Date.parse(i)):typeof i=="string"?o.setTime(Date.parse(i)):W.isLong(i)?o.setTime(i.toNumber()):typeof i=="number"&&t.relaxed&&o.setTime(i),o}if(e.$code!=null){var u=Object.assign({},e);return e.$scope&&(u.$scope=el(e.$scope)),gs.fromExtendedJSON(e)}if($v(e)||e.$dbPointer){var h=e.$ref?e:e.$dbPointer;if(h instanceof qn)return h;var a=Object.keys(h).filter(function(d){return d.startsWith("$")}),c=!0;if(a.forEach(function(d){["$ref","$id","$db"].indexOf(d)===-1&&(c=!1)}),c)return qn.fromExtendedJSON(h)}return e}function iw(e,t){return e.map(function(r,n){t.seenObjects.push({propertyName:"index ".concat(n),obj:null});try{return rr(r,t)}finally{t.seenObjects.pop()}})}function zu(e){var t=e.toISOString();return e.getUTCMilliseconds()!==0?t:t.slice(0,-5)+"Z"}function rr(e,t){if((typeof e=="object"||typeof e=="function")&&e!==null){var r=t.seenObjects.findIndex(function(I){return I.obj===e});if(r!==-1){var n=t.seenObjects.map(function(I){return I.propertyName}),s=n.slice(0,r).map(function(I){return"".concat(I," -> ")}).join(""),i=n[r],o=" -> "+n.slice(r+1,n.length-1).map(function(I){return"".concat(I," -> ")}).join(""),u=n[n.length-1],h=" ".repeat(s.length+i.length/2),a="-".repeat(o.length+(i.length+u.length)/2-1);throw new we(`Converting circular structure to EJSON:
`+"    ".concat(s).concat(i).concat(o).concat(u,`
`)+"    ".concat(h,"\\").concat(a,"/"))}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return iw(e,t);if(e===void 0)return null;if(e instanceof Date||Fv(e)){var c=e.getTime(),d=c>-1&&c<2534023188e5;return t.legacy?t.relaxed&&d?{$date:e.getTime()}:{$date:zu(e)}:t.relaxed&&d?{$date:zu(e)}:{$date:{$numberLong:e.getTime().toString()}}}if(typeof e=="number"&&(!t.relaxed||!isFinite(e))){if(Math.floor(e)===e){var _=e>=Zf&&e<=zf,m=e>=Qf&&e<=Xf;if(_)return{$numberInt:e.toString()};if(m)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp||Mv(e)){var S=e.flags;if(S===void 0){var b=e.toString().match(/[gimuy]*$/);b&&(S=b[0])}var A=new Gn(e.source,S);return A.toExtendedJSON(t)}return e!=null&&typeof e=="object"?ow(e,t):e}var sw={Binary:function(e){return new xr(e.value(),e.sub_type)},Code:function(e){return new gs(e.code,e.scope)},DBRef:function(e){return new qn(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new Oa(e.bytes)},Double:function(e){return new _s(e.value)},Int32:function(e){return new ms(e.value)},Long:function(e){return W.fromBits(e.low!=null?e.low:e.low_,e.low!=null?e.high:e.high_,e.low!=null?e.unsigned:e.unsigned_)},MaxKey:function(){return new xa},MinKey:function(){return new Na},ObjectID:function(e){return new pt(e)},ObjectId:function(e){return new pt(e)},BSONRegExp:function(e){return new Gn(e.pattern,e.options)},Symbol:function(e){return new Ra(e.value)},Timestamp:function(e){return Jf.fromBits(e.low,e.high)}};function ow(e,t){if(e==null||typeof e!="object")throw new Or("not an object instance");var r=e._bsontype;if(typeof r>"u"){var n={};for(var s in e){t.seenObjects.push({propertyName:s,obj:null});try{var i=rr(e[s],t);s==="__proto__"?Object.defineProperty(n,s,{value:i,writable:!0,enumerable:!0,configurable:!0}):n[s]=i}finally{t.seenObjects.pop()}}return n}else if(rw(e)){var o=e;if(typeof o.toExtendedJSON!="function"){var u=sw[e._bsontype];if(!u)throw new we("Unrecognized or invalid _bsontype: "+e._bsontype);o=u(o)}return r==="Code"&&o.scope?o=new gs(o.code,rr(o.scope,t)):r==="DBRef"&&o.oid&&(o=new qn(rr(o.collection,t),rr(o.oid,t),rr(o.db,t),rr(o.fields,t))),o.toExtendedJSON(t)}else throw new Or("_bsontype must be a string, but was: "+typeof r)}var Ze;(function(e){function t(i,o){var u=Object.assign({},{relaxed:!0,legacy:!1},o);return typeof u.relaxed=="boolean"&&(u.strict=!u.relaxed),typeof u.strict=="boolean"&&(u.relaxed=!u.strict),JSON.parse(i,function(h,a){if(h.indexOf("\0")!==-1)throw new Or("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(h)));return el(a,u)})}e.parse=t;function r(i,o,u,h){u!=null&&typeof u=="object"&&(h=u,u=0),o!=null&&typeof o=="object"&&!Array.isArray(o)&&(h=o,o=void 0,u=0);var a=Object.assign({relaxed:!0,legacy:!1},h,{seenObjects:[{propertyName:"(root)",obj:null}]}),c=rr(i,a);return JSON.stringify(c,o,u)}e.stringify=r;function n(i,o){return o=o||{},JSON.parse(r(i,o))}e.serialize=n;function s(i,o){return o=o||{},t(JSON.stringify(i),o)}e.deserialize=s})(Ze||(Ze={}));var Zu=Hf();Zu.Map?Zu.Map:function(){function e(t){t===void 0&&(t=[]),this._keys=[],this._values={};for(var r=0;r<t.length;r++)if(t[r]!=null){var n=t[r],s=n[0],i=n[1];this._keys.push(s),this._values[s]={v:i,i:this._keys.length-1}}}return e.prototype.clear=function(){this._keys=[],this._values={}},e.prototype.delete=function(t){var r=this._values[t];return r==null?!1:(delete this._values[t],this._keys.splice(r.i,1),!0)},e.prototype.entries=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?[n,t._values[n].v]:void 0,done:n===void 0}}}},e.prototype.forEach=function(t,r){r=r||this;for(var n=0;n<this._keys.length;n++){var s=this._keys[n];t.call(r,this._values[s].v,s,r)}},e.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},e.prototype.has=function(t){return this._values[t]!=null},e.prototype.keys=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?n:void 0,done:n===void 0}}}},e.prototype.set=function(t,r){return this._values[t]?(this._values[t].v=r,this):(this._keys.push(t),this._values[t]={v:r,i:this._keys.length-1},this)},e.prototype.values=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?t._values[n].v:void 0,done:n===void 0}}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),e}();W.fromNumber(Uv);W.fromNumber(Bv);var So=new Uint8Array(8);new DataView(So.buffer,So.byteOffset,So.byteLength);var aw=1024*1024*17;ie.alloc(aw);var uw=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},cw=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},tl=function(){function e(t,r){this._stages=[],t&&r&&(this._db=t,this._request=new je.reqClass(this._db.config),this._collectionName=r)}return e.prototype.end=function(){return uw(this,void 0,void 0,function(){var t;return cw(this,function(r){switch(r.label){case 0:if(!this._collectionName||!this._db)throw new Error("Aggregation pipeline cannot send request");return[4,this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages})];case 1:return t=r.sent(),t&&t.data&&t.data.list?[2,{requestId:t.requestId,data:JSON.parse(t.data.list).map(Ze.parse)}]:[2,t]}})})},e.prototype.unwrap=function(){return this._stages},e.prototype.done=function(){return this._stages.map(function(t){var r,n=t.stageKey,s=t.stageValue;return r={},r[n]=JSON.parse(s),r})},e.prototype._pipe=function(t,r){return this._stages.push({stageKey:"$"+t,stageValue:JSON.stringify(r)}),this},e.prototype.addFields=function(t){return this._pipe("addFields",t)},e.prototype.bucket=function(t){return this._pipe("bucket",t)},e.prototype.bucketAuto=function(t){return this._pipe("bucketAuto",t)},e.prototype.count=function(t){return this._pipe("count",t)},e.prototype.geoNear=function(t){return this._pipe("geoNear",t)},e.prototype.group=function(t){return this._pipe("group",t)},e.prototype.limit=function(t){return this._pipe("limit",t)},e.prototype.match=function(t){return this._pipe("match",Go.encode(t))},e.prototype.project=function(t){return this._pipe("project",t)},e.prototype.lookup=function(t){return this._pipe("lookup",t)},e.prototype.replaceRoot=function(t){return this._pipe("replaceRoot",t)},e.prototype.sample=function(t){return this._pipe("sample",t)},e.prototype.skip=function(t){return this._pipe("skip",t)},e.prototype.sort=function(t){return this._pipe("sort",t)},e.prototype.sortByCount=function(t){return this._pipe("sortByCount",t)},e.prototype.unwind=function(t){return this._pipe("unwind",t)},e}(),fw=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lw=function(e){fw(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId");return new Uu(this._db,this._coll,r)},t.prototype.add=function(r,n){var s=new Uu(this._db,this._coll,void 0);return s.create(r,n)},t.prototype.aggregate=function(){return new tl(this._db,this._coll)},t}(gv),hw={eq:function(e){return new De(q.EQ,[e])},neq:function(e){return new De(q.NEQ,[e])},lt:function(e){return new De(q.LT,[e])},lte:function(e){return new De(q.LTE,[e])},gt:function(e){return new De(q.GT,[e])},gte:function(e){return new De(q.GTE,[e])},in:function(e){return new De(q.IN,e)},nin:function(e){return new De(q.NIN,e)},all:function(e){return new De(q.ALL,e)},elemMatch:function(e){return new De(q.ELEM_MATCH,[e])},exists:function(e){return new De(q.EXISTS,[e])},size:function(e){return new De(q.SIZE,[e])},mod:function(e){return new De(q.MOD,[e])},geoNear:function(e){return new De(q.GEO_NEAR,[e])},geoWithin:function(e){return new De(q.GEO_WITHIN,[e])},geoIntersects:function(e){return new De(q.GEO_INTERSECTS,[e])},and:function(){var e=Te(arguments[0])?arguments[0]:Array.from(arguments);return new Ar(et.AND,e)},nor:function(){var e=Te(arguments[0])?arguments[0]:Array.from(arguments);return new Ar(et.NOR,e)},or:function(){var e=Te(arguments[0])?arguments[0]:Array.from(arguments);return new Ar(et.OR,e)},not:function(){var e=Te(arguments[0])?arguments[0]:Array.from(arguments);return new Ar(et.NOT,e)},set:function(e){return new xe(Z.SET,[e])},remove:function(){return new xe(Z.REMOVE,[])},inc:function(e){return new xe(Z.INC,[e])},mul:function(e){return new xe(Z.MUL,[e])},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r;if(ur(e[0])&&e[0].hasOwnProperty("each")){var n=e[0];r={$each:n.each,$position:n.position,$sort:n.sort,$slice:n.slice}}else Te(e[0])?r=e[0]:r=Array.from(e);return new xe(Z.PUSH,r)},pull:function(e){return new xe(Z.PULL,e)},pullAll:function(e){return new xe(Z.PULL_ALL,e)},pop:function(){return new xe(Z.POP,[])},shift:function(){return new xe(Z.SHIFT,[])},unshift:function(){var e=Te(arguments[0])?arguments[0]:Array.from(arguments);return new xe(Z.UNSHIFT,e)},addToSet:function(e){return new xe(Z.ADD_TO_SET,e)},rename:function(e){return new xe(Z.RENAME,[e])},bit:function(e){return new xe(Z.BIT,[e])},max:function(e){return new xe(Z.MAX,[e])},min:function(e){return new xe(Z.MIN,[e])},expr:function(e){return{$expr:e}},jsonSchema:function(e){return{$jsonSchema:e}},text:function(e){return uv(e)?{$search:e.search}:{$search:e.search,$language:e.language,$caseSensitive:e.caseSensitive,$diacriticSensitive:e.diacriticSensitive}},aggregate:{pipeline:function(){return new tl},abs:function(e){return new D("abs",e)},add:function(e){return new D("add",e)},ceil:function(e){return new D("ceil",e)},divide:function(e){return new D("divide",e)},exp:function(e){return new D("exp",e)},floor:function(e){return new D("floor",e)},ln:function(e){return new D("ln",e)},log:function(e){return new D("log",e)},log10:function(e){return new D("log10",e)},mod:function(e){return new D("mod",e)},multiply:function(e){return new D("multiply",e)},pow:function(e){return new D("pow",e)},sqrt:function(e){return new D("sqrt",e)},subtract:function(e){return new D("subtract",e)},trunc:function(e){return new D("trunc",e)},arrayElemAt:function(e){return new D("arrayElemAt",e)},arrayToObject:function(e){return new D("arrayToObject",e)},concatArrays:function(e){return new D("concatArrays",e)},filter:function(e){return new D("filter",e)},in:function(e){return new D("in",e)},indexOfArray:function(e){return new D("indexOfArray",e)},isArray:function(e){return new D("isArray",e)},map:function(e){return new D("map",e)},range:function(e){return new D("range",e)},reduce:function(e){return new D("reduce",e)},reverseArray:function(e){return new D("reverseArray",e)},size:function(e){return new D("size",e)},slice:function(e){return new D("slice",e)},zip:function(e){return new D("zip",e)},and:function(e){return new D("and",e)},not:function(e){return new D("not",e)},or:function(e){return new D("or",e)},cmp:function(e){return new D("cmp",e)},eq:function(e){return new D("eq",e)},gt:function(e){return new D("gt",e)},gte:function(e){return new D("gte",e)},lt:function(e){return new D("lt",e)},lte:function(e){return new D("lte",e)},neq:function(e){return new D("ne",e)},cond:function(e){return new D("cond",e)},ifNull:function(e){return new D("ifNull",e)},switch:function(e){return new D("switch",e)},dateFromParts:function(e){return new D("dateFromParts",e)},dateFromString:function(e){return new D("dateFromString",e)},dayOfMonth:function(e){return new D("dayOfMonth",e)},dayOfWeek:function(e){return new D("dayOfWeek",e)},dayOfYear:function(e){return new D("dayOfYear",e)},isoDayOfWeek:function(e){return new D("isoDayOfWeek",e)},isoWeek:function(e){return new D("isoWeek",e)},isoWeekYear:function(e){return new D("isoWeekYear",e)},millisecond:function(e){return new D("millisecond",e)},minute:function(e){return new D("minute",e)},month:function(e){return new D("month",e)},second:function(e){return new D("second",e)},hour:function(e){return new D("hour",e)},week:function(e){return new D("week",e)},year:function(e){return new D("year",e)},literal:function(e){return new D("literal",e)},mergeObjects:function(e){return new D("mergeObjects",e)},objectToArray:function(e){return new D("objectToArray",e)},allElementsTrue:function(e){return new D("allElementsTrue",e)},anyElementTrue:function(e){return new D("anyElementTrue",e)},setDifference:function(e){return new D("setDifference",e)},setEquals:function(e){return new D("setEquals",e)},setIntersection:function(e){return new D("setIntersection",e)},setIsSubset:function(e){return new D("setIsSubset",e)},setUnion:function(e){return new D("setUnion",e)},concat:function(e){return new D("concat",e)},dateToString:function(e){return new D("dateToString",e)},indexOfBytes:function(e){return new D("indexOfBytes",e)},indexOfCP:function(e){return new D("indexOfCP",e)},split:function(e){return new D("split",e)},strLenBytes:function(e){return new D("strLenBytes",e)},strLenCP:function(e){return new D("strLenCP",e)},strcasecmp:function(e){return new D("strcasecmp",e)},substr:function(e){return new D("substr",e)},substrBytes:function(e){return new D("substrBytes",e)},substrCP:function(e){return new D("substrCP",e)},toLower:function(e){return new D("toLower",e)},toUpper:function(e){return new D("toUpper",e)},meta:function(e){return new D("meta",e)},addToSet:function(e){return new D("addToSet",e)},avg:function(e){return new D("avg",e)},first:function(e){return new D("first",e)},last:function(e){return new D("last",e)},max:function(e){return new D("max",e)},min:function(e){return new D("min",e)},push:function(e){return new D("push",e)},stdDevPop:function(e){return new D("stdDevPop",e)},stdDevSamp:function(e){return new D("stdDevSamp",e)},sum:function(e){return new D("sum",e)},let:function(e){return new D("let",e)}},project:{slice:function(e){return new Xu("slice",e)},elemMatch:function(e){return new Xu("elemMatch",e)}}},D=function(){function e(t,r){this["$"+t]=r}return e}(),Xu=function(){function e(t,r){this["$"+t]=r}return e}(),dw=function(){function e(t){var r=t.regexp,n=t.options;if(!r)throw new TypeError("regexp must be a string");this.$regex=r,this.$options=n}return e.prototype.parse=function(){return{$regex:this.$regex,$options:this.$options}},Object.defineProperty(e.prototype,"_internalType",{get:function(){return Ff},enumerable:!0,configurable:!0}),e}();function pw(e){return new dw(e)}var rl={CREATE_WATCH_NET_ERROR:{code:"CREATE_WATCH_NET_ERROR",message:"create watch network error"},CREATE_WACTH_EXCEED_ERROR:{code:"CREATE_WACTH_EXCEED_ERROR",message:"maximum connections exceed"},CREATE_WATCH_SERVER_ERROR:{code:"CREATE_WATCH_SERVER_ERROR",message:"create watch server error"},CONN_ERROR:{code:"CONN_ERROR",message:"connection error"},INVALID_PARAM:{code:"INVALID_PARAM",message:"Invalid request param"},INSERT_DOC_FAIL:{code:"INSERT_DOC_FAIL",message:"insert document failed"},DATABASE_TRANSACTION_CONFLICT:{code:"DATABASE_TRANSACTION_CONFLICT",message:"database transaction conflict"}},Tt=function(){return Tt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Tt.apply(this,arguments)},kn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Mn=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},yw="database.getInTransaction",Qu="database.updateDocInTransaction",gw="database.deleteDocInTransaction",_w="database.insertDocInTransaction",ec=function(){function e(t,r,n){this._coll=r,this.id=n,this._transaction=t,this._request=this._transaction.getRequestMethod(),this._transactionId=this._transaction.getTransactionId()}return e.prototype.create=function(t){return kn(this,void 0,void 0,function(){var r,n,s,i;return Mn(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,data:Ze.stringify(Hn(t),{relaxed:!1})},this.id&&(r._id=this.id),[4,this._request.send(_w,r)];case 1:if(n=o.sent(),n.code)throw n;if(s=Ze.parse(n.inserted),i=Ze.parse(n.ok),i==1&&s==1)return[2,Tt(Tt({},n),{ok:i,inserted:s})];throw new Error(rl.INSERT_DOC_FAIL.message)}})})},e.prototype.get=function(){return kn(this,void 0,void 0,function(){var t,r;return Mn(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(yw,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,{data:r.data!=="null"?hs.formatField(Ze.parse(r.data)):Ze.parse(r.data),requestId:r.requestId}]}})})},e.prototype.set=function(t){return kn(this,void 0,void 0,function(){var r,n;return Mn(this,function(s){switch(s.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Ze.stringify(Hn(t),{relaxed:!1}),upsert:!0},[4,this._request.send(Qu,r)];case 1:if(n=s.sent(),n.code)throw n;return[2,Tt(Tt({},n),{updated:Ze.parse(n.updated),upserted:n.upserted?JSON.parse(n.upserted):null})]}})})},e.prototype.update=function(t){return kn(this,void 0,void 0,function(){var r,n;return Mn(this,function(s){switch(s.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Ze.stringify(Ia.encode(t),{relaxed:!1})},[4,this._request.send(Qu,r)];case 1:if(n=s.sent(),n.code)throw n;return[2,Tt(Tt({},n),{updated:Ze.parse(n.updated)})]}})})},e.prototype.delete=function(){return kn(this,void 0,void 0,function(){var t,r;return Mn(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(gw,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,Tt(Tt({},r),{deleted:Ze.parse(r.deleted)})]}})})},e}(),mw=function(){function e(t,r){this._coll=r,this._transaction=t}return e}(),vw=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ww=function(e){vw(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId");return new ec(this._transaction,this._coll,r)},t.prototype.add=function(r){var n;r._id!==void 0&&(n=r._id);var s=new ec(this._transaction,this._coll,n);return s.create(r)},t}(mw),rn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},nn=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ew="database.startTransaction",bw="database.commitTransaction",Sw="database.abortTransaction",nl=function(){function e(t){this._db=t,this._request=new je.reqClass(this._db.config),this.aborted=!1,this.commited=!1,this.inited=!1}return e.prototype.init=function(){return rn(this,void 0,void 0,function(){var t;return nn(this,function(r){switch(r.label){case 0:return[4,this._request.send(Ew)];case 1:if(t=r.sent(),t.code)throw t;return this.inited=!0,this._id=t.transactionId,[2]}})})},e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new ww(this,t)},e.prototype.getTransactionId=function(){return this._id},e.prototype.getRequestMethod=function(){return this._request},e.prototype.commit=function(){return rn(this,void 0,void 0,function(){var t,r;return nn(this,function(n){switch(n.label){case 0:return t={transactionId:this._id},[4,this._request.send(bw,t)];case 1:if(r=n.sent(),r.code)throw r;return this.commited=!0,[2,r]}})})},e.prototype.rollback=function(t){return rn(this,void 0,void 0,function(){var r,n;return nn(this,function(s){switch(s.label){case 0:return r={transactionId:this._id},[4,this._request.send(Sw,r)];case 1:if(n=s.sent(),n.code)throw n;return this.aborted=!0,this.abortReason=t,[2,n]}})})},e}();function Aw(){return rn(this,void 0,void 0,function(){var e;return nn(this,function(t){switch(t.label){case 0:return e=new nl(this),[4,e.init()];case 1:return t.sent(),[2,e]}})})}function il(e,t){return t===void 0&&(t=3),rn(this,void 0,void 0,function(){var r,n,s,i,o=this;return nn(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,10]),r=new nl(this),[4,r.init()];case 1:return u.sent(),[4,e(r)];case 2:if(n=u.sent(),r.aborted===!0)throw r.abortReason;return[4,r.commit()];case 3:return u.sent(),[2,n];case 4:if(s=u.sent(),r.inited===!1)throw s;return i=function(h){return rn(o,void 0,void 0,function(){return nn(this,function(a){switch(a.label){case 0:if(!(!r.aborted&&!r.commited))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.rollback()];case 2:return a.sent(),[3,4];case 3:return a.sent(),[3,4];case 4:throw h;case 5:throw r.aborted===!0?r.abortReason:h}})})},t<=0?[4,i(s)]:[3,6];case 5:u.sent(),u.label=6;case 6:return s&&s.code===rl.DATABASE_TRANSACTION_CONFLICT.code?[4,il.bind(this)(e,--t)]:[3,8];case 7:return[2,u.sent()];case 8:return[4,i(s)];case 9:return u.sent(),[3,10];case 10:return[2]}})})}var je=function(){function e(t){this.config=t,this.Geo=lv,this.serverDate=av,this.command=hw,this.RegExp=pw,this.startTransaction=Aw,this.runTransaction=il,this.logicCommand=Ar,this.updateCommand=xe,this.queryCommand=De}return e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new lw(this,t)},e.prototype.createCollection=function(t){var r=new e.reqClass(this.config),n={collectionName:t};return r.send("database.addCollection",n)},e}(),Ki=function(){return Ki=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ki.apply(this,arguments)},Iw="database";function Tw(e){var t=this.platform,r=t.adapter,n=t.runtime;return je.reqClass=this.request.constructor,je.getAccessToken=this.authInstance?this.authInstance.getAccessToken.bind(this.authInstance):function(){return""},je.runtime=n,this.wsClientClass&&(je.wsClass=r.wsClass,je.wsClientClass=this.wsClientClass),je.ws||(je.ws=null),new je(Ki(Ki({},this.config),e))}var Ow={name:Iw,entity:{database:Tw}};try{cloudbase.registerComponent(Ow)}catch{}var xw="Expected a function",sl="__lodash_hash_undefined__",ol=1/0,Nw=9007199254740991,Rw="[object Function]",Dw="[object GeneratorFunction]",Cw="[object Symbol]",Pw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kw=/^\w*$/,Mw=/^\./,Fw=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Lw=/[\\^$.*+?()[\]{}|]/g,Uw=/\\(\\)?/g,Bw=/^\[object .+?Constructor\]$/,$w=/^(?:0|[1-9]\d*)$/,Ww=typeof L=="object"&&L&&L.Object===Object&&L,jw=typeof self=="object"&&self&&self.Object===Object&&self,Da=Ww||jw||Function("return this")();function Yw(e,t){return e==null?void 0:e[t]}function Hw(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var qw=Array.prototype,Gw=Function.prototype,al=Object.prototype,Ao=Da["__core-js_shared__"],tc=function(){var e=/[^.]+$/.exec(Ao&&Ao.keys&&Ao.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ul=Gw.toString,vs=al.hasOwnProperty,cl=al.toString,Kw=RegExp("^"+ul.call(vs).replace(Lw,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rc=Da.Symbol,Vw=qw.splice,Jw=fl(Da,"Map"),Kn=fl(Object,"create"),nc=rc?rc.prototype:void 0,ic=nc?nc.toString:void 0;function Nr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function zw(){this.__data__=Kn?Kn(null):{}}function Zw(e){return this.has(e)&&delete this.__data__[e]}function Xw(e){var t=this.__data__;if(Kn){var r=t[e];return r===sl?void 0:r}return vs.call(t,e)?t[e]:void 0}function Qw(e){var t=this.__data__;return Kn?t[e]!==void 0:vs.call(t,e)}function eE(e,t){var r=this.__data__;return r[e]=Kn&&t===void 0?sl:t,this}Nr.prototype.clear=zw;Nr.prototype.delete=Zw;Nr.prototype.get=Xw;Nr.prototype.has=Qw;Nr.prototype.set=eE;function hn(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function tE(){this.__data__=[]}function rE(e){var t=this.__data__,r=ws(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Vw.call(t,r,1),!0}function nE(e){var t=this.__data__,r=ws(t,e);return r<0?void 0:t[r][1]}function iE(e){return ws(this.__data__,e)>-1}function sE(e,t){var r=this.__data__,n=ws(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}hn.prototype.clear=tE;hn.prototype.delete=rE;hn.prototype.get=nE;hn.prototype.has=iE;hn.prototype.set=sE;function Pr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oE(){this.__data__={hash:new Nr,map:new(Jw||hn),string:new Nr}}function aE(e){return Es(this,e).delete(e)}function uE(e){return Es(this,e).get(e)}function cE(e){return Es(this,e).has(e)}function fE(e,t){return Es(this,e).set(e,t),this}Pr.prototype.clear=oE;Pr.prototype.delete=aE;Pr.prototype.get=uE;Pr.prototype.has=cE;Pr.prototype.set=fE;function lE(e,t,r){var n=e[t];(!(vs.call(e,t)&&ll(n,r))||r===void 0&&!(t in e))&&(e[t]=r)}function ws(e,t){for(var r=e.length;r--;)if(ll(e[r][0],t))return r;return-1}function hE(e){if(!Vi(e)||vE(e))return!1;var t=SE(e)||Hw(e)?Kw:Bw;return t.test(bE(e))}function dE(e,t,r,n){if(!Vi(e))return e;t=_E(t,e)?[t]:yE(t);for(var s=-1,i=t.length,o=i-1,u=e;u!=null&&++s<i;){var h=EE(t[s]),a=r;if(s!=o){var c=u[h];a=void 0,a===void 0&&(a=Vi(c)?c:gE(t[s+1])?[]:{})}lE(u,h,a),u=u[h]}return e}function pE(e){if(typeof e=="string")return e;if(Pa(e))return ic?ic.call(e):"";var t=e+"";return t=="0"&&1/e==-ol?"-0":t}function yE(e){return hl(e)?e:wE(e)}function Es(e,t){var r=e.__data__;return mE(t)?r[typeof t=="string"?"string":"hash"]:r.map}function fl(e,t){var r=Yw(e,t);return hE(r)?r:void 0}function gE(e,t){return t=t??Nw,!!t&&(typeof e=="number"||$w.test(e))&&e>-1&&e%1==0&&e<t}function _E(e,t){if(hl(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Pa(e)?!0:kw.test(e)||!Pw.test(e)||t!=null&&e in Object(t)}function mE(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function vE(e){return!!tc&&tc in e}var wE=Ca(function(e){e=IE(e);var t=[];return Mw.test(e)&&t.push(""),e.replace(Fw,function(r,n,s,i){t.push(s?i.replace(Uw,"$1"):n||r)}),t});function EE(e){if(typeof e=="string"||Pa(e))return e;var t=e+"";return t=="0"&&1/e==-ol?"-0":t}function bE(e){if(e!=null){try{return ul.call(e)}catch{}try{return e+""}catch{}}return""}function Ca(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(xw);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,n);return r.cache=i.set(s,o),o};return r.cache=new(Ca.Cache||Pr),r}Ca.Cache=Pr;function ll(e,t){return e===t||e!==e&&t!==t}var hl=Array.isArray;function SE(e){var t=Vi(e)?cl.call(e):"";return t==Rw||t==Dw}function Vi(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function AE(e){return!!e&&typeof e=="object"}function Pa(e){return typeof e=="symbol"||AE(e)&&cl.call(e)==Cw}function IE(e){return e==null?"":pE(e)}function TE(e,t,r){return e==null?e:dE(e,t,r)}var OE=TE;const xE=zo(OE);var NE="Expected a function",dl="__lodash_hash_undefined__",pl=1/0,RE="[object Function]",DE="[object GeneratorFunction]",CE="[object Symbol]",PE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kE=/^\w*$/,ME=/^\./,FE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,LE=/[\\^$.*+?()[\]{}|]/g,UE=/\\(\\)?/g,BE=/^\[object .+?Constructor\]$/,$E=typeof L=="object"&&L&&L.Object===Object&&L,WE=typeof self=="object"&&self&&self.Object===Object&&self,ka=$E||WE||Function("return this")();function jE(e,t){return e==null?void 0:e[t]}function YE(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var HE=Array.prototype,qE=Function.prototype,yl=Object.prototype,Io=ka["__core-js_shared__"],sc=function(){var e=/[^.]+$/.exec(Io&&Io.keys&&Io.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),gl=qE.toString,bs=yl.hasOwnProperty,_l=yl.toString,GE=RegExp("^"+gl.call(bs).replace(LE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oc=ka.Symbol,KE=HE.splice,VE=vl(ka,"Map"),Vn=vl(Object,"create"),ac=oc?oc.prototype:void 0,uc=ac?ac.toString:void 0;function Rr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function JE(){this.__data__=Vn?Vn(null):{}}function zE(e){return this.has(e)&&delete this.__data__[e]}function ZE(e){var t=this.__data__;if(Vn){var r=t[e];return r===dl?void 0:r}return bs.call(t,e)?t[e]:void 0}function XE(e){var t=this.__data__;return Vn?t[e]!==void 0:bs.call(t,e)}function QE(e,t){var r=this.__data__;return r[e]=Vn&&t===void 0?dl:t,this}Rr.prototype.clear=JE;Rr.prototype.delete=zE;Rr.prototype.get=ZE;Rr.prototype.has=XE;Rr.prototype.set=QE;function dn(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function e1(){this.__data__=[]}function t1(e){var t=this.__data__,r=Ss(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():KE.call(t,r,1),!0}function r1(e){var t=this.__data__,r=Ss(t,e);return r<0?void 0:t[r][1]}function n1(e){return Ss(this.__data__,e)>-1}function i1(e,t){var r=this.__data__,n=Ss(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}dn.prototype.clear=e1;dn.prototype.delete=t1;dn.prototype.get=r1;dn.prototype.has=n1;dn.prototype.set=i1;function kr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function s1(){this.__data__={hash:new Rr,map:new(VE||dn),string:new Rr}}function o1(e){return As(this,e).delete(e)}function a1(e){return As(this,e).get(e)}function u1(e){return As(this,e).has(e)}function c1(e,t){return As(this,e).set(e,t),this}kr.prototype.clear=s1;kr.prototype.delete=o1;kr.prototype.get=a1;kr.prototype.has=u1;kr.prototype.set=c1;function Ss(e,t){for(var r=e.length;r--;)if(E1(e[r][0],t))return r;return-1}function f1(e,t){t=wl(t,e)?[t]:ml(t);for(var r=0,n=t.length;e!=null&&r<n;)e=e[El(t[r++])];return r&&r==n?e:void 0}function l1(e){if(!Sl(e)||g1(e))return!1;var t=b1(e)||YE(e)?GE:BE;return t.test(v1(e))}function h1(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(s);++n<s;)i[n]=e[n+t];return i}function d1(e){if(typeof e=="string")return e;if(Fa(e))return uc?uc.call(e):"";var t=e+"";return t=="0"&&1/e==-pl?"-0":t}function p1(e,t){t=wl(t,e)?[t]:ml(t),e=_1(e,t);var r=El(w1(t));return!(e!=null&&bs.call(e,r))||delete e[r]}function ml(e){return bl(e)?e:m1(e)}function As(e,t){var r=e.__data__;return y1(t)?r[typeof t=="string"?"string":"hash"]:r.map}function vl(e,t){var r=jE(e,t);return l1(r)?r:void 0}function wl(e,t){if(bl(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Fa(e)?!0:kE.test(e)||!PE.test(e)||t!=null&&e in Object(t)}function y1(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function g1(e){return!!sc&&sc in e}function _1(e,t){return t.length==1?e:f1(e,h1(t,0,-1))}var m1=Ma(function(e){e=A1(e);var t=[];return ME.test(e)&&t.push(""),e.replace(FE,function(r,n,s,i){t.push(s?i.replace(UE,"$1"):n||r)}),t});function El(e){if(typeof e=="string"||Fa(e))return e;var t=e+"";return t=="0"&&1/e==-pl?"-0":t}function v1(e){if(e!=null){try{return gl.call(e)}catch{}try{return e+""}catch{}}return""}function w1(e){var t=e?e.length:0;return t?e[t-1]:void 0}function Ma(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(NE);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,n);return r.cache=i.set(s,o),o};return r.cache=new(Ma.Cache||kr),r}Ma.Cache=kr;function E1(e,t){return e===t||e!==e&&t!==t}var bl=Array.isArray;function b1(e){var t=Sl(e)?_l.call(e):"";return t==RE||t==DE}function Sl(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function S1(e){return!!e&&typeof e=="object"}function Fa(e){return typeof e=="symbol"||S1(e)&&_l.call(e)==CE}function A1(e){return e==null?"":d1(e)}function I1(e,t){return e==null?!0:p1(e,t)}var T1=I1;const O1=zo(T1);var Ji={exports:{}};Ji.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",s=9007199254740991,i="[object Arguments]",o="[object Array]",u="[object Boolean]",h="[object Date]",a="[object Error]",c="[object Function]",d="[object GeneratorFunction]",_="[object Map]",m="[object Number]",S="[object Object]",b="[object Promise]",A="[object RegExp]",I="[object Set]",E="[object String]",O="[object Symbol]",T="[object WeakMap]",M="[object ArrayBuffer]",P="[object DataView]",B="[object Float32Array]",G="[object Float64Array]",z="[object Int8Array]",Se="[object Int16Array]",ye="[object Int32Array]",ve="[object Uint8Array]",ne="[object Uint8ClampedArray]",Me="[object Uint16Array]",Be="[object Uint32Array]",At=/[\\^$.*+?()[\]{}|]/g,fe=/\w*$/,$e=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,U={};U[i]=U[o]=U[M]=U[P]=U[u]=U[h]=U[B]=U[G]=U[z]=U[Se]=U[ye]=U[_]=U[m]=U[S]=U[A]=U[I]=U[E]=U[O]=U[ve]=U[ne]=U[Me]=U[Be]=!0,U[a]=U[c]=U[T]=!1;var Le=typeof L=="object"&&L&&L.Object===Object&&L,ri=typeof self=="object"&&self&&self.Object===Object&&self,nt=Le||ri||Function("return this")(),pn=t&&!t.nodeType&&t,ni=pn&&!0&&e&&!e.nodeType&&e,Ts=ni&&ni.exports===pn;function yn(p,w){return p.set(w[0],w[1]),p}function Os(p,w){return p.add(w),p}function xs(p,w){for(var x=-1,$=p?p.length:0;++x<$&&w(p[x],x,p)!==!1;);return p}function ii(p,w){for(var x=-1,$=w.length,Fe=p.length;++x<$;)p[Fe+x]=w[x];return p}function lr(p,w,x,$){for(var Fe=-1,He=p?p.length:0;++Fe<He;)x=w(x,p[Fe],Fe,p);return x}function it(p,w){for(var x=-1,$=Array(p);++x<p;)$[x]=w(x);return $}function gn(p,w){return p==null?void 0:p[w]}function si(p){var w=!1;if(p!=null&&typeof p.toString!="function")try{w=!!(p+"")}catch{}return w}function y(p){var w=-1,x=Array(p.size);return p.forEach(function($,Fe){x[++w]=[Fe,$]}),x}function f(p,w){return function(x){return p(w(x))}}function l(p){var w=-1,x=Array(p.size);return p.forEach(function($){x[++w]=$}),x}var g=Array.prototype,v=Function.prototype,N=Object.prototype,R=nt["__core-js_shared__"],V=function(){var p=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),se=v.toString,ee=N.hasOwnProperty,Ae=N.toString,ge=RegExp("^"+se.call(ee).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hr=Ts?nt.Buffer:void 0,_n=nt.Symbol,mn=nt.Uint8Array,Ol=f(Object.getPrototypeOf,Object),xl=Object.create,Nl=N.propertyIsEnumerable,Rl=g.splice,Ua=Object.getOwnPropertySymbols,Dl=hr?hr.isBuffer:void 0,Cl=f(Object.keys,Object),Ns=Lr(nt,"DataView"),vn=Lr(nt,"Map"),Rs=Lr(nt,"Promise"),Ds=Lr(nt,"Set"),Cs=Lr(nt,"WeakMap"),wn=Lr(Object,"create"),Pl=yr(Ns),kl=yr(vn),Ml=yr(Rs),Fl=yr(Ds),Ll=yr(Cs),Ba=_n?_n.prototype:void 0,$a=Ba?Ba.valueOf:void 0;function dr(p){var w=-1,x=p?p.length:0;for(this.clear();++w<x;){var $=p[w];this.set($[0],$[1])}}function Ul(){this.__data__=wn?wn(null):{}}function Bl(p){return this.has(p)&&delete this.__data__[p]}function $l(p){var w=this.__data__;if(wn){var x=w[p];return x===n?void 0:x}return ee.call(w,p)?w[p]:void 0}function Wl(p){var w=this.__data__;return wn?w[p]!==void 0:ee.call(w,p)}function jl(p,w){var x=this.__data__;return x[p]=wn&&w===void 0?n:w,this}dr.prototype.clear=Ul,dr.prototype.delete=Bl,dr.prototype.get=$l,dr.prototype.has=Wl,dr.prototype.set=jl;function Ut(p){var w=-1,x=p?p.length:0;for(this.clear();++w<x;){var $=p[w];this.set($[0],$[1])}}function Yl(){this.__data__=[]}function Hl(p){var w=this.__data__,x=oi(w,p);if(x<0)return!1;var $=w.length-1;return x==$?w.pop():Rl.call(w,x,1),!0}function ql(p){var w=this.__data__,x=oi(w,p);return x<0?void 0:w[x][1]}function Gl(p){return oi(this.__data__,p)>-1}function Kl(p,w){var x=this.__data__,$=oi(x,p);return $<0?x.push([p,w]):x[$][1]=w,this}Ut.prototype.clear=Yl,Ut.prototype.delete=Hl,Ut.prototype.get=ql,Ut.prototype.has=Gl,Ut.prototype.set=Kl;function Mr(p){var w=-1,x=p?p.length:0;for(this.clear();++w<x;){var $=p[w];this.set($[0],$[1])}}function Vl(){this.__data__={hash:new dr,map:new(vn||Ut),string:new dr}}function Jl(p){return ai(this,p).delete(p)}function zl(p){return ai(this,p).get(p)}function Zl(p){return ai(this,p).has(p)}function Xl(p,w){return ai(this,p).set(p,w),this}Mr.prototype.clear=Vl,Mr.prototype.delete=Jl,Mr.prototype.get=zl,Mr.prototype.has=Zl,Mr.prototype.set=Xl;function Fr(p){this.__data__=new Ut(p)}function Ql(){this.__data__=new Ut}function eh(p){return this.__data__.delete(p)}function th(p){return this.__data__.get(p)}function rh(p){return this.__data__.has(p)}function nh(p,w){var x=this.__data__;if(x instanceof Ut){var $=x.__data__;if(!vn||$.length<r-1)return $.push([p,w]),this;x=this.__data__=new Mr($)}return x.set(p,w),this}Fr.prototype.clear=Ql,Fr.prototype.delete=eh,Fr.prototype.get=th,Fr.prototype.has=rh,Fr.prototype.set=nh;function ih(p,w){var x=Ms(p)||xh(p)?it(p.length,String):[],$=x.length,Fe=!!$;for(var He in p)ee.call(p,He)&&!(Fe&&(He=="length"||Ah(He,$)))&&x.push(He);return x}function Wa(p,w,x){var $=p[w];(!(ee.call(p,w)&&qa($,x))||x===void 0&&!(w in p))&&(p[w]=x)}function oi(p,w){for(var x=p.length;x--;)if(qa(p[x][0],w))return x;return-1}function sh(p,w){return p&&ja(w,Fs(w),p)}function Ps(p,w,x,$,Fe,He,Bt){var qe;if($&&(qe=He?$(p,Fe,He,Bt):$(p)),qe!==void 0)return qe;if(!ui(p))return p;var Va=Ms(p);if(Va){if(qe=Eh(p),!w)return mh(p,qe)}else{var Ur=pr(p),Ja=Ur==c||Ur==d;if(Rh(p))return lh(p,w);if(Ur==S||Ur==i||Ja&&!He){if(si(p))return He?p:{};if(qe=bh(Ja?{}:p),!w)return vh(p,sh(qe,p))}else{if(!U[Ur])return He?p:{};qe=Sh(p,Ur,Ps,w)}}Bt||(Bt=new Fr);var za=Bt.get(p);if(za)return za;if(Bt.set(p,qe),!Va)var Za=x?wh(p):Fs(p);return xs(Za||p,function(Ls,ci){Za&&(ci=Ls,Ls=p[ci]),Wa(qe,ci,Ps(Ls,w,x,$,ci,p,Bt))}),qe}function oh(p){return ui(p)?xl(p):{}}function ah(p,w,x){var $=w(p);return Ms(p)?$:ii($,x(p))}function uh(p){return Ae.call(p)}function ch(p){if(!ui(p)||Th(p))return!1;var w=Ka(p)||si(p)?ge:$e;return w.test(yr(p))}function fh(p){if(!Ha(p))return Cl(p);var w=[];for(var x in Object(p))ee.call(p,x)&&x!="constructor"&&w.push(x);return w}function lh(p,w){if(w)return p.slice();var x=new p.constructor(p.length);return p.copy(x),x}function ks(p){var w=new p.constructor(p.byteLength);return new mn(w).set(new mn(p)),w}function hh(p,w){var x=w?ks(p.buffer):p.buffer;return new p.constructor(x,p.byteOffset,p.byteLength)}function dh(p,w,x){var $=w?x(y(p),!0):y(p);return lr($,yn,new p.constructor)}function ph(p){var w=new p.constructor(p.source,fe.exec(p));return w.lastIndex=p.lastIndex,w}function yh(p,w,x){var $=w?x(l(p),!0):l(p);return lr($,Os,new p.constructor)}function gh(p){return $a?Object($a.call(p)):{}}function _h(p,w){var x=w?ks(p.buffer):p.buffer;return new p.constructor(x,p.byteOffset,p.length)}function mh(p,w){var x=-1,$=p.length;for(w||(w=Array($));++x<$;)w[x]=p[x];return w}function ja(p,w,x,$){x||(x={});for(var Fe=-1,He=w.length;++Fe<He;){var Bt=w[Fe],qe=void 0;Wa(x,Bt,qe===void 0?p[Bt]:qe)}return x}function vh(p,w){return ja(p,Ya(p),w)}function wh(p){return ah(p,Fs,Ya)}function ai(p,w){var x=p.__data__;return Ih(w)?x[typeof w=="string"?"string":"hash"]:x.map}function Lr(p,w){var x=gn(p,w);return ch(x)?x:void 0}var Ya=Ua?f(Ua,Object):Ph,pr=uh;(Ns&&pr(new Ns(new ArrayBuffer(1)))!=P||vn&&pr(new vn)!=_||Rs&&pr(Rs.resolve())!=b||Ds&&pr(new Ds)!=I||Cs&&pr(new Cs)!=T)&&(pr=function(p){var w=Ae.call(p),x=w==S?p.constructor:void 0,$=x?yr(x):void 0;if($)switch($){case Pl:return P;case kl:return _;case Ml:return b;case Fl:return I;case Ll:return T}return w});function Eh(p){var w=p.length,x=p.constructor(w);return w&&typeof p[0]=="string"&&ee.call(p,"index")&&(x.index=p.index,x.input=p.input),x}function bh(p){return typeof p.constructor=="function"&&!Ha(p)?oh(Ol(p)):{}}function Sh(p,w,x,$){var Fe=p.constructor;switch(w){case M:return ks(p);case u:case h:return new Fe(+p);case P:return hh(p,$);case B:case G:case z:case Se:case ye:case ve:case ne:case Me:case Be:return _h(p,$);case _:return dh(p,$,x);case m:case E:return new Fe(p);case A:return ph(p);case I:return yh(p,$,x);case O:return gh(p)}}function Ah(p,w){return w=w??s,!!w&&(typeof p=="number"||Q.test(p))&&p>-1&&p%1==0&&p<w}function Ih(p){var w=typeof p;return w=="string"||w=="number"||w=="symbol"||w=="boolean"?p!=="__proto__":p===null}function Th(p){return!!V&&V in p}function Ha(p){var w=p&&p.constructor,x=typeof w=="function"&&w.prototype||N;return p===x}function yr(p){if(p!=null){try{return se.call(p)}catch{}try{return p+""}catch{}}return""}function Oh(p){return Ps(p,!0,!0)}function qa(p,w){return p===w||p!==p&&w!==w}function xh(p){return Nh(p)&&ee.call(p,"callee")&&(!Nl.call(p,"callee")||Ae.call(p)==i)}var Ms=Array.isArray;function Ga(p){return p!=null&&Dh(p.length)&&!Ka(p)}function Nh(p){return Ch(p)&&Ga(p)}var Rh=Dl||kh;function Ka(p){var w=ui(p)?Ae.call(p):"";return w==c||w==d}function Dh(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=s}function ui(p){var w=typeof p;return!!p&&(w=="object"||w=="function")}function Ch(p){return!!p&&typeof p=="object"}function Fs(p){return Ga(p)?ih(p):fh(p)}function Ph(){return[]}function kh(){return!1}e.exports=Oh})(Ji,Ji.exports);var x1=Ji.exports;const N1=zo(x1);function Zr(e){return e===void 0&&(e=""),(e?e+"_":"")+ +new Date+"_"+Math.random()}var R1=function(){function e(t){this.close=t.close,this.onChange=t.onChange,this.onError=t.onError,t.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return t.virtualClient}})}return e}(),cc=function(){function e(t){var r=t.id,n=t.docChanges,s=t.docs,i=t.msgType,o=t.type,u,h;Object.defineProperties(this,{id:{get:function(){return r},enumerable:!0},docChanges:{get:function(){return u||(u=JSON.parse(JSON.stringify(n))),u},enumerable:!0},docs:{get:function(){return h||(h=JSON.parse(JSON.stringify(s))),h},enumerable:!0},msgType:{get:function(){return i},enumerable:!0},type:{get:function(){return o},enumerable:!0}})}return e}(),Is=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),D1=function(e){Is(t,e);function t(r){var n=e.call(this,"Watch Error "+JSON.stringify(r.msgData)+" (requestid: "+r.requestId+")")||this;return n.isRealtimeErrorMessageError=!0,n.payload=r,n}return t}(Error),fc=function(e){return e==null?void 0:e.isRealtimeErrorMessageError},C1=function(e){Is(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="timeout",r.payload=null,r.generic=!0,r}return t}(Error),P1=function(e){return e.type==="timeout"},k1=function(e){Is(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cancelled",r.payload=null,r.generic=!0,r}return t}(Error),M1=function(e){return e.type==="cancelled"},ft=function(e){Is(t,e);function t(r){var n=e.call(this,r.errMsg)||this;return n.errCode="UNKNOWN_ERROR",Object.defineProperties(n,{message:{get:function(){return"errCode: "+this.errCode+" "+(Ve[this.errCode]||"")+" | errMsg: "+this.errMsg},set:function(s){this.errMsg=s}}}),n.errCode=r.errCode||"UNKNOWN_ERROR",n.errMsg=r.errMsg,n}return Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: "+this.errCode+" | errMsg: "+this.errMsg},set:function(r){this.errMsg=r},enumerable:!1,configurable:!0}),t}(Error),Ve={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"},Jo=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})},ze=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Ge=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},lc=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,s++)n[s]=i[o];return n},le;(function(e){e.LOGGINGIN="LOGGINGIN",e.INITING="INITING",e.REBUILDING="REBUILDING",e.ACTIVE="ACTIVE",e.ERRORED="ERRORED",e.CLOSING="CLOSING",e.CLOSED="CLOSED",e.PAUSED="PAUSED",e.RESUMING="RESUMING"})(le||(le={}));var F1=100,Ai=2,L1=2,U1=10*1e3,B1=10*1e3,$1=10*1e3,W1=function(){function e(t){var r=this;this.watchStatus=le.INITING,this._login=function(n,s){return ze(r,void 0,void 0,function(){var i;return Ge(this,function(o){switch(o.label){case 0:return this.watchStatus=le.LOGGINGIN,[4,this.login(n,s)];case 1:return i=o.sent(),this.envId||(this.envId=i.envId),[2,i]}})})},this.initWatch=function(n){return ze(r,void 0,void 0,function(){var s,i=this;return Ge(this,function(o){switch(o.label){case 0:if(this._initWatchPromise)return[2,this._initWatchPromise];this._initWatchPromise=new Promise(function(u,h){return ze(i,void 0,void 0,function(){var a,c,d,_,m,S,b,A,I,E,O;return Ge(this,function(T){switch(T.label){case 0:return T.trys.push([0,3,,4]),this.watchStatus===le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):[4,this._login(this.envId,n)];case 1:return a=T.sent().envId,this.watchStatus===le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):(this.watchStatus=le.INITING,c={watchId:this.watchId,requestId:Zr(),msgType:"INIT_WATCH",msgData:{envId:a,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!0,timeout:B1})]);case 2:if(d=T.sent(),_=d.msgData,m=_.events,S=_.currEvent,this.sessionInfo={queryID:d.msgData.queryID,currentEventId:S-1,currentDocs:[]},m.length>0){for(b=0,A=m;b<A.length;b++)I=A[b],I.ID=S;this.handleServerEvents(d)}else this.sessionInfo.currentEventId=S,E=new cc({id:S,docChanges:[],docs:[],type:"init"}),this.listener.onChange(E),this.scheduleSendACK();return this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=le.ACTIVE,this._availableRetries.INIT_WATCH=Ai,u(),[3,4];case 3:return O=T.sent(),this.handleWatchEstablishmentError(O,{operationName:"INIT_WATCH",resolve:u,reject:h}),[3,4];case 4:return[2]}})})}),s=!1,o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this._initWatchPromise];case 2:return o.sent(),s=!0,[3,4];case 3:return this._initWatchPromise=void 0,[7];case 4:return console.log("[realtime] initWatch "+(s?"success":"fail")),[2]}})})},this.rebuildWatch=function(n){return ze(r,void 0,void 0,function(){var s,i=this;return Ge(this,function(o){switch(o.label){case 0:if(this._rebuildWatchPromise)return[2,this._rebuildWatchPromise];this._rebuildWatchPromise=new Promise(function(u,h){return ze(i,void 0,void 0,function(){var a,c,d,_;return Ge(this,function(m){switch(m.label){case 0:return m.trys.push([0,3,,4]),this.watchStatus===le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):[4,this._login(this.envId,n)];case 1:if(a=m.sent().envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");return this.watchStatus===le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):(this.watchStatus=le.REBUILDING,c={watchId:this.watchId,requestId:Zr(),msgType:"REBUILD_WATCH",msgData:{envId:a,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!1,timeout:$1})]);case 2:return d=m.sent(),this.handleServerEvents(d),this.watchStatus=le.ACTIVE,this._availableRetries.REBUILD_WATCH=Ai,u(),[3,4];case 3:return _=m.sent(),this.handleWatchEstablishmentError(_,{operationName:"REBUILD_WATCH",resolve:u,reject:h}),[3,4];case 4:return[2]}})})}),s=!1,o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this._rebuildWatchPromise];case 2:return o.sent(),s=!0,[3,4];case 3:return this._rebuildWatchPromise=void 0,[7];case 4:return console.log("[realtime] rebuildWatch "+(s?"success":"fail")),[2]}})})},this.handleWatchEstablishmentError=function(n,s){return ze(r,void 0,void 0,function(){var i,o,u,h=this;return Ge(this,function(a){return i=s.operationName==="INIT_WATCH",o=function(){h.closeWithError(new ft({errCode:i?Ve.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:Ve.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:n})),s.reject(n)},u=function(c){h.useRetryTicket(s.operationName)?i?(h._initWatchPromise=void 0,s.resolve(h.initWatch(c))):(h._rebuildWatchPromise=void 0,s.resolve(h.rebuildWatch(c))):o()},this.handleCommonError(n,{onSignError:function(){return u(!0)},onTimeoutError:function(){return u(!1)},onNotRetryableError:o,onCancelledError:s.reject,onUnknownError:function(){return ze(h,void 0,void 0,function(){var c,d=this;return Ge(this,function(_){switch(_.label){case 0:return _.trys.push([0,8,,9]),c=function(){return ze(d,void 0,void 0,function(){return Ge(this,function(m){switch(m.label){case 0:return this.pause(),[4,this.onceWSConnected()];case 1:return m.sent(),u(!0),[2]}})})},this.isWSConnected()?[3,2]:[4,c()];case 1:return _.sent(),[3,7];case 2:return[4,Jo(F1)];case 3:return _.sent(),this.watchStatus!==le.PAUSED?[3,4]:(s.reject(new k1(s.operationName+" cancelled due to pause after unknownError")),[3,7]);case 4:return this.isWSConnected()?[3,6]:[4,c()];case 5:return _.sent(),[3,7];case 6:u(!1),_.label=7;case 7:return[3,9];case 8:return _.sent(),u(!0),[3,9];case 9:return[2]}})})}}),[2]})})},this.closeWatch=function(){return ze(r,void 0,void 0,function(){var n,s,i;return Ge(this,function(o){switch(o.label){case 0:if(n=this.sessionInfo?this.sessionInfo.queryID:"",this.watchStatus!==le.ACTIVE)return this.watchStatus=le.CLOSED,this.onWatchClose(this,n),[2];o.label=1;case 1:return o.trys.push([1,3,4,5]),this.watchStatus=le.CLOSING,s={watchId:this.watchId,requestId:Zr(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:s})];case 2:return o.sent(),this.sessionInfo=void 0,this.watchStatus=le.CLOSED,[3,5];case 3:return i=o.sent(),this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:i})),[3,5];case 4:return this.onWatchClose(this,n),[7];case 5:return[2]}})})},this.scheduleSendACK=function(){r.clearACKSchedule(),r._ackTimeoutId=setTimeout(function(){r._waitExpectedTimeoutId?r.scheduleSendACK():r.sendACK()},U1)},this.clearACKSchedule=function(){r._ackTimeoutId&&clearTimeout(r._ackTimeoutId)},this.sendACK=function(){return ze(r,void 0,void 0,function(){var n,s,i;return Ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.watchStatus!==le.ACTIVE?(this.scheduleSendACK(),[2]):this.sessionInfo?(n={watchId:this.watchId,requestId:Zr(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:n})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return o.sent(),this.scheduleSendACK(),[3,3];case 2:if(s=o.sent(),fc(s))switch(i=s.payload,i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this.rebuildWatch(),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:i.msgData.code})),[2]}return this._availableRetries.CHECK_LAST&&this._availableRetries.CHECK_LAST>0?(this._availableRetries.CHECK_LAST--,this.scheduleSendACK()):this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:s})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(n,s){if(fc(n)){var i=n.payload;switch(i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":{s.onSignError(n);return}case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":{s.onNotRetryableError(n);return}default:{s.onNotRetryableError(n);return}}}else if(P1(n)){s.onTimeoutError(n);return}else if(M1(n)){s.onCancelledError(n);return}s.onUnknownError(n)},this.watchId="watchid_"+ +new Date+"_"+Math.random(),this.envId=t.envId,this.collectionName=t.collectionName,this.query=t.query,this.limit=t.limit,this.orderBy=t.orderBy,this.send=t.send,this.login=t.login,this.isWSConnected=t.isWSConnected,this.onceWSConnected=t.onceWSConnected,this.getWaitExpectedTimeoutLength=t.getWaitExpectedTimeoutLength,this.onWatchStart=t.onWatchStart,this.onWatchClose=t.onWatchClose,this.debug=t.debug,this._availableRetries={INIT_WATCH:Ai,REBUILD_WATCH:Ai,CHECK_LAST:L1},this.listener=new R1({close:this.closeWatch,onChange:t.onChange,onError:t.onError,debug:this.debug,virtualClient:this}),this.initWatch()}return e.prototype.onMessage=function(t){var r=this;switch(this.watchStatus){case le.PAUSED:{if(t.msgType!=="ERROR")return;break}case le.LOGGINGIN:case le.INITING:case le.REBUILDING:{console.warn("[realtime listener] internal non-fatal error: unexpected message received while "+this.watchStatus);return}case le.CLOSED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");return}case le.ERRORED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error");return}}if(!this.sessionInfo){console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.");return}switch(this.scheduleSendACK(),t.msgType){case"NEXT_EVENT":{console.warn("nextevent "+t.msgData.currEvent+" ignored",t),this.handleServerEvents(t);break}case"CHECK_EVENT":{this.sessionInfo.currentEventId<t.msgData.currEvent&&(this.sessionInfo.expectEventId=t.msgData.currEvent,this.clearWaitExpectedEvent(),this._waitExpectedTimeoutId=setTimeout(function(){r.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log("[realtime] waitExpectedTimeoutLength "+this.getWaitExpectedTimeoutLength()));break}case"ERROR":{this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:t.msgData.code+" - "+t.msgData.message}));break}default:{console.warn("[realtime listener] virtual client receive unexpected msg "+t.msgType+": ",t);break}}},e.prototype.closeWithError=function(t){this.watchStatus=le.ERRORED,this.clearACKSchedule(),this.listener.onError(t),this.onWatchClose(this,this.sessionInfo&&this.sessionInfo.queryID||""),console.log("[realtime] client closed ("+this.collectionName+" "+this.query+") (watchId "+this.watchId+")")},e.prototype.pause=function(){this.watchStatus=le.PAUSED,console.log("[realtime] client paused ("+this.collectionName+" "+this.query+") (watchId "+this.watchId+")")},e.prototype.resume=function(){return ze(this,void 0,void 0,function(){var t;return Ge(this,function(r){switch(r.label){case 0:this.watchStatus=le.RESUMING,console.log("[realtime] client resuming with "+(this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH")+" ("+this.collectionName+" "+this.query+") ("+this.watchId+")"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.sessionInfo?this.rebuildWatch():this.initWatch()];case 2:return r.sent(),console.log("[realtime] client successfully resumed ("+this.collectionName+" "+this.query+") ("+this.watchId+")"),[3,4];case 3:return t=r.sent(),console.error("[realtime] client resume failed ("+this.collectionName+" "+this.query+") ("+this.watchId+")",t),[3,4];case 4:return[2]}})})},e.prototype.useRetryTicket=function(t){return this._availableRetries[t]&&this._availableRetries[t]>0?(this._availableRetries[t]--,console.log("[realtime] "+t+" use a retry ticket, now only "+this._availableRetries[t]+" retry left"),!0):!1},e.prototype.handleServerEvents=function(t){return ze(this,void 0,void 0,function(){var r;return Ge(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this._handleServerEvents(t)];case 1:return n.sent(),this._postHandleServerEventsValidityCheck(t),[3,3];case 2:throw r=n.sent(),console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",r),r;case 3:return[2]}})})},e.prototype._handleServerEvents=function(t){return ze(this,void 0,void 0,function(){var r,n,s,i,o,u,h,a,c,d,_,m;return Ge(this,function(S){switch(S.label){case 0:if(r=t.requestId,n=t.msgData.events,s=t.msgType,!n.length||!this.sessionInfo)return[2];i=this.sessionInfo;try{o=n.map(j1)}catch(b){return this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:b})),[2]}u=lc(i.currentDocs),h=!1,a=function(b,A){var I,E,P,M,O,T,M,B,B,P,P,B,G,G,z,Se,ye;return Ge(this,function(ve){switch(ve.label){case 0:return I=o[b],i.currentEventId>=I.id?(!o[b-1]||I.id>o[b-1].id?console.warn("[realtime] duplicate event received, cur "+i.currentEventId+" but got "+I.id):console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId "+r+")"),[2,"continue"]):[3,1];case 1:if(i.currentEventId!==I.id-1)return[3,2];switch(I.dataType){case"update":{if(!I.doc)switch(I.queueType){case"update":case"dequeue":{if(E=u.find(function(ne){return ne._id===I.docId}),E){if(P=N1(E),I.updatedFields)for(M in I.updatedFields)xE(P,M,I.updatedFields[M]);if(I.removedFields)for(O=0,T=I.removedFields;O<T.length;O++)M=T[O],O1(P,M);I.doc=P}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break}case"enqueue":throw B=new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '+t.requestId+")"}),c.closeWithError(B),B}break}case"replace":{if(!I.doc)throw B=new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '+t.requestId+")"}),c.closeWithError(B),B;break}case"remove":{P=u.find(function(ne){return ne._id===I.docId}),P?I.doc=P:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break}case"limit":{if(!I.doc)switch(I.queueType){case"dequeue":{P=u.find(function(ne){return ne._id===I.docId}),P?I.doc=P:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType event where no doc is associated.");break}case"enqueue":throw B=new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="limit" and queueType="enqueue" (requestId '+t.requestId+")"}),c.closeWithError(B),B}break}}switch(I.queueType){case"init":{h?u.push(I.doc):(h=!0,u=[I.doc]);break}case"enqueue":{u.push(I.doc);break}case"dequeue":{G=u.findIndex(function(ne){return ne._id===I.docId}),G>-1?u.splice(G,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break}case"update":{G=u.findIndex(function(ne){return ne._id===I.docId}),G>-1?u[G]=I.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.");break}}return(b===A-1||o[b+1]&&o[b+1].id!==I.id)&&(z=lc(u),Se=o.slice(0,b+1).filter(function(ne){return ne.id===I.id}),c.sessionInfo.currentEventId=I.id,c.sessionInfo.currentDocs=u,ye=new cc({id:I.id,docChanges:Se,docs:z,msgType:s}),c.listener.onChange(ye)),[3,4];case 2:return console.warn("[realtime listener] event received is out of order, cur "+c.sessionInfo.currentEventId+" but got "+I.id),[4,c.rebuildWatch()];case 3:return ve.sent(),[2,{value:void 0}];case 4:return[2]}})},c=this,d=0,_=o.length,S.label=1;case 1:return d<_?[5,a(d,_)]:[3,4];case 2:if(m=S.sent(),typeof m=="object")return[2,m.value];S.label=3;case 3:return d++,[3,1];case 4:return[2]}})})},e.prototype._postHandleServerEventsValidityCheck=function(t){if(!this.sessionInfo){console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur");return}if(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<t.msgData.currEvent){console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling");return}},e.prototype.clearWaitExpectedEvent=function(){this._waitExpectedTimeoutId&&(clearTimeout(this._waitExpectedTimeoutId),this._waitExpectedTimeoutId=void 0)},e}();function j1(e){var t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&e.Doc!=="{}"?JSON.parse(e.Doc):void 0};return e.DataType==="update"&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=JSON.parse(e.removedFields))),t}var Al={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}},ut;(function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.GoingAway=1001]="GoingAway",e[e.ProtocolError=1002]="ProtocolError",e[e.UnsupportedData=1003]="UnsupportedData",e[e.NoStatusReceived=1005]="NoStatusReceived",e[e.AbnormalClosure=1006]="AbnormalClosure",e[e.InvalidFramePayloadData=1007]="InvalidFramePayloadData",e[e.PolicyViolation=1008]="PolicyViolation",e[e.MessageTooBig=1009]="MessageTooBig",e[e.MissingExtension=1010]="MissingExtension",e[e.InternalError=1011]="InternalError",e[e.ServiceRestart=1012]="ServiceRestart",e[e.TryAgainLater=1013]="TryAgainLater",e[e.BadGateway=1014]="BadGateway",e[e.TLSHandshake=1015]="TLSHandshake",e[e.ReconnectWebSocket=3e3]="ReconnectWebSocket",e[e.NoRealtimeListeners=3001]="NoRealtimeListeners",e[e.HeartbeatPingError=3002]="HeartbeatPingError",e[e.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",e[e.NoAuthentication=3050]="NoAuthentication"})(ut||(ut={}));var To=function(e,t){var r=Al[e],n=r?r.name+", code "+e+", reason "+(t||r.description):"code "+e;return new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:n})},Il=null,Tl="web";function Y1(){return Il}function H1(e){Il=e}function hc(){return Tl}function q1(e){Tl=e}var zi=function(){return zi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},zi.apply(this,arguments)},_t=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},mt=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Oo={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},dc=3,G1=5e3,K1=1e4,V1=5,J1=1e4,z1=2,Z1=2,X1=5e3,Q1=function(){function e(t){var r=this;this._virtualWSClient=new Set,this._queryIdClientMap=new Map,this._watchIdClientMap=new Map,this._pingFailed=0,this._pongMissed=0,this._logins=new Map,this._wsReadySubsribers=[],this._wsResponseWait=new Map,this._rttObserved=[],this.send=function(n){return _t(r,void 0,void 0,function(){var s=this;return mt(this,function(i){return[2,new Promise(function(o,u){return _t(s,void 0,void 0,function(){var h,a,c,d,_,m,S,b=this;return mt(this,function(A){switch(A.label){case 0:a=!1,c=!1,d=function(I){a=!0,h&&clearTimeout(h),o(I)},_=function(I){c=!0,h&&clearTimeout(h),u(I)},n.timeout&&(h=setTimeout(function(){return _t(b,void 0,void 0,function(){return mt(this,function(I){switch(I.label){case 0:return!a||!c?[4,Jo(0)]:[3,2];case 1:I.sent(),(!a||!c)&&_(new C1("wsclient.send timedout")),I.label=2;case 2:return[2]}})})},n.timeout)),A.label=1;case 1:return A.trys.push([1,8,,9]),this._wsInitPromise?[4,this._wsInitPromise]:[3,3];case 2:A.sent(),A.label=3;case 3:if(!this._ws)return _(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this._ws.readyState!==Oo.OPEN)return _(new Error("ws readyState invalid: "+this._ws.readyState+", can not send message")),[2];n.waitResponse&&this._wsResponseWait.set(n.msg.requestId,{resolve:d,reject:_,skipOnMessage:n.skipOnMessage}),A.label=4;case 4:return A.trys.push([4,6,,7]),[4,this._ws.send(JSON.stringify(n.msg))];case 5:return A.sent(),n.waitResponse||d(),[3,7];case 6:return m=A.sent(),m&&(_(m),n.waitResponse&&this._wsResponseWait.delete(n.msg.requestId)),[3,7];case 7:return[3,9];case 8:return S=A.sent(),_(S),[3,9];case 9:return[2]}})})})]})})},this.closeAllClients=function(n){r._virtualWSClient.forEach(function(s){s.closeWithError(n)})},this.pauseClients=function(n){(n||r._virtualWSClient).forEach(function(s){s.pause()})},this.resumeClients=function(n){(n||r._virtualWSClient).forEach(function(s){s.resume()})},this.initWebSocketConnection=function(n,s){return s===void 0&&(s=r._maxReconnect),_t(r,void 0,void 0,function(){var i=this;return mt(this,function(o){switch(o.label){case 0:if(n&&this._reconnectState)return[2];if(n&&(this._reconnectState=!0),this._wsInitPromise)return[2,this._wsInitPromise];n&&this.pauseClients(),this.close(ut.ReconnectWebSocket),this._wsInitPromise=new Promise(function(u,h){return _t(i,void 0,void 0,function(){var a,c,d,_=this;return mt(this,function(m){switch(m.label){case 0:return m.trys.push([0,6,,11]),[4,this.getWsSign()];case 1:return a=m.sent(),[4,new Promise(function(S){var b=a.wsUrl||"wss://tcb-ws.tencentcloudapi.com",A=Y1();_._ws=A?new A(b):new WebSocket(b),S()})];case 2:return m.sent(),this._ws.connect?[4,this._ws.connect()]:[3,4];case 3:m.sent(),m.label=4;case 4:return[4,this.initWebSocketEvent()];case 5:return m.sent(),u(),n&&(this.resumeClients(),this._reconnectState=!1),[3,11];case 6:return c=m.sent(),console.error("[realtime] initWebSocketConnection connect fail",c),s>0?(d=!0,this._wsInitPromise=void 0,d?[4,Jo(this._reconnectInterval)]:[3,8]):[3,9];case 7:m.sent(),n&&(this._reconnectState=!1),m.label=8;case 8:return u(this.initWebSocketConnection(n,s-1)),[3,10];case 9:h(c),n&&this.closeAllClients(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:c})),m.label=10;case 10:return[3,11];case 11:return[2]}})})}),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this._wsInitPromise];case 2:return o.sent(),this._wsReadySubsribers.forEach(function(u){var h=u.resolve;return h()}),[3,5];case 3:return o.sent(),this._wsReadySubsribers.forEach(function(u){var h=u.reject;return h()}),[3,5];case 4:return this._wsInitPromise=void 0,this._wsReadySubsribers=[],[7];case 5:return[2]}})})},this.initWebSocketEvent=function(){return new Promise(function(n,s){if(!r._ws)throw new Error("can not initWebSocketEvent, ws not exists");var i=!1;r._ws.onopen=function(o){console.warn("[realtime] ws event: open",o),i=!0,n()},r._ws.onerror=function(o){r._logins=new Map,i?(console.error("[realtime] ws event: error",o),r.clearHeartbeat(),r._virtualWSClient.forEach(function(u){return u.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:o}))})):(console.error("[realtime] ws open failed with ws event: error",o),s(o))},r._ws.onclose=function(o){switch(console.warn("[realtime] ws event: close",o),r._logins=new Map,r.clearHeartbeat(),o.code){case ut.ReconnectWebSocket:break;case ut.NoRealtimeListeners:break;case ut.HeartbeatPingError:case ut.HeartbeatPongTimeoutError:case ut.NormalClosure:case ut.AbnormalClosure:{r._maxReconnect>0?r.initWebSocketConnection(!0,r._maxReconnect):r.closeAllClients(To(o.code));break}case ut.NoAuthentication:{r.closeAllClients(To(o.code,o.reason));break}default:r._maxReconnect>0?r.initWebSocketConnection(!0,r._maxReconnect):r.closeAllClients(To(o.code))}},r._ws.onmessage=function(o){var u=o.data;r.heartbeat();var h;try{h=JSON.parse(u)}catch(I){throw new Error("[realtime] onMessage parse res.data error: "+I)}if(h.msgType==="ERROR"){var a=null;r._virtualWSClient.forEach(function(I){I.watchId===h.watchId&&(a=I)}),a&&a.listener.onError(h)}var c=r._wsResponseWait.get(h.requestId);if(c){try{h.msgType==="ERROR"?c.reject(new D1(h)):c.resolve(h)}catch(I){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",I)}finally{r._wsResponseWait.delete(h.requestId)}if(c.skipOnMessage)return}if(h.msgType==="PONG"){if(r._lastPingSendTS){var d=Date.now()-r._lastPingSendTS;if(d>K1){console.warn("[realtime] untrusted rtt observed: "+d);return}r._rttObserved.length>=dc&&r._rttObserved.splice(0,r._rttObserved.length-dc+1),r._rttObserved.push(d)}return}var _=h.watchId&&r._watchIdClientMap.get(h.watchId);if(_)_.onMessage(h);else switch(console.error("[realtime] no realtime listener found responsible for watchId "+h.watchId+": ",h),h.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":{_=r._queryIdClientMap.get(h.msgData.queryID),_&&_.onMessage(h);break}default:for(var m=0,S=Array.from(r._watchIdClientMap.entries());m<S.length;m++){var b=S[m],A=b[1];A.onMessage(h);break}}},r.heartbeat()})},this.isWSConnected=function(){return!!(r._ws&&r._ws.readyState===Oo.OPEN)},this.onceWSConnected=function(){return _t(r,void 0,void 0,function(){var n=this;return mt(this,function(s){return this.isWSConnected()?[2]:this._wsInitPromise?[2,this._wsInitPromise]:[2,new Promise(function(i,o){n._wsReadySubsribers.push({resolve:i,reject:o})})]})})},this.webLogin=function(n,s){return _t(r,void 0,void 0,function(){var i,o,u,h,a,c,d,_,m=this;return mt(this,function(S){switch(S.label){case 0:if(!s){if(n){if(i=this._logins.get(n),i){if(i.loggedIn&&i.loginResult)return[2,i.loginResult];if(i.loggingInPromise)return[2,i.loggingInPromise]}}else if(o=this._logins.get(""),o!=null&&o.loggingInPromise)return[2,o.loggingInPromise]}u=new Promise(function(b,A){return _t(m,void 0,void 0,function(){var I,E,O,T,M;return mt(this,function(P){switch(P.label){case 0:return P.trys.push([0,3,,4]),[4,this.getWsSign()];case 1:return I=P.sent(),E={envId:I.envId||"",accessToken:"",referrer:"web",sdkVersion:"",dataVersion:""},O={watchId:void 0,requestId:Zr(),msgType:"LOGIN",msgData:E,exMsgData:{runtime:hc(),signStr:I.signStr,secretVersion:I.secretVersion}},[4,this.send({msg:O,waitResponse:!0,skipOnMessage:!0,timeout:X1})];case 2:return T=P.sent(),T.msgData.code?A(new Error(T.msgData.code+" "+T.msgData.message)):b({envId:I.envId}),[3,4];case 3:return M=P.sent(),A(M),[3,4];case 4:return[2]}})})}),h=n&&this._logins.get(n),a=Date.now(),h?(h.loggedIn=!1,h.loggingInPromise=u,h.loginStartTS=a):(h={loggedIn:!1,loggingInPromise:u,loginStartTS:a},this._logins.set(n||"",h)),S.label=1;case 1:return S.trys.push([1,3,,4]),[4,u];case 2:if(c=S.sent(),d=n&&this._logins.get(n),d&&d===h&&d.loginStartTS===a)return h.loggedIn=!0,h.loggingInPromise=void 0,h.loginStartTS=void 0,h.loginResult=c,[2,c];if(d){if(d.loggedIn&&d.loginResult)return[2,d.loginResult];if(d.loggingInPromise)return[2,d.loggingInPromise];throw new Error("ws unexpected login info")}else throw new Error("ws login info reset");case 3:throw _=S.sent(),h.loggedIn=!1,h.loggingInPromise=void 0,h.loginStartTS=void 0,h.loginResult=void 0,_;case 4:return[2]}})})},this.getWsSign=function(){return _t(r,void 0,void 0,function(){var n,s,i,o,u,h,a;return mt(this,function(c){switch(c.label){case 0:return this._wsSign&&this._wsSign.expiredTs>Date.now()?[2,this._wsSign]:(n=Date.now()+6e4,[4,this._context.appConfig.request.send("auth.wsWebSign",{runtime:hc()})]);case 1:if(s=c.sent(),s.code)throw new Error("[tcb-js-sdk] : "+s.code);if(s.data)return i=s.data,o=i.signStr,u=i.wsUrl,h=i.secretVersion,a=i.envId,[2,{signStr:o,wsUrl:u,secretVersion:h,envId:a,expiredTs:n}];throw new Error("[tcb-js-sdk] ")}})})},this.getWaitExpectedTimeoutLength=function(){return r._rttObserved.length?r._rttObserved.reduce(function(n,s){return n+s})/r._rttObserved.length*1.5:G1},this.ping=function(){return _t(r,void 0,void 0,function(){var n;return mt(this,function(s){switch(s.label){case 0:return n={watchId:void 0,requestId:Zr(),msgType:"PING",msgData:null},[4,this.send({msg:n})];case 1:return s.sent(),[2]}})})},this.onWatchStart=function(n,s){r._queryIdClientMap.set(s,n)},this.onWatchClose=function(n,s){s&&r._queryIdClientMap.delete(s),r._watchIdClientMap.delete(n.watchId),r._virtualWSClient.delete(n),r._virtualWSClient.size||r.close(ut.NoRealtimeListeners)},this._maxReconnect=t.maxReconnect||V1,this._reconnectInterval=t.reconnectInterval||J1,this._context=t.context}return e.prototype.clearHeartbeat=function(){this._pingTimeoutId&&clearTimeout(this._pingTimeoutId),this._pongTimeoutId&&clearTimeout(this._pongTimeoutId)},e.prototype.close=function(t){this.clearHeartbeat(),this._ws&&(this._ws.close(t,Al[t].name),this._ws=void 0)},e.prototype.watch=function(t){!this._ws&&!this._wsInitPromise&&this.initWebSocketConnection(!1);var r=new W1(zi(zi({},t),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this._virtualWSClient.add(r),this._watchIdClientMap.set(r.watchId,r),r.listener},e.prototype.heartbeat=function(t){var r=this;this.clearHeartbeat(),this._pingTimeoutId=setTimeout(function(){return _t(r,void 0,void 0,function(){var n=this;return mt(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),!this._ws||this._ws.readyState!==Oo.OPEN?[2]:(this._lastPingSendTS=Date.now(),[4,this.ping()]);case 1:return s.sent(),this._pingFailed=0,this._pongTimeoutId=setTimeout(function(){console.error("pong timed out"),n._pongMissed<Z1?(n._pongMissed++,n.heartbeat(!0)):n.initWebSocketConnection(!0)},this._context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return s.sent(),this._pingFailed<z1?(this._pingFailed++,this.heartbeat()):this.close(ut.HeartbeatPingError),[3,3];case 3:return[2]}})})},t?0:this._context.appConfig.realtimePingInterval)},e}(),eb={target:"database",entity:function(){var e=this.platform,t=e.adapter,r=e.runtime;H1(t.wsClass),q1(r)}},tb={name:"realtime",IIFE:!0,entity:function(){this.prototype.wsClientClass=Q1}};try{cloudbase.registerComponent(tb),cloudbase.registerHook(eb)}catch{}const rb="walle-quant-website-2cg83b3402af",Ii="pms",La=on.init({env:rb}),Ti=La.database(),xo=La.auth();class nb{async login(){return xo.anonymousAuthProvider().signIn()}hasLoginState(){return xo.hasLoginState()}uid(){return void 0||xo.currentUser.uid}}class ib{create({uid:t="",order:r={},key:n=""}){return Ti.collection(Ii).add({uid:t,order:r,key:n})}query(t){return Ti.collection(Ii).where({uid:t}).get()}delete(t){return Ti.collection(Ii).where({uid:t}).delete()}watch(t,r=()=>{},n=()=>{}){return Ti.collection(Ii).where({uid:t}).watch({onChange:r,onError:n})}}class sb{async request(t="native",r){const n=async i=>await(await fetch(i,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json(),s=`xpms/${t}`;try{const i=location.hostname==="localhost"?`/s/${s}`:`https://s.one-quant.com/${s}`;return await n(i)}catch{const o=`https://walle-quant-website-2cg83b3402af-1256154226.ap-shanghai.app.tcloudbase.com/${s}`;return await n(o)}}async query(t){return this.request("query",{out_trade_no:t})}async native({amount:t,id:r,title:n,attach:s}){return this.request("native",{total_fee:t,out_trade_no:r,body:n,attach:s})}}const wr={app:La,user:new nb,db:new ib,pay:new sb},ob="/assets/wx-Bfv1OeoY.png",ab={props:["visible","price","title","message","messageTip","messageSucc","messageFail","orderTitle","orderAttach","orderPrefix"],components:{ElDialog:pc},data(){return{isVisible:this.$props.visible,isShowClose:!1,amount:0,order:{qrcode:"",out_trade_no:"",pay_order_id:""},elmessage:this.$props.message||jh}},mounted(){this.$props.visible&&this.payment(this.$props.price)},unmounted(){this.hide()},methods:{onbeforeunload(e){try{const t="  ";return typeof e>"u"&&(e=window.event),e&&(e.returnValue=t),t}catch{}},show(){this.isVisible=!0},hide(){this.isVisible=!1,this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.elmessage.closeAll(),window.removeEventListener("beforeunload",this.onbeforeunload)},async payment(e){if(e&&(this.amount=e),this.amount<=0){this.elmessage.info(""),this.$emit("fail");return}try{await wr.user.login();const t=wr.user.uid(),r=k().format("YYYYMMDD"),n=k().format("YYYYMMDD"),s=this.$props.orderPrefix||"9560",i=(this.$props.orderTitle?this.$props.orderTitle+" - ":"")+r.slice(4)+n.slice(4)+k().format("SSS"),o=this.$props.orderAttach||t,u=s+r+n+k().format("HHmmssSSSSSS"),h=+(this.amount*100).toFixed(),a=await wr.pay.native({title:i,amount:h,id:u,attach:o});if(!(a.return_code===1&&a.qrcode)){this.elmessage.info({message:" "}),this.$emit("fail");return}this.isVisible=!0,this.elmessage.closeAll(),this.elmessage.info({message:this.$props.messageTip||" ",duration:0}),window.addEventListener("beforeunload",this.onbeforeunload);const c=b=>b&&b.order&&b.order.out_trade_no==u?(this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.isVisible=!1,this.elmessage.closeAll(),this.elmessage.info({message:this.$props.messageSucc||""}),this.$emit("succ",b),!0):!1,d=await wr.db.query(t);(!d.data||!d.data.length)&&await wr.db.create({uid:t}),this.order=a;let _=50;this.intervalId=setInterval(async()=>{_--;const b=await wr.pay.query(this.order.pay_order_id);if(b&&+b.status==1){c({order:{out_trade_no:u,total_fee:h,status:b.status}});return}_===0&&(this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.elmessage.closeAll(),this.elmessage.info({message:this.$props.messageFail||" "}),this.$emit("fail"))},6*1e3);const m=b=>{b.msgType!=="INIT_EVENT"&&c(b.docs[0])},S=()=>{};this.watcher=wr.db.watch(t,m,S)}catch(t){try{window.__WALLE_GUARD&&window.__WALLE_GUARD.sendSecurityReport("pay|"+(t.message||"exception").toLowerCase(),t.stack||t)}catch{}}},async onClose(e){this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.elmessage.closeAll(),this.isVisible=!1,this.order={},e&&e()}}},ub={class:"tips"},cb={class:"qrcode"},fb={class:"img"},lb=["src"],hb={class:"price"},db=xt("span",{class:"icon-price"},"",-1),pb=xt("span",{class:"unit-price"},"",-1),yb={key:0},gb=xt("br",null,null,-1),_b={class:"footer"},mb=xt("img",{src:ob,width:"100",style:{"margin-top":"5px"}},null,-1),vb=xt("a",{class:"custom-wx"},"",-1);function wb(e,t,r,n,s,i){const o=$h,u=pc,h=Wh;return Us(),Fh(u,{class:"payment-dialog-9527",modelValue:s.isVisible,"onUpdate:modelValue":t[0]||(t[0]=a=>s.isVisible=a),modal:!1,"close-on-click-modal":!1,"destroy-on-close":!0,"before-close":i.onClose,"show-close":s.isShowClose},{default:Bs(()=>[Xa(e.$slots,"header"),xt("p",ub,$s(e.$props.title||""),1),xt("div",cb,[Lh((Us(),Qa("div",fb,[xt("img",{src:s.order.qrcode},null,8,lb)])),[[h,!s.order.qrcode]]),xt("h3",hb,[db,fi(" "+$s(s.amount)+" ",1),pb]),s.order.pay_order_id?(Us(),Qa("p",yb," - "+$s(s.order.pay_order_id),1)):Uh("",!0),fi("    "),gb]),xt("div",_b,[Xa(e.$slots,"footer",{},()=>[fi("   "),Bh(o,{effect:"light",placement:"top"},{content:Bs(()=>[mb]),default:Bs(()=>[vb]),_:1}),fi("  ")])])]),_:3},8,["modelValue","before-close","show-close"])}const Ib=Mh(ab,[["render",wb]]);export{Ib as default};
