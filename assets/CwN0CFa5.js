import{Z as Ch,p as za,a3 as Ph,a0 as kh,K as Za,a1 as Ar,a2 as Ls,q as Mh,a9 as Us,W as Fh}from"./app-CFBHZ-JG.js";import{E as hc}from"./DNHFUwDx.js";import{E as Lh}from"./Dxv5_yXh.js";var U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Uh(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var dc;function P(){return dc.apply(null,arguments)}function Bh(e){dc=e}function Et(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ir(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function te(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Jo(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(te(e,t))return!1;return!0}function Ke(e){return e===void 0}function Zt(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Jn(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function pc(e,t){var r=[],n,s=e.length;for(n=0;n<s;++n)r.push(t(e[n],n));return r}function rr(e,t){for(var r in t)te(t,r)&&(e[r]=t[r]);return te(t,"toString")&&(e.toString=t.toString),te(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Mt(e,t,r,n){return Lc(e,t,r,n,!0).utc()}function $h(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function K(e){return e._pf==null&&(e._pf=$h()),e._pf}var Oo;Array.prototype.some?Oo=Array.prototype.some:Oo=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function zo(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=K(e),r=Oo.call(t.parsedDateParts,function(s){return s!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function zi(e){var t=Mt(NaN);return e!=null?rr(K(t),e):K(t).userInvalidated=!0,t}var Xa=P.momentProperties=[],Bs=!1;function Zo(e,t){var r,n,s,i=Xa.length;if(Ke(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ke(t._i)||(e._i=t._i),Ke(t._f)||(e._f=t._f),Ke(t._l)||(e._l=t._l),Ke(t._strict)||(e._strict=t._strict),Ke(t._tzm)||(e._tzm=t._tzm),Ke(t._isUTC)||(e._isUTC=t._isUTC),Ke(t._offset)||(e._offset=t._offset),Ke(t._pf)||(e._pf=K(t)),Ke(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=Xa[r],s=t[n],Ke(s)||(e[n]=s);return e}function zn(e){Zo(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Bs===!1&&(Bs=!0,P.updateOffset(this),Bs=!1)}function bt(e){return e instanceof zn||e!=null&&e._isAMomentObject!=null}function yc(e){P.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function yt(e,t){var r=!0;return rr(function(){if(P.deprecationHandler!=null&&P.deprecationHandler(null,e),r){var n=[],s,i,o,u=arguments.length;for(i=0;i<u;i++){if(s="",typeof arguments[i]=="object"){s+=`
[`+i+"] ";for(o in arguments[0])te(arguments[0],o)&&(s+=o+": "+arguments[0][o]+", ");s=s.slice(0,-2)}else s=arguments[i];n.push(s)}yc(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var Qa={};function gc(e,t){P.deprecationHandler!=null&&P.deprecationHandler(e,t),Qa[e]||(yc(t),Qa[e]=!0)}P.suppressDeprecationWarnings=!1;P.deprecationHandler=null;function Ft(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Wh(e){var t,r;for(r in e)te(e,r)&&(t=e[r],Ft(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function xo(e,t){var r=rr({},e),n;for(n in t)te(t,n)&&(Ir(e[n])&&Ir(t[n])?(r[n]={},rr(r[n],e[n]),rr(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)te(e,n)&&!te(t,n)&&Ir(e[n])&&(r[n]=rr({},r[n]));return r}function Xo(e){e!=null&&this.set(e)}var No;Object.keys?No=Object.keys:No=function(e){var t,r=[];for(t in e)te(e,t)&&r.push(t);return r};var jh={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Yh(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Ft(n)?n.call(t,r):n}function Ct(e,t,r){var n=""+Math.abs(e),s=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}var Qo=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,fi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,$s={},Xr={};function W(e,t,r,n){var s=n;typeof n=="string"&&(s=function(){return this[n]()}),e&&(Xr[e]=s),t&&(Xr[t[0]]=function(){return Ct(s.apply(this,arguments),t[1],t[2])}),r&&(Xr[r]=function(){return this.localeData().ordinal(s.apply(this,arguments),e)})}function Hh(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function qh(e){var t=e.match(Qo),r,n;for(r=0,n=t.length;r<n;r++)Xr[t[r]]?t[r]=Xr[t[r]]:t[r]=Hh(t[r]);return function(s){var i="",o;for(o=0;o<n;o++)i+=Ft(t[o])?t[o].call(s,e):t[o];return i}}function Ti(e,t){return e.isValid()?(t=mc(t,e.localeData()),$s[t]=$s[t]||qh(t),$s[t](e)):e.localeData().invalidDate()}function mc(e,t){var r=5;function n(s){return t.longDateFormat(s)||s}for(fi.lastIndex=0;r>=0&&fi.test(e);)e=e.replace(fi,n),fi.lastIndex=0,r-=1;return e}var Gh={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Kh(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Qo).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var Vh="Invalid date";function Jh(){return this._invalidDate}var zh="%d",Zh=/\d{1,2}/;function Xh(e){return this._ordinal.replace("%d",e)}var Qh={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ed(e,t,r,n){var s=this._relativeTime[r];return Ft(s)?s(e,t,r,n):s.replace(/%d/i,e)}function td(e,t){var r=this._relativeTime[e>0?"future":"past"];return Ft(r)?r(t):r.replace(/%s/i,t)}var eu={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function gt(e){return typeof e=="string"?eu[e]||eu[e.toLowerCase()]:void 0}function ea(e){var t={},r,n;for(n in e)te(e,n)&&(r=gt(n),r&&(t[r]=e[n]));return t}var rd={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function nd(e){var t=[],r;for(r in e)te(e,r)&&t.push({unit:r,priority:rd[r]});return t.sort(function(n,s){return n.priority-s.priority}),t}var _c=/\d/,tt=/\d\d/,vc=/\d{3}/,ta=/\d{4}/,Zi=/[+-]?\d{6}/,pe=/\d\d?/,wc=/\d\d\d\d?/,Ec=/\d\d\d\d\d\d?/,Xi=/\d{1,3}/,ra=/\d{1,4}/,Qi=/[+-]?\d{1,6}/,an=/\d+/,es=/[+-]?\d+/,id=/Z|[+-]\d\d:?\d\d/gi,ts=/Z|[+-]\d\d(?::?\d\d)?/gi,sd=/[+-]?\d+(\.\d{1,3})?/,Zn=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,un=/^[1-9]\d?/,na=/^([1-9]\d|\d)/,Di;Di={};function F(e,t,r){Di[e]=Ft(t)?t:function(n,s){return n&&r?r:t}}function od(e,t){return te(Di,e)?Di[e](t._strict,t._locale):new RegExp(ad(e))}function ad(e){return Jt(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,s,i){return r||n||s||i}))}function Jt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function lt(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function J(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=lt(t)),r}var Ro={};function ce(e,t){var r,n=t,s;for(typeof e=="string"&&(e=[e]),Zt(t)&&(n=function(i,o){o[t]=J(i)}),s=e.length,r=0;r<s;r++)Ro[e[r]]=n}function Xn(e,t){ce(e,function(r,n,s,i){s._w=s._w||{},t(r,s._w,s,i)})}function ud(e,t,r){t!=null&&te(Ro,e)&&Ro[e](t,r._a,r,e)}function rs(e){return e%4===0&&e%100!==0||e%400===0}var Ue=0,Kt=1,xt=2,xe=3,wt=4,Vt=5,br=6,cd=7,fd=8;W("Y",0,0,function(){var e=this.year();return e<=9999?Ct(e,4):"+"+e});W(0,["YY",2],0,function(){return this.year()%100});W(0,["YYYY",4],0,"year");W(0,["YYYYY",5],0,"year");W(0,["YYYYYY",6,!0],0,"year");F("Y",es);F("YY",pe,tt);F("YYYY",ra,ta);F("YYYYY",Qi,Zi);F("YYYYYY",Qi,Zi);ce(["YYYYY","YYYYYY"],Ue);ce("YYYY",function(e,t){t[Ue]=e.length===2?P.parseTwoDigitYear(e):J(e)});ce("YY",function(e,t){t[Ue]=P.parseTwoDigitYear(e)});ce("Y",function(e,t){t[Ue]=parseInt(e,10)});function Fn(e){return rs(e)?366:365}P.parseTwoDigitYear=function(e){return J(e)+(J(e)>68?1900:2e3)};var bc=cn("FullYear",!0);function ld(){return rs(this.year())}function cn(e,t){return function(r){return r!=null?(Sc(this,e,r),P.updateOffset(this,t),this):Un(this,e)}}function Un(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function Sc(e,t,r){var n,s,i,o,u;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,s=e._isUTC,t){case"Milliseconds":return void(s?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(s?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(s?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(s?n.setUTCHours(r):n.setHours(r));case"Date":return void(s?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}i=r,o=e.month(),u=e.date(),u=u===29&&o===1&&!rs(i)?28:u,s?n.setUTCFullYear(i,o,u):n.setFullYear(i,o,u)}}function hd(e){return e=gt(e),Ft(this[e])?this[e]():this}function dd(e,t){if(typeof e=="object"){e=ea(e);var r=nd(e),n,s=r.length;for(n=0;n<s;n++)this[r[n].unit](e[r[n].unit])}else if(e=gt(e),Ft(this[e]))return this[e](t);return this}function pd(e,t){return(e%t+t)%t}var Ae;Array.prototype.indexOf?Ae=Array.prototype.indexOf:Ae=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function ia(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=pd(t,12);return e+=(t-r)/12,r===1?rs(e)?29:28:31-r%7%2}W("M",["MM",2],"Mo",function(){return this.month()+1});W("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});W("MMMM",0,0,function(e){return this.localeData().months(this,e)});F("M",pe,un);F("MM",pe,tt);F("MMM",function(e,t){return t.monthsShortRegex(e)});F("MMMM",function(e,t){return t.monthsRegex(e)});ce(["M","MM"],function(e,t){t[Kt]=J(e)-1});ce(["MMM","MMMM"],function(e,t,r,n){var s=r._locale.monthsParse(e,n,r._strict);s!=null?t[Kt]=s:K(r).invalidMonth=e});var yd="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ac="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ic=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,gd=Zn,md=Zn;function _d(e,t){return e?Et(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Ic).test(t)?"format":"standalone"][e.month()]:Et(this._months)?this._months:this._months.standalone}function vd(e,t){return e?Et(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ic.test(t)?"format":"standalone"][e.month()]:Et(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function wd(e,t,r){var n,s,i,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Mt([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(s=Ae.call(this._shortMonthsParse,o),s!==-1?s:null):(s=Ae.call(this._longMonthsParse,o),s!==-1?s:null):t==="MMM"?(s=Ae.call(this._shortMonthsParse,o),s!==-1?s:(s=Ae.call(this._longMonthsParse,o),s!==-1?s:null)):(s=Ae.call(this._longMonthsParse,o),s!==-1?s:(s=Ae.call(this._shortMonthsParse,o),s!==-1?s:null))}function Ed(e,t,r){var n,s,i;if(this._monthsParseExact)return wd.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(s=Mt([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function Tc(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=J(t);else if(t=e.localeData().monthsParse(t),!Zt(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,ia(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function Oc(e){return e!=null?(Tc(this,e),P.updateOffset(this,!0),this):Un(this,"Month")}function bd(){return ia(this.year(),this.month())}function Sd(e){return this._monthsParseExact?(te(this,"_monthsRegex")||xc.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(te(this,"_monthsShortRegex")||(this._monthsShortRegex=gd),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Ad(e){return this._monthsParseExact?(te(this,"_monthsRegex")||xc.call(this),e?this._monthsStrictRegex:this._monthsRegex):(te(this,"_monthsRegex")||(this._monthsRegex=md),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function xc(){function e(h,a){return a.length-h.length}var t=[],r=[],n=[],s,i,o,u;for(s=0;s<12;s++)i=Mt([2e3,s]),o=Jt(this.monthsShort(i,"")),u=Jt(this.months(i,"")),t.push(o),r.push(u),n.push(u),n.push(o);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Id(e,t,r,n,s,i,o){var u;return e<100&&e>=0?(u=new Date(e+400,t,r,n,s,i,o),isFinite(u.getFullYear())&&u.setFullYear(e)):u=new Date(e,t,r,n,s,i,o),u}function Bn(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Ci(e,t,r){var n=7+t-r,s=(7+Bn(e,0,n).getUTCDay()-t)%7;return-s+n-1}function Nc(e,t,r,n,s){var i=(7+r-n)%7,o=Ci(e,n,s),u=1+7*(t-1)+i+o,h,a;return u<=0?(h=e-1,a=Fn(h)+u):u>Fn(e)?(h=e+1,a=u-Fn(e)):(h=e,a=u),{year:h,dayOfYear:a}}function $n(e,t,r){var n=Ci(e.year(),t,r),s=Math.floor((e.dayOfYear()-n-1)/7)+1,i,o;return s<1?(o=e.year()-1,i=s+zt(o,t,r)):s>zt(e.year(),t,r)?(i=s-zt(e.year(),t,r),o=e.year()+1):(o=e.year(),i=s),{week:i,year:o}}function zt(e,t,r){var n=Ci(e,t,r),s=Ci(e+1,t,r);return(Fn(e)-n+s)/7}W("w",["ww",2],"wo","week");W("W",["WW",2],"Wo","isoWeek");F("w",pe,un);F("ww",pe,tt);F("W",pe,un);F("WW",pe,tt);Xn(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=J(e)});function Td(e){return $n(e,this._week.dow,this._week.doy).week}var Od={dow:0,doy:6};function xd(){return this._week.dow}function Nd(){return this._week.doy}function Rd(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Dd(e){var t=$n(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}W("d",0,"do","day");W("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});W("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});W("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});W("e",0,0,"weekday");W("E",0,0,"isoWeekday");F("d",pe);F("e",pe);F("E",pe);F("dd",function(e,t){return t.weekdaysMinRegex(e)});F("ddd",function(e,t){return t.weekdaysShortRegex(e)});F("dddd",function(e,t){return t.weekdaysRegex(e)});Xn(["dd","ddd","dddd"],function(e,t,r,n){var s=r._locale.weekdaysParse(e,n,r._strict);s!=null?t.d=s:K(r).invalidWeekday=e});Xn(["d","e","E"],function(e,t,r,n){t[n]=J(e)});function Cd(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Pd(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function sa(e,t){return e.slice(t,7).concat(e.slice(0,t))}var kd="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Rc="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Md="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Fd=Zn,Ld=Zn,Ud=Zn;function Bd(e,t){var r=Et(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?sa(r,this._week.dow):e?r[e.day()]:r}function $d(e){return e===!0?sa(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Wd(e){return e===!0?sa(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function jd(e,t,r){var n,s,i,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Mt([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(s=Ae.call(this._weekdaysParse,o),s!==-1?s:null):t==="ddd"?(s=Ae.call(this._shortWeekdaysParse,o),s!==-1?s:null):(s=Ae.call(this._minWeekdaysParse,o),s!==-1?s:null):t==="dddd"?(s=Ae.call(this._weekdaysParse,o),s!==-1||(s=Ae.call(this._shortWeekdaysParse,o),s!==-1)?s:(s=Ae.call(this._minWeekdaysParse,o),s!==-1?s:null)):t==="ddd"?(s=Ae.call(this._shortWeekdaysParse,o),s!==-1||(s=Ae.call(this._weekdaysParse,o),s!==-1)?s:(s=Ae.call(this._minWeekdaysParse,o),s!==-1?s:null)):(s=Ae.call(this._minWeekdaysParse,o),s!==-1||(s=Ae.call(this._weekdaysParse,o),s!==-1)?s:(s=Ae.call(this._shortWeekdaysParse,o),s!==-1?s:null))}function Yd(e,t,r){var n,s,i;if(this._weekdaysParseExact)return jd.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(s=Mt([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Hd(e){if(!this.isValid())return e!=null?this:NaN;var t=Un(this,"Day");return e!=null?(e=Cd(e,this.localeData()),this.add(e-t,"d")):t}function qd(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Gd(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Pd(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Kd(e){return this._weekdaysParseExact?(te(this,"_weekdaysRegex")||oa.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(te(this,"_weekdaysRegex")||(this._weekdaysRegex=Fd),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Vd(e){return this._weekdaysParseExact?(te(this,"_weekdaysRegex")||oa.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(te(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ld),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Jd(e){return this._weekdaysParseExact?(te(this,"_weekdaysRegex")||oa.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(te(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ud),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function oa(){function e(c,d){return d.length-c.length}var t=[],r=[],n=[],s=[],i,o,u,h,a;for(i=0;i<7;i++)o=Mt([2e3,1]).day(i),u=Jt(this.weekdaysMin(o,"")),h=Jt(this.weekdaysShort(o,"")),a=Jt(this.weekdays(o,"")),t.push(u),r.push(h),n.push(a),s.push(u),s.push(h),s.push(a);t.sort(e),r.sort(e),n.sort(e),s.sort(e),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function aa(){return this.hours()%12||12}function zd(){return this.hours()||24}W("H",["HH",2],0,"hour");W("h",["hh",2],0,aa);W("k",["kk",2],0,zd);W("hmm",0,0,function(){return""+aa.apply(this)+Ct(this.minutes(),2)});W("hmmss",0,0,function(){return""+aa.apply(this)+Ct(this.minutes(),2)+Ct(this.seconds(),2)});W("Hmm",0,0,function(){return""+this.hours()+Ct(this.minutes(),2)});W("Hmmss",0,0,function(){return""+this.hours()+Ct(this.minutes(),2)+Ct(this.seconds(),2)});function Dc(e,t){W(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}Dc("a",!0);Dc("A",!1);function Cc(e,t){return t._meridiemParse}F("a",Cc);F("A",Cc);F("H",pe,na);F("h",pe,un);F("k",pe,un);F("HH",pe,tt);F("hh",pe,tt);F("kk",pe,tt);F("hmm",wc);F("hmmss",Ec);F("Hmm",wc);F("Hmmss",Ec);ce(["H","HH"],xe);ce(["k","kk"],function(e,t,r){var n=J(e);t[xe]=n===24?0:n});ce(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ce(["h","hh"],function(e,t,r){t[xe]=J(e),K(r).bigHour=!0});ce("hmm",function(e,t,r){var n=e.length-2;t[xe]=J(e.substr(0,n)),t[wt]=J(e.substr(n)),K(r).bigHour=!0});ce("hmmss",function(e,t,r){var n=e.length-4,s=e.length-2;t[xe]=J(e.substr(0,n)),t[wt]=J(e.substr(n,2)),t[Vt]=J(e.substr(s)),K(r).bigHour=!0});ce("Hmm",function(e,t,r){var n=e.length-2;t[xe]=J(e.substr(0,n)),t[wt]=J(e.substr(n))});ce("Hmmss",function(e,t,r){var n=e.length-4,s=e.length-2;t[xe]=J(e.substr(0,n)),t[wt]=J(e.substr(n,2)),t[Vt]=J(e.substr(s))});function Zd(e){return(e+"").toLowerCase().charAt(0)==="p"}var Xd=/[ap]\.?m?\.?/i,Qd=cn("Hours",!0);function ep(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var Pc={calendar:jh,longDateFormat:Gh,invalidDate:Vh,ordinal:zh,dayOfMonthOrdinalParse:Zh,relativeTime:Qh,months:yd,monthsShort:Ac,week:Od,weekdays:kd,weekdaysMin:Md,weekdaysShort:Rc,meridiemParse:Xd},ge={},En={},Wn;function tp(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function tu(e){return e&&e.toLowerCase().replace("_","-")}function rp(e){for(var t=0,r,n,s,i;t<e.length;){for(i=tu(e[t]).split("-"),r=i.length,n=tu(e[t+1]),n=n?n.split("-"):null;r>0;){if(s=ns(i.slice(0,r).join("-")),s)return s;if(n&&n.length>=r&&tp(i,n)>=r-1)break;r--}t++}return Wn}function np(e){return!!(e&&e.match("^[^/\\\\]*$"))}function ns(e){var t=null,r;if(ge[e]===void 0&&typeof module<"u"&&module&&module.exports&&np(e))try{t=Wn._abbr,r=require,r("./locale/"+e),or(t)}catch{ge[e]=null}return ge[e]}function or(e,t){var r;return e&&(Ke(t)?r=Xt(e):r=ua(e,t),r?Wn=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Wn._abbr}function ua(e,t){if(t!==null){var r,n=Pc;if(t.abbr=e,ge[e]!=null)gc("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ge[e]._config;else if(t.parentLocale!=null)if(ge[t.parentLocale]!=null)n=ge[t.parentLocale]._config;else if(r=ns(t.parentLocale),r!=null)n=r._config;else return En[t.parentLocale]||(En[t.parentLocale]=[]),En[t.parentLocale].push({name:e,config:t}),null;return ge[e]=new Xo(xo(n,t)),En[e]&&En[e].forEach(function(s){ua(s.name,s.config)}),or(e),ge[e]}else return delete ge[e],null}function ip(e,t){if(t!=null){var r,n,s=Pc;ge[e]!=null&&ge[e].parentLocale!=null?ge[e].set(xo(ge[e]._config,t)):(n=ns(e),n!=null&&(s=n._config),t=xo(s,t),n==null&&(t.abbr=e),r=new Xo(t),r.parentLocale=ge[e],ge[e]=r),or(e)}else ge[e]!=null&&(ge[e].parentLocale!=null?(ge[e]=ge[e].parentLocale,e===or()&&or(e)):ge[e]!=null&&delete ge[e]);return ge[e]}function Xt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Wn;if(!Et(e)){if(t=ns(e),t)return t;e=[e]}return rp(e)}function sp(){return No(ge)}function ca(e){var t,r=e._a;return r&&K(e).overflow===-2&&(t=r[Kt]<0||r[Kt]>11?Kt:r[xt]<1||r[xt]>ia(r[Ue],r[Kt])?xt:r[xe]<0||r[xe]>24||r[xe]===24&&(r[wt]!==0||r[Vt]!==0||r[br]!==0)?xe:r[wt]<0||r[wt]>59?wt:r[Vt]<0||r[Vt]>59?Vt:r[br]<0||r[br]>999?br:-1,K(e)._overflowDayOfYear&&(t<Ue||t>xt)&&(t=xt),K(e)._overflowWeeks&&t===-1&&(t=cd),K(e)._overflowWeekday&&t===-1&&(t=fd),K(e).overflow=t),e}var op=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ap=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,up=/Z|[+-]\d\d(?::?\d\d)?/,li=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ws=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],cp=/^\/?Date\((-?\d+)/i,fp=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,lp={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function kc(e){var t,r,n=e._i,s=op.exec(n)||ap.exec(n),i,o,u,h,a=li.length,c=Ws.length;if(s){for(K(e).iso=!0,t=0,r=a;t<r;t++)if(li[t][1].exec(s[1])){o=li[t][0],i=li[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(s[3]){for(t=0,r=c;t<r;t++)if(Ws[t][1].exec(s[3])){u=(s[2]||" ")+Ws[t][0];break}if(u==null){e._isValid=!1;return}}if(!i&&u!=null){e._isValid=!1;return}if(s[4])if(up.exec(s[4]))h="Z";else{e._isValid=!1;return}e._f=o+(u||"")+(h||""),la(e)}else e._isValid=!1}function hp(e,t,r,n,s,i){var o=[dp(e),Ac.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(s,10)];return i&&o.push(parseInt(i,10)),o}function dp(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function pp(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function yp(e,t,r){if(e){var n=Rc.indexOf(e),s=new Date(t[0],t[1],t[2]).getDay();if(n!==s)return K(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function gp(e,t,r){if(e)return lp[e];if(t)return 0;var n=parseInt(r,10),s=n%100,i=(n-s)/100;return i*60+s}function Mc(e){var t=fp.exec(pp(e._i)),r;if(t){if(r=hp(t[4],t[3],t[2],t[5],t[6],t[7]),!yp(t[1],r,e))return;e._a=r,e._tzm=gp(t[8],t[9],t[10]),e._d=Bn.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),K(e).rfc2822=!0}else e._isValid=!1}function mp(e){var t=cp.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(kc(e),e._isValid===!1)delete e._isValid;else return;if(Mc(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:P.createFromInputFallback(e)}P.createFromInputFallback=yt("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Gr(e,t,r){return e??t??r}function _p(e){var t=new Date(P.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function fa(e){var t,r,n=[],s,i,o;if(!e._d){for(s=_p(e),e._w&&e._a[xt]==null&&e._a[Kt]==null&&vp(e),e._dayOfYear!=null&&(o=Gr(e._a[Ue],s[Ue]),(e._dayOfYear>Fn(o)||e._dayOfYear===0)&&(K(e)._overflowDayOfYear=!0),r=Bn(o,0,e._dayOfYear),e._a[Kt]=r.getUTCMonth(),e._a[xt]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=s[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[xe]===24&&e._a[wt]===0&&e._a[Vt]===0&&e._a[br]===0&&(e._nextDay=!0,e._a[xe]=0),e._d=(e._useUTC?Bn:Id).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[xe]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(K(e).weekdayMismatch=!0)}}function vp(e){var t,r,n,s,i,o,u,h,a;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,o=4,r=Gr(t.GG,e._a[Ue],$n(de(),1,4).year),n=Gr(t.W,1),s=Gr(t.E,1),(s<1||s>7)&&(h=!0)):(i=e._locale._week.dow,o=e._locale._week.doy,a=$n(de(),i,o),r=Gr(t.gg,e._a[Ue],a.year),n=Gr(t.w,a.week),t.d!=null?(s=t.d,(s<0||s>6)&&(h=!0)):t.e!=null?(s=t.e+i,(t.e<0||t.e>6)&&(h=!0)):s=i),n<1||n>zt(r,i,o)?K(e)._overflowWeeks=!0:h!=null?K(e)._overflowWeekday=!0:(u=Nc(r,n,s,i,o),e._a[Ue]=u.year,e._dayOfYear=u.dayOfYear)}P.ISO_8601=function(){};P.RFC_2822=function(){};function la(e){if(e._f===P.ISO_8601){kc(e);return}if(e._f===P.RFC_2822){Mc(e);return}e._a=[],K(e).empty=!0;var t=""+e._i,r,n,s,i,o,u=t.length,h=0,a,c;for(s=mc(e._f,e._locale).match(Qo)||[],c=s.length,r=0;r<c;r++)i=s[r],n=(t.match(od(i,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&K(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),h+=n.length),Xr[i]?(n?K(e).empty=!1:K(e).unusedTokens.push(i),ud(i,n,e)):e._strict&&!n&&K(e).unusedTokens.push(i);K(e).charsLeftOver=u-h,t.length>0&&K(e).unusedInput.push(t),e._a[xe]<=12&&K(e).bigHour===!0&&e._a[xe]>0&&(K(e).bigHour=void 0),K(e).parsedDateParts=e._a.slice(0),K(e).meridiem=e._meridiem,e._a[xe]=wp(e._locale,e._a[xe],e._meridiem),a=K(e).era,a!==null&&(e._a[Ue]=e._locale.erasConvertYear(a,e._a[Ue])),fa(e),ca(e)}function wp(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Ep(e){var t,r,n,s,i,o,u=!1,h=e._f.length;if(h===0){K(e).invalidFormat=!0,e._d=new Date(NaN);return}for(s=0;s<h;s++)i=0,o=!1,t=Zo({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[s],la(t),zo(t)&&(o=!0),i+=K(t).charsLeftOver,i+=K(t).unusedTokens.length*10,K(t).score=i,u?i<n&&(n=i,r=t):(n==null||i<n||o)&&(n=i,r=t,o&&(u=!0));rr(e,r||t)}function bp(e){if(!e._d){var t=ea(e._i),r=t.day===void 0?t.date:t.day;e._a=pc([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),fa(e)}}function Sp(e){var t=new zn(ca(Fc(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Fc(e){var t=e._i,r=e._f;return e._locale=e._locale||Xt(e._l),t===null||r===void 0&&t===""?zi({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),bt(t)?new zn(ca(t)):(Jn(t)?e._d=t:Et(r)?Ep(e):r?la(e):Ap(e),zo(e)||(e._d=null),e))}function Ap(e){var t=e._i;Ke(t)?e._d=new Date(P.now()):Jn(t)?e._d=new Date(t.valueOf()):typeof t=="string"?mp(e):Et(t)?(e._a=pc(t.slice(0),function(r){return parseInt(r,10)}),fa(e)):Ir(t)?bp(e):Zt(t)?e._d=new Date(t):P.createFromInputFallback(e)}function Lc(e,t,r,n,s){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ir(e)&&Jo(e)||Et(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=s,i._l=r,i._i=e,i._f=t,i._strict=n,Sp(i)}function de(e,t,r,n){return Lc(e,t,r,n,!1)}var Ip=yt("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=de.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:zi()}),Tp=yt("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=de.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:zi()});function Uc(e,t){var r,n;if(t.length===1&&Et(t[0])&&(t=t[0]),!t.length)return de();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Op(){var e=[].slice.call(arguments,0);return Uc("isBefore",e)}function xp(){var e=[].slice.call(arguments,0);return Uc("isAfter",e)}var Np=function(){return Date.now?Date.now():+new Date},bn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Rp(e){var t,r=!1,n,s=bn.length;for(t in e)if(te(e,t)&&!(Ae.call(bn,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<s;++n)if(e[bn[n]]){if(r)return!1;parseFloat(e[bn[n]])!==J(e[bn[n]])&&(r=!0)}return!0}function Dp(){return this._isValid}function Cp(){return St(NaN)}function is(e){var t=ea(e),r=t.year||0,n=t.quarter||0,s=t.month||0,i=t.week||t.isoWeek||0,o=t.day||0,u=t.hour||0,h=t.minute||0,a=t.second||0,c=t.millisecond||0;this._isValid=Rp(t),this._milliseconds=+c+a*1e3+h*6e4+u*1e3*60*60,this._days=+o+i*7,this._months=+s+n*3+r*12,this._data={},this._locale=Xt(),this._bubble()}function Oi(e){return e instanceof is}function Do(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Pp(e,t,r){var n=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),i=0,o;for(o=0;o<n;o++)J(e[o])!==J(t[o])&&i++;return i+s}function Bc(e,t){W(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Ct(~~(r/60),2)+t+Ct(~~r%60,2)})}Bc("Z",":");Bc("ZZ","");F("Z",ts);F("ZZ",ts);ce(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=ha(ts,e)});var kp=/([\+\-]|\d\d)/gi;function ha(e,t){var r=(t||"").match(e),n,s,i;return r===null?null:(n=r[r.length-1]||[],s=(n+"").match(kp)||["-",0,0],i=+(s[1]*60)+J(s[2]),i===0?0:s[0]==="+"?i:-i)}function da(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(bt(e)||Jn(e)?e.valueOf():de(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),P.updateOffset(r,!1),r):de(e).local()}function Co(e){return-Math.round(e._d.getTimezoneOffset())}P.updateOffset=function(){};function Mp(e,t,r){var n=this._offset||0,s;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=ha(ts,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(s=Co(this)),this._offset=e,this._isUTC=!0,s!=null&&this.add(s,"m"),n!==e&&(!t||this._changeInProgress?jc(this,St(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,P.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Co(this)}function Fp(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Lp(e){return this.utcOffset(0,e)}function Up(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Co(this),"m")),this}function Bp(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=ha(id,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function $p(e){return this.isValid()?(e=e?de(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Wp(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function jp(){if(!Ke(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Zo(e,this),e=Fc(e),e._a?(t=e._isUTC?Mt(e._a):de(e._a),this._isDSTShifted=this.isValid()&&Pp(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Yp(){return this.isValid()?!this._isUTC:!1}function Hp(){return this.isValid()?this._isUTC:!1}function $c(){return this.isValid()?this._isUTC&&this._offset===0:!1}var qp=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Gp=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function St(e,t){var r=e,n=null,s,i,o;return Oi(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Zt(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=qp.exec(e))?(s=n[1]==="-"?-1:1,r={y:0,d:J(n[xt])*s,h:J(n[xe])*s,m:J(n[wt])*s,s:J(n[Vt])*s,ms:J(Do(n[br]*1e3))*s}):(n=Gp.exec(e))?(s=n[1]==="-"?-1:1,r={y:yr(n[2],s),M:yr(n[3],s),w:yr(n[4],s),d:yr(n[5],s),h:yr(n[6],s),m:yr(n[7],s),s:yr(n[8],s)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=Kp(de(r.from),de(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),i=new is(r),Oi(e)&&te(e,"_locale")&&(i._locale=e._locale),Oi(e)&&te(e,"_isValid")&&(i._isValid=e._isValid),i}St.fn=is.prototype;St.invalid=Cp;function yr(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function ru(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Kp(e,t){var r;return e.isValid()&&t.isValid()?(t=da(t,e),e.isBefore(t)?r=ru(e,t):(r=ru(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function Wc(e,t){return function(r,n){var s,i;return n!==null&&!isNaN(+n)&&(gc(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),s=St(r,n),jc(this,s,e),this}}function jc(e,t,r,n){var s=t._milliseconds,i=Do(t._days),o=Do(t._months);e.isValid()&&(n=n??!0,o&&Tc(e,Un(e,"Month")+o*r),i&&Sc(e,"Date",Un(e,"Date")+i*r),s&&e._d.setTime(e._d.valueOf()+s*r),n&&P.updateOffset(e,i||o))}var Vp=Wc(1,"add"),Jp=Wc(-1,"subtract");function Yc(e){return typeof e=="string"||e instanceof String}function zp(e){return bt(e)||Jn(e)||Yc(e)||Zt(e)||Xp(e)||Zp(e)||e===null||e===void 0}function Zp(e){var t=Ir(e)&&!Jo(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,i,o=n.length;for(s=0;s<o;s+=1)i=n[s],r=r||te(e,i);return t&&r}function Xp(e){var t=Et(e),r=!1;return t&&(r=e.filter(function(n){return!Zt(n)&&Yc(e)}).length===0),t&&r}function Qp(e){var t=Ir(e)&&!Jo(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,i;for(s=0;s<n.length;s+=1)i=n[s],r=r||te(e,i);return t&&r}function ey(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function ty(e,t){arguments.length===1&&(arguments[0]?zp(arguments[0])?(e=arguments[0],t=void 0):Qp(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||de(),n=da(r,this).startOf("day"),s=P.calendarFormat(this,n)||"sameElse",i=t&&(Ft(t[s])?t[s].call(this,r):t[s]);return this.format(i||this.localeData().calendar(s,this,de(r)))}function ry(){return new zn(this)}function ny(e,t){var r=bt(e)?e:de(e);return this.isValid()&&r.isValid()?(t=gt(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function iy(e,t){var r=bt(e)?e:de(e);return this.isValid()&&r.isValid()?(t=gt(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function sy(e,t,r,n){var s=bt(e)?e:de(e),i=bt(t)?t:de(t);return this.isValid()&&s.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(s,r):!this.isBefore(s,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function oy(e,t){var r=bt(e)?e:de(e),n;return this.isValid()&&r.isValid()?(t=gt(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function ay(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function uy(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function cy(e,t,r){var n,s,i;if(!this.isValid())return NaN;if(n=da(e,this),!n.isValid())return NaN;switch(s=(n.utcOffset()-this.utcOffset())*6e4,t=gt(t),t){case"year":i=xi(this,n)/12;break;case"month":i=xi(this,n);break;case"quarter":i=xi(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-s)/864e5;break;case"week":i=(this-n-s)/6048e5;break;default:i=this-n}return r?i:lt(i)}function xi(e,t){if(e.date()<t.date())return-xi(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),s,i;return t-n<0?(s=e.clone().add(r-1,"months"),i=(t-n)/(n-s)):(s=e.clone().add(r+1,"months"),i=(t-n)/(s-n)),-(r+i)||0}P.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";P.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function fy(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ly(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Ti(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ft(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ti(r,"Z")):Ti(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function hy(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,s,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+s+i)}function dy(e){e||(e=this.isUtc()?P.defaultFormatUtc:P.defaultFormat);var t=Ti(this,e);return this.localeData().postformat(t)}function py(e,t){return this.isValid()&&(bt(e)&&e.isValid()||de(e).isValid())?St({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function yy(e){return this.from(de(),e)}function gy(e,t){return this.isValid()&&(bt(e)&&e.isValid()||de(e).isValid())?St({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function my(e){return this.to(de(),e)}function Hc(e){var t;return e===void 0?this._locale._abbr:(t=Xt(e),t!=null&&(this._locale=t),this)}var qc=yt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function Gc(){return this._locale}var Pi=1e3,Qr=60*Pi,ki=60*Qr,Kc=(365*400+97)*24*ki;function en(e,t){return(e%t+t)%t}function Vc(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-Kc:new Date(e,t,r).valueOf()}function Jc(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-Kc:Date.UTC(e,t,r)}function _y(e){var t,r;if(e=gt(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Jc:Vc,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=en(t+(this._isUTC?0:this.utcOffset()*Qr),ki);break;case"minute":t=this._d.valueOf(),t-=en(t,Qr);break;case"second":t=this._d.valueOf(),t-=en(t,Pi);break}return this._d.setTime(t),P.updateOffset(this,!0),this}function vy(e){var t,r;if(e=gt(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Jc:Vc,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=ki-en(t+(this._isUTC?0:this.utcOffset()*Qr),ki)-1;break;case"minute":t=this._d.valueOf(),t+=Qr-en(t,Qr)-1;break;case"second":t=this._d.valueOf(),t+=Pi-en(t,Pi)-1;break}return this._d.setTime(t),P.updateOffset(this,!0),this}function wy(){return this._d.valueOf()-(this._offset||0)*6e4}function Ey(){return Math.floor(this.valueOf()/1e3)}function by(){return new Date(this.valueOf())}function Sy(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ay(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Iy(){return this.isValid()?this.toISOString():null}function Ty(){return zo(this)}function Oy(){return rr({},K(this))}function xy(){return K(this).overflow}function Ny(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}W("N",0,0,"eraAbbr");W("NN",0,0,"eraAbbr");W("NNN",0,0,"eraAbbr");W("NNNN",0,0,"eraName");W("NNNNN",0,0,"eraNarrow");W("y",["y",1],"yo","eraYear");W("y",["yy",2],0,"eraYear");W("y",["yyy",3],0,"eraYear");W("y",["yyyy",4],0,"eraYear");F("N",pa);F("NN",pa);F("NNN",pa);F("NNNN",$y);F("NNNNN",Wy);ce(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var s=r._locale.erasParse(e,n,r._strict);s?K(r).era=s:K(r).invalidEra=e});F("y",an);F("yy",an);F("yyy",an);F("yyyy",an);F("yo",jy);ce(["y","yy","yyy","yyyy"],Ue);ce(["yo"],function(e,t,r,n){var s;r._locale._eraYearOrdinalRegex&&(s=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Ue]=r._locale.eraYearOrdinalParse(e,s):t[Ue]=parseInt(e,10)});function Ry(e,t){var r,n,s,i=this._eras||Xt("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":s=P(i[r].since).startOf("day"),i[r].since=s.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":s=P(i[r].until).startOf("day").valueOf(),i[r].until=s.valueOf();break}}return i}function Dy(e,t,r){var n,s,i=this.eras(),o,u,h;for(e=e.toUpperCase(),n=0,s=i.length;n<s;++n)if(o=i[n].name.toUpperCase(),u=i[n].abbr.toUpperCase(),h=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(u===e)return i[n];break;case"NNNN":if(o===e)return i[n];break;case"NNNNN":if(h===e)return i[n];break}else if([o,u,h].indexOf(e)>=0)return i[n]}function Cy(e,t){var r=e.since<=e.until?1:-1;return t===void 0?P(e.since).year():P(e.since).year()+(t-e.offset)*r}function Py(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function ky(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function My(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Fy(){var e,t,r,n,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e)if(r=s[e].since<=s[e].until?1:-1,n=this.clone().startOf("day").valueOf(),s[e].since<=n&&n<=s[e].until||s[e].until<=n&&n<=s[e].since)return(this.year()-P(s[e].since).year())*r+s[e].offset;return this.year()}function Ly(e){return te(this,"_erasNameRegex")||ya.call(this),e?this._erasNameRegex:this._erasRegex}function Uy(e){return te(this,"_erasAbbrRegex")||ya.call(this),e?this._erasAbbrRegex:this._erasRegex}function By(e){return te(this,"_erasNarrowRegex")||ya.call(this),e?this._erasNarrowRegex:this._erasRegex}function pa(e,t){return t.erasAbbrRegex(e)}function $y(e,t){return t.erasNameRegex(e)}function Wy(e,t){return t.erasNarrowRegex(e)}function jy(e,t){return t._eraYearOrdinalRegex||an}function ya(){var e=[],t=[],r=[],n=[],s,i,o,u,h,a=this.eras();for(s=0,i=a.length;s<i;++s)o=Jt(a[s].name),u=Jt(a[s].abbr),h=Jt(a[s].narrow),t.push(o),e.push(u),r.push(h),n.push(o),n.push(u),n.push(h);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}W(0,["gg",2],0,function(){return this.weekYear()%100});W(0,["GG",2],0,function(){return this.isoWeekYear()%100});function ss(e,t){W(0,[e,e.length],0,t)}ss("gggg","weekYear");ss("ggggg","weekYear");ss("GGGG","isoWeekYear");ss("GGGGG","isoWeekYear");F("G",es);F("g",es);F("GG",pe,tt);F("gg",pe,tt);F("GGGG",ra,ta);F("gggg",ra,ta);F("GGGGG",Qi,Zi);F("ggggg",Qi,Zi);Xn(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=J(e)});Xn(["gg","GG"],function(e,t,r,n){t[n]=P.parseTwoDigitYear(e)});function Yy(e){return zc.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Hy(e){return zc.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function qy(){return zt(this.year(),1,4)}function Gy(){return zt(this.isoWeekYear(),1,4)}function Ky(){var e=this.localeData()._week;return zt(this.year(),e.dow,e.doy)}function Vy(){var e=this.localeData()._week;return zt(this.weekYear(),e.dow,e.doy)}function zc(e,t,r,n,s){var i;return e==null?$n(this,n,s).year:(i=zt(e,n,s),t>i&&(t=i),Jy.call(this,e,t,r,n,s))}function Jy(e,t,r,n,s){var i=Nc(e,t,r,n,s),o=Bn(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}W("Q",0,"Qo","quarter");F("Q",_c);ce("Q",function(e,t){t[Kt]=(J(e)-1)*3});function zy(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}W("D",["DD",2],"Do","date");F("D",pe,un);F("DD",pe,tt);F("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});ce(["D","DD"],xt);ce("Do",function(e,t){t[xt]=J(e.match(pe)[0])});var Zc=cn("Date",!0);W("DDD",["DDDD",3],"DDDo","dayOfYear");F("DDD",Xi);F("DDDD",vc);ce(["DDD","DDDD"],function(e,t,r){r._dayOfYear=J(e)});function Zy(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}W("m",["mm",2],0,"minute");F("m",pe,na);F("mm",pe,tt);ce(["m","mm"],wt);var Xy=cn("Minutes",!1);W("s",["ss",2],0,"second");F("s",pe,na);F("ss",pe,tt);ce(["s","ss"],Vt);var Qy=cn("Seconds",!1);W("S",0,0,function(){return~~(this.millisecond()/100)});W(0,["SS",2],0,function(){return~~(this.millisecond()/10)});W(0,["SSS",3],0,"millisecond");W(0,["SSSS",4],0,function(){return this.millisecond()*10});W(0,["SSSSS",5],0,function(){return this.millisecond()*100});W(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});W(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});W(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});W(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});F("S",Xi,_c);F("SS",Xi,tt);F("SSS",Xi,vc);var nr,Xc;for(nr="SSSS";nr.length<=9;nr+="S")F(nr,an);function e0(e,t){t[br]=J(("0."+e)*1e3)}for(nr="S";nr.length<=9;nr+="S")ce(nr,e0);Xc=cn("Milliseconds",!1);W("z",0,0,"zoneAbbr");W("zz",0,0,"zoneName");function t0(){return this._isUTC?"UTC":""}function r0(){return this._isUTC?"Coordinated Universal Time":""}var C=zn.prototype;C.add=Vp;C.calendar=ty;C.clone=ry;C.diff=cy;C.endOf=vy;C.format=dy;C.from=py;C.fromNow=yy;C.to=gy;C.toNow=my;C.get=hd;C.invalidAt=xy;C.isAfter=ny;C.isBefore=iy;C.isBetween=sy;C.isSame=oy;C.isSameOrAfter=ay;C.isSameOrBefore=uy;C.isValid=Ty;C.lang=qc;C.locale=Hc;C.localeData=Gc;C.max=Tp;C.min=Ip;C.parsingFlags=Oy;C.set=dd;C.startOf=_y;C.subtract=Jp;C.toArray=Sy;C.toObject=Ay;C.toDate=by;C.toISOString=ly;C.inspect=hy;typeof Symbol<"u"&&Symbol.for!=null&&(C[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});C.toJSON=Iy;C.toString=fy;C.unix=Ey;C.valueOf=wy;C.creationData=Ny;C.eraName=Py;C.eraNarrow=ky;C.eraAbbr=My;C.eraYear=Fy;C.year=bc;C.isLeapYear=ld;C.weekYear=Yy;C.isoWeekYear=Hy;C.quarter=C.quarters=zy;C.month=Oc;C.daysInMonth=bd;C.week=C.weeks=Rd;C.isoWeek=C.isoWeeks=Dd;C.weeksInYear=Ky;C.weeksInWeekYear=Vy;C.isoWeeksInYear=qy;C.isoWeeksInISOWeekYear=Gy;C.date=Zc;C.day=C.days=Hd;C.weekday=qd;C.isoWeekday=Gd;C.dayOfYear=Zy;C.hour=C.hours=Qd;C.minute=C.minutes=Xy;C.second=C.seconds=Qy;C.millisecond=C.milliseconds=Xc;C.utcOffset=Mp;C.utc=Lp;C.local=Up;C.parseZone=Bp;C.hasAlignedHourOffset=$p;C.isDST=Wp;C.isLocal=Yp;C.isUtcOffset=Hp;C.isUtc=$c;C.isUTC=$c;C.zoneAbbr=t0;C.zoneName=r0;C.dates=yt("dates accessor is deprecated. Use date instead.",Zc);C.months=yt("months accessor is deprecated. Use month instead",Oc);C.years=yt("years accessor is deprecated. Use year instead",bc);C.zone=yt("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Fp);C.isDSTShifted=yt("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",jp);function n0(e){return de(e*1e3)}function i0(){return de.apply(null,arguments).parseZone()}function Qc(e){return e}var re=Xo.prototype;re.calendar=Yh;re.longDateFormat=Kh;re.invalidDate=Jh;re.ordinal=Xh;re.preparse=Qc;re.postformat=Qc;re.relativeTime=ed;re.pastFuture=td;re.set=Wh;re.eras=Ry;re.erasParse=Dy;re.erasConvertYear=Cy;re.erasAbbrRegex=Uy;re.erasNameRegex=Ly;re.erasNarrowRegex=By;re.months=_d;re.monthsShort=vd;re.monthsParse=Ed;re.monthsRegex=Ad;re.monthsShortRegex=Sd;re.week=Td;re.firstDayOfYear=Nd;re.firstDayOfWeek=xd;re.weekdays=Bd;re.weekdaysMin=Wd;re.weekdaysShort=$d;re.weekdaysParse=Yd;re.weekdaysRegex=Kd;re.weekdaysShortRegex=Vd;re.weekdaysMinRegex=Jd;re.isPM=Zd;re.meridiem=ep;function Mi(e,t,r,n){var s=Xt(),i=Mt().set(n,t);return s[r](i,e)}function ef(e,t,r){if(Zt(e)&&(t=e,e=void 0),e=e||"",t!=null)return Mi(e,t,r,"month");var n,s=[];for(n=0;n<12;n++)s[n]=Mi(e,n,r,"month");return s}function ga(e,t,r,n){typeof e=="boolean"?(Zt(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Zt(t)&&(r=t,t=void 0),t=t||"");var s=Xt(),i=e?s._week.dow:0,o,u=[];if(r!=null)return Mi(t,(r+i)%7,n,"day");for(o=0;o<7;o++)u[o]=Mi(t,(o+i)%7,n,"day");return u}function s0(e,t){return ef(e,t,"months")}function o0(e,t){return ef(e,t,"monthsShort")}function a0(e,t,r){return ga(e,t,r,"weekdays")}function u0(e,t,r){return ga(e,t,r,"weekdaysShort")}function c0(e,t,r){return ga(e,t,r,"weekdaysMin")}or("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=J(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});P.lang=yt("moment.lang is deprecated. Use moment.locale instead.",or);P.langData=yt("moment.langData is deprecated. Use moment.localeData instead.",Xt);var Bt=Math.abs;function f0(){var e=this._data;return this._milliseconds=Bt(this._milliseconds),this._days=Bt(this._days),this._months=Bt(this._months),e.milliseconds=Bt(e.milliseconds),e.seconds=Bt(e.seconds),e.minutes=Bt(e.minutes),e.hours=Bt(e.hours),e.months=Bt(e.months),e.years=Bt(e.years),this}function tf(e,t,r,n){var s=St(t,r);return e._milliseconds+=n*s._milliseconds,e._days+=n*s._days,e._months+=n*s._months,e._bubble()}function l0(e,t){return tf(this,e,t,1)}function h0(e,t){return tf(this,e,t,-1)}function nu(e){return e<0?Math.floor(e):Math.ceil(e)}function d0(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,s,i,o,u,h;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=nu(Po(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,s=lt(e/1e3),n.seconds=s%60,i=lt(s/60),n.minutes=i%60,o=lt(i/60),n.hours=o%24,t+=lt(o/24),h=lt(rf(t)),r+=h,t-=nu(Po(h)),u=lt(r/12),r%=12,n.days=t,n.months=r,n.years=u,this}function rf(e){return e*4800/146097}function Po(e){return e*146097/4800}function p0(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=gt(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+rf(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Po(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Qt(e){return function(){return this.as(e)}}var nf=Qt("ms"),y0=Qt("s"),g0=Qt("m"),m0=Qt("h"),_0=Qt("d"),v0=Qt("w"),w0=Qt("M"),E0=Qt("Q"),b0=Qt("y"),S0=nf;function A0(){return St(this)}function I0(e){return e=gt(e),this.isValid()?this[e+"s"]():NaN}function Dr(e){return function(){return this.isValid()?this._data[e]:NaN}}var T0=Dr("milliseconds"),O0=Dr("seconds"),x0=Dr("minutes"),N0=Dr("hours"),R0=Dr("days"),D0=Dr("months"),C0=Dr("years");function P0(){return lt(this.days()/7)}var Ht=Math.round,Kr={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function k0(e,t,r,n,s){return s.relativeTime(t||1,!!r,e,n)}function M0(e,t,r,n){var s=St(e).abs(),i=Ht(s.as("s")),o=Ht(s.as("m")),u=Ht(s.as("h")),h=Ht(s.as("d")),a=Ht(s.as("M")),c=Ht(s.as("w")),d=Ht(s.as("y")),m=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||o<=1&&["m"]||o<r.m&&["mm",o]||u<=1&&["h"]||u<r.h&&["hh",u]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(m=m||c<=1&&["w"]||c<r.w&&["ww",c]),m=m||a<=1&&["M"]||a<r.M&&["MM",a]||d<=1&&["y"]||["yy",d],m[2]=t,m[3]=+e>0,m[4]=n,k0.apply(null,m)}function F0(e){return e===void 0?Ht:typeof e=="function"?(Ht=e,!0):!1}function L0(e,t){return Kr[e]===void 0?!1:t===void 0?Kr[e]:(Kr[e]=t,e==="s"&&(Kr.ss=t-1),!0)}function U0(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Kr,s,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Kr,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),s=this.localeData(),i=M0(this,!r,n,s),r&&(i=s.pastFuture(+this,i)),s.postformat(i)}var js=Math.abs;function Br(e){return(e>0)-(e<0)||+e}function os(){if(!this.isValid())return this.localeData().invalidDate();var e=js(this._milliseconds)/1e3,t=js(this._days),r=js(this._months),n,s,i,o,u=this.asSeconds(),h,a,c,d;return u?(n=lt(e/60),s=lt(n/60),e%=60,n%=60,i=lt(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=u<0?"-":"",a=Br(this._months)!==Br(u)?"-":"",c=Br(this._days)!==Br(u)?"-":"",d=Br(this._milliseconds)!==Br(u)?"-":"",h+"P"+(i?a+i+"Y":"")+(r?a+r+"M":"")+(t?c+t+"D":"")+(s||n||e?"T":"")+(s?d+s+"H":"")+(n?d+n+"M":"")+(e?d+o+"S":"")):"P0D"}var Z=is.prototype;Z.isValid=Dp;Z.abs=f0;Z.add=l0;Z.subtract=h0;Z.as=p0;Z.asMilliseconds=nf;Z.asSeconds=y0;Z.asMinutes=g0;Z.asHours=m0;Z.asDays=_0;Z.asWeeks=v0;Z.asMonths=w0;Z.asQuarters=E0;Z.asYears=b0;Z.valueOf=S0;Z._bubble=d0;Z.clone=A0;Z.get=I0;Z.milliseconds=T0;Z.seconds=O0;Z.minutes=x0;Z.hours=N0;Z.days=R0;Z.weeks=P0;Z.months=D0;Z.years=C0;Z.humanize=U0;Z.toISOString=os;Z.toString=os;Z.toJSON=os;Z.locale=Hc;Z.localeData=Gc;Z.toIsoString=yt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",os);Z.lang=qc;W("X",0,0,"unix");W("x",0,0,"valueOf");F("x",es);F("X",sd);ce("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});ce("x",function(e,t,r){r._d=new Date(J(e))});//! moment.js
P.version="2.30.1";Bh(de);P.fn=C;P.min=Op;P.max=xp;P.now=Np;P.utc=Mt;P.unix=n0;P.months=s0;P.isDate=Jn;P.locale=or;P.invalid=zi;P.duration=St;P.isMoment=bt;P.weekdays=a0;P.parseZone=i0;P.localeData=Xt;P.isDuration=Oi;P.monthsShort=o0;P.weekdaysMin=c0;P.defineLocale=ua;P.updateLocale=ip;P.locales=sp;P.weekdaysShort=u0;P.normalizeUnits=gt;P.relativeTimeRounding=F0;P.relativeTimeThreshold=L0;P.calendarFormat=ey;P.prototype=C;P.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var Qe={},Qn={},Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.COMMUNITY_SITE_URL=Ye.IS_DEBUG_MODE=Ye.getProtocol=Ye.setProtocol=Ye.getSdkName=Ye.setSdkName=void 0;var sf="@cloudbase/js-sdk";function B0(e){sf=e}Ye.setSdkName=B0;function $0(){return sf}Ye.getSdkName=$0;var of=typeof location<"u"&&location.protocol==="http:"?"http:":"https:";function W0(e){of=e}Ye.setProtocol=W0;function j0(){return of}Ye.getProtocol=j0;Ye.IS_DEBUG_MODE=!1;Ye.COMMUNITY_SITE_URL="https://support.qq.com/products/148793";var as={};Object.defineProperty(as,"__esModule",{value:!0});as.ERRORS=void 0;as.ERRORS={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"};(function(e){var t=U&&U.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i),Object.defineProperty(n,o,{enumerable:!0,get:function(){return s[i]}})}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=U&&U.__exportStar||function(n,s){for(var i in n)i!=="default"&&!s.hasOwnProperty(i)&&t(s,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(Ye,e),r(as,e)})(Qn);var af={},sn={},Fi;(function(e){e.local="local",e.none="none",e.session="session"})(Fi||(Fi={}));var uf=function(){function e(){}return e}(),Y0=function(){function e(){}return e}();function ko(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),s="";for(var i in r)s===""?!n&&(t+="?"):s+="&",s+=i+"="+encodeURIComponent(r[i]);return t+=s,/^http(s)?\:\/\//.test(t)?t:""+e+t}const H0=Object.freeze(Object.defineProperty({__proto__:null,AbstractSDKRequest:uf,AbstractStorage:Y0,get StorageType(){return Fi},formatUrl:ko},Symbol.toStringTag,{value:"Module"})),cf=Uh(H0);var H={},ff={exports:{}},Ys={exports:{}},iu;function ei(){return iu||(iu=1,function(e,t){(function(r,n){e.exports=n()})(U,function(){var r=r||function(n,s){var i=Object.create||function(){function _(){}return function(v){var N;return _.prototype=v,N=new _,_.prototype=null,N}}(),o={},u=o.lib={},h=u.Base=function(){return{extend:function(_){var v=i(this);return _&&v.mixIn(_),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var _=this.extend();return _.init.apply(_,arguments),_},init:function(){},mixIn:function(_){for(var v in _)_.hasOwnProperty(v)&&(this[v]=_[v]);_.hasOwnProperty("toString")&&(this.toString=_.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=u.WordArray=h.extend({init:function(_,v){_=this.words=_||[],v!=s?this.sigBytes=v:this.sigBytes=_.length*4},toString:function(_){return(_||d).stringify(this)},concat:function(_){var v=this.words,N=_.words,O=this.sigBytes,I=_.sigBytes;if(this.clamp(),O%4)for(var k=0;k<I;k++){var M=N[k>>>2]>>>24-k%4*8&255;v[O+k>>>2]|=M<<24-(O+k)%4*8}else for(var k=0;k<I;k+=4)v[O+k>>>2]=N[k>>>2];return this.sigBytes+=I,this},clamp:function(){var _=this.words,v=this.sigBytes;_[v>>>2]&=4294967295<<32-v%4*8,_.length=n.ceil(v/4)},clone:function(){var _=h.clone.call(this);return _.words=this.words.slice(0),_},random:function(_){for(var v=[],N=function(j){var j=j,G=987654321,ee=4294967295;return function(){G=36969*(G&65535)+(G>>16)&ee,j=18e3*(j&65535)+(j>>16)&ee;var _e=(G<<16)+j&ee;return _e/=4294967296,_e+=.5,_e*(n.random()>.5?1:-1)}},O=0,I;O<_;O+=4){var k=N((I||n.random())*4294967296);I=k()*987654071,v.push(k()*4294967296|0)}return new a.init(v,_)}}),c=o.enc={},d=c.Hex={stringify:function(_){for(var v=_.words,N=_.sigBytes,O=[],I=0;I<N;I++){var k=v[I>>>2]>>>24-I%4*8&255;O.push((k>>>4).toString(16)),O.push((k&15).toString(16))}return O.join("")},parse:function(_){for(var v=_.length,N=[],O=0;O<v;O+=2)N[O>>>3]|=parseInt(_.substr(O,2),16)<<24-O%8*4;return new a.init(N,v/2)}},m=c.Latin1={stringify:function(_){for(var v=_.words,N=_.sigBytes,O=[],I=0;I<N;I++){var k=v[I>>>2]>>>24-I%4*8&255;O.push(String.fromCharCode(k))}return O.join("")},parse:function(_){for(var v=_.length,N=[],O=0;O<v;O++)N[O>>>2]|=(_.charCodeAt(O)&255)<<24-O%4*8;return new a.init(N,v)}},w=c.Utf8={stringify:function(_){try{return decodeURIComponent(escape(m.stringify(_)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(_){return m.parse(unescape(encodeURIComponent(_)))}},A=u.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(_){typeof _=="string"&&(_=w.parse(_)),this._data.concat(_),this._nDataBytes+=_.sigBytes},_process:function(_){var v=this._data,N=v.words,O=v.sigBytes,I=this.blockSize,k=I*4,M=O/k;_?M=n.ceil(M):M=n.max((M|0)-this._minBufferSize,0);var j=M*I,G=n.min(j*4,O);if(j){for(var ee=0;ee<j;ee+=I)this._doProcessBlock(N,ee);var _e=N.splice(0,j);v.sigBytes-=G}return new a.init(_e,G)},clone:function(){var _=h.clone.call(this);return _._data=this._data.clone(),_},_minBufferSize:0});u.Hasher=A.extend({cfg:h.extend(),init:function(_){this.cfg=this.cfg.extend(_),this.reset()},reset:function(){A.reset.call(this),this._doReset()},update:function(_){return this._append(_),this._process(),this},finalize:function(_){_&&this._append(_);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(_){return function(v,N){return new _.init(N).finalize(v)}},_createHmacHelper:function(_){return function(v,N){return new S.HMAC.init(_,N).finalize(v)}}});var S=o.algo={};return o}(Math);return r})}(Ys)),Ys.exports}var Hs={exports:{}},su;function q0(){return su||(su=1,function(e,t){(function(r,n){e.exports=n(ei())})(U,function(r){return function(n){var s=r,i=s.lib,o=i.WordArray,u=i.Hasher,h=s.algo,a=[],c=[];(function(){function w(v){for(var N=n.sqrt(v),O=2;O<=N;O++)if(!(v%O))return!1;return!0}function A(v){return(v-(v|0))*4294967296|0}for(var S=2,_=0;_<64;)w(S)&&(_<8&&(a[_]=A(n.pow(S,1/2))),c[_]=A(n.pow(S,1/3)),_++),S++})();var d=[],m=h.SHA256=u.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(w,A){for(var S=this._hash.words,_=S[0],v=S[1],N=S[2],O=S[3],I=S[4],k=S[5],M=S[6],j=S[7],G=0;G<64;G++){if(G<16)d[G]=w[A+G]|0;else{var ee=d[G-15],_e=(ee<<25|ee>>>7)^(ee<<14|ee>>>18)^ee>>>3,be=d[G-2],Ne=(be<<15|be>>>17)^(be<<13|be>>>19)^be>>>10;d[G]=_e+d[G-7]+Ne+d[G-16]}var ne=I&k^~I&M,Me=_&v^_&N^v&N,Be=(_<<30|_>>>2)^(_<<19|_>>>13)^(_<<10|_>>>22),At=(I<<26|I>>>6)^(I<<21|I>>>11)^(I<<7|I>>>25),fe=j+At+ne+c[G]+d[G],$e=Be+Me;j=M,M=k,k=I,I=O+fe|0,O=N,N=v,v=_,_=fe+$e|0}S[0]=S[0]+_|0,S[1]=S[1]+v|0,S[2]=S[2]+N|0,S[3]=S[3]+O|0,S[4]=S[4]+I|0,S[5]=S[5]+k|0,S[6]=S[6]+M|0,S[7]=S[7]+j|0},_doFinalize:function(){var w=this._data,A=w.words,S=this._nDataBytes*8,_=w.sigBytes*8;return A[_>>>5]|=128<<24-_%32,A[(_+64>>>9<<4)+14]=n.floor(S/4294967296),A[(_+64>>>9<<4)+15]=S,w.sigBytes=A.length*4,this._process(),this._hash},clone:function(){var w=u.clone.call(this);return w._hash=this._hash.clone(),w}});s.SHA256=u._createHelper(m),s.HmacSHA256=u._createHmacHelper(m)}(Math),r.SHA256})}(Hs)),Hs.exports}var qs={exports:{}},ou;function G0(){return ou||(ou=1,function(e,t){(function(r,n){e.exports=n(ei())})(U,function(r){(function(){var n=r,s=n.lib,i=s.Base,o=n.enc,u=o.Utf8,h=n.algo;h.HMAC=i.extend({init:function(a,c){a=this._hasher=new a.init,typeof c=="string"&&(c=u.parse(c));var d=a.blockSize,m=d*4;c.sigBytes>m&&(c=a.finalize(c)),c.clamp();for(var w=this._oKey=c.clone(),A=this._iKey=c.clone(),S=w.words,_=A.words,v=0;v<d;v++)S[v]^=1549556828,_[v]^=909522486;w.sigBytes=A.sigBytes=m,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var c=this._hasher,d=c.finalize(a);c.reset();var m=c.finalize(this._oKey.clone().concat(d));return m}})})()})}(qs)),qs.exports}(function(e,t){(function(r,n,s){e.exports=n(ei(),q0(),G0())})(U,function(r){return r.HmacSHA256})})(ff);var K0=ff.exports,lf={exports:{}};(function(e,t){(function(r,n){e.exports=n(ei())})(U,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,o=n.enc;o.Base64={stringify:function(h){var a=h.words,c=h.sigBytes,d=this._map;h.clamp();for(var m=[],w=0;w<c;w+=3)for(var A=a[w>>>2]>>>24-w%4*8&255,S=a[w+1>>>2]>>>24-(w+1)%4*8&255,_=a[w+2>>>2]>>>24-(w+2)%4*8&255,v=A<<16|S<<8|_,N=0;N<4&&w+N*.75<c;N++)m.push(d.charAt(v>>>6*(3-N)&63));var O=d.charAt(64);if(O)for(;m.length%4;)m.push(O);return m.join("")},parse:function(h){var a=h.length,c=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var m=0;m<c.length;m++)d[c.charCodeAt(m)]=m}var w=c.charAt(64);if(w){var A=h.indexOf(w);A!==-1&&(a=A)}return u(h,a,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function u(h,a,c){for(var d=[],m=0,w=0;w<a;w++)if(w%4){var A=c[h.charCodeAt(w-1)]<<w%4*2,S=c[h.charCodeAt(w)]>>>6-w%4*2;d[m>>>2]|=(A|S)<<24-m%4*8,m++}return i.create(d,m)}}(),r.enc.Base64})})(lf);var V0=lf.exports,hf={exports:{}};(function(e,t){(function(r,n){e.exports=n(ei())})(U,function(r){return r.enc.Utf8})})(hf);var J0=hf.exports,ma=U&&U.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(H,"__esModule",{value:!0});H.transformPhone=H.sleep=H.printGroupLog=H.throwError=H.printInfo=H.printError=H.printWarn=H.execCallback=H.createPromiseCallback=H.removeParam=H.getHash=H.getQuery=H.toQueryString=H.createSign=H.formatUrl=H.genSeqId=H.isFormData=H.isInstanceOf=H.isNull=H.isPalinObject=H.isUndefined=H.isString=H.isArray=void 0;var z0=ma(K0),Z0=ma(V0),au=ma(J0),us=Qn;function X0(e){return Object.prototype.toString.call(e)==="[object Array]"}H.isArray=X0;function Q0(e){return typeof e=="string"}H.isString=Q0;function eg(e){return typeof e>"u"}H.isUndefined=eg;function tg(e){return Object.prototype.toString.call(e)==="[object Object]"}H.isPalinObject=tg;function rg(e){return Object.prototype.toString.call(e)==="[object Null]"}H.isNull=rg;function ng(e,t){return e instanceof t}H.isInstanceOf=ng;function ig(e){return Object.prototype.toString.call(e)==="[object FormData]"}H.isFormData=ig;function sg(){return Math.random().toString(16).slice(2)}H.genSeqId=sg;function og(e,t,r){r===void 0&&(r={});var n=/\?/.test(t),s="";for(var i in r)s===""?!n&&(t+="?"):s+="&",s+=i+"="+encodeURIComponent(r[i]);return t+=s,/^http(s)?\:\/\//.test(t)?t:""+e+t}H.formatUrl=og;function Gs(e){var t=Z0.default.stringify(e);return t=t.replace(/=+$/,""),t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t}function ag(e,t){var r={alg:"HS256",typ:"JWT"},n=Gs(au.default.parse(JSON.stringify(r))),s=Gs(au.default.parse(JSON.stringify(e))),i=n+"."+s,o=Gs(z0.default(i,t));return i+"."+o}H.createSign=ag;function ug(e){e===void 0&&(e={});var t=[];for(var r in e)t.push(r+"="+encodeURIComponent(e[r]));return t.join("&")}H.toQueryString=ug;function cg(e,t){if(typeof window>"u")return!1;var r=t||window.location.search,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=r.substr(r.indexOf("?")+1).match(n);return s!=null?s[2]:""}H.getQuery=cg;H.getHash=function(e){if(typeof window>"u")return"";var t=window.location.hash.match(new RegExp("[#?&/]"+e+"=([^&#]*)"));return t?t[1]:""};function fg(e,t){var r=t.split("?")[0],n,s=[],i=t.indexOf("?")!==-1?t.split("?")[1]:"";if(i!==""){s=i.split("&");for(var o=s.length-1;o>=0;o-=1)n=s[o].split("=")[0],n===e&&s.splice(o,1);r=r+"?"+s.join("&")}return r}H.removeParam=fg;function lg(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,s){e=function(i,o){return i?s(i):n(o)}});return e.promise=r,e}H.createPromiseCallback=lg;function hg(e,t,r){if(r===void 0&&(r=null),e&&typeof e=="function")return e(t,r);if(t)throw t;return r}H.execCallback=hg;function dg(e,t){console.warn("["+us.getSdkName()+"]["+e+"]:"+t)}H.printWarn=dg;function pg(e,t){console.error({code:e,msg:"["+us.getSdkName()+"]["+e+"]:"+t})}H.printError=pg;function yg(e,t){console.log("["+us.getSdkName()+"]["+e+"]:"+t)}H.printInfo=yg;function gg(e,t){throw new Error(JSON.stringify({code:e,msg:"["+us.getSdkName()+"]["+e+"]:"+t}))}H.throwError=gg;function mg(e){var t=e.title,r=e.subtitle,n=r===void 0?"":r,s=e.content,i=s===void 0?[]:s,o=e.printTrace,u=o===void 0?!1:o,h=e.collapsed,a=h===void 0?!1:h;a?console.groupCollapsed(t,n):console.group(t,n);for(var c=0,d=i;c<d.length;c++){var m=d[c],w=m.type,A=m.body;switch(w){case"info":console.log(A);break;case"warn":console.warn(A);break;case"error":console.error(A);break}}u&&console.trace("stack trace:"),console.groupEnd()}H.printGroupLog=mg;H.sleep=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})};function _g(e){return"+86"+e}H.transformPhone=_g;var vg=U&&U.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ot=U&&U.__assign||function(){return ot=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ot.apply(this,arguments)},wg=U&&U.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Eg=U&&U.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(sn,"__esModule",{value:!0});sn.WebRequest=sn.genAdapter=void 0;var bg=cf,Ks=H,Sg=Ye,df=function(e){vg(t,e);function t(r){var n=e.call(this)||this,s=r.timeout,i=r.timeoutMsg,o=r.restrictedMethods;return n._timeout=s||0,n._timeoutMsg=i||"",n._restrictedMethods=o||["get","post","upload","download"],n}return t.prototype.get=function(r){return this._request(ot(ot({},r),{method:"get"}),this._restrictedMethods.includes("get"))},t.prototype.post=function(r){return this._request(ot(ot({},r),{method:"post"}),this._restrictedMethods.includes("post"))},t.prototype.put=function(r){return this._request(ot(ot({},r),{method:"put"}))},t.prototype.upload=function(r){var n=r.data,s=r.file,i=r.name,o=new FormData;for(var u in n)o.append(u,n[u]);return o.append("key",i),o.append("file",s),this._request(ot(ot({},r),{data:o,method:"post"}),this._restrictedMethods.includes("upload"))},t.prototype.download=function(r){return wg(this,void 0,void 0,function(){var n,s,i,o;return Eg(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.get(ot(ot({},r),{headers:{},responseType:"blob"}))];case 1:return n=u.sent().data,s=window.URL.createObjectURL(new Blob([n])),i=decodeURIComponent(new URL(r.url).pathname.split("/").pop()||""),o=document.createElement("a"),o.href=s,o.setAttribute("download",i),o.style.display="none",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(s),document.body.removeChild(o),[3,3];case 2:return u.sent(),[3,3];case 3:return[2,new Promise(function(h){h({statusCode:200,tempFilePath:r.url})})]}})})},t.prototype._request=function(r,n){var s=this;n===void 0&&(n=!1);var i=String(r.method).toLowerCase()||"get";return new Promise(function(o){var u=r.url,h=r.headers,a=h===void 0?{}:h,c=r.data,d=r.responseType,m=r.withCredentials,w=r.body,A=r.onUploadProgress,S=Ks.formatUrl(Sg.getProtocol(),u,i==="get"?c:{}),_=new XMLHttpRequest;_.open(i,S),d&&(_.responseType=d);for(var v in a)_.setRequestHeader(v,a[v]);var N;A&&_.upload.addEventListener("progress",A),_.onreadystatechange=function(){var I={};if(_.readyState===4){var k=_.getAllResponseHeaders(),M=k.trim().split(/[\r\n]+/),j={};M.forEach(function(G){var ee=G.split(": "),_e=ee.shift().toLowerCase(),be=ee.join(": ");j[_e]=be}),I.header=j,I.statusCode=_.status;try{I.data=d==="blob"?_.response:JSON.parse(_.responseText)}catch{I.data=d==="blob"?_.response:_.responseText}clearTimeout(N),o(I)}},n&&s._timeout&&(N=setTimeout(function(){console.warn(s._timeoutMsg),_.abort()},s._timeout));var O;Ks.isFormData(c)?O=c:a["content-type"]==="application/x-www-form-urlencoded"?O=Ks.toQueryString(c):w?O=w:O=c?JSON.stringify(c):void 0,m&&(_.withCredentials=!0),_.send(O)})},t}(bg.AbstractSDKRequest);sn.WebRequest=df;function Ag(){var e={root:window,reqClass:df,wsClass:WebSocket,localStorage,sessionStorage};return e}sn.genAdapter=Ag;(function(e){var t=U&&U.__createBinding||(Object.create?function(a,c,d,m){m===void 0&&(m=d),Object.defineProperty(a,m,{enumerable:!0,get:function(){return c[d]}})}:function(a,c,d,m){m===void 0&&(m=d),a[m]=c[d]}),r=U&&U.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),n=U&&U.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var d in a)d!=="default"&&Object.hasOwnProperty.call(a,d)&&t(c,a,d);return r(c,a),c};Object.defineProperty(e,"__esModule",{value:!0}),e.useDefaultAdapter=e.useAdapters=e.RUNTIME=void 0;var s=n(sn),i=H,o;(function(a){a.WEB="web",a.WX_MP="wx_mp"})(o=e.RUNTIME||(e.RUNTIME={}));function u(a){for(var c=i.isArray(a)?a:[a],d=0,m=c;d<m.length;d++){var w=m[d],A=w.isMatch,S=w.genAdapter,_=w.runtime;if(A())return{adapter:S(),runtime:_}}}e.useAdapters=u;function h(){return{adapter:s.genAdapter(),runtime:o.WEB}}e.useDefaultAdapter=h})(af);var cs={},hi={},Ig=U&&U.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),di=U&&U.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},pi=U&&U.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(cs,"__esModule",{value:!0});cs.CloudbaseCache=void 0;var Tg=cf,vt=H,Ot=Qn,yi=function(e){Ig(t,e);function t(r){var n=e.call(this)||this;return n._root=r,r.tcbCacheObject||(r.tcbCacheObject={}),n}return t.prototype.setItem=function(r,n){this._root.tcbCacheObject[r]=n},t.prototype.getItem=function(r){return this._root.tcbCacheObject[r]},t.prototype.removeItem=function(r){delete this._root.tcbCacheObject[r]},t.prototype.clear=function(){delete this._root.tcbCacheObject},t}(Tg.AbstractStorage);function Vs(e,t){switch(e){case"local":return t.localStorage?t.localStorage:(vt.printWarn(Ot.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new yi(t.root));case"none":return new yi(t.root);case"session":return t.sessionStorage?t.sessionStorage:(vt.printWarn(Ot.ERRORS.INVALID_PARAMS,"sessionStorage is not supported on current platform"),new yi(t.root));default:return t.localStorage?t.localStorage:(vt.printWarn(Ot.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new yi(t.root))}}var Og=function(){function e(t){this.keys={};var r=t.persistence,n=t.platformInfo,s=n===void 0?{}:n,i=t.keys,o=i===void 0?{}:i,u=t.alwaysLocalKeys,h=u===void 0?[]:u;this._platformInfo=s,this._alwaysLocalKeys=h,this._storage||(this._persistence=s.adapter.primaryStorage||r,this._storage=Vs(this._persistence,s.adapter),this.keys=o)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this._storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this._persistence},enumerable:!1,configurable:!0}),e.prototype.updatePersistence=function(t){if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use updatePersistenceAsync insteed");return}if(t!==this._persistence){var r=this._persistence==="local";this._persistence=t;var n=Vs(t,this._platformInfo.adapter);for(var s in this.keys){var i=this.keys[s];if(!(r&&this._alwaysLocalKeys.includes(s))){var o=this._storage.getItem(i);!vt.isUndefined(o)&&!vt.isNull(o)&&(n.setItem(i,o),this._storage.removeItem(i))}}this._storage=n}},e.prototype.updatePersistenceAsync=function(t){return di(this,void 0,void 0,function(){var r,n,s,i,o,u,h,a;return pi(this,function(c){switch(c.label){case 0:if(t===this._persistence)return[2];r=this._persistence==="local",this._persistence=t,n=Vs(t,this._platformInfo.adapter),s=[];for(i in this.keys)s.push(i);o=0,c.label=1;case 1:return o<s.length?(u=s[o],h=this.keys[u],r&&this._alwaysLocalKeys.includes(u)?[3,4]:[4,this._storage.getItem(h)]):[3,5];case 2:return a=c.sent(),!vt.isUndefined(a)&&!vt.isNull(a)?(n.setItem(h,a),[4,this._storage.removeItem(h)]):[3,4];case 3:c.sent(),c.label=4;case 4:return o++,[3,1];case 5:return this._storage=n,[2]}})})},e.prototype.setStore=function(t,r,n){if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed");return}if(this._storage)try{var s={version:n||"localCachev1",content:r};this._storage.setItem(t,JSON.stringify(s))}catch(i){throw new Error(JSON.stringify({code:Ot.ERRORS.OPERATION_FAIL,msg:"["+Ot.getSdkName()+"]["+Ot.ERRORS.OPERATION_FAIL+"]setStore failed",info:i}))}},e.prototype.setStoreAsync=function(t,r,n){return di(this,void 0,void 0,function(){var s;return pi(this,function(i){switch(i.label){case 0:if(!this._storage)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),s={version:n||"localCachev1",content:r},[4,this._storage.setItem(t,JSON.stringify(s))];case 2:return i.sent(),[3,4];case 3:return i.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(t,r){var n;if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed");return}try{if(typeof process<"u"&&(!((n=hi)===null||n===void 0)&&n.tcb_token))return hi.tcb_token;if(!this._storage)return""}catch{return""}r=r||"localCachev1";var s=this._storage.getItem(t);if(!s)return"";if(s.indexOf(r)>=0){var i=JSON.parse(s);return i.content}else return""},e.prototype.getStoreAsync=function(t,r){var n;return di(this,void 0,void 0,function(){var s,i;return pi(this,function(o){switch(o.label){case 0:try{if(typeof process<"u"&&(!((n=hi)===null||n===void 0)&&n.tcb_token))return[2,hi.tcb_token];if(!this._storage)return[2,""]}catch{return[2,""]}return r=r||"localCachev1",[4,this._storage.getItem(t)];case 1:return s=o.sent(),s?s.indexOf(r)>=0?(i=JSON.parse(s),[2,i.content]):[2,""]:[2,""]}})})},e.prototype.removeStore=function(t){if(this.mode==="async"){vt.printWarn(Ot.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed");return}this._storage.removeItem(t)},e.prototype.removeStoreAsync=function(t){return di(this,void 0,void 0,function(){return pi(this,function(r){switch(r.label){case 0:return[4,this._storage.removeItem(t)];case 1:return r.sent(),[2]}})})},e}();cs.CloudbaseCache=Og;var Je={},xg=U&&U.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ng=U&&U.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,s++)n[s]=i[o];return n};Object.defineProperty(Je,"__esModule",{value:!0});Je.removeEventListener=Je.activateEvent=Je.addEventListener=Je.CloudbaseEventEmitter=Je.IErrorEvent=Je.CloudbaseEvent=void 0;var uu=H;function Rg(e,t,r){r[e]=r[e]||[],r[e].push(t)}function Dg(e,t,r){if(r!=null&&r[e]){var n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var _a=function(){function e(t,r){this.data=r||null,this.name=t}return e}();Je.CloudbaseEvent=_a;var pf=function(e){xg(t,e);function t(r,n){var s=e.call(this,"error",{error:r,data:n})||this;return s.error=r,s}return t}(_a);Je.IErrorEvent=pf;var yf=function(){function e(){this._listeners={}}return e.prototype.on=function(t,r){return Rg(t,r,this._listeners),this},e.prototype.off=function(t,r){return Dg(t,r,this._listeners),this},e.prototype.fire=function(t,r){if(uu.isInstanceOf(t,pf))return console.error(t.error),this;var n=uu.isString(t)?new _a(t,r||{}):t,s=n.name;if(this._listens(s)){n.target=this;for(var i=this._listeners[s]?Ng(this._listeners[s]):[],o=0,u=i;o<u.length;o++){var h=u[o];h.call(this,n)}}return this},e.prototype._listens=function(t){return this._listeners[t]&&this._listeners[t].length>0},e}();Je.CloudbaseEventEmitter=yf;var va=new yf;function Cg(e,t){va.on(e,t)}Je.addEventListener=Cg;function Pg(e,t){t===void 0&&(t={}),va.fire(e,t)}Je.activateEvent=Pg;function kg(e,t){va.off(e,t)}Je.removeEventListener=kg;var gf={},fs={},Mg=U&&U.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Fg=U&&U.__generator||function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(fs,"__esModule",{value:!0});fs.catchErrorsDecorator=void 0;var cu=H,Lg=Qn,Ln=!1;typeof navigator<"u"&&navigator.userAgent&&(Ln=navigator.userAgent.indexOf("Firefox")!==-1);var Ug=Ln?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,mf=/https?\:\/\/.+\:\d*\/.*\.js\:\d+\:\d+/;function Bg(e){var t=e.mode,r=t===void 0?"async":t,n=e.customInfo,s=n===void 0?{}:n,i=e.title,o=e.messages,u=o===void 0?[]:o;return function(h,a,c){if(Lg.IS_DEBUG_MODE){var d=s.className||h.constructor.name,m=s.methodName||a,w=c.value,A=$g(new Error);r==="sync"?c.value=function(){for(var S=[],_=0;_<arguments.length;_++)S[_]=arguments[_];var v=fu({err:new Error,className:d,methodName:m,sourceLink:A});try{return w.apply(this,S)}catch(M){var N=M,O=M.message,I={title:i||d+"."+m+" failed",content:[{type:"error",body:M}]};if(O&&/^\{.*\}$/.test(O)){var k=JSON.parse(O);I.subtitle=O,k.code&&(v?(v.code=k.code,v.msg=k.msg):(M.code=k.code,M.message=k.msg),N=v||M,I.content=u.map(function(j){return{type:"info",body:j}}))}throw cu.printGroupLog(I),N}}:c.value=function(){for(var S=[],_=0;_<arguments.length;_++)S[_]=arguments[_];return Mg(this,void 0,void 0,function(){var v,N,O,I,k,M;return Fg(this,function(j){switch(j.label){case 0:v=fu({err:new Error,className:d,methodName:m,sourceLink:A}),j.label=1;case 1:return j.trys.push([1,3,,4]),[4,w.apply(this,S)];case 2:return[2,j.sent()];case 3:throw N=j.sent(),O=N,I=N.message,k={title:i||d+"."+m+" failed",content:[{type:"error",body:N}]},I&&/^\{.*\}$/.test(I)&&(M=JSON.parse(I),k.subtitle=M,M.code&&(v?(v.code=M.code,v.message=M.msg):(N.code=M.code,N.message=M.msg),O=v||N,k.content=u.map(function(G){return{type:"info",body:G}}))),cu.printGroupLog(k),O;case 4:return[2]}})})}}}}fs.catchErrorsDecorator=Bg;function $g(e){var t="",r=e.stack.split(`
`),n=r.findIndex(function(i){return Ug.test(i)});if(n!==-1){var s=mf.exec(r[n+1]||"");t=s?s[0]:""}return t}function fu(e){var t=e.err,r=e.className,n=e.methodName,s=e.sourceLink;if(!s)return null;var i=t.stack.split(`
`),o=Ln?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp(r+"\\.descriptor.value\\s*\\[as\\s"+n+"\\]\\s*\\(.*\\)$"),u=Ln?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp(r+"\\.descriptor.value\\s*\\[as\\s"+n+"\\]"),h=i.findIndex(function(d){return o.test(d)}),a;if(h!==-1){var c=i.filter(function(d,m){return m>h});c.unshift(i[h].replace(u,r+"."+n).replace(mf,s)),a=new Error,a.stack=(Ln?"@debugger":"Error")+`
`+c.join(`
`)}return a}(function(e){var t=U&&U.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i),Object.defineProperty(n,o,{enumerable:!0,get:function(){return s[i]}})}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=U&&U.__exportStar||function(n,s){for(var i in n)i!=="default"&&!s.hasOwnProperty(i)&&t(s,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(fs,e)})(gf);var Wg=U&&U.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),jg=U&&U.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),fn=U&&U.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Wg(t,e,r);return jg(t,e),t};Object.defineProperty(Qe,"__esModule",{value:!0});var er=Qe.helpers=Ee=Qe.utils=wa=Qe.events=_f=Qe.cache=Cr=Qe.adapters=we=Qe.constants=void 0,Yg=fn(Qn),we=Qe.constants=Yg,Hg=fn(af),Cr=Qe.adapters=Hg,qg=fn(cs),_f=Qe.cache=qg,Gg=fn(Je),wa=Qe.events=Gg,Kg=fn(H),Ee=Qe.utils=Kg,Vg=fn(gf);er=Qe.helpers=Vg;var Jg=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Li=function(){return Li=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Li.apply(this,arguments)},zg=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Zg=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};function Xg(){if(typeof wx>"u"||typeof Page>"u"||!wx.getSystemInfoSync||!wx.getStorageSync||!wx.setStorageSync||!wx.connectSocket||!wx.request)return!1;try{if(!wx.getSystemInfoSync()||wx.getSystemInfoSync().AppPlatform==="qq")return!1}catch{return!1}return!0}function Qg(){return typeof App>"u"&&typeof getApp>"u"&&!wx.onAppHide&&!wx.offAppHide&&!wx.onAppShow&&!wx.offAppShow}var em=function(e){Jg(t,e);function t(r){r===void 0&&(r={});var n=e.call(this)||this,s=r.timeout,i=r.timeoutMsg,o=r.restrictedMethods;return n._timeout=s||0,n._timeoutMsg=i||"",n._restrictedMethods=o||["get","post","upload","download"],n}return t.prototype.post=function(r){var n=this;return new Promise(function(s,i){var o=r.url,u=r.data,h=r.headers,a=wx.request({url:ko("https:",o),data:u,timeout:n._timeout,method:"POST",header:h,success:function(c){s(c)},fail:function(c){i(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!n._timeout||n._restrictedMethods.indexOf("post")===-1)){var d=c.errMsg;if(d==="request:fail timeout"){console.warn(n._timeoutMsg);try{a.abort()}catch{}}}}})})},t.prototype.upload=function(r){var n=this,s=this;return new Promise(function(i){return zg(n,void 0,void 0,function(){var o,u,h,a,c,d;return Zg(this,function(m){return o=r.url,u=r.file,h=r.data,a=r.headers,c=r.onUploadProgress,d=wx.uploadFile({url:o,filePath:u,name:"file",formData:Li({},h),header:a,timeout:this._timeout,success:function(w){var A={statusCode:w.statusCode,data:w.data||{}};w.statusCode===200&&h.success_action_status&&(A.statusCode=parseInt(h.success_action_status,10)),i(A)},fail:function(w){i(w)},complete:function(w){if(!(!w||!w.errMsg)&&!(!s._timeout||s._restrictedMethods.indexOf("upload")===-1)){var A=w.errMsg;if(A==="request:fail timeout"){console.warn(s._timeoutMsg);try{d.abort()}catch{}}}}}),c&&d.onProgressUpdate(function(w){c(w)}),[2]})})})},t.prototype.download=function(r){var n=this,s=this;return new Promise(function(i,o){var u=r.url,h=r.headers,a=wx.downloadFile({url:ko("https:",u),header:h,timeout:n._timeout,success:function(c){c.statusCode===200&&c.tempFilePath?i({statusCode:200,tempFilePath:c.tempFilePath}):i(c)},fail:function(c){o(c)},complete:function(c){if(!(!c||!c.errMsg)&&!(!s._timeout||s._restrictedMethods.indexOf("download")===-1)){var d=c.errMsg;if(d==="request:fail timeout"){console.warn(s._timeoutMsg);try{a.abort()}catch{}}}}})})},t}(uf),tm={setItem:function(e,t){wx.setStorageSync(e,t)},getItem:function(e){return wx.getStorageSync(e)},removeItem:function(e){wx.removeStorageSync(e)},clear:function(){wx.clearStorageSync()}},rm=function(){function e(t,r){r===void 0&&(r={});var n=wx.connectSocket(Li({url:t},r)),s={set onopen(i){n.onOpen(i)},set onmessage(i){n.onMessage(i)},set onclose(i){n.onClose(i)},set onerror(i){n.onError(i)},send:function(i){return n.send({data:i})},close:function(i,o){return n.close({code:i,reason:o})},get readyState(){return n.readyState},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};return s}return e}();function nm(){var e={root:{},reqClass:em,wsClass:rm,localStorage:tm,primaryStorage:Fi.local,getAppSign:function(){var t=wx.getAccountInfoSync();return Qg()?t&&t.plugin?t.plugin.appId:"":t&&t.miniProgram?t.miniProgram.appId:""}};return e}var im={genAdapter:nm,isMatch:Xg,runtime:"wx_mp"},Mo=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,s++)n[s]=i[o];return n},Ui=we.ERRORS,lu={};function sm(e,t){var r=t.name,n=t.namespace,s=t.entity,i=t.injectEvents,o=t.IIFE,u=o===void 0?!1:o;if(lu[r]||n&&e[n])throw new Error(JSON.stringify({code:Ui.INVALID_OPERATION,msg:"Duplicate component "+r}));if(u){if(!s||typeof s!="function")throw new Error(JSON.stringify({code:Ui.INVALID_PARAMS,msg:"IIFE component's entity must be a function"}));s.call(e)}if(lu[r]=t,n?e.prototype[n]=s:vf(e.prototype,s),i){var h=i.bus,a=i.events;if(!h||!a||a.length===0)return;var c=e.prototype.fire||function(){};e.prototype.events||(e.prototype.events={});var d=e.prototype.events||{};d[r]?e.prototype.events[r].events=Mo(e.prototype.events[r].events,a):e.prototype.events[r]={bus:h,events:a},e.prototype.fire=function(m,w){c(m,w);for(var A in this.events){var S=this.events[A],_=S.bus,v=S.events;if(v.includes(m)){_.fire(m,w);break}}}}}function vf(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var r=t;return new Date(r.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=vf(e[n],t[n]));return e}function om(e,t){var r=t.entity,n=t.target;if(!e.prototype.hasOwnProperty(n))throw new Error(JSON.stringify({code:Ui.INVALID_OPERATION,msg:"target:"+n+" is not exist"}));var s=e.prototype[n];if(typeof s!="function")throw new Error(JSON.stringify({code:Ui.INVALID_OPERATION,msg:"target:"+n+" is not a function which is the only type supports hook"}));e.prototype[n]=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.call.apply(r,Mo([this],i)),s.call.apply(s,Mo([this],i))}}var at={},Vr=function(){return Vr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Vr.apply(this,arguments)},am="access_token",um="access_token_expire",cm="refresh_token",fm="anonymous_uuid",lm="login_type",hm="user_info",hu=_f.CloudbaseCache,Ni={},Fo={};function du(e){var t=e.env,r=e.persistence,n=e.platformInfo,s=am+"_"+t,i=um+"_"+t,o=cm+"_"+t,u=fm+"_"+t,h=lm+"_"+t,a=hm+"_"+t,c={accessTokenKey:s,accessTokenExpireKey:i,refreshTokenKey:o,anonymousUuidKey:u,loginTypeKey:h,userInfoKey:a};Ni[t]?Ni[t].updatePersistence(r):Ni[t]=new hu(Vr(Vr({},e),{keys:c,platformInfo:n,alwaysLocalKeys:["anonymousUuidKey"]})),Fo[t]=Fo[t]||new hu(Vr(Vr({},e),{keys:c,platformInfo:n,persistence:"local"}))}function wf(e){return Ni[e]}function Ef(e){return Fo[e]}var dm=we.setSdkName,pm=we.setProtocol,bf="",Sf="@cloudbase/js-sdk";function ym(e){bf=e}function gm(){return bf}function mm(e){Sf=e,dm(e)}function _m(){return Sf}var vm="2020-01-10",Af=typeof location<"u"&&location.protocol==="http:"?"http:":"https:",If=(typeof process<"u","//tcb-api.tencentcloudapi.com/web");function Tf(e,t){If=e,t&&(Af=t,pm(t))}function wm(e,t,r){var n=t?"//"+e+"."+t+".tcb-api.tencentcloudapi.com/web":"//"+e+".ap-shanghai.tcb-api.tencentcloudapi.com/web";Tf(n,r)}function Em(){return{BASE_URL:If,PROTOCOL:Af}}var Lo;(function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.CUSTOM="CUSTOM",e.NULL="NULL"})(Lo||(Lo={}));var pu={LOGIN_STATE_CHANGED:"loginStateChanged",LOGIN_STATE_EXPIRED:"loginStateExpire",LOGIN_TYPE_CHANGED:"loginTypeChanged",ANONYMOUS_CONVERTED:"anonymousConverted",ACCESS_TOKEN_REFRESHD:"refreshAccessToken"},ht=function(){return ht=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ht.apply(this,arguments)},$t=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Wt=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Sn=we.ERRORS,bm=Ee.genSeqId,Sm=Ee.isFormData,Am=Ee.formatUrl,Im=Ee.createSign,Tm=Cr.RUNTIME,yu=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"];function Js(e,t,r){var n=e[t];e[t]=function(s){var i={},o={};r.forEach(function(h){var a=h.call(e,s),c=a.data,d=a.headers;Object.assign(i,c),Object.assign(o,d)});var u=s.data;return u&&function(){if(Sm(u)){for(var h in i)u.append(h,i[h]);return}s.data=ht(ht({},u),i)}(),s.headers=ht(ht({},s.headers||{}),o),n.call(e,s)}}function zs(){var e=bm();return{data:{seqId:e},headers:{"X-SDK-Version":"@cloudbase/js-sdk/"+gm(),"x-seqid":e}}}var Om=function(){function e(t){this._throwWhenRequestFail=!1,this.config=t,this._reqClass=new at.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:"[@cloudbase/js-sdk] "+this.config.timeout/1e3+"s",restrictedMethods:["post"]}),this._throwWhenRequestFail=t.throw||!1,this._cache=wf(this.config.env),this._localCache=Ef(this.config.env),Js(this._reqClass,"post",[zs]),Js(this._reqClass,"upload",[zs]),Js(this._reqClass,"download",[zs])}return e.prototype.post=function(t){return $t(this,void 0,void 0,function(){var r;return Wt(this,function(n){switch(n.label){case 0:return[4,this._reqClass.post(t)];case 1:return r=n.sent(),[2,r]}})})},e.prototype.upload=function(t){return $t(this,void 0,void 0,function(){var r;return Wt(this,function(n){switch(n.label){case 0:return[4,this._reqClass.upload(t)];case 1:return r=n.sent(),[2,r]}})})},e.prototype.download=function(t){return $t(this,void 0,void 0,function(){var r;return Wt(this,function(n){switch(n.label){case 0:return[4,this._reqClass.download(t)];case 1:return r=n.sent(),[2,r]}})})},e.prototype.refreshAccessToken=function(){return $t(this,void 0,void 0,function(){var t,r,n;return Wt(this,function(s){switch(s.label){case 0:this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken()),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._refreshAccessTokenPromise];case 2:return t=s.sent(),[3,4];case 3:return n=s.sent(),r=n,[3,4];case 4:if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,r)throw r;return[2,t]}})})},e.prototype.getAccessToken=function(){return $t(this,void 0,void 0,function(){var t,r,n,s,i,o,u,h,a,c;return Wt(this,function(d){switch(d.label){case 0:return t=this._cache.keys,r=t.accessTokenKey,n=t.accessTokenExpireKey,s=t.refreshTokenKey,[4,this._cache.getStoreAsync(s)];case 1:if(i=d.sent(),!i)throw new Error(JSON.stringify({code:Sn.OPERATION_FAIL,msg:"refresh token is not exist, your local data might be messed up, please retry after clear localStorage or sessionStorage"}));return[4,this._cache.getStoreAsync(r)];case 2:return o=d.sent(),h=Number,[4,this._cache.getStoreAsync(n)];case 3:return u=h.apply(void 0,[d.sent()]),a=!0,c=this._shouldRefreshAccessTokenHook,c?[4,this._shouldRefreshAccessTokenHook(o,u)]:[3,5];case 4:c=!d.sent(),d.label=5;case 5:return c&&(a=!1),(!o||!u||u<Date.now())&&a?[4,this.refreshAccessToken()]:[3,7];case 6:return[2,d.sent()];case 7:return[2,{accessToken:o,accessTokenExpire:u}]}})})},e.prototype.request=function(t,r,n){return $t(this,void 0,void 0,function(){var s,i,o,u,h,a,c,d,d,m,w,A,S,_,v,N,O,I,k,M,j,G,ee,_e,be,Ne,ne,Me;return Wt(this,function(Be){switch(Be.label){case 0:return s="x-tcb-trace_"+this.config.env,i="application/x-www-form-urlencoded",o=ht({action:t,dataVersion:vm,env:this.config.env},r),yu.indexOf(t)!==-1?[3,3]:(u=this._cache.keys.refreshTokenKey,[4,this._cache.getStoreAsync(u)]);case 1:return h=Be.sent(),h?(a=o,[4,this.getAccessToken()]):[3,3];case 2:a.access_token=Be.sent().accessToken,Be.label=3;case 3:if(t==="storage.uploadFile"){c=new FormData;for(d in c)c.hasOwnProperty(d)&&c[d]!==void 0&&c.append(d,o[d]);i="multipart/form-data"}else{i="application/json;charset=UTF-8",c={};for(d in o)o[d]!==void 0&&(c[d]=o[d])}return m={headers:{"content-type":i}},n!=null&&n.onUploadProgress&&(m.onUploadProgress=n.onUploadProgress),this.config.region&&(m.headers["X-TCB-Region"]=this.config.region),w=this._localCache.getStore(s),w&&(m.headers["X-TCB-Trace"]=w),at.runtime!==Tm.WEB&&(A=this.config,S=A.appSign,_=A.appSecret,v=Date.now(),N=_.appAccessKey,O=_.appAccessKeyId,I=Im({data:{},timestamp:v,appAccessKeyId:O,appSign:S},N),m.headers["X-TCB-App-Source"]="timestamp="+v+";appAccessKeyId="+O+";appSign="+S+";sign="+I),k=r.parse,M=r.inQuery,j=r.search,G={env:this.config.env},k&&(G.parse=!0),M&&(G=ht(ht({},M),G)),ee=Em(),_e=ee.BASE_URL,be=ee.PROTOCOL,Ne=Am(be,_e,G),j&&(Ne+=j),[4,this.post(ht({url:Ne,data:c},m))];case 4:if(ne=Be.sent(),Me=ne.header&&ne.header["x-tcb-trace"],Me&&this._localCache.setStore(s,Me),Number(ne.status)!==200&&Number(ne.statusCode)!==200||!ne.data)throw new Error("network request error");return[2,ne]}})})},e.prototype.send=function(t,r){return r===void 0&&(r={}),$t(this,void 0,void 0,function(){var n;return Wt(this,function(s){switch(s.label){case 0:return[4,this.request(t,r,{onUploadProgress:r.onUploadProgress})];case 1:return n=s.sent(),n.data.code==="ACCESS_TOKEN_EXPIRED"&&yu.indexOf(t)===-1?[4,this.refreshAccessToken()]:[3,4];case 2:return s.sent(),[4,this.request(t,r,{onUploadProgress:r.onUploadProgress})];case 3:n=s.sent(),s.label=4;case 4:if(n.data.code&&this._throwWhenRequestFail)throw new Error(JSON.stringify({code:Sn.OPERATION_FAIL,msg:"["+n.data.code+"] "+n.data.message}));return[2,n.data]}})})},e.prototype._refreshAccessToken=function(t){return t===void 0&&(t=1),$t(this,void 0,void 0,function(){var r,n,s,i,o,u,h,a,c,d,m,w,A,S;return Wt(this,function(_){switch(_.label){case 0:return r=this._cache.keys,n=r.accessTokenKey,s=r.accessTokenExpireKey,i=r.refreshTokenKey,o=r.loginTypeKey,u=r.anonymousUuidKey,[4,this._cache.removeStoreAsync(n)];case 1:return _.sent(),[4,this._cache.removeStoreAsync(s)];case 2:return _.sent(),[4,this._cache.getStoreAsync(i)];case 3:if(h=_.sent(),!h)throw new Error(JSON.stringify({code:Sn.INVALID_OPERATION,msg:"not login"}));return a={refresh_token:h},[4,this.request("auth.fetchAccessTokenWithRefreshToken",a)];case 4:return c=_.sent(),c.data.code?(d=c.data.code,d==="SIGN_PARAM_INVALID"||d==="REFRESH_TOKEN_EXPIRED"||d==="INVALID_REFRESH_TOKEN"?[4,this._cache.getStoreAsync(o)]:[3,11]):[3,12];case 5:return m=_.sent()===Lo.ANONYMOUS,m&&d==="INVALID_REFRESH_TOKEN"?[4,this._cache.getStoreAsync(u)]:[3,9];case 6:return w=_.sent(),[4,this._cache.getStoreAsync(i)];case 7:return A=_.sent(),[4,this.send("auth.signInAnonymously",{anonymous_uuid:w,refresh_token:A})];case 8:if(S=_.sent(),this._setRefreshToken(S.refresh_token),t>=1)return[2,this._refreshAccessToken(--t)];throw new Error(JSON.stringify({code:Sn.OPERATION_FAIL,message:" refresh token "}));case 9:return on.fire(pu.LOGIN_STATE_EXPIRED),[4,this._cache.removeStoreAsync(i)];case 10:_.sent(),_.label=11;case 11:throw new Error(JSON.stringify({code:Sn.NETWORK_ERROR,msg:"refresh access_token failed"+c.data.code}));case 12:return c.data.access_token?(on.fire(pu.ACCESS_TOKEN_REFRESHD),[4,this._cache.setStoreAsync(n,c.data.access_token)]):[3,15];case 13:return _.sent(),[4,this._cache.setStoreAsync(s,c.data.access_token_expire+Date.now())];case 14:return _.sent(),[2,{accessToken:c.data.access_token,accessTokenExpire:c.data.access_token_expire}];case 15:return c.data.refresh_token?[4,this._cache.removeStoreAsync(i)]:[3,19];case 16:return _.sent(),[4,this._cache.setStoreAsync(i,c.data.refresh_token)];case 17:return _.sent(),[4,this._refreshAccessToken()];case 18:_.sent(),_.label=19;case 19:return[2]}})})},e.prototype._setRefreshToken=function(t){return $t(this,void 0,void 0,function(){var r,n,s,i;return Wt(this,function(o){switch(o.label){case 0:return r=this._cache.keys,n=r.accessTokenKey,s=r.accessTokenExpireKey,i=r.refreshTokenKey,[4,this._cache.removeStoreAsync(n)];case 1:return o.sent(),[4,this._cache.removeStoreAsync(s)];case 2:return o.sent(),[4,this._cache.setStoreAsync(i,t)];case 3:return o.sent(),[2]}})})},e}(),Of={};function xm(e){Of[e.env]=new Om(ht(ht({},e),{throw:!0}))}function Nm(e){return Of[e]}var Bi=function(){return Bi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Bi.apply(this,arguments)},gu=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},$r=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Rm=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Dm=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Cm=Cr.useAdapters,Pm=Cr.useDefaultAdapter,km=Cr.RUNTIME,gr=we.ERRORS,mu=we.COMMUNITY_SITE_URL,_u=Ee.printWarn,vu=er.catchErrorsDecorator,Mm={timeout:15e3,persistence:"local"},wu=1e3*60*10,Eu=100,bu={},Fm=function(){function e(t){this._config=t||this._config,this.authInstance=null}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return at},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cache",{get:function(){return wf(this._config.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCache",{get:function(){return Ef(this._config.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){return Nm(this._config.env)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){if(!t.env)throw new Error(JSON.stringify({code:gr.INVALID_PARAMS,msg:"env must not be specified"}));if(at.adapter||this._useDefaultAdapter(),this.requestClient=new at.adapter.reqClass({timeout:t.timeout||5e3,timeoutMsg:"["+_m()+"][REQUEST TIMEOUT] request had been abort since didn't finished within"+t.timeout/1e3+"s"}),at.runtime!==km.WEB){if(!t.appSecret)throw new Error(JSON.stringify({code:gr.INVALID_PARAMS,msg:"invalid appSecret"}));var r=at.adapter.getAppSign?at.adapter.getAppSign():"";if(t.appSign&&r&&t.appSign!==r)throw new Error(JSON.stringify({code:gr.INVALID_PARAMS,msg:"invalid appSign"}));if(r&&(t.appSign=r),!t.appSign)throw new Error(JSON.stringify({code:gr.INVALID_PARAMS,msg:"invalid appSign"}))}this._config=Bi(Bi({},Mm),t),this._config.timeout=this._formatTimeout(this._config.timeout);var n=this._config,s=n.env,i=n.persistence,o=n.debug,u=n.timeout,h=n.appSecret,a=n.appSign;du({env:s,persistence:i,debug:o,platformInfo:this.platform}),xm({env:s,region:t.region||"",timeout:u,appSecret:h,appSign:a}),t.region&&wm(s,t.region||"");var c=new e(this._config);return c.requestClient=this.requestClient,c},e.prototype.updateConfig=function(t){var r=t.persistence,n=t.debug;this._config.persistence=r,this._config.debug=n,du({env:this._config.env,persistence:r,debug:n,platformInfo:this.platform})},e.prototype.registerExtension=function(t){bu[t.name]=t},e.prototype.invokeExtension=function(t,r){return Rm(this,void 0,void 0,function(){var n;return Dm(this,function(s){switch(s.label){case 0:if(n=bu[t],!n)throw new Error(JSON.stringify({code:gr.INVALID_PARAMS,msg:"extension:"+t+" must be registered before invoke"}));return[4,n.invoke(r,this)];case 1:return[2,s.sent()]}})})},e.prototype.useAdapters=function(t){var r=Cm(t)||{},n=r.adapter,s=r.runtime;n&&(at.adapter=n),s&&(at.runtime=s)},e.prototype.registerHook=function(t){om(e,t)},e.prototype.registerComponent=function(t){sm(e,t)},e.prototype.registerVersion=function(t){ym(t)},e.prototype.registerSdkName=function(t){mm(t)},e.prototype.registerEndPoint=function(t,r){Tf(t,r)},e.prototype._useDefaultAdapter=function(){var t=Pm(),r=t.adapter,n=t.runtime;at.adapter=r,at.runtime=n},e.prototype._formatTimeout=function(t){switch(!0){case t>wu:return _u(gr.INVALID_PARAMS,"timeout is greater than maximum value[10min]"),wu;case t<Eu:return _u(gr.INVALID_PARAMS,"timeout is less than maximum value[100ms]"),Eu;default:return t}},gu([vu({mode:"sync",title:"Cloudbase ",messages:["","  1 -  cloudbase.init() ","  2 - https://docs.cloudbase.net/api-reference/webv2/adapter.html#jie-ru-liu-cheng",""+mu]}),$r("design:type",Function),$r("design:paramtypes",[Object]),$r("design:returntype",e)],e.prototype,"init",null),gu([vu({title:"",messages:["","  1 -  invokeExtension() ","  2 -  registerExtension() ",""+mu]}),$r("design:type",Function),$r("design:paramtypes",[String,Object]),$r("design:returntype",Promise)],e.prototype,"invokeExtension",null),e}(),on=new Fm;on.useAdapters(im);const Lm="@cloudbase/js-sdk",Um="1.7.2",Bm="cloudbase javascript sdk",$m="dist/index.cjs.js",Wm="dist/index.esm.js",jm="miniprogram_dist",Ym="./index.d.ts",Hm={lint:'eslint --fix "./src/**/*.ts" "./database/**/*.ts"',build:"rm -rf dist/ && gulp build","build:cdn":"gulp cdn","build:miniapp":"gulp miniapp","build:e2e":"rm -rf dist/ && NODE_ENV=e2e gulp e2e"},qm={access:"public"},Gm={type:"git",url:"https://github.com/TencentCloudBase/cloudbase-js-sdk"},Km=["tcb","cloudbase","Cloudbase","serverless","Serverless","javascript","JavaScript"],Vm=["miniprogram_dist","**/dist/","/index.d.ts","**/package.json"],Jm=["app","auth","database","functions","storage"],zm="",Zm="ISC",Xm={"@cloudbase/analytics":"^1.1.1-alpha.0","@cloudbase/app":"^1.4.1","@cloudbase/auth":"^1.6.1","@cloudbase/database":"0.9.18-next","@cloudbase/functions":"^1.3.4","@cloudbase/realtime":"^1.1.4-alpha.0","@cloudbase/storage":"^1.3.4","@cloudbase/types":"^1.1.3-alpha.0","@cloudbase/utilities":"^1.3.4"},Qm={"@babel/core":"^7.9.0","@babel/plugin-proposal-class-properties":"^7.8.3","@babel/plugin-transform-runtime":"^7.9.0","@babel/preset-env":"^7.9.5","@babel/preset-typescript":"^7.9.0","@typescript-eslint/eslint-plugin":"^3.8.0","@typescript-eslint/parser":"^3.8.0","awesome-typescript-loader":"^5.2.1","babel-loader":"^8.1.0",eslint:"^7.6.0","eslint-config-alloy":"^3.7.4",gulp:"^4.0.2","gulp-clean":"^0.4.0","gulp-rename":"^2.0.0","gulp-sourcemaps":"^2.6.5","gulp-typescript":"^6.0.0-alpha.1","json-loader":"^0.5.7","merge-stream":"^2.0.0","package-json-cleanup-loader":"^1.0.3",typescript:"^3.8.3",webpack:"4.41.3","webpack-cli":"^3.3.11","webpack-node-externals":"^1.7.2","webpack-stream":"^5.2.1","webpack-visualizer-plugin":"^0.1.11"},e_=["last 2 version","> 1%","not dead","chrome 53"],t_="29ca0bf24318daa1fbb230910edf0b1545e17e7f",r_={name:Lm,version:Um,description:Bm,main:$m,module:Wm,miniprogram:jm,typings:Ym,scripts:Hm,publishConfig:qm,repository:Gm,keywords:Km,files:Vm,components:Jm,author:zm,license:Zm,dependencies:Xm,devDependencies:Qm,browserslist:e_,gitHead:t_};var n_=r_.version;on.registerVersion(n_);try{window.cloudbase=on}catch{}var An=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},In=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},ln=function(){function e(t){this._config=t,this._cache=t.cache,this._request=t.request}return e.prototype.checkLocalLoginState=function(){return An(this,void 0,void 0,function(){var t,r,n,s,i,o;return In(this,function(u){switch(u.label){case 0:return t=this._cache.keys,r=t.accessTokenKey,n=t.accessTokenExpireKey,[4,this._cache.getStoreAsync(r)];case 1:return s=u.sent(),[4,this._cache.getStoreAsync(n)];case 2:return i=u.sent(),s?i&&i>Date.now()?(o=new Pt({envId:this._config.env,cache:this._cache,request:this._request}),[4,o.checkLocalStateAsync()]):[3,4]:[3,7];case 3:return u.sent(),[2,o];case 4:return[4,this._cache.removeStoreAsync(r)];case 5:return u.sent(),[4,this._cache.removeStoreAsync(n)];case 6:u.sent(),u.label=7;case 7:return[2]}})})},e.prototype.setRefreshToken=function(t){return An(this,void 0,void 0,function(){var r,n,s,i;return In(this,function(o){switch(o.label){case 0:return r=this._cache.keys,n=r.accessTokenKey,s=r.accessTokenExpireKey,i=r.refreshTokenKey,[4,this._cache.removeStoreAsync(n)];case 1:return o.sent(),[4,this._cache.removeStoreAsync(s)];case 2:return o.sent(),[4,this._cache.setStoreAsync(i,t)];case 3:return o.sent(),[2]}})})},e.prototype.setAccessToken=function(t,r){return An(this,void 0,void 0,function(){var n,s,i;return In(this,function(o){switch(o.label){case 0:return n=this._cache.keys,s=n.accessTokenKey,i=n.accessTokenExpireKey,[4,this._cache.setStoreAsync(s,t)];case 1:return o.sent(),[4,this._cache.setStoreAsync(i,r)];case 2:return o.sent(),[2]}})})},e.prototype.refreshUserInfo=function(){return An(this,void 0,void 0,function(){var t,r;return In(this,function(n){switch(n.label){case 0:return t="auth.getUserInfo",[4,this._request.send(t,{})];case 1:return r=n.sent().data,[4,this.setLocalUserInfo(r)];case 2:return n.sent(),[2,r]}})})},e.prototype.setLocalUserInfo=function(t){return An(this,void 0,void 0,function(){var r;return In(this,function(n){switch(n.label){case 0:return r=this._cache.keys.userInfoKey,[4,this._cache.setStoreAsync(r,t)];case 1:return n.sent(),[2]}})})},e}(),Te;(function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.NULL="NULL",e.PHONE="PHONE"})(Te||(Te={}));var i_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zs=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},jt=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Wr=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},jr=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Xs=we.getSdkName,gi=we.ERRORS,Qs=we.COMMUNITY_SITE_URL,Su=Cr.RUNTIME,s_=Ee.getQuery,o_=Ee.getHash,Au=Ee.removeParam,a_=Ee.printWarn,eo=er.catchErrorsDecorator,u_=function(e){i_(t,e);function t(r,n,s,i){var o=e.call(this,r)||this;return o._runtime=r.runtime,o._appid=n,o._scope=s,o._state=i||"weixin",o}return t.prototype.signIn=function(){return Wr(this,void 0,void 0,function(){return jr(this,function(r){return[2,a_(gi.OPERATION_FAIL,"API signIn has been deprecated, please use signInWithRedirect insteed")]})})},t.prototype.signInWithRedirect=function(){return Wr(this,void 0,void 0,function(){return jr(this,function(r){return[2,this._redirect()]})})},t.prototype.getRedirectResult=function(r){return Wr(this,void 0,void 0,function(){var n;return jr(this,function(s){return n=Iu(),n?[2,this._signInWithCode(n,r)]:[2,null]})})},t.prototype.getLinkRedirectResult=function(r){return r===void 0&&(r={}),Wr(this,void 0,void 0,function(){var n,s,i,o,u,h;return jr(this,function(a){return n=r.withUnionId,s=n===void 0?!1:n,i=Iu(),i?(o=this._appid,u=function(c){switch(c){case"snsapi_login":return"WECHAT-OPEN";default:return"WECHAT-PUBLIC"}}(this._scope),h=this._runtime===Su.WX_MP?"1":"0",[2,this._request.send("auth.linkWithWeixinCode",{payload:{appid:o,loginType:u,code:i,hybridMiniapp:h,withUnionId:s}})]):[2,null]})})},t.prototype._redirect=function(){var r=Au("code",location.href);r=Au("state",r),r=encodeURIComponent(r);var n="//open.weixin.qq.com/connect/oauth2/authorize";this._scope==="snsapi_login"&&(n="//open.weixin.qq.com/connect/qrconnect");try{location.href=n+"?appid="+this._appid+"&redirect_uri="+r+"&response_type=code&scope="+this._scope+"&state="+this._state+"#wechat_redirect"}catch(s){throw new Error("["+Xs()+"]["+gi.UNKOWN_ERROR+"]"+s)}},t.prototype._signInWithCode=function(r,n){return Wr(this,void 0,void 0,function(){var s,i,o,u,h,a,c,d;return jr(this,function(m){switch(m.label){case 0:return s=this._cache.keys,i=s.accessTokenKey,o=s.accessTokenExpireKey,u=s.refreshTokenKey,h=function(w){switch(w){case"snsapi_login":return"WECHAT-OPEN";default:return"WECHAT-PUBLIC"}}(this._scope),[4,this._getRefreshTokenByWXCode(this._appid,h,r,n)];case 1:return a=m.sent(),c=a.refreshToken,[4,this._cache.setStoreAsync(u,c)];case 2:return m.sent(),a.accessToken?[4,this._cache.setStoreAsync(i,a.accessToken)]:[3,4];case 3:m.sent(),m.label=4;case 4:return a.accessTokenExpire?[4,this._cache.setStoreAsync(o,String(a.accessTokenExpire+Date.now()))]:[3,6];case 5:m.sent(),m.label=6;case 6:return me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.WECHAT,persistence:this._config.persistence}),[4,this.refreshUserInfo()];case 7:return m.sent(),d=new Pt({envId:this._config.env,cache:this._cache,request:this._request}),[4,d.checkLocalStateAsync()];case 8:return m.sent(),[2,d]}})})},t.prototype._getRefreshTokenByWXCode=function(r,n,s,i){return i===void 0&&(i={}),Wr(this,void 0,void 0,function(){var o,u,h,a,c,d,m;return jr(this,function(w){return o=i.withUnionId,u=o===void 0?!1:o,h=i.createUser,a=h===void 0?!0:h,c=this._scope==="snsapi_base"?!1:i.syncUserInfo||!1,d="auth.signIn",m=this._runtime===Su.WX_MP?"1":"0",[2,this._request.send(d,{appid:r,loginType:n,hybridMiniapp:m,syncUserInfo:c,loginCredential:s,withUnionId:u,createUser:a}).then(function(A){if(A.code)throw new Error("["+Xs()+"]["+gi.OPERATION_FAIL+"] failed login via wechat: "+A.code);if(A.refresh_token)return{refreshToken:A.refresh_token,accessToken:A.access_token,accessTokenExpire:A.access_token_expire};throw new Error("["+Xs()+"]["+gi.OPERATION_FAIL+"] action:getJwt not return refreshToken")})]})})},Zs([eo({title:"",messages:["","  1 -  auth().weixinAuthProvider().signInWithRedirect() ",""+Qs]}),jt("design:type",Function),jt("design:paramtypes",[]),jt("design:returntype",Promise)],t.prototype,"signInWithRedirect",null),Zs([eo({title:"",messages:["","  1 -  auth().weixinAuthProvider().getRedirectResult() ","  2 - ","  3 -  AppId  AppSecret ",""+Qs]}),jt("design:type",Function),jt("design:paramtypes",[Object]),jt("design:returntype",Promise)],t.prototype,"getRedirectResult",null),Zs([eo({title:"",messages:["","  1 -  auth().weixinAuthProvider().getLinkRedirectResult() ","  2 - ","  3 -  AppId  AppSecret ",""+Qs]}),jt("design:type",Function),jt("design:paramtypes",[Object]),jt("design:returntype",Promise)],t.prototype,"getLinkRedirectResult",null),t}(ln);function Iu(){return s_("code")||o_("code")}var c_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),f_=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},to=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Tn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},On=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},ro=we.ERRORS,l_=we.COMMUNITY_SITE_URL,Tu=Ee.throwError,h_=Ee.isString,d_=wa.addEventListener,p_=er.catchErrorsDecorator,y_=function(e){c_(t,e);function t(r){var n=e.call(this,r)||this;return n._onConverted=n._onConverted.bind(n),d_(ue.ANONYMOUS_CONVERTED,n._onConverted),n}return t.prototype.signIn=function(){return Tn(this,void 0,void 0,function(){var r,n,s,i,o,u,h;return On(this,function(a){switch(a.label){case 0:return[4,this._cache.updatePersistenceAsync("local")];case 1:return a.sent(),r=this._cache.keys,n=r.anonymousUuidKey,s=r.refreshTokenKey,[4,this._cache.getStoreAsync(n)];case 2:return i=a.sent(),[4,this._cache.getStoreAsync(s)];case 3:return o=a.sent(),[4,this._request.send("auth.signInAnonymously",{anonymous_uuid:i,refresh_token:o})];case 4:return u=a.sent(),u.uuid&&u.refresh_token?[4,this._setAnonymousUUID(u.uuid)]:[3,10];case 5:return a.sent(),[4,this.setRefreshToken(u.refresh_token)];case 6:return a.sent(),[4,this._request.refreshAccessToken()];case 7:return a.sent(),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.ANONYMOUS,persistence:"local"}),me.fire(ue.LOGIN_STATE_CHANGED),h=new Pt({envId:this._config.env,cache:this._cache,request:this._request}),[4,h.checkLocalStateAsync()];case 8:return a.sent(),[4,h.user.refresh()];case 9:return a.sent(),[2,h];case 10:throw new Error(JSON.stringify({code:ro.OPERATION_FAIL,msg:JSON.stringify(u)||"anonymous signIn failed"}))}})})},t.prototype.linkAndRetrieveDataWithTicket=function(r){return Tn(this,void 0,void 0,function(){var n,s,i,o,u,h,a;return On(this,function(c){switch(c.label){case 0:return h_(r)||Tu(ro.INVALID_PARAMS,"ticket must be a string"),n=this._cache.keys,s=n.anonymousUuidKey,i=n.refreshTokenKey,[4,this._cache.getStoreAsync(s)];case 1:return o=c.sent(),[4,this._cache.getStoreAsync(i)];case 2:return u=c.sent(),[4,this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:o,refresh_token:u,ticket:r})];case 3:return h=c.sent(),h.refresh_token?[4,this._clearAnonymousUUID()]:[3,8];case 4:return c.sent(),[4,this.setRefreshToken(h.refresh_token)];case 5:return c.sent(),[4,this._request.refreshAccessToken()];case 6:return c.sent(),me.fire(ue.ANONYMOUS_CONVERTED,{env:this._config.env}),me.fire(ue.LOGIN_TYPE_CHANGED,{loginType:Te.CUSTOM,persistence:"local"}),a=new Pt({envId:this._config.env,cache:this._cache,request:this._request}),[4,a.checkLocalStateAsync()];case 7:return c.sent(),[2,a];case 8:Tu(ro.OPERATION_FAIL,JSON.stringify(h)||"linkAndRetrieveDataWithTicket failed"),c.label=9;case 9:return[2]}})})},t.prototype._setAnonymousUUID=function(r){return Tn(this,void 0,void 0,function(){var n,s,i;return On(this,function(o){switch(o.label){case 0:return n=this._cache.keys,s=n.anonymousUuidKey,i=n.loginTypeKey,[4,this._cache.removeStoreAsync(s)];case 1:return o.sent(),[4,this._cache.setStoreAsync(s,r)];case 2:return o.sent(),[4,this._cache.setStoreAsync(i,Te.ANONYMOUS)];case 3:return o.sent(),[2]}})})},t.prototype._clearAnonymousUUID=function(){return Tn(this,void 0,void 0,function(){return On(this,function(r){switch(r.label){case 0:return[4,this._cache.removeStoreAsync(this._cache.keys.anonymousUuidKey)];case 1:return r.sent(),[2]}})})},t.prototype._onConverted=function(r){return Tn(this,void 0,void 0,function(){var n;return On(this,function(s){switch(s.label){case 0:return n=r.data.env,n!==this._config.env?[2]:[4,this._cache.updatePersistenceAsync(this._config.persistence)];case 1:return s.sent(),[2]}})})},f_([p_({title:"",messages:["","  1 - ","  2 -  auth().anonymouseProvider().signIn() ",""+l_]}),to("design:type",Function),to("design:paramtypes",[]),to("design:returntype",Promise)],t.prototype,"signIn",null),t}(ln),g_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),m_=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},no=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},__=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},v_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ou=we.ERRORS,w_=we.COMMUNITY_SITE_URL,E_=Ee.isString,b_=er.catchErrorsDecorator,S_=function(e){g_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r){return __(this,void 0,void 0,function(){var n,s,i,o,u,h,a;return v_(this,function(c){switch(c.label){case 0:if(!E_(r))throw new Error(JSON.stringify({code:Ou.INVALID_PARAMS,msg:"ticket must be a string"}));return n=this._cache.keys.refreshTokenKey,o=(i=this._request).send,u=["auth.signInWithTicket"],h={ticket:r},[4,this._cache.getStoreAsync(n)];case 1:return[4,o.apply(i,u.concat([(h.refresh_token=c.sent()||"",h)]))];case 2:return s=c.sent(),s.refresh_token?[4,this.setRefreshToken(s.refresh_token)]:[3,7];case 3:return c.sent(),[4,this._request.refreshAccessToken()];case 4:return c.sent(),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.CUSTOM,persistence:this._config.persistence}),me.fire(ue.LOGIN_STATE_CHANGED),[4,this.refreshUserInfo()];case 5:return c.sent(),a=new Pt({envId:this._config.env,cache:this._cache,request:this._request}),[4,a.checkLocalStateAsync()];case 6:return c.sent(),[2,a];case 7:throw new Error(JSON.stringify({code:Ou.OPERATION_FAIL,msg:"custom signIn failed"}))}})})},m_([b_({title:"",messages:["","  1 - ","  2 -  auth().customAuthProvider().signIn() ","  3 - ticket ","  4 -  ticket ",""+w_]}),no("design:type",Function),no("design:paramtypes",[String]),no("design:returntype",Promise)],t.prototype,"signIn",null),t}(ln),A_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xn=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},We=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},Nn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Rn=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},io=Ee.throwError,I_=Ee.isString,so=we.ERRORS,Dn=we.COMMUNITY_SITE_URL,Cn=er.catchErrorsDecorator,T_=function(e){A_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r,n){return Nn(this,void 0,void 0,function(){var s,i,o,u,h;return Rn(this,function(a){switch(a.label){case 0:return I_(r)||io(so.INVALID_PARAMS,"email must be a string"),s=this._cache.keys.refreshTokenKey,[4,this._request.send("auth.signIn",{loginType:"EMAIL",email:r,password:n,refresh_token:this._cache.getStore(s)||""})];case 1:return i=a.sent(),o=i.refresh_token,u=i.access_token,h=i.access_token_expire,o?[4,this.setRefreshToken(o)]:[3,8];case 2:return a.sent(),u&&h?[4,this.setAccessToken(u,h)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,this._request.refreshAccessToken()];case 5:a.sent(),a.label=6;case 6:return[4,this.refreshUserInfo()];case 7:return a.sent(),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.EMAIL,persistence:this._config.persistence}),[2,new Pt({envId:this._config.env,cache:this._cache,request:this._request})];case 8:i.code?io(so.OPERATION_FAIL,"Email login fail["+i.code+"] "+i.message):io(so.OPERATION_FAIL,"Email login fail"),a.label=9;case 9:return[2]}})})},t.prototype.signUp=function(r,n){return Nn(this,void 0,void 0,function(){return Rn(this,function(s){return[2,this._request.send("auth.signUpWithEmailAndPassword",{email:r,password:n})]})})},t.prototype.resetPassword=function(r){return Nn(this,void 0,void 0,function(){return Rn(this,function(n){return[2,this._request.send("auth.sendPasswordResetEmail",{email:r})]})})},t.prototype.resetPasswordWithToken=function(r,n){return Nn(this,void 0,void 0,function(){return Rn(this,function(s){return[2,this._request.send("auth.resetPasswordWithToken",{token:r,newPassword:n})]})})},t.prototype.activate=function(r){return Nn(this,void 0,void 0,function(){return Rn(this,function(n){return[2,this._request.send("auth.activateEndUserMail",{token:r})]})})},xn([Cn({title:"",messages:["","  1 -  auth().emailAuthProvider() ","  2 - ","  3 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String,String]),We("design:returntype",Promise)],t.prototype,"signIn",null),xn([Cn({title:"",messages:["","  1 -  auth().signUpWithEmailAndPassword() ","  2 - ","  3 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String,String]),We("design:returntype",Promise)],t.prototype,"signUp",null),xn([Cn({title:"",messages:["","  1 -  auth().sendPasswordResetEmail() ","  2 - ","  3 - ","  4 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String]),We("design:returntype",Promise)],t.prototype,"resetPassword",null),xn([Cn({title:"",messages:["","  1 - ","  2 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String,String]),We("design:returntype",Promise)],t.prototype,"resetPasswordWithToken",null),xn([Cn({title:"",messages:["","  1 - ","  2 - ",""+Dn]}),We("design:type",Function),We("design:paramtypes",[String]),We("design:returntype",Promise)],t.prototype,"activate",null),t}(ln),O_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),x_=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},oo=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},N_=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},R_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},D_=Ee.printWarn,mi=we.ERRORS,C_=we.COMMUNITY_SITE_URL,P_=er.catchErrorsDecorator,k_=function(e){O_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r,n){return N_(this,void 0,void 0,function(){var s,i,o,u,h,a,c,d,m;return R_(this,function(w){switch(w.label){case 0:if(typeof r!="string")throw new Error(JSON.stringify({code:mi.INVALID_PARAMS,msg:"username must be a string"}));return typeof n!="string"&&(n="",D_(mi.INVALID_PARAMS,"password is empty")),s=this._cache.keys.refreshTokenKey,u=(o=this._request).send,h=["auth.signIn"],a={loginType:Te.USERNAME,username:r,password:n},[4,this._cache.getStoreAsync(s)];case 1:return[4,u.apply(o,h.concat([(a.refresh_token=w.sent()||"",a)]))];case 2:return i=w.sent(),c=i.refresh_token,d=i.access_token_expire,m=i.access_token,c?[4,this.setRefreshToken(c)]:[3,9];case 3:return w.sent(),m&&d?[4,this.setAccessToken(m,d)]:[3,5];case 4:return w.sent(),[3,7];case 5:return[4,this._request.refreshAccessToken()];case 6:w.sent(),w.label=7;case 7:return[4,this.refreshUserInfo()];case 8:return w.sent(),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.USERNAME,persistence:this._config.persistence}),[2,new Pt({envId:this._config.env,cache:this._cache,request:this._request})];case 9:throw i.code?new Error(JSON.stringify({code:mi.OPERATION_FAIL,msg:"login by username failed:["+i.code+"] "+i.message})):new Error(JSON.stringify({code:mi.OPERATION_FAIL,msg:"login by username failed"}));case 10:return[2]}})})},x_([P_({title:"",messages:["","  1 -  auth().signInWithUsernameAndPassword() ","  2 - ","  3 - ",""+C_]}),oo("design:type",Function),oo("design:paramtypes",[String,String]),oo("design:returntype",Promise)],t.prototype,"signIn",null),t}(ln),M_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ao=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},Yt=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},uo=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},co=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},_i=Ee.throwError,fo=Ee.isString,F_=Ee.transformPhone,vi=we.ERRORS,lo=we.COMMUNITY_SITE_URL,ho=er.catchErrorsDecorator,Ri={SIGNIN:"SIGNIN",SIGNUP:"SIGNUP",FORCERESETPWD:"FORCERESETPWD"},L_=function(e){M_(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.signIn=function(r){return uo(this,void 0,void 0,function(){var n,s,i,o,u,h,a,c,d;return co(this,function(m){switch(m.label){case 0:return n=r.phoneNumber,s=r.phoneCode,i=r.password,o=r.signMethod,fo(n)||_i(vi.INVALID_PARAMS,"phoneNumber must be a string"),!fo(s)&&!fo(i)&&_i(vi.INVALID_PARAMS,"phoneCode or password must be a string"),o||(o=Ri.SIGNIN),u=this._cache.keys.refreshTokenKey,[4,this._request.send("auth.signIn",{loginType:Te.PHONE,phoneNumber:F_(n),phoneCode:s,password:i,refresh_token:this._cache.getStore(u)||"",signMethod:o})];case 1:return h=m.sent(),a=h.refresh_token,c=h.access_token,d=h.access_token_expire,a?[4,this.setRefreshToken(a)]:[3,8];case 2:return m.sent(),c&&d?[4,this.setAccessToken(c,d)]:[3,4];case 3:return m.sent(),[3,6];case 4:return[4,this._request.refreshAccessToken()];case 5:m.sent(),m.label=6;case 6:return[4,this.refreshUserInfo()];case 7:return m.sent(),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.PHONE,persistence:this._config.persistence}),[2,new Pt({envId:this._config.env,cache:this._cache,request:this._request})];case 8:h.code?_i(vi.OPERATION_FAIL,"Phone login fail["+h.code+"] "+h.message):_i(vi.OPERATION_FAIL,"Phone login fail"),m.label=9;case 9:return[2]}})})},t.prototype.signUp=function(r,n,s){return uo(this,void 0,void 0,function(){return co(this,function(i){return[2,this.signIn({phoneNumber:r,phoneCode:n,password:s,signMethod:Ri.SIGNUP})]})})},t.prototype.forceResetPwd=function(r,n,s){return uo(this,void 0,void 0,function(){return co(this,function(i){return[2,this.signIn({phoneNumber:r,phoneCode:n,password:s,signMethod:Ri.FORCERESETPWD})]})})},ao([ho({title:"",messages:["","  1 -  auth().SmsAuthProvider() ","  2 - ","  3 - /",""+lo]}),Yt("design:type",Function),Yt("design:paramtypes",[Object]),Yt("design:returntype",Promise)],t.prototype,"signIn",null),ao([ho({title:"",messages:["","  1 -  auth().signUpWithPhoneCode() ","  2 - ",""+lo]}),Yt("design:type",Function),Yt("design:paramtypes",[String,String,String]),Yt("design:returntype",Promise)],t.prototype,"signUp",null),ao([ho({title:"",messages:["","  1 -  auth().forceResetPwd() ","  2 - ",""+lo]}),Yt("design:type",Function),Yt("design:paramtypes",[String,String,String]),Yt("design:returntype",Promise)],t.prototype,"forceResetPwd",null),t}(ln),Re=function(){return Re=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Re.apply(this,arguments)},Ce=function(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},Y=function(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)},oe=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},ae=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},U_=wa.CloudbaseEventEmitter,B_=Cr.RUNTIME,Uo=Ee.printWarn,Ea=Ee.throwError,Bo=Ee.transformPhone,tn=we.ERRORS,Pe=we.COMMUNITY_SITE_URL,ke=er.catchErrorsDecorator,$_="auth",me=new U_,W_=function(){function e(t){var r=t.cache,n=t.request;this._cache=r,this._request=n,this._setUserInfo()}return e.prototype.checkLocalInfo=function(){return oe(this,void 0,void 0,function(){return ae(this,function(t){return this.uid=this._getLocalUserInfo("uid"),this.loginType=this._getLocalUserInfo("loginType"),this.openid=this._getLocalUserInfo("wxOpenId"),this.wxOpenId=this._getLocalUserInfo("wxOpenId"),this.wxPublicId=this._getLocalUserInfo("wxPublicId"),this.unionId=this._getLocalUserInfo("wxUnionId"),this.qqMiniOpenId=this._getLocalUserInfo("qqMiniOpenId"),this.customUserId=this._getLocalUserInfo("customUserId"),this.nickName=this._getLocalUserInfo("nickName"),this.gender=this._getLocalUserInfo("gender"),this.avatarUrl=this._getLocalUserInfo("avatarUrl"),this.email=this._getLocalUserInfo("email"),this.hasPassword=!!this._getLocalUserInfo("hasPassword"),this.phone=this._getLocalUserInfo("phone"),this.username=this._getLocalUserInfo("username"),this.location={country:this._getLocalUserInfo("country"),province:this._getLocalUserInfo("province"),city:this._getLocalUserInfo("city")},[2]})})},e.prototype.checkLocalInfoAsync=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u,h,a,c,d,m,w,A,S,_,v,N;return ae(this,function(O){switch(O.label){case 0:return t=this,[4,this._getLocalUserInfoAsync("uid")];case 1:return t.uid=O.sent(),r=this,[4,this._getLocalUserInfoAsync("loginType")];case 2:return r.loginType=O.sent(),n=this,[4,this._getLocalUserInfoAsync("wxOpenId")];case 3:return n.openid=O.sent(),s=this,[4,this._getLocalUserInfoAsync("wxOpenId")];case 4:return s.wxOpenId=O.sent(),i=this,[4,this._getLocalUserInfoAsync("wxPublicId")];case 5:return i.wxPublicId=O.sent(),o=this,[4,this._getLocalUserInfoAsync("wxUnionId")];case 6:return o.unionId=O.sent(),u=this,[4,this._getLocalUserInfoAsync("qqMiniOpenId")];case 7:return u.qqMiniOpenId=O.sent(),h=this,[4,this._getLocalUserInfoAsync("customUserId")];case 8:return h.customUserId=O.sent(),a=this,[4,this._getLocalUserInfoAsync("nickName")];case 9:return a.nickName=O.sent(),c=this,[4,this._getLocalUserInfoAsync("gender")];case 10:return c.gender=O.sent(),d=this,[4,this._getLocalUserInfoAsync("avatarUrl")];case 11:return d.avatarUrl=O.sent(),m=this,[4,this._getLocalUserInfoAsync("email")];case 12:return m.email=O.sent(),w=this,A=Boolean,[4,this._getLocalUserInfoAsync("hasPassword")];case 13:return w.hasPassword=A.apply(void 0,[O.sent()]),S=this,[4,this._getLocalUserInfoAsync("phone")];case 14:return S.phone=O.sent(),_=this,[4,this._getLocalUserInfoAsync("username")];case 15:return _.username=O.sent(),v=this,N={},[4,this._getLocalUserInfoAsync("country")];case 16:return N.country=O.sent(),[4,this._getLocalUserInfoAsync("province")];case 17:return N.province=O.sent(),[4,this._getLocalUserInfoAsync("city")];case 18:return v.location=(N.city=O.sent(),N),[2]}})})},e.prototype.linkWithTicket=function(t){if(typeof t!="string")throw new Error("ticket must be string");return this._request.send("auth.linkWithTicket",{ticket:t})},e.prototype.linkWithRedirect=function(t){t.signInWithRedirect()},e.prototype.getLinkedUidList=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o;return ae(this,function(u){switch(u.label){case 0:return[4,this._request.send("auth.getLinkedUidList",{})];case 1:for(t=u.sent().data,r=!1,n=t.users,s=0,i=n;s<i.length;s++)if(o=i[s],o.wxOpenId&&o.wxPublicId){r=!0;break}return[2,{users:n,hasPrimaryUid:r}]}})})},e.prototype.setPrimaryUid=function(t){return this._request.send("auth.setPrimaryUid",{uid:t})},e.prototype.unlink=function(t){return this._request.send("auth.unlink",{platform:t})},e.prototype.update=function(t){return oe(this,void 0,void 0,function(){var r,n,s,i,o,u,h;return ae(this,function(a){switch(a.label){case 0:return r=t.nickName,n=t.gender,s=t.avatarUrl,i=t.province,o=t.country,u=t.city,[4,this._request.send("auth.updateUserInfo",{nickName:r,gender:n,avatarUrl:s,province:i,country:o,city:u})];case 1:return h=a.sent().data,this._setLocalUserInfo(h),[2]}})})},e.prototype.updatePassword=function(t,r){return this._request.send("auth.updatePassword",{oldPassword:r,newPassword:t})},e.prototype.updateEmail=function(t,r){return this._request.send("auth.updateEmail",{newEmail:t,password:r})},e.prototype.updateUsername=function(t){return typeof t!="string"&&Ea(tn.INVALID_PARAMS,"username must be a string"),this._request.send("auth.updateUsername",{username:t})},e.prototype.refresh=function(){return oe(this,void 0,void 0,function(){var t,r;return ae(this,function(n){switch(n.label){case 0:return t="auth.getUserInfo",[4,this._request.send(t,{})];case 1:return r=n.sent().data,this._setLocalUserInfo(r),[2,r]}})})},e.prototype.linkWithPhoneNumber=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this._request.send("auth.linkOrUpdatePhoneNumber",{phoneNumber:Bo(t),phoneCode:r})]})})},e.prototype.updatePhoneNumber=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this._request.send("auth.linkOrUpdatePhoneNumber",{phoneNumber:Bo(t),phoneCode:r})]})})},e.prototype._getLocalUserInfo=function(t){var r=this._cache.keys.userInfoKey,n=this._cache.getStore(r);return n[t]},e.prototype._getLocalUserInfoAsync=function(t){return oe(this,void 0,void 0,function(){var r,n;return ae(this,function(s){switch(s.label){case 0:return r=this._cache.keys.userInfoKey,[4,this._cache.getStoreAsync(r)];case 1:return n=s.sent(),[2,n[t]]}})})},e.prototype._setUserInfo=function(){var t=this,r=this._cache.keys.userInfoKey,n=this._cache.getStore(r);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl","phone","username"].forEach(function(s){t[s]=n[s]}),this.location={country:n.country,province:n.province,city:n.city}},e.prototype._setLocalUserInfo=function(t){var r=this._cache.keys.userInfoKey;this._cache.setStore(r,t),this._setUserInfo()},Ce([ke({title:"",messages:["","  1 -  User.linkWithTicket() ","  2 - ","  3 - ticket ","  4 -  ticket ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"linkWithTicket",null),Ce([ke({title:"",messages:["","  1 -  User.linkWithRedirect() ","  2 - ","  3 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",void 0)],e.prototype,"linkWithRedirect",null),Ce([ke({title:"",messages:["","  1 -  User.getLinkedUidList() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getLinkedUidList",null),Ce([ke({title:"",messages:["","  1 -  User.setPrimaryUid() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"setPrimaryUid",null),Ce([ke({title:"",messages:["","  1 -  User.unlink() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"unlink",null),Ce([ke({title:"",messages:["","  1 -  User.update() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[Object]),Y("design:returntype",Promise)],e.prototype,"update",null),Ce([ke({title:"",messages:["","  1 -  User.updatePassword() ","  3 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",void 0)],e.prototype,"updatePassword",null),Ce([ke({title:"",messages:["","  1 -  User.updateEmail() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",void 0)],e.prototype,"updateEmail",null),Ce([ke({title:"",messages:["","  1 -  User.updateUsername() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",void 0)],e.prototype,"updateUsername",null),Ce([ke({title:"",messages:["","  1 -  User.refresh() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"refresh",null),Ce([ke({title:"",messages:["","  1 -  auth().linkWithPhoneNumber() ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",Promise)],e.prototype,"linkWithPhoneNumber",null),Ce([ke({title:"",messages:["","  1 - ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String,String]),Y("design:returntype",Promise)],e.prototype,"updatePhoneNumber",null),e}(),Pt=function(){function e(t){var r=t.envId,n=t.cache,s=t.request;r||Ea(tn.INVALID_PARAMS,"envId is not defined"),this._cache=n,this.user=new W_({cache:n,request:s})}return e.prototype.checkLocalState=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u;return ae(this,function(h){return t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=t.accessTokenExpireKey,i=this._cache.getStore(r),o=this._cache.getStore(n),u=this._cache.getStore(s),this.credential={refreshToken:i,accessToken:o,accessTokenExpire:u},this._loginType=this._cache.getStore(this._cache.keys.loginTypeKey),this.user.checkLocalInfo(),[2]})})},e.prototype.checkLocalStateAsync=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u,h;return ae(this,function(a){switch(a.label){case 0:return t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=t.accessTokenExpireKey,[4,this._cache.getStoreAsync(r)];case 1:return i=a.sent(),[4,this._cache.getStoreAsync(n)];case 2:return o=a.sent(),[4,this._cache.getStoreAsync(s)];case 3:return u=a.sent(),this.credential={refreshToken:i,accessToken:o,accessTokenExpire:u},h=this,[4,this._cache.getStoreAsync(this._cache.keys.loginTypeKey)];case 4:return h._loginType=a.sent(),[4,this.user.checkLocalInfoAsync()];case 5:return a.sent(),[2]}})})},Object.defineProperty(e.prototype,"isAnonymousAuth",{get:function(){return this.loginType===Te.ANONYMOUS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCustomAuth",{get:function(){return this.loginType===Te.CUSTOM},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWeixinAuth",{get:function(){return this.loginType===Te.WECHAT||this.loginType===Te.WECHAT_OPEN||this.loginType===Te.WECHAT_PUBLIC},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUsernameAuth",{get:function(){return this.loginType===Te.USERNAME},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loginType",{get:function(){return this._loginType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPhoneAuth",{get:function(){return this.loginType===Te.PHONE},enumerable:!1,configurable:!0}),e}(),j_=function(){function e(t){this._config=t,this._cache=t.cache,this._request=t.request,this._runtime=t.runtime||B_.WEB,me.on(ue.LOGIN_TYPE_CHANGED,this._onLoginTypeChanged.bind(this))}return Object.defineProperty(e.prototype,"currentUser",{get:function(){if(this._cache.mode==="async"){Uo(tn.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrenUser insteed");return}var t=this.hasLoginState();return t&&t.user||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loginType",{get:function(){return this._cache.getStore(this._cache.keys.loginTypeKey)},enumerable:!1,configurable:!0}),e.prototype.getCurrenUser=function(){return oe(this,void 0,void 0,function(){var t;return ae(this,function(r){switch(r.label){case 0:return[4,this.getLoginState()];case 1:return t=r.sent(),t?[4,t.user.checkLocalInfoAsync()]:[3,3];case 2:return r.sent(),[2,t.user||null];case 3:return[2,null]}})})},e.prototype.getLoginType=function(){return oe(this,void 0,void 0,function(){return ae(this,function(t){switch(t.label){case 0:return[4,this._cache.getStoreAsync(this._cache.keys.loginTypeKey)];case 1:return[2,t.sent()]}})})},e.prototype.getAccessToken=function(){return oe(this,void 0,void 0,function(){var t;return ae(this,function(r){switch(r.label){case 0:return t={},[4,this._request.getAccessToken()];case 1:return[2,(t.accessToken=r.sent().accessToken,t.env=this._config.env,t)]}})})},e.prototype.weixinAuthProvider=function(t){var r=t.appid,n=t.scope,s=t.state;return this._weixinAuthProvider||(this._weixinAuthProvider=new u_(Re(Re({},this._config),{cache:this._cache,request:this._request,runtime:this._runtime}),r,n,s)),this._weixinAuthProvider},e.prototype.anonymousAuthProvider=function(){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new y_(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._anonymousAuthProvider},e.prototype.customAuthProvider=function(){return this._customAuthProvider||(this._customAuthProvider=new S_(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._customAuthProvider},e.prototype.emailAuthProvider=function(){return this._emailAuthProvider||(this._emailAuthProvider=new T_(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._emailAuthProvider},e.prototype.usernameAuthProvider=function(){return this._usernameAuthProvider||(this._usernameAuthProvider=new k_(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._usernameAuthProvider},e.prototype.phoneAuthProvider=function(){return this._phoneAuthProvider||(this._phoneAuthProvider=new L_(Re(Re({},this._config),{cache:this._cache,request:this._request}))),this._phoneAuthProvider},e.prototype.signInWithUsernameAndPassword=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.usernameAuthProvider().signIn(t,r)]})})},e.prototype.isUsernameRegistered=function(t){return oe(this,void 0,void 0,function(){var r;return ae(this,function(n){switch(n.label){case 0:return typeof t!="string"&&Ea(tn.INVALID_PARAMS,"username must be a string"),[4,this._request.send("auth.isUsernameRegistered",{username:t})];case 1:return r=n.sent().data,[2,r==null?void 0:r.isRegistered]}})})},e.prototype.signInWithEmailAndPassword=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.emailAuthProvider().signIn(t,r)]})})},e.prototype.signUpWithEmailAndPassword=function(t,r){return oe(this,void 0,void 0,function(){return ae(this,function(n){return[2,this.emailAuthProvider().signUp(t,r)]})})},e.prototype.sendPasswordResetEmail=function(t){return oe(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.emailAuthProvider().resetPassword(t)]})})},e.prototype.signOut=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i,o,u;return ae(this,function(h){switch(h.label){case 0:return t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=t.accessTokenExpireKey,i="auth.logout",[4,this._cache.getStoreAsync(r)];case 1:return o=h.sent(),o?[4,this._request.send(i,{refresh_token:o})]:[2];case 2:return u=h.sent(),this._cache.removeStoreAsync(r),this._cache.removeStoreAsync(n),this._cache.removeStoreAsync(s),me.fire(ue.LOGIN_STATE_CHANGED),me.fire(ue.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:Te.NULL,persistence:this._config.persistence}),[2,u]}})})},e.prototype.onLoginStateChanged=function(t){return oe(this,void 0,void 0,function(){var r,n=this;return ae(this,function(s){switch(s.label){case 0:return me.on(ue.LOGIN_STATE_CHANGED,function(){return oe(n,void 0,void 0,function(){var i;return ae(this,function(o){switch(o.label){case 0:return[4,this.getLoginState()];case 1:return i=o.sent(),t.call(this,i),[2]}})})}),[4,this.getLoginState()];case 1:return r=s.sent(),t.call(this,r),[2]}})})},e.prototype.onLoginStateExpired=function(t){me.on(ue.LOGIN_STATE_EXPIRED,t.bind(this))},e.prototype.onAccessTokenRefreshed=function(t){me.on(ue.ACCESS_TOKEN_REFRESHD,t.bind(this))},e.prototype.onAnonymousConverted=function(t){me.on(ue.ANONYMOUS_CONVERTED,t.bind(this))},e.prototype.onLoginTypeChanged=function(t){var r=this;me.on(ue.LOGIN_TYPE_CHANGED,function(){return oe(r,void 0,void 0,function(){var n;return ae(this,function(s){switch(s.label){case 0:return[4,this.getLoginState()];case 1:return n=s.sent(),t.call(this,n),[2]}})})})},e.prototype.hasLoginState=function(){if(this._cache.mode==="async"){Uo(tn.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed");return}var t=this._cache.keys.refreshTokenKey,r=this._cache.getStore(t);if(r){var n=new Pt({envId:this._config.env,cache:this._cache,request:this._request});return n.checkLocalState(),n}else return null},e.prototype.getLoginState=function(){return oe(this,void 0,void 0,function(){var t,r,n;return ae(this,function(s){switch(s.label){case 0:return t=this._cache.keys.refreshTokenKey,[4,this._cache.getStoreAsync(t)];case 1:return r=s.sent(),r?(n=new Pt({envId:this._config.env,cache:this._cache,request:this._request}),[4,n.checkLocalStateAsync()]):[3,3];case 2:return s.sent(),[2,n];case 3:return[2,null]}})})},e.prototype.shouldRefreshAccessToken=function(t){this._request._shouldRefreshAccessTokenHook=t.bind(this)},e.prototype.getUserInfo=function(){return oe(this,void 0,void 0,function(){var t,r;return ae(this,function(n){switch(n.label){case 0:return t="auth.getUserInfo",[4,this._request.send(t,{})];case 1:return r=n.sent(),r.code?[2,r]:[2,Re(Re({},r.data),{requestId:r.seqId})]}})})},e.prototype.getAuthHeader=function(){var t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,s=this._cache.getStore(r),i=this._cache.getStore(n);return{"x-cloudbase-credentials":i+"/@@/"+s}},e.prototype.getAuthHeaderAsync=function(){return oe(this,void 0,void 0,function(){var t,r,n,s,i;return ae(this,function(o){switch(o.label){case 0:return[4,this._request.refreshAccessToken()];case 1:return o.sent(),t=this._cache.keys,r=t.refreshTokenKey,n=t.accessTokenKey,[4,this._cache.getStoreAsync(r)];case 2:return s=o.sent(),[4,this._cache.getStoreAsync(n)];case 3:return i=o.sent(),[2,{"x-cloudbase-credentials":i+"/@@/"+s}]}})})},e.prototype.sendPhoneCode=function(t){return oe(this,void 0,void 0,function(){var r;return ae(this,function(n){switch(n.label){case 0:return[4,this._request.send("auth.sendPhoneCode",{phoneNumber:Bo(t)})];case 1:return r=n.sent().data,[2,r.SendStatus==="Ok"]}})})},e.prototype.signUpWithPhoneCode=function(t,r,n){return oe(this,void 0,void 0,function(){return ae(this,function(s){return[2,this.phoneAuthProvider().signUp(t,r,n)]})})},e.prototype.signInWithPhoneCodeOrPassword=function(t){return oe(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.phoneAuthProvider().signIn(t)]})})},e.prototype.forceResetPwdByPhoneCode=function(t){return oe(this,void 0,void 0,function(){return ae(this,function(r){return[2,this.phoneAuthProvider().signIn(Re(Re({},t),{signMethod:Ri.FORCERESETPWD}))]})})},e.prototype._onLoginTypeChanged=function(t){return oe(this,void 0,void 0,function(){var r,n,s,i;return ae(this,function(o){switch(o.label){case 0:return r=t.data,n=r.loginType,s=r.persistence,i=r.env,i!==this._config.env?[2]:[4,this._cache.updatePersistenceAsync(s)];case 1:return o.sent(),[4,this._cache.setStoreAsync(this._cache.keys.loginTypeKey,n)];case 2:return o.sent(),[2]}})})},Ce([ke({title:"",messages:["","  1 -  auth().getCurrenUser() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getCurrenUser",null),Ce([ke({title:"",messages:["","  1 -  auth().isUsernameRegistered() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"isUsernameRegistered",null),Ce([ke({title:"",messages:["","  1 -  auth().signOut() ","  2 - signOut",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"signOut",null),Ce([ke({title:"",messages:["","  1 -  auth().getLoginState() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getLoginState",null),Ce([ke({title:"",messages:["","  1 - ","  2 -  auth().getUserInfo() ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype",Promise)],e.prototype,"getUserInfo",null),Ce([ke({title:"",messages:["","  1 - ","  2 - ",""+Pe]}),Y("design:type",Function),Y("design:paramtypes",[String]),Y("design:returntype",Promise)],e.prototype,"sendPhoneCode",null),e}(),ue={LOGIN_STATE_CHANGED:"loginStateChanged",LOGIN_STATE_EXPIRED:"loginStateExpire",LOGIN_TYPE_CHANGED:"loginTypeChanged",ANONYMOUS_CONVERTED:"anonymousConverted",ACCESS_TOKEN_REFRESHD:"refreshAccessToken"},Y_={name:$_,namespace:"auth",injectEvents:{bus:me,events:[ue.LOGIN_TYPE_CHANGED,ue.LOGIN_STATE_EXPIRED,ue.LOGIN_STATE_CHANGED,ue.ACCESS_TOKEN_REFRESHD,ue.ANONYMOUS_CONVERTED]},entity:function(e){if(e===void 0&&(e={region:"",persistence:"local"}),this.authInstance)return Uo(tn.INVALID_OPERATION,"every cloudbase instance should has only one auth object"),this.authInstance;var t=this.platform,r=t.adapter,n=t.runtime,s=e.persistence||r.primaryStorage;s&&s!==this.config.persistence&&this.updateConfig({persistence:s});var i=this.config,o=i.env,u=i.persistence,h=i.debug;return this.authInstance=new j_({env:o,region:e.region,persistence:u,debug:h,cache:this.cache,request:this.request,runtime:n}),this.authInstance}};try{cloudbase.registerComponent(Y_)}catch{}var mr,qt;(function(e){e.DocIDError="ID",e.CollNameError="",e.OpStrError="",e.DirectionError="",e.IntergerError="must be integer",e.QueryParamTypeError="",e.QueryParamValueError="undefined"})(qt||(qt={}));var he={String:"String",Number:"Number",Object:"Object",Array:"Array",Boolean:"Boolean",Null:"Null",GeoPoint:"GeoPoint",GeoLineString:"GeoLineString",GeoPolygon:"GeoPolygon",GeoMultiPoint:"GeoMultiPoint",GeoMultiLineString:"GeoMultiLineString",GeoMultiPolygon:"GeoMultiPolygon",Timestamp:"Date",Command:"Command",ServerDate:"ServerDate",BsonDate:"BsonDate"},H_=["desc","asc"],q_=["<","<=","==",">=",">"],wr;(function(e){e.lt="<",e.gt=">",e.lte="<=",e.gte=">=",e.eq="=="})(wr||(wr={}));mr={},mr[wr.eq]="$eq",mr[wr.lt]="$lt",mr[wr.lte]="$lte",mr[wr.gt]="$gt",mr[wr.gte]="$gte";var Dt;(function(e){e.WHERE="WHERE",e.DOC="DOC"})(Dt||(Dt={}));var G_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wi=[],xu={},K_=function(){function e(t){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:t}})}return e}(),rt=function(e){G_(t,e);function t(r,n){var s=this;if(n!==xu)throw new TypeError("InternalSymbol cannot be constructed with new operator");return s=e.call(this,r)||this,s}return t.for=function(r){for(var n=0,s=wi.length;n<s;n++)if(wi[n].target===r)return wi[n].instance;var i=new t(r,xu);return wi.push({target:r,instance:i}),i},t}(K_),jn=rt.for("UNSET_FIELD_NAME"),xf=rt.for("UPDATE_COMMAND"),Nf=rt.for("QUERY_COMMAND"),Rf=rt.for("LOGIC_COMMAND"),Df=rt.for("GEO_POINT"),V_=rt.for("SYMBOL_GEO_LINE_STRING"),J_=rt.for("SYMBOL_GEO_POLYGON"),z_=rt.for("SYMBOL_GEO_MULTI_POINT"),Z_=rt.for("SYMBOL_GEO_MULTI_LINE_STRING"),X_=rt.for("SYMBOL_GEO_MULTI_POLYGON"),Cf=rt.for("SERVER_DATE"),Pf=rt.for("REGEXP"),kf=function(){function e(t){var r=(t===void 0?{}:t).offset,n=r===void 0?0:r;this.offset=n}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return Cf},enumerable:!0,configurable:!0}),e.prototype.parse=function(){return{$date:{offset:this.offset}}},e}();function Q_(e){return new kf(e)}var po=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},ls=function(){function e(){}return e.formatResDocumentData=function(t){return t.map(function(r){return e.formatField(r)})},e.formatField=function(t){var r=Object.keys(t),n={};return Array.isArray(t)&&(n=[]),r.forEach(function(s){var i=t[s],o=e.whichType(i),u;switch(o){case he.GeoPoint:u=new Xe(i.coordinates[0],i.coordinates[1]);break;case he.GeoLineString:u=new Nt(i.coordinates.map(function(h){return new Xe(h[0],h[1])}));break;case he.GeoPolygon:u=new Tr(i.coordinates.map(function(h){return new Nt(h.map(function(a){var c=po(a,2),d=c[0],m=c[1];return new Xe(d,m)}))}));break;case he.GeoMultiPoint:u=new $i(i.coordinates.map(function(h){return new Xe(h[0],h[1])}));break;case he.GeoMultiLineString:u=new Wi(i.coordinates.map(function(h){return new Nt(h.map(function(a){var c=po(a,2),d=c[0],m=c[1];return new Xe(d,m)}))}));break;case he.GeoMultiPolygon:u=new Yn(i.coordinates.map(function(h){return new Tr(h.map(function(a){return new Nt(a.map(function(c){var d=po(c,2),m=d[0],w=d[1];return new Xe(m,w)}))}))}));break;case he.Timestamp:u=new Date(i.$timestamp*1e3);break;case he.Object:case he.Array:u=e.formatField(i);break;case he.ServerDate:u=new Date(i.$date);break;default:u=i}Array.isArray(n)?n.push(u):n[s]=u}),n},e.whichType=function(t){var r=Object.prototype.toString.call(t).slice(8,-1);if(r===he.Timestamp)return he.BsonDate;if(r===he.Object){if(t instanceof Xe)return he.GeoPoint;if(t instanceof Date)return he.Timestamp;if(t instanceof kf)return he.ServerDate;t.$timestamp?r=he.Timestamp:t.$date?r=he.ServerDate:Xe.validate(t)?r=he.GeoPoint:Nt.validate(t)?r=he.GeoLineString:Tr.validate(t)?r=he.GeoPolygon:$i.validate(t)?r=he.GeoMultiPoint:Wi.validate(t)?r=he.GeoMultiLineString:Yn.validate(t)&&(r=he.GeoMultiPolygon)}return r},e.generateDocId=function(){for(var t="ABCDEFabcdef0123456789",r="",n=0;n<24;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},e}(),ir=function(){function e(){}return e.isGeopoint=function(t,r){if(ls.whichType(r)!==he.Number)throw new Error("Geo Point must be number type");var n=Math.abs(r);if(t==="latitude"&&n>90)throw new Error("latitude should be a number ranges from -90 to 90");if(t==="longitude"&&n>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0},e.isInteger=function(t,r){if(!Number.isInteger(r))throw new Error(t+qt.IntergerError);return!0},e.isFieldOrder=function(t){if(H_.indexOf(t)===-1)throw new Error(qt.DirectionError);return!0},e.isFieldPath=function(t){if(!/^[a-zA-Z0-9-_\.]/.test(t))throw new Error;return!0},e.isOperator=function(t){if(q_.indexOf(t)===-1)throw new Error(qt.OpStrError);return!0},e.isCollName=function(t){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(t))throw new Error(qt.CollNameError);return!0},e.isDocID=function(t){if(!/^([a-fA-F0-9]){24}$/.test(t))throw new Error(qt.DocIDError);return!0},e}(),kt=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},ar=function(e){return kt(e)==="object"},ev=function(e){return kt(e)==="string"},dt=function(e){return kt(e)==="number"},Ie=function(e){return Array.isArray(e)},Mf=function(e){return kt(e)==="date"},ba=function(e){return kt(e)==="regexp"},Ff=function(e){return e&&e._internalType instanceof rt},Xe=function(){function e(t,r){ir.isGeopoint("longitude",t),ir.isGeopoint("latitude",r),this.longitude=t,this.latitude=r}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Point",coordinates:[this.longitude,this.latitude]},r},e.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},e.prototype.toReadableString=function(){return"["+this.longitude+","+this.latitude+"]"},e.validate=function(t){return t.type==="Point"&&Ie(t.coordinates)&&ir.isGeopoint("longitude",t.coordinates[0])&&ir.isGeopoint("latitude",t.coordinates[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return Df},enumerable:!0,configurable:!0}),e}(),tv=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Nt=function(){function e(t){if(!Ie(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length<2)throw new Error('"points" must contain 2 points at least');t.forEach(function(r){if(!(r instanceof Xe))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"LineString",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="LineString"||!Ie(t.coordinates))return!1;try{for(var s=tv(t.coordinates),i=s.next();!i.done;i=s.next()){var o=i.value;if(!dt(o[0])||!dt(o[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!0},e.isClosed=function(t){var r=t.points[0],n=t.points[t.points.length-1];if(r.latitude===n.latitude&&r.longitude===n.longitude)return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return V_},enumerable:!0,configurable:!0}),e}(),Nu=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Tr=function(){function e(t){if(!Ie(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Nt))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]");if(!Nt.isClosed(r))throw new Error("LineString "+r.points.map(function(n){return n.toReadableString()})+" is not a closed cycle")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"Polygon",coordinates:this.lines.map(function(n){return n.points.map(function(s){return[s.longitude,s.latitude]})})},r},e.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,s,i;if(t.type!=="Polygon"||!Ie(t.coordinates))return!1;try{for(var o=Nu(t.coordinates),u=o.next();!u.done;u=o.next()){var h=u.value;if(!this.isCloseLineString(h))return!1;try{for(var a=(s=void 0,Nu(h)),c=a.next();!c.done;c=a.next()){var d=c.value;if(!dt(d[0])||!dt(d[1]))return!1}}catch(m){s={error:m}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}}catch(m){r={error:m}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},e.isCloseLineString=function(t){var r=t[0],n=t[t.length-1];return!(r[0]!==n[0]||r[1]!==n[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return X_},enumerable:!0,configurable:!0}),e}(),rv=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$i=function(){function e(t){if(!Ie(t))throw new TypeError('"points" must be of type Point[]. Received type '+typeof t);if(t.length===0)throw new Error('"points" must contain 1 point at least');t.forEach(function(r){if(!(r instanceof Xe))throw new TypeError('"points" must be of type Point[]. Received type '+typeof r+"[]")}),this.points=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPoint",coordinates:this.points.map(function(n){return n.toJSON().coordinates})},r},e.prototype.toJSON=function(){return{type:"MultiPoint",coordinates:this.points.map(function(t){return t.toJSON().coordinates})}},e.validate=function(t){var r,n;if(t.type!=="MultiPoint"||!Ie(t.coordinates))return!1;try{for(var s=rv(t.coordinates),i=s.next();!i.done;i=s.next()){var o=i.value;if(!dt(o[0])||!dt(o[1]))return!1}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return z_},enumerable:!0,configurable:!0}),e}(),Ru=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Wi=function(){function e(t){if(!Ie(t))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof t);if(t.length===0)throw new Error("Polygon must contain 1 linestring at least");t.forEach(function(r){if(!(r instanceof Nt))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof r+"[]")}),this.lines=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiLineString",coordinates:this.lines.map(function(n){return n.points.map(function(s){return[s.longitude,s.latitude]})})},r},e.prototype.toJSON=function(){return{type:"MultiLineString",coordinates:this.lines.map(function(t){return t.points.map(function(r){return[r.longitude,r.latitude]})})}},e.validate=function(t){var r,n,s,i;if(t.type!=="MultiLineString"||!Ie(t.coordinates))return!1;try{for(var o=Ru(t.coordinates),u=o.next();!u.done;u=o.next()){var h=u.value;try{for(var a=(s=void 0,Ru(h)),c=a.next();!c.done;c=a.next()){var d=c.value;if(!dt(d[0])||!dt(d[1]))return!1}}catch(m){s={error:m}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}}catch(m){r={error:m}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return Z_},enumerable:!0,configurable:!0}),e}(),Ei=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yn=function(){function e(t){var r,n;if(!Ie(t))throw new TypeError('"polygons" must be of type Polygon[]. Received type '+typeof t);if(t.length===0)throw new Error("MultiPolygon must contain 1 polygon at least");try{for(var s=Ei(t),i=s.next();!i.done;i=s.next()){var o=i.value;if(!(o instanceof Tr))throw new TypeError('"polygon" must be of type Polygon[]. Received type '+typeof o+"[]")}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.polygons=t}return e.prototype.parse=function(t){var r;return r={},r[t]={type:"MultiPolygon",coordinates:this.polygons.map(function(n){return n.lines.map(function(s){return s.points.map(function(i){return[i.longitude,i.latitude]})})})},r},e.prototype.toJSON=function(){return{type:"MultiPolygon",coordinates:this.polygons.map(function(t){return t.lines.map(function(r){return r.points.map(function(n){return[n.longitude,n.latitude]})})})}},e.validate=function(t){var r,n,s,i,o,u;if(t.type!=="MultiPolygon"||!Ie(t.coordinates))return!1;try{for(var h=Ei(t.coordinates),a=h.next();!a.done;a=h.next()){var c=a.value;try{for(var d=(s=void 0,Ei(c)),m=d.next();!m.done;m=d.next()){var w=m.value;try{for(var A=(o=void 0,Ei(w)),S=A.next();!S.done;S=A.next()){var _=S.value;if(!dt(_[0])||!dt(_[1]))return!1}}catch(v){o={error:v}}finally{try{S&&!S.done&&(u=A.return)&&u.call(A)}finally{if(o)throw o.error}}}}catch(v){s={error:v}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(s)throw s.error}}}}catch(v){r={error:v}}finally{try{a&&!a.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return J_},enumerable:!0,configurable:!0}),e}();const nv=Object.freeze(Object.defineProperty({__proto__:null,LineString:Nt,MultiLineString:Wi,MultiPoint:$i,MultiPolygon:Yn,Point:Xe,Polygon:Tr},Symbol.toStringTag,{value:"Module"}));var Gt=function(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(n,s){e=function(i,o){return i?s(i):n(o)}});return e.promise=r,e},z;(function(e){e.SET="set",e.REMOVE="remove",e.INC="inc",e.MUL="mul",e.PUSH="push",e.PULL="pull",e.PULL_ALL="pullAll",e.POP="pop",e.SHIFT="shift",e.UNSHIFT="unshift",e.ADD_TO_SET="addToSet",e.BIT="bit",e.RENAME="rename",e.MAX="max",e.MIN="min"})(z||(z={}));var Oe=function(){function e(t,r,n){this._internalType=xf,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||jn}return e.prototype._setFieldName=function(t){var r=new e(this.operator,this.operands,t);return r},e}();function Du(e){return e&&e instanceof Oe&&e._internalType===xf}var et;(function(e){e.AND="and",e.OR="or",e.NOT="not",e.NOR="nor"})(et||(et={}));var Sr=function(){function e(t,r,n){if(this._internalType=Rf,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=t,this.operands=r,this.fieldName=n||jn,this.fieldName!==jn)if(Array.isArray(r)){r=r.slice(),this.operands=r;for(var s=0,i=r.length;s<i;s++){var o=r[s];(ji(o)||Yi(o))&&(r[s]=o._setFieldName(this.fieldName))}}else{var o=r;(ji(o)||Yi(o))&&(r=o._setFieldName(this.fieldName))}}return e.prototype._setFieldName=function(t){var r=this.operands.map(function(s){return s instanceof e?s._setFieldName(t):s}),n=new e(this.operator,r,t);return n},e.prototype.and=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(et.AND,t,this.fieldName)},e.prototype.or=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(et.OR,t,this.fieldName)},e}();function ji(e){return e&&e instanceof Sr&&e._internalType===Rf}var iv=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),q;(function(e){e.EQ="eq",e.NEQ="neq",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte",e.IN="in",e.NIN="nin",e.ALL="all",e.ELEM_MATCH="elemMatch",e.EXISTS="exists",e.SIZE="size",e.MOD="mod",e.GEO_NEAR="geoNear",e.GEO_WITHIN="geoWithin",e.GEO_INTERSECTS="geoIntersects"})(q||(q={}));var De=function(e){iv(t,e);function t(r,n,s){var i=e.call(this,r,n,s)||this;return i.operator=r,i._internalType=Nf,i}return t.prototype.toJSON=function(){var r,n;switch(this.operator){case q.IN:case q.NIN:return r={},r["$"+this.operator]=this.operands,r;default:return n={},n["$"+this.operator]=this.operands[0],n}},t.prototype._setFieldName=function(r){var n=new t(this.operator,this.operands,r);return n},t.prototype.eq=function(r){var n=new t(q.EQ,[r],this.fieldName);return this.and(n)},t.prototype.neq=function(r){var n=new t(q.NEQ,[r],this.fieldName);return this.and(n)},t.prototype.gt=function(r){var n=new t(q.GT,[r],this.fieldName);return this.and(n)},t.prototype.gte=function(r){var n=new t(q.GTE,[r],this.fieldName);return this.and(n)},t.prototype.lt=function(r){var n=new t(q.LT,[r],this.fieldName);return this.and(n)},t.prototype.lte=function(r){var n=new t(q.LTE,[r],this.fieldName);return this.and(n)},t.prototype.in=function(r){var n=new t(q.IN,r,this.fieldName);return this.and(n)},t.prototype.nin=function(r){var n=new t(q.NIN,r,this.fieldName);return this.and(n)},t.prototype.geoNear=function(r){if(!(r.geometry instanceof Xe))throw new TypeError('"geometry" must be of type Point. Received type '+typeof r.geometry);if(r.maxDistance!==void 0&&!dt(r.maxDistance))throw new TypeError('"maxDistance" must be of type Number. Received type '+typeof r.maxDistance);if(r.minDistance!==void 0&&!dt(r.minDistance))throw new TypeError('"minDistance" must be of type Number. Received type '+typeof r.minDistance);var n=new t(q.GEO_NEAR,[r],this.fieldName);return this.and(n)},t.prototype.geoWithin=function(r){if(!(r.geometry instanceof Yn)&&!(r.geometry instanceof Tr))throw new TypeError('"geometry" must be of type Polygon or MultiPolygon. Received type '+typeof r.geometry);var n=new t(q.GEO_WITHIN,[r],this.fieldName);return this.and(n)},t.prototype.geoIntersects=function(r){if(!(r.geometry instanceof Xe)&&!(r.geometry instanceof Nt)&&!(r.geometry instanceof Tr)&&!(r.geometry instanceof $i)&&!(r.geometry instanceof Wi)&&!(r.geometry instanceof Yn))throw new TypeError('"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type '+typeof r.geometry);var n=new t(q.GEO_INTERSECTS,[r],this.fieldName);return this.and(n)},t}(Sr);function Yi(e){return e&&e instanceof De&&e._internalType===Nf}function Cu(e){return Yi(e)}var cr={};for(var ur in q)cr[ur]="$"+ur;for(var ur in et)cr[ur]="$"+ur;for(var ur in z)cr[ur]="$"+ur;cr[q.NEQ]="$ne";cr[z.REMOVE]="$unset";cr[z.SHIFT]="$pop";cr[z.UNSHIFT]="$push";function Jr(e){return cr[e]||"$"+e}var $o=function(){return $o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},$o.apply(this,arguments)},sv=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},Pu=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(sv(arguments[t]));return e};function Hn(e){return Wo(e,[e])}function Wo(e,t){if(Ff(e))switch(e._internalType){case Df:return e.toJSON();case Cf:return e.parse();case Pf:return e.parse();default:return e.toJSON?e.toJSON():e}else{if(Mf(e))return{$date:+e};if(ba(e))return{$regex:e.source,$options:e.flags};if(Ie(e))return e.map(function(s){if(t.indexOf(s)>-1)throw new Error("Cannot convert circular structure to JSON");return Wo(s,Pu(t,[s]))});if(ar(e)){var r=$o({},e);for(var n in r){if(t.indexOf(r[n])>-1)throw new Error("Cannot convert circular structure to JSON");r[n]=Wo(r[n],Pu(t,[r[n]]))}return r}else return e}}var jo=function(){return jo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},jo.apply(this,arguments)},ov=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},ku=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ov(arguments[t]));return e};function Lf(e,t,r,n){var s=jo({},e);for(var i in e)if(!/^\$/.test(i)){var o=e[i];if(o&&ar(o)&&!t(o)){if(n.indexOf(o)>-1)throw new Error("Cannot convert circular structure to JSON");var u=ku(r,[i]),h=ku(n,[o]),a=Lf(o,t,u,h);s[i]=a;var c=!1;for(var d in a)/^\$/.test(d)?c=!0:(s[i+"."+d]=a[d],delete s[i][d]);c||delete s[i]}}return s}function Uf(e){return Lf(e,Yo,[],[e])}function Mu(e,t,r){t[r]||delete e[r];for(var n in t)e[n]?Ie(e[n])?e[n].push(t[n]):ar(e[n])?ar(t[n])?Object.assign(e[n],t[n]):(console.warn("unmergable condition, query is object but condition is "+kt(t)+", can only overwrite",t,r),e[n]=t[n]):(console.warn("to-merge query is of type "+kt(e)+", can only overwrite",e,t,r),e[n]=t[n]):e[n]=t[n]}function Yo(e){return Ff(e)||Mf(e)||ba(e)}function sr(e){return Hn(e)}var Sa=function(){function e(){}return e.encode=function(t){var r=new e;return r.encodeUpdate(t)},e.prototype.encodeUpdate=function(t){return Du(t)?this.encodeUpdateCommand(t):kt(t)==="object"?this.encodeUpdateObject(t):t},e.prototype.encodeUpdateCommand=function(t){if(t.fieldName===jn)throw new Error("Cannot encode a comparison command with unset field name");switch(t.operator){case z.PUSH:case z.PULL:case z.PULL_ALL:case z.POP:case z.SHIFT:case z.UNSHIFT:case z.ADD_TO_SET:return this.encodeArrayUpdateCommand(t);default:return this.encodeFieldUpdateCommand(t)}},e.prototype.encodeFieldUpdateCommand=function(t){var r,n,s,i,o=Jr(t.operator);switch(t.operator){case z.REMOVE:return r={},r[o]=(n={},n[t.fieldName]="",n),r;default:return s={},s[o]=(i={},i[t.fieldName]=t.operands[0],i),s}},e.prototype.encodeArrayUpdateCommand=function(t){var r,n,s,i,o,u,h,a,c,d,m=Jr(t.operator);switch(t.operator){case z.PUSH:{var w=void 0;return Ie(t.operands)?w={$each:t.operands.map(sr)}:w=t.operands,r={},r[m]=(n={},n[t.fieldName]=w,n),r}case z.UNSHIFT:{var w={$each:t.operands.map(sr),$position:0};return s={},s[m]=(i={},i[t.fieldName]=w,i),s}case z.POP:return o={},o[m]=(u={},u[t.fieldName]=1,u),o;case z.SHIFT:return h={},h[m]=(a={},a[t.fieldName]=-1,a),h;default:return c={},c[m]=(d={},d[t.fieldName]=sr(t.operands),d),c}},e.prototype.encodeUpdateObject=function(t){var r=Uf(t);for(var n in r)if(!/^\$/.test(n)){var s=r[n];if(Du(s)){r[n]=s._setFieldName(n);var i=this.encodeUpdateCommand(r[n]);Mu(r,i,n)}else{r[n]=s=sr(s);var o=new Oe(z.SET,[s],n),i=this.encodeUpdateCommand(o);Mu(r,i,n)}}return r},e}(),yo={};function Bf(e){if(!je.wsClientClass)throw new Error("to use realtime you must import realtime module first");var t=e.config.env;return yo[t]||(yo[t]=new je.wsClientClass({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,request:new je.reqClass(e.config)}}})),yo[t]}var Hi=function(){return Hi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Hi.apply(this,arguments)},Fu=function(){function e(t,r,n,s){var i=this;s===void 0&&(s={}),this.watch=function(o){var u=Bf(i._db);return u.watch(Hi(Hi({},o),{envId:i._db.config.env,collectionName:i._coll,query:JSON.stringify({_id:i.id})}))},this._db=t,this._coll=r,this.id=n,this.request=new je.reqClass(this._db.config),this.projection=s}return e.prototype.create=function(t,r){r=r||Gt();var n={collectionName:this._coll,data:Hn(t)};return this.id&&(n._id=this.id),this.request.send("database.addDocument",n).then(function(s){s.code?r(0,s):r(0,{id:s.data._id,requestId:s.requestId})}).catch(function(s){r(s)}),r.promise},e.prototype.set=function(t,r){if(r=r||Gt(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docId"});if(!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:""});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"_id"});var n=!1,s=function(u){if(typeof u=="object")for(var h in u)u[h]instanceof Oe?n=!0:typeof u[h]=="object"&&s(u[h])};if(s(t),n)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});var i=!1,o={collectionName:this._coll,queryType:Dt.DOC,data:Hn(t),multi:!1,merge:i,upsert:!0};return this.id&&(o.query={_id:this.id}),this.request.send("database.updateDocument",o).then(function(u){u.code?r(0,u):r(0,{updated:u.data.updated,upsertedId:u.data.upserted_id,requestId:u.requestId})}).catch(function(u){r(u)}),r.promise},e.prototype.update=function(t,r){if(r=r||Gt(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:""});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"_id"});var n={_id:this.id},s=!0,i={collectionName:this._coll,data:Sa.encode(t),query:n,queryType:Dt.DOC,multi:!1,merge:s,upsert:!1};return this.request.send("database.updateDocument",i).then(function(o){o.code?r(0,o):r(0,{updated:o.data.updated,upsertedId:o.data.upserted_id,requestId:o.requestId})}).catch(function(o){r(o)}),r.promise},e.prototype.remove=function(t){t=t||Gt();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Dt.DOC,multi:!1};return this.request.send("database.deleteDocument",n).then(function(s){s.code?t(0,s):t(0,{deleted:s.data.deleted,requestId:s.requestId})}).catch(function(s){t(s)}),t.promise},e.prototype.get=function(t){t=t||Gt();var r={_id:this.id},n={collectionName:this._coll,query:r,queryType:Dt.DOC,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",n).then(function(s){if(s.code)t(0,s);else{var i=ls.formatResDocumentData(s.data.list);t(0,{data:i,requestId:s.requestId,total:s.TotalCount,limit:s.Limit,offset:s.Offset})}}).catch(function(s){t(s)}),t.promise},e.prototype.field=function(t){for(var r in t)t[r]?t[r]=1:t[r]=0;return new e(this._db,this._coll,this.id,t)},e}(),Ho=function(){function e(){}return e.encode=function(t){var r=new av;return r.encodeQuery(t)},e}(),av=function(){function e(){}return e.prototype.encodeQuery=function(t,r){var n;return Yo(t)?ji(t)?this.encodeLogicCommand(t):Yi(t)?this.encodeQueryCommand(t):(n={},n[r]=this.encodeQueryObject(t),n):ar(t)?this.encodeQueryObject(t):t},e.prototype.encodeRegExp=function(t){return{$regex:t.source,$options:t.flags}},e.prototype.encodeLogicCommand=function(t){var r,n,s,i,o,u,h,a=this;switch(t.operator){case et.NOR:case et.AND:case et.OR:{var c=Jr(t.operator),d=t.operands.map(function(A){return a.encodeQuery(A,t.fieldName)});return r={},r[c]=d,r}case et.NOT:{var c=Jr(t.operator),m=t.operands[0];if(ba(m))return n={},n[t.fieldName]=(s={},s[c]=this.encodeRegExp(m),s),n;var d=this.encodeQuery(m)[t.fieldName];return i={},i[t.fieldName]=(o={},o[c]=d,o),i}default:{var c=Jr(t.operator);if(t.operands.length===1){var w=this.encodeQuery(t.operands[0]);return u={},u[c]=w,u}else{var d=t.operands.map(this.encodeQuery.bind(this));return h={},h[c]=d,h}}}},e.prototype.encodeQueryCommand=function(t){return Cu(t)?this.encodeComparisonCommand(t):this.encodeComparisonCommand(t)},e.prototype.encodeComparisonCommand=function(t){var r,n,s,i,o,u,h,a,c;if(t.fieldName===jn)throw new Error("Cannot encode a comparison command with unset field name");var d=Jr(t.operator);switch(t.operator){case q.EQ:case q.NEQ:case q.LT:case q.LTE:case q.GT:case q.GTE:case q.ELEM_MATCH:case q.EXISTS:case q.SIZE:case q.MOD:return r={},r[t.fieldName]=(n={},n[d]=sr(t.operands[0]),n),r;case q.IN:case q.NIN:case q.ALL:return s={},s[t.fieldName]=(i={},i[d]=sr(t.operands),i),s;case q.GEO_NEAR:{var m=t.operands[0];return o={},o[t.fieldName]={$nearSphere:{$geometry:m.geometry.toJSON(),$maxDistance:m.maxDistance,$minDistance:m.minDistance}},o}case q.GEO_WITHIN:{var m=t.operands[0];return u={},u[t.fieldName]={$geoWithin:{$geometry:m.geometry.toJSON()}},u}case q.GEO_INTERSECTS:{var m=t.operands[0];return h={},h[t.fieldName]={$geoIntersects:{$geometry:m.geometry.toJSON()}},h}default:return a={},a[t.fieldName]=(c={},c[d]=sr(t.operands[0]),c),a}},e.prototype.encodeQueryObject=function(t){var r=Uf(t);for(var n in r){var s=r[n];if(ji(s)){r[n]=s._setFieldName(n);var i=this.encodeLogicCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else if(Cu(s)){r[n]=s._setFieldName(n);var i=this.encodeComparisonCommand(r[n]);this.mergeConditionAfterEncode(r,i,n)}else Yo(s)&&(r[n]=sr(s))}return r},e.prototype.mergeConditionAfterEncode=function(t,r,n){r[n]||delete t[n];for(var s in r)t[s]?Ie(t[s])?t[s]=t[s].concat(r[s]):ar(t[s])?ar(r[s])?Object.assign(t,r):(console.warn("unmergable condition, query is object but condition is "+kt(r)+", can only overwrite",r,n),t[s]=r[s]):(console.warn("to-merge query is of type "+kt(t)+", can only overwrite",t,r,n),t[s]=r[s]):t[s]=r[s]},e}(),Er=function(){return Er=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Er.apply(this,arguments)},uv=function(){function e(t,r,n,s,i){var o=this;this.watch=function(u){var h=Bf(o._db);return h.watch(Er(Er({},u),{envId:o._db.config.env,collectionName:o._coll,query:JSON.stringify(o._fieldFilters||{}),limit:o._queryOptions.limit,orderBy:o._fieldOrders?o._fieldOrders.reduce(function(a,c){return a[c.field]=c.direction,a},{}):void 0}))},this._db=t,this._coll=r,this._fieldFilters=n,this._fieldOrders=s||[],this._queryOptions=i||{},this._request=new je.reqClass(this._db.config)}return e.prototype.get=function(t){t=t||Gt();var r=[];this._fieldOrders&&this._fieldOrders.forEach(function(s){r.push(s)});var n={collectionName:this._coll,queryType:Dt.WHERE};return this._fieldFilters&&(n.query=this._fieldFilters),r.length>0&&(n.order=r),this._queryOptions.offset&&(n.offset=this._queryOptions.offset),this._queryOptions.limit?n.limit=this._queryOptions.limit<1e3?this._queryOptions.limit:1e3:n.limit=100,this._queryOptions.projection&&(n.projection=this._queryOptions.projection),this._request.send("database.queryDocument",n).then(function(s){if(s.code)t(0,s);else{var i=ls.formatResDocumentData(s.data.list),o={data:i,requestId:s.requestId};s.TotalCount&&(o.total=s.TotalCount),s.Limit&&(o.limit=s.Limit),s.Offset&&(o.offset=s.Offset),t(0,o)}}).catch(function(s){t(s)}),t.promise},e.prototype.count=function(t){t=t||Gt();var r={collectionName:this._coll,queryType:Dt.WHERE};return this._fieldFilters&&(r.query=this._fieldFilters),this._request.send("database.countDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,total:n.data.total})}).catch(function(n){t(n)}),t.promise},e.prototype.where=function(t){if(Object.prototype.toString.call(t).slice(8,-1)!=="Object")throw Error(qt.QueryParamTypeError);var r=Object.keys(t),n=r.some(function(s){return t[s]!==void 0});if(r.length&&!n)throw Error(qt.QueryParamValueError);return new e(this._db,this._coll,Ho.encode(t),this._fieldOrders,this._queryOptions)},e.prototype.orderBy=function(t,r){ir.isFieldPath(t),ir.isFieldOrder(r);var n={field:t,direction:r},s=this._fieldOrders.concat(n);return new e(this._db,this._coll,this._fieldFilters,s,this._queryOptions)},e.prototype.limit=function(t){ir.isInteger("limit",t);var r=Er({},this._queryOptions);return r.limit=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.skip=function(t){ir.isInteger("offset",t);var r=Er({},this._queryOptions);return r.offset=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.update=function(t,r){if(r=r||Gt(),!t||typeof t!="object")return Promise.resolve({code:"INVALID_PARAM",message:""});if(t.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"_id"});var n={collectionName:this._coll,query:this._fieldFilters,queryType:Dt.WHERE,multi:!0,merge:!0,upsert:!1,data:Sa.encode(t)};return this._request.send("database.updateDocument",n).then(function(s){s.code?r(0,s):r(0,{requestId:s.requestId,updated:s.data.updated,upsertId:s.data.upsert_id})}).catch(function(s){r(s)}),r.promise},e.prototype.field=function(t){for(var r in t)t[r]?typeof t[r]!="object"&&(t[r]=1):t[r]=0;var n=Er({},this._queryOptions);return n.projection=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,n)},e.prototype.remove=function(t){t=t||Gt(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");var r={collectionName:this._coll,query:Ho.encode(this._fieldFilters),queryType:Dt.WHERE,multi:!0};return this._request.send("database.deleteDocument",r).then(function(n){n.code?t(0,n):t(0,{requestId:n.requestId,deleted:n.data.deleted})}).catch(function(n){t(n)}),t.promise},e}();function cv(e,t){return t={exports:{}},e(t,t.exports),t.exports}var fv=yv,lv=mv,hv=wv,Rt=[],ct=[],dv=typeof Uint8Array<"u"?Uint8Array:Array,go="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yr=0,pv=go.length;Yr<pv;++Yr)Rt[Yr]=go[Yr],ct[go.charCodeAt(Yr)]=Yr;ct[45]=62;ct[95]=63;function $f(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function yv(e){var t=$f(e),r=t[0],n=t[1];return(r+n)*3/4-n}function gv(e,t,r){return(t+r)*3/4-r}function mv(e){var t,r=$f(e),n=r[0],s=r[1],i=new dv(gv(e,n,s)),o=0,u=s>0?n-4:n,h;for(h=0;h<u;h+=4)t=ct[e.charCodeAt(h)]<<18|ct[e.charCodeAt(h+1)]<<12|ct[e.charCodeAt(h+2)]<<6|ct[e.charCodeAt(h+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=t&255;return s===2&&(t=ct[e.charCodeAt(h)]<<2|ct[e.charCodeAt(h+1)]>>4,i[o++]=t&255),s===1&&(t=ct[e.charCodeAt(h)]<<10|ct[e.charCodeAt(h+1)]<<4|ct[e.charCodeAt(h+2)]>>2,i[o++]=t>>8&255,i[o++]=t&255),i}function _v(e){return Rt[e>>18&63]+Rt[e>>12&63]+Rt[e>>6&63]+Rt[e&63]}function vv(e,t,r){for(var n,s=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(_v(n));return s.join("")}function wv(e){for(var t,r=e.length,n=r%3,s=[],i=16383,o=0,u=r-n;o<u;o+=i)s.push(vv(e,o,o+i>u?u:o+i));return n===1?(t=e[r-1],s.push(Rt[t>>2]+Rt[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],s.push(Rt[t>>10]+Rt[t>>4&63]+Rt[t<<2&63]+"=")),s.join("")}var mo={byteLength:fv,toByteArray:lv,fromByteArray:hv};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Ev=function(t,r,n,s,i){var o,u,h=i*8-s-1,a=(1<<h)-1,c=a>>1,d=-7,m=n?i-1:0,w=n?-1:1,A=t[r+m];for(m+=w,o=A&(1<<-d)-1,A>>=-d,d+=h;d>0;o=o*256+t[r+m],m+=w,d-=8);for(u=o&(1<<-d)-1,o>>=-d,d+=s;d>0;u=u*256+t[r+m],m+=w,d-=8);if(o===0)o=1-c;else{if(o===a)return u?NaN:(A?-1:1)*(1/0);u=u+Math.pow(2,s),o=o-c}return(A?-1:1)*u*Math.pow(2,o-s)},bv=function(t,r,n,s,i,o){var u,h,a,c=o*8-i-1,d=(1<<c)-1,m=d>>1,w=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=s?0:o-1,S=s?1:-1,_=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(h=isNaN(r)?1:0,u=d):(u=Math.floor(Math.log(r)/Math.LN2),r*(a=Math.pow(2,-u))<1&&(u--,a*=2),u+m>=1?r+=w/a:r+=w*Math.pow(2,1-m),r*a>=2&&(u++,a/=2),u+m>=d?(h=0,u=d):u+m>=1?(h=(r*a-1)*Math.pow(2,i),u=u+m):(h=r*Math.pow(2,m-1)*Math.pow(2,i),u=0));i>=8;t[n+A]=h&255,A+=S,h/=256,i-=8);for(u=u<<i|h,c+=i;c>0;t[n+A]=u&255,A+=S,u/=256,c-=8);t[n+A-S]|=_*128},Hr={read:Ev,write:bv},hs=cv(function(e,t){var r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;var n=2147483647;t.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var y=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(y,f),y.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function i(y){if(y>n)throw new RangeError('The value "'+y+'" is invalid for option "size"');var f=new Uint8Array(y);return Object.setPrototypeOf(f,o.prototype),f}function o(y,f,l){if(typeof y=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return c(y)}return u(y,f,l)}o.poolSize=8192;function u(y,f,l){if(typeof y=="string")return d(y,f);if(ArrayBuffer.isView(y))return w(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(y));if(it(y,ArrayBuffer)||y&&it(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(it(y,SharedArrayBuffer)||y&&it(y.buffer,SharedArrayBuffer)))return A(y,f,l);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var g=y.valueOf&&y.valueOf();if(g!=null&&g!==y)return o.from(g,f,l);var E=S(y);if(E)return E;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return o.from(y[Symbol.toPrimitive]("string"),f,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(y))}o.from=function(y,f,l){return u(y,f,l)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function h(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function a(y,f,l){return h(y),y<=0?i(y):f!==void 0?typeof l=="string"?i(y).fill(f,l):i(y).fill(f):i(y)}o.alloc=function(y,f,l){return a(y,f,l)};function c(y){return h(y),i(y<0?0:_(y)|0)}o.allocUnsafe=function(y){return c(y)},o.allocUnsafeSlow=function(y){return c(y)};function d(y,f){if((typeof f!="string"||f==="")&&(f="utf8"),!o.isEncoding(f))throw new TypeError("Unknown encoding: "+f);var l=N(y,f)|0,g=i(l),E=g.write(y,f);return E!==l&&(g=g.slice(0,E)),g}function m(y){for(var f=y.length<0?0:_(y.length)|0,l=i(f),g=0;g<f;g+=1)l[g]=y[g]&255;return l}function w(y){if(it(y,Uint8Array)){var f=new Uint8Array(y);return A(f.buffer,f.byteOffset,f.byteLength)}return m(y)}function A(y,f,l){if(f<0||y.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<f+(l||0))throw new RangeError('"length" is outside of buffer bounds');var g;return f===void 0&&l===void 0?g=new Uint8Array(y):l===void 0?g=new Uint8Array(y,f):g=new Uint8Array(y,f,l),Object.setPrototypeOf(g,o.prototype),g}function S(y){if(o.isBuffer(y)){var f=_(y.length)|0,l=i(f);return l.length===0||y.copy(l,0,0,f),l}if(y.length!==void 0)return typeof y.length!="number"||gn(y.length)?i(0):m(y);if(y.type==="Buffer"&&Array.isArray(y.data))return m(y.data)}function _(y){if(y>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return y|0}function v(y){return+y!=y&&(y=0),o.alloc(+y)}o.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==o.prototype},o.compare=function(f,l){if(it(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),it(l,Uint8Array)&&(l=o.from(l,l.offset,l.byteLength)),!o.isBuffer(f)||!o.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===l)return 0;for(var g=f.length,E=l.length,x=0,R=Math.min(g,E);x<R;++x)if(f[x]!==l[x]){g=f[x],E=l[x];break}return g<E?-1:E<g?1:0},o.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(f,l){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return o.alloc(0);var g;if(l===void 0)for(l=0,g=0;g<f.length;++g)l+=f[g].length;var E=o.allocUnsafe(l),x=0;for(g=0;g<f.length;++g){var R=f[g];if(it(R,Uint8Array))x+R.length>E.length?o.from(R).copy(E,x):Uint8Array.prototype.set.call(E,R,x);else if(o.isBuffer(R))R.copy(E,x);else throw new TypeError('"list" argument must be an Array of Buffers');x+=R.length}return E};function N(y,f){if(o.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||it(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(y));var l=y.length,g=arguments.length>2&&arguments[2]===!0;if(!g&&l===0)return 0;for(var E=!1;;)switch(f){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return yn(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l*2;case"hex":return l>>>1;case"base64":return ii(y).length;default:if(E)return g?-1:yn(y).length;f=(""+f).toLowerCase(),E=!0}}o.byteLength=N;function O(y,f,l){var g=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((l===void 0||l>this.length)&&(l=this.length),l<=0)||(l>>>=0,f>>>=0,l<=f))return"";for(y||(y="utf8");;)switch(y){case"hex":return $e(this,f,l);case"utf8":case"utf-8":return ne(this,f,l);case"ascii":return At(this,f,l);case"latin1":case"binary":return fe(this,f,l);case"base64":return Ne(this,f,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,f,l);default:if(g)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),g=!0}}o.prototype._isBuffer=!0;function I(y,f,l){var g=y[f];y[f]=y[l],y[l]=g}o.prototype.swap16=function(){var f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<f;l+=2)I(this,l,l+1);return this},o.prototype.swap32=function(){var f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<f;l+=4)I(this,l,l+3),I(this,l+1,l+2);return this},o.prototype.swap64=function(){var f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<f;l+=8)I(this,l,l+7),I(this,l+1,l+6),I(this,l+2,l+5),I(this,l+3,l+4);return this},o.prototype.toString=function(){var f=this.length;return f===0?"":arguments.length===0?ne(this,0,f):O.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(f){if(!o.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:o.compare(this,f)===0},o.prototype.inspect=function(){var f="",l=t.INSPECT_MAX_BYTES;return f=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(f+=" ... "),"<Buffer "+f+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(f,l,g,E,x){if(it(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),!o.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(f));if(l===void 0&&(l=0),g===void 0&&(g=f?f.length:0),E===void 0&&(E=0),x===void 0&&(x=this.length),l<0||g>f.length||E<0||x>this.length)throw new RangeError("out of range index");if(E>=x&&l>=g)return 0;if(E>=x)return-1;if(l>=g)return 1;if(l>>>=0,g>>>=0,E>>>=0,x>>>=0,this===f)return 0;for(var R=x-E,V=g-l,se=Math.min(R,V),Q=this.slice(E,x),Se=f.slice(l,g),ye=0;ye<se;++ye)if(Q[ye]!==Se[ye]){R=Q[ye],V=Se[ye];break}return R<V?-1:V<R?1:0};function k(y,f,l,g,E){if(y.length===0)return-1;if(typeof l=="string"?(g=l,l=0):l>2147483647?l=2147483647:l<-2147483648&&(l=-2147483648),l=+l,gn(l)&&(l=E?0:y.length-1),l<0&&(l=y.length+l),l>=y.length){if(E)return-1;l=y.length-1}else if(l<0)if(E)l=0;else return-1;if(typeof f=="string"&&(f=o.from(f,g)),o.isBuffer(f))return f.length===0?-1:M(y,f,l,g,E);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?E?Uint8Array.prototype.indexOf.call(y,f,l):Uint8Array.prototype.lastIndexOf.call(y,f,l):M(y,[f],l,g,E);throw new TypeError("val must be string, number or Buffer")}function M(y,f,l,g,E){var x=1,R=y.length,V=f.length;if(g!==void 0&&(g=String(g).toLowerCase(),g==="ucs2"||g==="ucs-2"||g==="utf16le"||g==="utf-16le")){if(y.length<2||f.length<2)return-1;x=2,R/=2,V/=2,l/=2}function se(mn,_n){return x===1?mn[_n]:mn.readUInt16BE(_n*x)}var Q;if(E){var Se=-1;for(Q=l;Q<R;Q++)if(se(y,Q)===se(f,Se===-1?0:Q-Se)){if(Se===-1&&(Se=Q),Q-Se+1===V)return Se*x}else Se!==-1&&(Q-=Q-Se),Se=-1}else for(l+V>R&&(l=R-V),Q=l;Q>=0;Q--){for(var ye=!0,lr=0;lr<V;lr++)if(se(y,Q+lr)!==se(f,lr)){ye=!1;break}if(ye)return Q}return-1}o.prototype.includes=function(f,l,g){return this.indexOf(f,l,g)!==-1},o.prototype.indexOf=function(f,l,g){return k(this,f,l,g,!0)},o.prototype.lastIndexOf=function(f,l,g){return k(this,f,l,g,!1)};function j(y,f,l,g){l=Number(l)||0;var E=y.length-l;g?(g=Number(g),g>E&&(g=E)):g=E;var x=f.length;g>x/2&&(g=x/2);for(var R=0;R<g;++R){var V=parseInt(f.substr(R*2,2),16);if(gn(V))return R;y[l+R]=V}return R}function G(y,f,l,g){return fr(yn(f,y.length-l),y,l,g)}function ee(y,f,l,g){return fr(Ts(f),y,l,g)}function _e(y,f,l,g){return fr(ii(f),y,l,g)}function be(y,f,l,g){return fr(Os(f,y.length-l),y,l,g)}o.prototype.write=function(f,l,g,E){if(l===void 0)E="utf8",g=this.length,l=0;else if(g===void 0&&typeof l=="string")E=l,g=this.length,l=0;else if(isFinite(l))l=l>>>0,isFinite(g)?(g=g>>>0,E===void 0&&(E="utf8")):(E=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var x=this.length-l;if((g===void 0||g>x)&&(g=x),f.length>0&&(g<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");E||(E="utf8");for(var R=!1;;)switch(E){case"hex":return j(this,f,l,g);case"utf8":case"utf-8":return G(this,f,l,g);case"ascii":case"latin1":case"binary":return ee(this,f,l,g);case"base64":return _e(this,f,l,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return be(this,f,l,g);default:if(R)throw new TypeError("Unknown encoding: "+E);E=(""+E).toLowerCase(),R=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ne(y,f,l){return f===0&&l===y.length?mo.fromByteArray(y):mo.fromByteArray(y.slice(f,l))}function ne(y,f,l){l=Math.min(y.length,l);for(var g=[],E=f;E<l;){var x=y[E],R=null,V=x>239?4:x>223?3:x>191?2:1;if(E+V<=l){var se,Q,Se,ye;switch(V){case 1:x<128&&(R=x);break;case 2:se=y[E+1],(se&192)===128&&(ye=(x&31)<<6|se&63,ye>127&&(R=ye));break;case 3:se=y[E+1],Q=y[E+2],(se&192)===128&&(Q&192)===128&&(ye=(x&15)<<12|(se&63)<<6|Q&63,ye>2047&&(ye<55296||ye>57343)&&(R=ye));break;case 4:se=y[E+1],Q=y[E+2],Se=y[E+3],(se&192)===128&&(Q&192)===128&&(Se&192)===128&&(ye=(x&15)<<18|(se&63)<<12|(Q&63)<<6|Se&63,ye>65535&&ye<1114112&&(R=ye))}}R===null?(R=65533,V=1):R>65535&&(R-=65536,g.push(R>>>10&1023|55296),R=56320|R&1023),g.push(R),E+=V}return Be(g)}var Me=4096;function Be(y){var f=y.length;if(f<=Me)return String.fromCharCode.apply(String,y);for(var l="",g=0;g<f;)l+=String.fromCharCode.apply(String,y.slice(g,g+=Me));return l}function At(y,f,l){var g="";l=Math.min(y.length,l);for(var E=f;E<l;++E)g+=String.fromCharCode(y[E]&127);return g}function fe(y,f,l){var g="";l=Math.min(y.length,l);for(var E=f;E<l;++E)g+=String.fromCharCode(y[E]);return g}function $e(y,f,l){var g=y.length;(!f||f<0)&&(f=0),(!l||l<0||l>g)&&(l=g);for(var E="",x=f;x<l;++x)E+=si[y[x]];return E}function X(y,f,l){for(var g=y.slice(f,l),E="",x=0;x<g.length-1;x+=2)E+=String.fromCharCode(g[x]+g[x+1]*256);return E}o.prototype.slice=function(f,l){var g=this.length;f=~~f,l=l===void 0?g:~~l,f<0?(f+=g,f<0&&(f=0)):f>g&&(f=g),l<0?(l+=g,l<0&&(l=0)):l>g&&(l=g),l<f&&(l=f);var E=this.subarray(f,l);return Object.setPrototypeOf(E,o.prototype),E};function L(y,f,l){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+f>l)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(f,l,g){f=f>>>0,l=l>>>0,g||L(f,l,this.length);for(var E=this[f],x=1,R=0;++R<l&&(x*=256);)E+=this[f+R]*x;return E},o.prototype.readUintBE=o.prototype.readUIntBE=function(f,l,g){f=f>>>0,l=l>>>0,g||L(f,l,this.length);for(var E=this[f+--l],x=1;l>0&&(x*=256);)E+=this[f+--l]*x;return E},o.prototype.readUint8=o.prototype.readUInt8=function(f,l){return f=f>>>0,l||L(f,1,this.length),this[f]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(f,l){return f=f>>>0,l||L(f,2,this.length),this[f]|this[f+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(f,l){return f=f>>>0,l||L(f,2,this.length),this[f]<<8|this[f+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(f,l){return f=f>>>0,l||L(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(f,l){return f=f>>>0,l||L(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},o.prototype.readIntLE=function(f,l,g){f=f>>>0,l=l>>>0,g||L(f,l,this.length);for(var E=this[f],x=1,R=0;++R<l&&(x*=256);)E+=this[f+R]*x;return x*=128,E>=x&&(E-=Math.pow(2,8*l)),E},o.prototype.readIntBE=function(f,l,g){f=f>>>0,l=l>>>0,g||L(f,l,this.length);for(var E=l,x=1,R=this[f+--E];E>0&&(x*=256);)R+=this[f+--E]*x;return x*=128,R>=x&&(R-=Math.pow(2,8*l)),R},o.prototype.readInt8=function(f,l){return f=f>>>0,l||L(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},o.prototype.readInt16LE=function(f,l){f=f>>>0,l||L(f,2,this.length);var g=this[f]|this[f+1]<<8;return g&32768?g|4294901760:g},o.prototype.readInt16BE=function(f,l){f=f>>>0,l||L(f,2,this.length);var g=this[f+1]|this[f]<<8;return g&32768?g|4294901760:g},o.prototype.readInt32LE=function(f,l){return f=f>>>0,l||L(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},o.prototype.readInt32BE=function(f,l){return f=f>>>0,l||L(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},o.prototype.readFloatLE=function(f,l){return f=f>>>0,l||L(f,4,this.length),Hr.read(this,f,!0,23,4)},o.prototype.readFloatBE=function(f,l){return f=f>>>0,l||L(f,4,this.length),Hr.read(this,f,!1,23,4)},o.prototype.readDoubleLE=function(f,l){return f=f>>>0,l||L(f,8,this.length),Hr.read(this,f,!0,52,8)},o.prototype.readDoubleBE=function(f,l){return f=f>>>0,l||L(f,8,this.length),Hr.read(this,f,!1,52,8)};function Le(y,f,l,g,E,x){if(!o.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>E||f<x)throw new RangeError('"value" argument is out of bounds');if(l+g>y.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(f,l,g,E){if(f=+f,l=l>>>0,g=g>>>0,!E){var x=Math.pow(2,8*g)-1;Le(this,f,l,g,x,0)}var R=1,V=0;for(this[l]=f&255;++V<g&&(R*=256);)this[l+V]=f/R&255;return l+g},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(f,l,g,E){if(f=+f,l=l>>>0,g=g>>>0,!E){var x=Math.pow(2,8*g)-1;Le(this,f,l,g,x,0)}var R=g-1,V=1;for(this[l+R]=f&255;--R>=0&&(V*=256);)this[l+R]=f/V&255;return l+g},o.prototype.writeUint8=o.prototype.writeUInt8=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,1,255,0),this[l]=f&255,l+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,65535,0),this[l]=f&255,this[l+1]=f>>>8,l+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,65535,0),this[l]=f>>>8,this[l+1]=f&255,l+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,4294967295,0),this[l+3]=f>>>24,this[l+2]=f>>>16,this[l+1]=f>>>8,this[l]=f&255,l+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,4294967295,0),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4},o.prototype.writeIntLE=function(f,l,g,E){if(f=+f,l=l>>>0,!E){var x=Math.pow(2,8*g-1);Le(this,f,l,g,x-1,-x)}var R=0,V=1,se=0;for(this[l]=f&255;++R<g&&(V*=256);)f<0&&se===0&&this[l+R-1]!==0&&(se=1),this[l+R]=(f/V>>0)-se&255;return l+g},o.prototype.writeIntBE=function(f,l,g,E){if(f=+f,l=l>>>0,!E){var x=Math.pow(2,8*g-1);Le(this,f,l,g,x-1,-x)}var R=g-1,V=1,se=0;for(this[l+R]=f&255;--R>=0&&(V*=256);)f<0&&se===0&&this[l+R+1]!==0&&(se=1),this[l+R]=(f/V>>0)-se&255;return l+g},o.prototype.writeInt8=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,1,127,-128),f<0&&(f=255+f+1),this[l]=f&255,l+1},o.prototype.writeInt16LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,32767,-32768),this[l]=f&255,this[l+1]=f>>>8,l+2},o.prototype.writeInt16BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,2,32767,-32768),this[l]=f>>>8,this[l+1]=f&255,l+2},o.prototype.writeInt32LE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,2147483647,-2147483648),this[l]=f&255,this[l+1]=f>>>8,this[l+2]=f>>>16,this[l+3]=f>>>24,l+4},o.prototype.writeInt32BE=function(f,l,g){return f=+f,l=l>>>0,g||Le(this,f,l,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4};function ri(y,f,l,g,E,x){if(l+g>y.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("Index out of range")}function nt(y,f,l,g,E){return f=+f,l=l>>>0,E||ri(y,f,l,4),Hr.write(y,f,l,g,23,4),l+4}o.prototype.writeFloatLE=function(f,l,g){return nt(this,f,l,!0,g)},o.prototype.writeFloatBE=function(f,l,g){return nt(this,f,l,!1,g)};function pn(y,f,l,g,E){return f=+f,l=l>>>0,E||ri(y,f,l,8),Hr.write(y,f,l,g,52,8),l+8}o.prototype.writeDoubleLE=function(f,l,g){return pn(this,f,l,!0,g)},o.prototype.writeDoubleBE=function(f,l,g){return pn(this,f,l,!1,g)},o.prototype.copy=function(f,l,g,E){if(!o.isBuffer(f))throw new TypeError("argument should be a Buffer");if(g||(g=0),!E&&E!==0&&(E=this.length),l>=f.length&&(l=f.length),l||(l=0),E>0&&E<g&&(E=g),E===g||f.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("sourceEnd out of bounds");E>this.length&&(E=this.length),f.length-l<E-g&&(E=f.length-l+g);var x=E-g;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(l,g,E):Uint8Array.prototype.set.call(f,this.subarray(g,E),l),x},o.prototype.fill=function(f,l,g,E){if(typeof f=="string"){if(typeof l=="string"?(E=l,l=0,g=this.length):typeof g=="string"&&(E=g,g=this.length),E!==void 0&&typeof E!="string")throw new TypeError("encoding must be a string");if(typeof E=="string"&&!o.isEncoding(E))throw new TypeError("Unknown encoding: "+E);if(f.length===1){var x=f.charCodeAt(0);(E==="utf8"&&x<128||E==="latin1")&&(f=x)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(l<0||this.length<l||this.length<g)throw new RangeError("Out of range index");if(g<=l)return this;l=l>>>0,g=g===void 0?this.length:g>>>0,f||(f=0);var R;if(typeof f=="number")for(R=l;R<g;++R)this[R]=f;else{var V=o.isBuffer(f)?f:o.from(f,E),se=V.length;if(se===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(R=0;R<g-l;++R)this[R+l]=V[R%se]}return this};var ni=/[^+/0-9A-Za-z-_]/g;function Is(y){if(y=y.split("=")[0],y=y.trim().replace(ni,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function yn(y,f){f=f||1/0;for(var l,g=y.length,E=null,x=[],R=0;R<g;++R){if(l=y.charCodeAt(R),l>55295&&l<57344){if(!E){if(l>56319){(f-=3)>-1&&x.push(239,191,189);continue}else if(R+1===g){(f-=3)>-1&&x.push(239,191,189);continue}E=l;continue}if(l<56320){(f-=3)>-1&&x.push(239,191,189),E=l;continue}l=(E-55296<<10|l-56320)+65536}else E&&(f-=3)>-1&&x.push(239,191,189);if(E=null,l<128){if((f-=1)<0)break;x.push(l)}else if(l<2048){if((f-=2)<0)break;x.push(l>>6|192,l&63|128)}else if(l<65536){if((f-=3)<0)break;x.push(l>>12|224,l>>6&63|128,l&63|128)}else if(l<1114112){if((f-=4)<0)break;x.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else throw new Error("Invalid code point")}return x}function Ts(y){for(var f=[],l=0;l<y.length;++l)f.push(y.charCodeAt(l)&255);return f}function Os(y,f){for(var l,g,E,x=[],R=0;R<y.length&&!((f-=2)<0);++R)l=y.charCodeAt(R),g=l>>8,E=l%256,x.push(E),x.push(g);return x}function ii(y){return mo.toByteArray(Is(y))}function fr(y,f,l,g){for(var E=0;E<g&&!(E+l>=f.length||E>=y.length);++E)f[E+l]=y[E];return E}function it(y,f){return y instanceof f||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===f.name}function gn(y){return y!==y}var si=function(){for(var y="0123456789abcdef",f=new Array(256),l=0;l<16;++l)for(var g=l*16,E=0;E<16;++E)f[g+E]=y[l]+y[E];return f}()}),ie=hs.Buffer;hs.SlowBuffer;hs.INSPECT_MAX_BYTES;hs.kMaxLength;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qo=function(t,r){return qo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},qo(t,r)};function ds(e,t){qo(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Or=function(e){ds(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),t}(Error),ve=function(e){ds(t,e);function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),t}(TypeError);function bi(e){return e&&e.Math==Math&&e}function Wf(){return bi(typeof globalThis=="object"&&globalThis)||bi(typeof window=="object"&&window)||bi(typeof self=="object"&&self)||bi(typeof global=="object"&&global)||Function("return this")()}function Sv(){var e=Wf();return typeof e.navigator=="object"&&e.navigator.product==="ReactNative"}var Av=function(t){var r=Sv()?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=ie.alloc(t),s=0;s<t;++s)n[s]=Math.floor(Math.random()*256);return n},Iv=function(){{if(typeof window<"u"){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues)return function(t){return e.getRandomValues(ie.alloc(t))}}return typeof global<"u"&&global.crypto&&global.crypto.getRandomValues?function(t){return global.crypto.getRandomValues(ie.alloc(t))}:Av}},jf=Iv();function Tv(e){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e))}function Aa(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function Ov(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function xv(e){return ti(e)&&Object.prototype.toString.call(e)==="[object Date]"}function ti(e){return typeof e=="object"&&e!==null}function ps(e,t){var r=!1;function n(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];return r||(console.warn(t),r=!0),e.apply(this,s)}return n}function qi(e){if(ArrayBuffer.isView(e))return ie.from(e.buffer,e.byteOffset,e.byteLength);if(Tv(e))return ie.from(e);throw new ve("Must use either Buffer or TypedArray")}var Nv=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,Yf=function(e){return typeof e=="string"&&Nv.test(e)},Go=function(e){if(!Yf(e))throw new ve('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var t=e.replace(/-/g,"");return ie.from(t,"hex")},Lu=function(e,t){return t===void 0&&(t=!0),t?e.toString("hex",0,4)+"-"+e.toString("hex",4,6)+"-"+e.toString("hex",6,8)+"-"+e.toString("hex",8,10)+"-"+e.toString("hex",10,16):e.toString("hex")},Rv=Math.pow(2,53),Dv=-Math.pow(2,53),Hf=4,xr=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(t!=null&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!(t instanceof ArrayBuffer)&&!Array.isArray(t))throw new ve("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=r??e.BSON_BINARY_SUBTYPE_DEFAULT,t==null?(this.buffer=ie.alloc(e.BUFFER_SIZE),this.position=0):(typeof t=="string"?this.buffer=ie.from(t,"binary"):Array.isArray(t)?this.buffer=ie.from(t):this.buffer=qi(t),this.position=this.buffer.byteLength)}return e.prototype.put=function(t){if(typeof t=="string"&&t.length!==1)throw new ve("only accepts single character String");if(typeof t!="number"&&t.length!==1)throw new ve("only accepts single character Uint8Array or Array");var r;if(typeof t=="string"?r=t.charCodeAt(0):typeof t=="number"?r=t:r=t[0],r<0||r>255)throw new ve("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=ie.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},e.prototype.write=function(t,r){if(r=typeof r=="number"?r:this.position,this.buffer.length<r+t.length){var n=ie.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(qi(t),r),this.position=r+t.byteLength>this.position?r+t.length:this.position):typeof t=="string"&&(this.buffer.write(t,r,t.length,"binary"),this.position=r+t.length>this.position?r+t.length:this.position)},e.prototype.read=function(t,r){return r=r&&r>0?r:this.position,this.buffer.slice(t,t+r)},e.prototype.value=function(t){return t=!!t,t&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},e.prototype.length=function(){return this.position},e.prototype.toJSON=function(){return this.buffer.toString("base64")},e.prototype.toString=function(t){return this.buffer.toString(t)},e.prototype.toExtendedJSON=function(t){t=t||{};var r=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return t.legacy?{$binary:r,$type:n.length===1?"0"+n:n}:{$binary:{base64:r,subType:n.length===1?"0"+n:n}}},e.prototype.toUUID=function(){if(this.sub_type===e.SUBTYPE_UUID)return new Uu(this.buffer.slice(0,this.position));throw new Or('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(e.SUBTYPE_UUID,'" is currently supported.'))},e.fromExtendedJSON=function(t,r){r=r||{};var n,s;if("$binary"in t?r.legacy&&typeof t.$binary=="string"&&"$type"in t?(s=t.$type?parseInt(t.$type,16):0,n=ie.from(t.$binary,"base64")):typeof t.$binary!="string"&&(s=t.$binary.subType?parseInt(t.$binary.subType,16):0,n=ie.from(t.$binary.base64,"base64")):"$uuid"in t&&(s=4,n=Go(t.$uuid)),!n)throw new ve("Unexpected Binary Extended JSON format ".concat(JSON.stringify(t)));return s===Hf?new Uu(n):new e(n,s)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.value(!0);return'new Binary(Buffer.from("'.concat(t.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_ENCRYPTED=6,e.SUBTYPE_COLUMN=7,e.SUBTYPE_USER_DEFINED=128,e}();Object.defineProperty(xr.prototype,"_bsontype",{value:"Binary"});var _o=16,Uu=function(e){ds(t,e);function t(r){var n=this,s,i;if(r==null)s=t.generate();else if(r instanceof t)s=ie.from(r.buffer),i=r.__id;else if(ArrayBuffer.isView(r)&&r.byteLength===_o)s=qi(r);else if(typeof r=="string")s=Go(r);else throw new ve("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");return n=e.call(this,s,Hf)||this,n.__id=i,n}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer},set:function(r){this.buffer=r,t.cacheHexString&&(this.__id=Lu(r))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(r){if(r===void 0&&(r=!0),t.cacheHexString&&this.__id)return this.__id;var n=Lu(this.id,r);return t.cacheHexString&&(this.__id=n),n},t.prototype.toString=function(r){return r?this.id.toString(r):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(r){if(!r)return!1;if(r instanceof t)return r.id.equals(this.id);try{return new t(r).id.equals(this.id)}catch{return!1}},t.prototype.toBinary=function(){return new xr(this.id,xr.SUBTYPE_UUID)},t.generate=function(){var r=jf(_o);return r[6]=r[6]&15|64,r[8]=r[8]&63|128,ie.from(r)},t.isValid=function(r){return r?r instanceof t?!0:typeof r=="string"?Yf(r):Aa(r)?r.length!==_o?!1:(r[6]&240)===64&&(r[8]&128)===128:!1:!1},t.createFromHexString=function(r){var n=Go(r);return new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},t}(xr),ys=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.code=t,this.scope=r}return e.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},e.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},e.fromExtendedJSON=function(t){return new e(t.$code,t.$scope)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toJSON();return'new Code("'.concat(String(t.code),'"').concat(t.scope?", ".concat(JSON.stringify(t.scope)):"",")")},e}();Object.defineProperty(ys.prototype,"_bsontype",{value:"Code"});function Cv(e){return ti(e)&&e.$id!=null&&typeof e.$ref=="string"&&(e.$db==null||typeof e.$db=="string")}var qn=function(){function e(t,r,n,s){if(!(this instanceof e))return new e(t,r,n,s);var i=t.split(".");i.length===2&&(n=i.shift(),t=i.shift()),this.collection=t,this.oid=r,this.db=n,this.fields=s||{}}return Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(t.$db=this.db),t},e.prototype.toExtendedJSON=function(t){t=t||{};var r={$ref:this.collection,$id:this.oid};return t.legacy||(this.db&&(r.$db=this.db),r=Object.assign(r,this.fields)),r},e.fromExtendedJSON=function(t){var r=Object.assign({},t);return delete r.$ref,delete r.$id,delete r.$db,new e(t.$ref,t.$id,t.$db,r)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(t),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},e}();Object.defineProperty(qn.prototype,"_bsontype",{value:"DBRef"});var st=void 0;try{st=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var Bu=65536,Pv=1<<24,zr=Bu*Bu,qf=zr*zr,$u=qf/2,Wu={},ju={},$=function(){function e(t,r,n){if(t===void 0&&(t=0),!(this instanceof e))return new e(t,r,n);typeof t=="bigint"?Object.assign(this,e.fromBigInt(t,!!r)):typeof t=="string"?Object.assign(this,e.fromString(t,!!r)):(this.low=t|0,this.high=r|0,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return e.fromBits=function(t,r,n){return new e(t,r,n)},e.fromInt=function(t,r){var n,s,i;return r?(t>>>=0,(i=0<=t&&t<256)&&(s=ju[t],s)?s:(n=e.fromBits(t,(t|0)<0?-1:0,!0),i&&(ju[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(s=Wu[t],s)?s:(n=e.fromBits(t,t<0?-1:0,!1),i&&(Wu[t]=n),n))},e.fromNumber=function(t,r){if(isNaN(t))return r?e.UZERO:e.ZERO;if(r){if(t<0)return e.UZERO;if(t>=qf)return e.MAX_UNSIGNED_VALUE}else{if(t<=-$u)return e.MIN_VALUE;if(t+1>=$u)return e.MAX_VALUE}return t<0?e.fromNumber(-t,r).neg():e.fromBits(t%zr|0,t/zr|0,r)},e.fromBigInt=function(t,r){return e.fromString(t.toString(),r)},e.fromString=function(t,r,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e.ZERO;if(typeof r=="number"?(n=r,r=!1):r=!!r,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return e.fromString(t.substring(1),r,n).neg();for(var i=e.fromNumber(Math.pow(n,8)),o=e.ZERO,u=0;u<t.length;u+=8){var h=Math.min(8,t.length-u),a=parseInt(t.substring(u,u+h),n);if(h<8){var c=e.fromNumber(Math.pow(n,h));o=o.mul(c).add(e.fromNumber(a))}else o=o.mul(i),o=o.add(e.fromNumber(a))}return o.unsigned=r,o},e.fromBytes=function(t,r,n){return n?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.isLong=function(t){return ti(t)&&t.__isLong__===!0},e.fromValue=function(t,r){return typeof t=="number"?e.fromNumber(t,r):typeof t=="string"?e.fromString(t,r):e.fromBits(t.low,t.high,typeof r=="boolean"?r:t.unsigned)},e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var r=this.high>>>16,n=this.high&65535,s=this.low>>>16,i=this.low&65535,o=t.high>>>16,u=t.high&65535,h=t.low>>>16,a=t.low&65535,c=0,d=0,m=0,w=0;return w+=i+a,m+=w>>>16,w&=65535,m+=s+h,d+=m>>>16,m&=65535,d+=n+u,c+=d>>>16,d&=65535,c+=r+o,c&=65535,e.fromBits(m<<16|w,c<<16|d,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),n=t.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},e.prototype.comp=function(t){return this.compare(t)},e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw Error("division by zero");if(st){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?st.div_u:st.div_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,st.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var n,s,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return e.UZERO;if(t.gt(this.shru(1)))return e.UONE;i=e.UZERO}else{if(this.eq(e.MIN_VALUE)){if(t.eq(e.ONE)||t.eq(e.NEG_ONE))return e.MIN_VALUE;if(t.eq(e.MIN_VALUE))return e.ONE;var o=this.shr(1);return n=o.div(t).shl(1),n.eq(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(s=this.sub(t.mul(n)),i=n.add(s.div(t)),i)}else if(t.eq(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=e.ZERO}for(s=this;s.gte(t);){n=Math.max(1,Math.floor(s.toNumber()/t.toNumber()));for(var u=Math.ceil(Math.log(n)/Math.LN2),h=u<=48?1:Math.pow(2,u-48),a=e.fromNumber(n),c=a.mul(t);c.isNegative()||c.gt(s);)n-=h,a=e.fromNumber(n,this.unsigned),c=a.mul(t);a.isZero()&&(a=e.ONE),i=i.add(a),s=s.sub(c)}return i},e.prototype.div=function(t){return this.divide(t)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},e.prototype.eq=function(t){return this.equals(t)},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(e.MIN_VALUE)?64:this.neg().getNumBitsAbs();var t=this.high!==0?this.high:this.low,r;for(r=31;r>0&&!(t&1<<r);r--);return this.high!==0?r+33:r+1},e.prototype.greaterThan=function(t){return this.comp(t)>0},e.prototype.gt=function(t){return this.greaterThan(t)},e.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},e.prototype.gte=function(t){return this.greaterThanOrEqual(t)},e.prototype.ge=function(t){return this.greaterThanOrEqual(t)},e.prototype.isEven=function(){return(this.low&1)===0},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isOdd=function(){return(this.low&1)===1},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isZero=function(){return this.high===0&&this.low===0},e.prototype.lessThan=function(t){return this.comp(t)<0},e.prototype.lt=function(t){return this.lessThan(t)},e.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},e.prototype.lte=function(t){return this.lessThanOrEqual(t)},e.prototype.modulo=function(t){if(e.isLong(t)||(t=e.fromValue(t)),st){var r=(this.unsigned?st.rem_u:st.rem_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,st.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},e.prototype.mod=function(t){return this.modulo(t)},e.prototype.rem=function(t){return this.modulo(t)},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),st){var r=st.mul(this.low,this.high,t.low,t.high);return e.fromBits(r,st.get_high(),this.unsigned)}if(t.isZero())return e.ZERO;if(this.eq(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.eq(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(e.TWO_PWR_24)&&t.lt(e.TWO_PWR_24))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,u=t.high>>>16,h=t.high&65535,a=t.low>>>16,c=t.low&65535,d=0,m=0,w=0,A=0;return A+=o*c,w+=A>>>16,A&=65535,w+=i*c,m+=w>>>16,w&=65535,w+=o*a,m+=w>>>16,w&=65535,m+=s*c,d+=m>>>16,m&=65535,m+=i*a,d+=m>>>16,m&=65535,m+=o*h,d+=m>>>16,m&=65535,d+=n*c+s*a+i*h+o*u,d&=65535,e.fromBits(w<<16|A,d<<16|m,this.unsigned)},e.prototype.mul=function(t){return this.multiply(t)},e.prototype.negate=function(){return!this.unsigned&&this.eq(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=function(){return this.negate()},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.notEquals=function(t){return!this.equals(t)},e.prototype.neq=function(t){return this.notEquals(t)},e.prototype.ne=function(t){return this.notEquals(t)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=function(t){return this.shiftLeft(t)},e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=function(t){return this.shiftRight(t)},e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),t&=63,t===0)return this;var r=this.high;if(t<32){var n=this.low;return e.fromBits(n>>>t|r<<32-t,r>>>t,this.unsigned)}else return t===32?e.fromBits(r,0,this.unsigned):e.fromBits(r>>>t-32,0,this.unsigned)},e.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},e.prototype.shru=function(t){return this.shiftRightUnsigned(t)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.neg())},e.prototype.sub=function(t){return this.subtract(t)},e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*zr+(this.low>>>0):this.high*zr+(this.low>>>0)},e.prototype.toBigInt=function(){return BigInt(this.toString())},e.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},e.prototype.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},e.prototype.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]},e.prototype.toSigned=function(){return this.unsigned?e.fromBits(this.low,this.high,!1):this},e.prototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(e.MIN_VALUE)){var r=e.fromNumber(t),n=this.div(r),s=n.mul(r).sub(this);return n.toString(t)+s.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var i=e.fromNumber(Math.pow(t,6),this.unsigned),o=this,u="";;){var h=o.div(i),a=o.sub(h.mul(i)).toInt()>>>0,c=a.toString(t);if(o=h,o.isZero())return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}},e.prototype.toUnsigned=function(){return this.unsigned?this:e.fromBits(this.low,this.high,!0)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.eqz=function(){return this.isZero()},e.prototype.le=function(t){return this.lessThanOrEqual(t)},e.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var n=e.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},e.TWO_PWR_24=e.fromInt(Pv),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e}();Object.defineProperty($.prototype,"__isLong__",{value:!0});Object.defineProperty($.prototype,"_bsontype",{value:"Long"});var kv=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Mv=/^(\+|-)?(Infinity|inf)$/i,Fv=/^(\+|-)?NaN$/i,Pn=6111,vo=-6176,Yu=6176,Lv=34,wo=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Hu=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),qu=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Uv=/^([-+])?(\d+)?$/,Bv=31,Gu=16383,$v=30,Wv=31;function Ku(e){return!isNaN(parseInt(e,10))}function jv(e){var t=$.fromNumber(1e9),r=$.fromNumber(0);if(!e.parts[0]&&!e.parts[1]&&!e.parts[2]&&!e.parts[3])return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=r.shiftLeft(32),r=r.add(new $(e.parts[n],0)),e.parts[n]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function Yv(e,t){if(!e&&!t)return{high:$.fromNumber(0),low:$.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new $(e.getLowBits(),0),s=t.shiftRightUnsigned(32),i=new $(t.getLowBits(),0),o=r.multiply(s),u=r.multiply(i),h=n.multiply(s),a=n.multiply(i);return o=o.add(u.shiftRightUnsigned(32)),u=new $(u.getLowBits(),0).add(h).add(a.shiftRightUnsigned(32)),o=o.add(u.shiftRightUnsigned(32)),a=u.shiftLeft(32).add(new $(a.getLowBits(),0)),{high:o,low:a}}function Hv(e,t){var r=e.high>>>0,n=t.high>>>0;if(r<n)return!0;if(r===n){var s=e.low>>>0,i=t.low>>>0;if(s<i)return!0}return!1}function qr(e,t){throw new ve('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var Ia=function(){function e(t){if(!(this instanceof e))return new e(t);if(typeof t=="string")this.bytes=e.fromString(t).bytes;else if(Aa(t)){if(t.byteLength!==16)throw new ve("Decimal128 must take a Buffer of 16 bytes");this.bytes=t}else throw new ve("Decimal128 must take a Buffer or string")}return e.fromString=function(t){var r=!1,n=!1,s=!1,i=0,o=0,u=0,h=0,a=0,c=[0],d=0,m=0,w=0,A=0,S=0,_=0,v=new $(0,0),N=new $(0,0),O=0,I=0;if(t.length>=7e3)throw new ve(""+t+" not a valid Decimal128 string");var k=t.match(kv),M=t.match(Mv),j=t.match(Fv);if(!k&&!M&&!j||t.length===0)throw new ve(""+t+" not a valid Decimal128 string");if(k){var G=k[2],ee=k[4],_e=k[5],be=k[6];ee&&be===void 0&&qr(t,"missing exponent power"),ee&&G===void 0&&qr(t,"missing exponent base"),ee===void 0&&(_e||be)&&qr(t,"missing e before exponent")}if((t[I]==="+"||t[I]==="-")&&(r=t[I++]==="-"),!Ku(t[I])&&t[I]!=="."){if(t[I]==="i"||t[I]==="I")return new e(ie.from(r?Hu:qu));if(t[I]==="N")return new e(ie.from(wo))}for(;Ku(t[I])||t[I]===".";){if(t[I]==="."){n&&qr(t,"contains multiple periods"),n=!0,I=I+1;continue}d<34&&(t[I]!=="0"||s)&&(s||(a=o),s=!0,c[m++]=parseInt(t[I],10),d=d+1),s&&(u=u+1),n&&(h=h+1),o=o+1,I=I+1}if(n&&!o)throw new ve(""+t+" not a valid Decimal128 string");if(t[I]==="e"||t[I]==="E"){var Ne=t.substr(++I).match(Uv);if(!Ne||!Ne[2])return new e(ie.from(wo));S=parseInt(Ne[0],10),I=I+Ne[0].length}if(t[I])return new e(ie.from(wo));if(w=0,!d)w=0,A=0,c[0]=0,u=1,d=1,i=0;else if(A=d-1,i=u,i!==1)for(;c[a+i-1]===0;)i=i-1;for(S<=h&&h-S>16384?S=vo:S=S-h;S>Pn;){if(A=A+1,A-w>Lv){var ne=c.join("");if(ne.match(/^0+$/)){S=Pn;break}qr(t,"overflow")}S=S-1}for(;S<vo||d<u;){if(A===0&&i<d){S=vo,i=0;break}if(d<u?u=u-1:A=A-1,S<Pn)S=S+1;else{var ne=c.join("");if(ne.match(/^0+$/)){S=Pn;break}qr(t,"overflow")}}if(A-w+1<i){var Me=o;n&&(a=a+1,Me=Me+1),r&&(a=a+1,Me=Me+1);var Be=parseInt(t[a+A+1],10),At=0;if(Be>=5&&(At=1,Be===5)){for(At=c[A]%2===1?1:0,_=a+A+2;_<Me;_++)if(parseInt(t[_],10)){At=1;break}}if(At){for(var fe=A;fe>=0;fe--)if(++c[fe]>9&&(c[fe]=0,fe===0))if(S<Pn)S=S+1,c[fe]=1;else return new e(ie.from(r?Hu:qu))}}if(v=$.fromNumber(0),N=$.fromNumber(0),i===0)v=$.fromNumber(0),N=$.fromNumber(0);else if(A-w<17){var fe=w;for(N=$.fromNumber(c[fe++]),v=new $(0,0);fe<=A;fe++)N=N.multiply($.fromNumber(10)),N=N.add($.fromNumber(c[fe]))}else{var fe=w;for(v=$.fromNumber(c[fe++]);fe<=A-17;fe++)v=v.multiply($.fromNumber(10)),v=v.add($.fromNumber(c[fe]));for(N=$.fromNumber(c[fe++]);fe<=A;fe++)N=N.multiply($.fromNumber(10)),N=N.add($.fromNumber(c[fe]))}var $e=Yv(v,$.fromString("100000000000000000"));$e.low=$e.low.add(N),Hv($e.low,N)&&($e.high=$e.high.add($.fromNumber(1))),O=S+Yu;var X={low:$.fromNumber(0),high:$.fromNumber(0)};$e.high.shiftRightUnsigned(49).and($.fromNumber(1)).equals($.fromNumber(1))?(X.high=X.high.or($.fromNumber(3).shiftLeft(61)),X.high=X.high.or($.fromNumber(O).and($.fromNumber(16383).shiftLeft(47))),X.high=X.high.or($e.high.and($.fromNumber(0x7fffffffffff)))):(X.high=X.high.or($.fromNumber(O&16383).shiftLeft(49)),X.high=X.high.or($e.high.and($.fromNumber(562949953421311)))),X.low=$e.low,r&&(X.high=X.high.or($.fromString("9223372036854775808")));var L=ie.alloc(16);return I=0,L[I++]=X.low.low&255,L[I++]=X.low.low>>8&255,L[I++]=X.low.low>>16&255,L[I++]=X.low.low>>24&255,L[I++]=X.low.high&255,L[I++]=X.low.high>>8&255,L[I++]=X.low.high>>16&255,L[I++]=X.low.high>>24&255,L[I++]=X.high.low&255,L[I++]=X.high.low>>8&255,L[I++]=X.high.low>>16&255,L[I++]=X.high.low>>24&255,L[I++]=X.high.high&255,L[I++]=X.high.high>>8&255,L[I++]=X.high.high>>16&255,L[I++]=X.high.high>>24&255,new e(L)},e.prototype.toString=function(){for(var t,r=0,n=new Array(36),s=0;s<n.length;s++)n[s]=0;var i=0,o=!1,u,h={parts:[0,0,0,0]},a,c,d=[];i=0;var m=this.bytes,w=m[i++]|m[i++]<<8|m[i++]<<16|m[i++]<<24,A=m[i++]|m[i++]<<8|m[i++]<<16|m[i++]<<24,S=m[i++]|m[i++]<<8|m[i++]<<16|m[i++]<<24,_=m[i++]|m[i++]<<8|m[i++]<<16|m[i++]<<24;i=0;var v={low:new $(w,A),high:new $(S,_)};v.high.lessThan($.ZERO)&&d.push("-");var N=_>>26&Bv;if(N>>3===3){if(N===$v)return d.join("")+"Infinity";if(N===Wv)return"NaN";t=_>>15&Gu,u=8+(_>>14&1)}else u=_>>14&7,t=_>>17&Gu;var O=t-Yu;if(h.parts[0]=(_&16383)+((u&15)<<14),h.parts[1]=S,h.parts[2]=A,h.parts[3]=w,h.parts[0]===0&&h.parts[1]===0&&h.parts[2]===0&&h.parts[3]===0)o=!0;else for(c=3;c>=0;c--){var I=0,k=jv(h);if(h=k.quotient,I=k.rem.low,!!I)for(a=8;a>=0;a--)n[c*9+a]=I%10,I=Math.floor(I/10)}if(o)r=1,n[i]=0;else for(r=36;!n[i];)r=r-1,i=i+1;var M=r-1+O;if(M>=34||M<=-7||O>0){if(r>34)return d.push("".concat(0)),O>0?d.push("E+".concat(O)):O<0&&d.push("E".concat(O)),d.join("");d.push("".concat(n[i++])),r=r-1,r&&d.push(".");for(var s=0;s<r;s++)d.push("".concat(n[i++]));d.push("E"),M>0?d.push("+".concat(M)):d.push("".concat(M))}else if(O>=0)for(var s=0;s<r;s++)d.push("".concat(n[i++]));else{var j=r+O;if(j>0)for(var s=0;s<j;s++)d.push("".concat(n[i++]));else d.push("0");for(d.push(".");j++<0;)d.push("0");for(var s=0;s<r-Math.max(j-1,0);s++)d.push("".concat(n[i++]))}return d.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},e}();Object.defineProperty(Ia.prototype,"_bsontype",{value:"Decimal128"});var gs=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toJSON=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},e.fromExtendedJSON=function(t,r){var n=parseFloat(t.$numberDouble);return r&&r.relaxed?n:new e(n)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toExtendedJSON();return"new Double(".concat(t.$numberDouble,")")},e}();Object.defineProperty(gs.prototype,"_bsontype",{value:"Double"});var ms=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t|0}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},e.fromExtendedJSON=function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},e}();Object.defineProperty(ms.prototype,"_bsontype",{value:"Int32"});var Ta=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$maxKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MaxKey()"},e}();Object.defineProperty(Ta.prototype,"_bsontype",{value:"MaxKey"});var Oa=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$minKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MinKey()"},e}();Object.defineProperty(Oa.prototype,"_bsontype",{value:"MinKey"});var qv=new RegExp("^[0-9a-fA-F]{24}$"),_r=null,It=Symbol("id"),pt=function(){function e(t){if(!(this instanceof e))return new e(t);var r;if(typeof t=="object"&&t&&"id"in t){if(typeof t.id!="string"&&!ArrayBuffer.isView(t.id))throw new ve("Argument passed in must have an id that is of type string or Buffer");"toHexString"in t&&typeof t.toHexString=="function"?r=ie.from(t.toHexString(),"hex"):r=t.id}else r=t;if(r==null||typeof r=="number")this[It]=e.generate(typeof r=="number"?r:void 0);else if(ArrayBuffer.isView(r)&&r.byteLength===12)this[It]=r instanceof ie?r:qi(r);else if(typeof r=="string")if(r.length===12){var n=ie.from(r);if(n.byteLength===12)this[It]=n;else throw new ve("Argument passed in must be a string of 12 bytes")}else if(r.length===24&&qv.test(r))this[It]=ie.from(r,"hex");else throw new ve("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new ve("Argument passed in does not match the accepted types");e.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(e.prototype,"id",{get:function(){return this[It]},set:function(t){this[It]=t,e.cacheHexString&&(this.__id=t.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(){if(e.cacheHexString&&this.__id)return this.__id;var t=this.id.toString("hex");return e.cacheHexString&&!this.__id&&(this.__id=t),t},e.getInc=function(){return e.index=(e.index+1)%16777215},e.generate=function(t){typeof t!="number"&&(t=Math.floor(Date.now()/1e3));var r=e.getInc(),n=ie.alloc(12);return n.writeUInt32BE(t,0),_r===null&&(_r=jf(5)),n[4]=_r[0],n[5]=_r[1],n[6]=_r[2],n[7]=_r[3],n[8]=_r[4],n[11]=r&255,n[10]=r>>8&255,n[9]=r>>16&255,n},e.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(t){if(t==null)return!1;if(t instanceof e)return this[It][11]===t[It][11]&&this[It].equals(t[It]);if(typeof t=="string"&&e.isValid(t)&&t.length===12&&Aa(this.id))return t===ie.prototype.toString.call(this.id,"latin1");if(typeof t=="string"&&e.isValid(t)&&t.length===24)return t.toLowerCase()===this.toHexString();if(typeof t=="string"&&e.isValid(t)&&t.length===12)return ie.from(t).equals(this.id);if(typeof t=="object"&&"toHexString"in t&&typeof t.toHexString=="function"){var r=t.toHexString(),n=this.toHexString().toLowerCase();return typeof r=="string"&&r.toLowerCase()===n}return!1},e.prototype.getTimestamp=function(){var t=new Date,r=this.id.readUInt32BE(0);return t.setTime(Math.floor(r)*1e3),t},e.createPk=function(){return new e},e.createFromTime=function(t){var r=ie.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(t,0),new e(r)},e.createFromHexString=function(t){if(typeof t>"u"||t!=null&&t.length!==24)throw new ve("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new e(ie.from(t,"hex"))},e.isValid=function(t){if(t==null)return!1;try{return new e(t),!0}catch{return!1}},e.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},e.fromExtendedJSON=function(t){return new e(t.$oid)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},e.index=Math.floor(Math.random()*16777215),e}();Object.defineProperty(pt.prototype,"generate",{value:ps(function(e){return pt.generate(e)},"Please use the static `ObjectId.generate(time)` instead")});Object.defineProperty(pt.prototype,"getInc",{value:ps(function(){return pt.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(pt.prototype,"get_inc",{value:ps(function(){return pt.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(pt,"get_inc",{value:ps(function(){return pt.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(pt.prototype,"_bsontype",{value:"ObjectID"});function Gv(e){return e.split("").sort().join("")}var Gn=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(this.pattern=t,this.options=Gv(r??""),this.pattern.indexOf("\0")!==-1)throw new Or("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(this.options.indexOf("\0")!==-1)throw new Or("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var n=0;n<this.options.length;n++)if(!(this.options[n]==="i"||this.options[n]==="m"||this.options[n]==="x"||this.options[n]==="l"||this.options[n]==="s"||this.options[n]==="u"))throw new Or("The regular expression option [".concat(this.options[n],"] is not supported"))}return e.parseOptions=function(t){return t?t.split("").sort().join(""):""},e.prototype.toExtendedJSON=function(t){return t=t||{},t.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},e.fromExtendedJSON=function(t){if("$regex"in t)if(typeof t.$regex!="string"){if(t.$regex._bsontype==="BSONRegExp")return t}else return new e(t.$regex,e.parseOptions(t.$options));if("$regularExpression"in t)return new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options));throw new ve("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(t)))},e}();Object.defineProperty(Gn.prototype,"_bsontype",{value:"BSONRegExp"});var xa=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value},e.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(){return{$symbol:this.value}},e.fromExtendedJSON=function(t){return new e(t.$symbol)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e}();Object.defineProperty(xa.prototype,"_bsontype",{value:"Symbol"});var Kv=$,Gf=function(e){ds(t,e);function t(r,n){var s=this;return s instanceof t?($.isLong(r)?s=e.call(this,r.low,r.high,!0)||this:ti(r)&&typeof r.t<"u"&&typeof r.i<"u"?s=e.call(this,r.i,r.t,!0)||this:s=e.call(this,r,n,!0)||this,Object.defineProperty(s,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),s):new t(r,n)}return t.prototype.toJSON=function(){return{$timestamp:this.toString()}},t.fromInt=function(r){return new t($.fromInt(r,!0))},t.fromNumber=function(r){return new t($.fromNumber(r,!0))},t.fromBits=function(r,n){return new t(r,n)},t.fromString=function(r,n){return new t($.fromString(r,!0,n))},t.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},t.fromExtendedJSON=function(r){return new t(r.$timestamp)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},t.MAX_VALUE=$.MAX_UNSIGNED_VALUE,t}(Kv);function Vv(e){return ti(e)&&Reflect.has(e,"_bsontype")&&typeof e._bsontype=="string"}var Kf=2147483647,Vf=-2147483648,Jf=9223372036854776e3,zf=-9223372036854776e3,Jv={$oid:pt,$binary:xr,$uuid:xr,$symbol:xa,$numberInt:ms,$numberDecimal:Ia,$numberDouble:gs,$numberLong:$,$minKey:Oa,$maxKey:Ta,$regex:Gn,$regularExpression:Gn,$timestamp:Gf};function Zf(e,t){if(t===void 0&&(t={}),typeof e=="number"){if(t.relaxed||t.legacy)return e;if(Math.floor(e)===e){if(e>=Vf&&e<=Kf)return new ms(e);if(e>=zf&&e<=Jf)return $.fromNumber(e)}return new gs(e)}if(e==null||typeof e!="object")return e;if(e.$undefined)return null;for(var r=Object.keys(e).filter(function(d){return d.startsWith("$")&&e[d]!=null}),n=0;n<r.length;n++){var s=Jv[r[n]];if(s)return s.fromExtendedJSON(e,t)}if(e.$date!=null){var i=e.$date,o=new Date;return t.legacy?typeof i=="number"?o.setTime(i):typeof i=="string"&&o.setTime(Date.parse(i)):typeof i=="string"?o.setTime(Date.parse(i)):$.isLong(i)?o.setTime(i.toNumber()):typeof i=="number"&&t.relaxed&&o.setTime(i),o}if(e.$code!=null){var u=Object.assign({},e);return e.$scope&&(u.$scope=Zf(e.$scope)),ys.fromExtendedJSON(e)}if(Cv(e)||e.$dbPointer){var h=e.$ref?e:e.$dbPointer;if(h instanceof qn)return h;var a=Object.keys(h).filter(function(d){return d.startsWith("$")}),c=!0;if(a.forEach(function(d){["$ref","$id","$db"].indexOf(d)===-1&&(c=!1)}),c)return qn.fromExtendedJSON(h)}return e}function zv(e,t){return e.map(function(r,n){t.seenObjects.push({propertyName:"index ".concat(n),obj:null});try{return tr(r,t)}finally{t.seenObjects.pop()}})}function Vu(e){var t=e.toISOString();return e.getUTCMilliseconds()!==0?t:t.slice(0,-5)+"Z"}function tr(e,t){if((typeof e=="object"||typeof e=="function")&&e!==null){var r=t.seenObjects.findIndex(function(v){return v.obj===e});if(r!==-1){var n=t.seenObjects.map(function(v){return v.propertyName}),s=n.slice(0,r).map(function(v){return"".concat(v," -> ")}).join(""),i=n[r],o=" -> "+n.slice(r+1,n.length-1).map(function(v){return"".concat(v," -> ")}).join(""),u=n[n.length-1],h=" ".repeat(s.length+i.length/2),a="-".repeat(o.length+(i.length+u.length)/2-1);throw new ve(`Converting circular structure to EJSON:
`+"    ".concat(s).concat(i).concat(o).concat(u,`
`)+"    ".concat(h,"\\").concat(a,"/"))}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return zv(e,t);if(e===void 0)return null;if(e instanceof Date||xv(e)){var c=e.getTime(),d=c>-1&&c<2534023188e5;return t.legacy?t.relaxed&&d?{$date:e.getTime()}:{$date:Vu(e)}:t.relaxed&&d?{$date:Vu(e)}:{$date:{$numberLong:e.getTime().toString()}}}if(typeof e=="number"&&(!t.relaxed||!isFinite(e))){if(Math.floor(e)===e){var m=e>=Vf&&e<=Kf,w=e>=zf&&e<=Jf;if(m)return{$numberInt:e.toString()};if(w)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp||Ov(e)){var A=e.flags;if(A===void 0){var S=e.toString().match(/[gimuy]*$/);S&&(A=S[0])}var _=new Gn(e.source,A);return _.toExtendedJSON(t)}return e!=null&&typeof e=="object"?Xv(e,t):e}var Zv={Binary:function(e){return new xr(e.value(),e.sub_type)},Code:function(e){return new ys(e.code,e.scope)},DBRef:function(e){return new qn(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new Ia(e.bytes)},Double:function(e){return new gs(e.value)},Int32:function(e){return new ms(e.value)},Long:function(e){return $.fromBits(e.low!=null?e.low:e.low_,e.low!=null?e.high:e.high_,e.low!=null?e.unsigned:e.unsigned_)},MaxKey:function(){return new Ta},MinKey:function(){return new Oa},ObjectID:function(e){return new pt(e)},ObjectId:function(e){return new pt(e)},BSONRegExp:function(e){return new Gn(e.pattern,e.options)},Symbol:function(e){return new xa(e.value)},Timestamp:function(e){return Gf.fromBits(e.low,e.high)}};function Xv(e,t){if(e==null||typeof e!="object")throw new Or("not an object instance");var r=e._bsontype;if(typeof r>"u"){var n={};for(var s in e){t.seenObjects.push({propertyName:s,obj:null});try{var i=tr(e[s],t);s==="__proto__"?Object.defineProperty(n,s,{value:i,writable:!0,enumerable:!0,configurable:!0}):n[s]=i}finally{t.seenObjects.pop()}}return n}else if(Vv(e)){var o=e;if(typeof o.toExtendedJSON!="function"){var u=Zv[e._bsontype];if(!u)throw new ve("Unrecognized or invalid _bsontype: "+e._bsontype);o=u(o)}return r==="Code"&&o.scope?o=new ys(o.code,tr(o.scope,t)):r==="DBRef"&&o.oid&&(o=new qn(tr(o.collection,t),tr(o.oid,t),tr(o.db,t),tr(o.fields,t))),o.toExtendedJSON(t)}else throw new Or("_bsontype must be a string, but was: "+typeof r)}var Ze;(function(e){function t(i,o){var u=Object.assign({},{relaxed:!0,legacy:!1},o);return typeof u.relaxed=="boolean"&&(u.strict=!u.relaxed),typeof u.strict=="boolean"&&(u.relaxed=!u.strict),JSON.parse(i,function(h,a){if(h.indexOf("\0")!==-1)throw new Or("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(h)));return Zf(a,u)})}e.parse=t;function r(i,o,u,h){u!=null&&typeof u=="object"&&(h=u,u=0),o!=null&&typeof o=="object"&&!Array.isArray(o)&&(h=o,o=void 0,u=0);var a=Object.assign({relaxed:!0,legacy:!1},h,{seenObjects:[{propertyName:"(root)",obj:null}]}),c=tr(i,a);return JSON.stringify(c,o,u)}e.stringify=r;function n(i,o){return o=o||{},JSON.parse(r(i,o))}e.serialize=n;function s(i,o){return o=o||{},t(JSON.stringify(i),o)}e.deserialize=s})(Ze||(Ze={}));var Ju=Wf();Ju.Map?Ju.Map:function(){function e(t){t===void 0&&(t=[]),this._keys=[],this._values={};for(var r=0;r<t.length;r++)if(t[r]!=null){var n=t[r],s=n[0],i=n[1];this._keys.push(s),this._values[s]={v:i,i:this._keys.length-1}}}return e.prototype.clear=function(){this._keys=[],this._values={}},e.prototype.delete=function(t){var r=this._values[t];return r==null?!1:(delete this._values[t],this._keys.splice(r.i,1),!0)},e.prototype.entries=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?[n,t._values[n].v]:void 0,done:n===void 0}}}},e.prototype.forEach=function(t,r){r=r||this;for(var n=0;n<this._keys.length;n++){var s=this._keys[n];t.call(r,this._values[s].v,s,r)}},e.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},e.prototype.has=function(t){return this._values[t]!=null},e.prototype.keys=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?n:void 0,done:n===void 0}}}},e.prototype.set=function(t,r){return this._values[t]?(this._values[t].v=r,this):(this._keys.push(t),this._values[t]={v:r,i:this._keys.length-1},this)},e.prototype.values=function(){var t=this,r=0;return{next:function(){var n=t._keys[r++];return{value:n!==void 0?t._values[n].v:void 0,done:n===void 0}}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),e}();$.fromNumber(Rv);$.fromNumber(Dv);var Eo=new Uint8Array(8);new DataView(Eo.buffer,Eo.byteOffset,Eo.byteLength);var Qv=1024*1024*17;ie.alloc(Qv);var ew=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},tw=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Xf=function(){function e(t,r){this._stages=[],t&&r&&(this._db=t,this._request=new je.reqClass(this._db.config),this._collectionName=r)}return e.prototype.end=function(){return ew(this,void 0,void 0,function(){var t;return tw(this,function(r){switch(r.label){case 0:if(!this._collectionName||!this._db)throw new Error("Aggregation pipeline cannot send request");return[4,this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages})];case 1:return t=r.sent(),t&&t.data&&t.data.list?[2,{requestId:t.requestId,data:JSON.parse(t.data.list).map(Ze.parse)}]:[2,t]}})})},e.prototype.unwrap=function(){return this._stages},e.prototype.done=function(){return this._stages.map(function(t){var r,n=t.stageKey,s=t.stageValue;return r={},r[n]=JSON.parse(s),r})},e.prototype._pipe=function(t,r){return this._stages.push({stageKey:"$"+t,stageValue:JSON.stringify(r)}),this},e.prototype.addFields=function(t){return this._pipe("addFields",t)},e.prototype.bucket=function(t){return this._pipe("bucket",t)},e.prototype.bucketAuto=function(t){return this._pipe("bucketAuto",t)},e.prototype.count=function(t){return this._pipe("count",t)},e.prototype.geoNear=function(t){return this._pipe("geoNear",t)},e.prototype.group=function(t){return this._pipe("group",t)},e.prototype.limit=function(t){return this._pipe("limit",t)},e.prototype.match=function(t){return this._pipe("match",Ho.encode(t))},e.prototype.project=function(t){return this._pipe("project",t)},e.prototype.lookup=function(t){return this._pipe("lookup",t)},e.prototype.replaceRoot=function(t){return this._pipe("replaceRoot",t)},e.prototype.sample=function(t){return this._pipe("sample",t)},e.prototype.skip=function(t){return this._pipe("skip",t)},e.prototype.sort=function(t){return this._pipe("sort",t)},e.prototype.sortByCount=function(t){return this._pipe("sortByCount",t)},e.prototype.unwind=function(t){return this._pipe("unwind",t)},e}(),rw=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nw=function(e){rw(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId");return new Fu(this._db,this._coll,r)},t.prototype.add=function(r,n){var s=new Fu(this._db,this._coll,void 0);return s.create(r,n)},t.prototype.aggregate=function(){return new Xf(this._db,this._coll)},t}(uv),iw={eq:function(e){return new De(q.EQ,[e])},neq:function(e){return new De(q.NEQ,[e])},lt:function(e){return new De(q.LT,[e])},lte:function(e){return new De(q.LTE,[e])},gt:function(e){return new De(q.GT,[e])},gte:function(e){return new De(q.GTE,[e])},in:function(e){return new De(q.IN,e)},nin:function(e){return new De(q.NIN,e)},all:function(e){return new De(q.ALL,e)},elemMatch:function(e){return new De(q.ELEM_MATCH,[e])},exists:function(e){return new De(q.EXISTS,[e])},size:function(e){return new De(q.SIZE,[e])},mod:function(e){return new De(q.MOD,[e])},geoNear:function(e){return new De(q.GEO_NEAR,[e])},geoWithin:function(e){return new De(q.GEO_WITHIN,[e])},geoIntersects:function(e){return new De(q.GEO_INTERSECTS,[e])},and:function(){var e=Ie(arguments[0])?arguments[0]:Array.from(arguments);return new Sr(et.AND,e)},nor:function(){var e=Ie(arguments[0])?arguments[0]:Array.from(arguments);return new Sr(et.NOR,e)},or:function(){var e=Ie(arguments[0])?arguments[0]:Array.from(arguments);return new Sr(et.OR,e)},not:function(){var e=Ie(arguments[0])?arguments[0]:Array.from(arguments);return new Sr(et.NOT,e)},set:function(e){return new Oe(z.SET,[e])},remove:function(){return new Oe(z.REMOVE,[])},inc:function(e){return new Oe(z.INC,[e])},mul:function(e){return new Oe(z.MUL,[e])},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r;if(ar(e[0])&&e[0].hasOwnProperty("each")){var n=e[0];r={$each:n.each,$position:n.position,$sort:n.sort,$slice:n.slice}}else Ie(e[0])?r=e[0]:r=Array.from(e);return new Oe(z.PUSH,r)},pull:function(e){return new Oe(z.PULL,e)},pullAll:function(e){return new Oe(z.PULL_ALL,e)},pop:function(){return new Oe(z.POP,[])},shift:function(){return new Oe(z.SHIFT,[])},unshift:function(){var e=Ie(arguments[0])?arguments[0]:Array.from(arguments);return new Oe(z.UNSHIFT,e)},addToSet:function(e){return new Oe(z.ADD_TO_SET,e)},rename:function(e){return new Oe(z.RENAME,[e])},bit:function(e){return new Oe(z.BIT,[e])},max:function(e){return new Oe(z.MAX,[e])},min:function(e){return new Oe(z.MIN,[e])},expr:function(e){return{$expr:e}},jsonSchema:function(e){return{$jsonSchema:e}},text:function(e){return ev(e)?{$search:e.search}:{$search:e.search,$language:e.language,$caseSensitive:e.caseSensitive,$diacriticSensitive:e.diacriticSensitive}},aggregate:{pipeline:function(){return new Xf},abs:function(e){return new D("abs",e)},add:function(e){return new D("add",e)},ceil:function(e){return new D("ceil",e)},divide:function(e){return new D("divide",e)},exp:function(e){return new D("exp",e)},floor:function(e){return new D("floor",e)},ln:function(e){return new D("ln",e)},log:function(e){return new D("log",e)},log10:function(e){return new D("log10",e)},mod:function(e){return new D("mod",e)},multiply:function(e){return new D("multiply",e)},pow:function(e){return new D("pow",e)},sqrt:function(e){return new D("sqrt",e)},subtract:function(e){return new D("subtract",e)},trunc:function(e){return new D("trunc",e)},arrayElemAt:function(e){return new D("arrayElemAt",e)},arrayToObject:function(e){return new D("arrayToObject",e)},concatArrays:function(e){return new D("concatArrays",e)},filter:function(e){return new D("filter",e)},in:function(e){return new D("in",e)},indexOfArray:function(e){return new D("indexOfArray",e)},isArray:function(e){return new D("isArray",e)},map:function(e){return new D("map",e)},range:function(e){return new D("range",e)},reduce:function(e){return new D("reduce",e)},reverseArray:function(e){return new D("reverseArray",e)},size:function(e){return new D("size",e)},slice:function(e){return new D("slice",e)},zip:function(e){return new D("zip",e)},and:function(e){return new D("and",e)},not:function(e){return new D("not",e)},or:function(e){return new D("or",e)},cmp:function(e){return new D("cmp",e)},eq:function(e){return new D("eq",e)},gt:function(e){return new D("gt",e)},gte:function(e){return new D("gte",e)},lt:function(e){return new D("lt",e)},lte:function(e){return new D("lte",e)},neq:function(e){return new D("ne",e)},cond:function(e){return new D("cond",e)},ifNull:function(e){return new D("ifNull",e)},switch:function(e){return new D("switch",e)},dateFromParts:function(e){return new D("dateFromParts",e)},dateFromString:function(e){return new D("dateFromString",e)},dayOfMonth:function(e){return new D("dayOfMonth",e)},dayOfWeek:function(e){return new D("dayOfWeek",e)},dayOfYear:function(e){return new D("dayOfYear",e)},isoDayOfWeek:function(e){return new D("isoDayOfWeek",e)},isoWeek:function(e){return new D("isoWeek",e)},isoWeekYear:function(e){return new D("isoWeekYear",e)},millisecond:function(e){return new D("millisecond",e)},minute:function(e){return new D("minute",e)},month:function(e){return new D("month",e)},second:function(e){return new D("second",e)},hour:function(e){return new D("hour",e)},week:function(e){return new D("week",e)},year:function(e){return new D("year",e)},literal:function(e){return new D("literal",e)},mergeObjects:function(e){return new D("mergeObjects",e)},objectToArray:function(e){return new D("objectToArray",e)},allElementsTrue:function(e){return new D("allElementsTrue",e)},anyElementTrue:function(e){return new D("anyElementTrue",e)},setDifference:function(e){return new D("setDifference",e)},setEquals:function(e){return new D("setEquals",e)},setIntersection:function(e){return new D("setIntersection",e)},setIsSubset:function(e){return new D("setIsSubset",e)},setUnion:function(e){return new D("setUnion",e)},concat:function(e){return new D("concat",e)},dateToString:function(e){return new D("dateToString",e)},indexOfBytes:function(e){return new D("indexOfBytes",e)},indexOfCP:function(e){return new D("indexOfCP",e)},split:function(e){return new D("split",e)},strLenBytes:function(e){return new D("strLenBytes",e)},strLenCP:function(e){return new D("strLenCP",e)},strcasecmp:function(e){return new D("strcasecmp",e)},substr:function(e){return new D("substr",e)},substrBytes:function(e){return new D("substrBytes",e)},substrCP:function(e){return new D("substrCP",e)},toLower:function(e){return new D("toLower",e)},toUpper:function(e){return new D("toUpper",e)},meta:function(e){return new D("meta",e)},addToSet:function(e){return new D("addToSet",e)},avg:function(e){return new D("avg",e)},first:function(e){return new D("first",e)},last:function(e){return new D("last",e)},max:function(e){return new D("max",e)},min:function(e){return new D("min",e)},push:function(e){return new D("push",e)},stdDevPop:function(e){return new D("stdDevPop",e)},stdDevSamp:function(e){return new D("stdDevSamp",e)},sum:function(e){return new D("sum",e)},let:function(e){return new D("let",e)}},project:{slice:function(e){return new zu("slice",e)},elemMatch:function(e){return new zu("elemMatch",e)}}},D=function(){function e(t,r){this["$"+t]=r}return e}(),zu=function(){function e(t,r){this["$"+t]=r}return e}(),sw=function(){function e(t){var r=t.regexp,n=t.options;if(!r)throw new TypeError("regexp must be a string");this.$regex=r,this.$options=n}return e.prototype.parse=function(){return{$regex:this.$regex,$options:this.$options}},Object.defineProperty(e.prototype,"_internalType",{get:function(){return Pf},enumerable:!0,configurable:!0}),e}();function ow(e){return new sw(e)}var Qf={CREATE_WATCH_NET_ERROR:{code:"CREATE_WATCH_NET_ERROR",message:"create watch network error"},CREATE_WACTH_EXCEED_ERROR:{code:"CREATE_WACTH_EXCEED_ERROR",message:"maximum connections exceed"},CREATE_WATCH_SERVER_ERROR:{code:"CREATE_WATCH_SERVER_ERROR",message:"create watch server error"},CONN_ERROR:{code:"CONN_ERROR",message:"connection error"},INVALID_PARAM:{code:"INVALID_PARAM",message:"Invalid request param"},INSERT_DOC_FAIL:{code:"INSERT_DOC_FAIL",message:"insert document failed"},DATABASE_TRANSACTION_CONFLICT:{code:"DATABASE_TRANSACTION_CONFLICT",message:"database transaction conflict"}},Tt=function(){return Tt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Tt.apply(this,arguments)},kn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Mn=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},aw="database.getInTransaction",Zu="database.updateDocInTransaction",uw="database.deleteDocInTransaction",cw="database.insertDocInTransaction",Xu=function(){function e(t,r,n){this._coll=r,this.id=n,this._transaction=t,this._request=this._transaction.getRequestMethod(),this._transactionId=this._transaction.getTransactionId()}return e.prototype.create=function(t){return kn(this,void 0,void 0,function(){var r,n,s,i;return Mn(this,function(o){switch(o.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,data:Ze.stringify(Hn(t),{relaxed:!1})},this.id&&(r._id=this.id),[4,this._request.send(cw,r)];case 1:if(n=o.sent(),n.code)throw n;if(s=Ze.parse(n.inserted),i=Ze.parse(n.ok),i==1&&s==1)return[2,Tt(Tt({},n),{ok:i,inserted:s})];throw new Error(Qf.INSERT_DOC_FAIL.message)}})})},e.prototype.get=function(){return kn(this,void 0,void 0,function(){var t,r;return Mn(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(aw,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,{data:r.data!=="null"?ls.formatField(Ze.parse(r.data)):Ze.parse(r.data),requestId:r.requestId}]}})})},e.prototype.set=function(t){return kn(this,void 0,void 0,function(){var r,n;return Mn(this,function(s){switch(s.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Ze.stringify(Hn(t),{relaxed:!1}),upsert:!0},[4,this._request.send(Zu,r)];case 1:if(n=s.sent(),n.code)throw n;return[2,Tt(Tt({},n),{updated:Ze.parse(n.updated),upserted:n.upserted?JSON.parse(n.upserted):null})]}})})},e.prototype.update=function(t){return kn(this,void 0,void 0,function(){var r,n;return Mn(this,function(s){switch(s.label){case 0:return r={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:Ze.stringify(Sa.encode(t),{relaxed:!1})},[4,this._request.send(Zu,r)];case 1:if(n=s.sent(),n.code)throw n;return[2,Tt(Tt({},n),{updated:Ze.parse(n.updated)})]}})})},e.prototype.delete=function(){return kn(this,void 0,void 0,function(){var t,r;return Mn(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send(uw,t)];case 1:if(r=n.sent(),r.code)throw r;return[2,Tt(Tt({},r),{deleted:Ze.parse(r.deleted)})]}})})},e}(),fw=function(){function e(t,r){this._coll=r,this._transaction=t}return e}(),lw=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hw=function(e){lw(t,e);function t(r,n){return e.call(this,r,n)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(r){if(typeof r!="string"&&typeof r!="number")throw new Error("docId");return new Xu(this._transaction,this._coll,r)},t.prototype.add=function(r){var n;r._id!==void 0&&(n=r._id);var s=new Xu(this._transaction,this._coll,n);return s.create(r)},t}(fw),rn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},nn=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},dw="database.startTransaction",pw="database.commitTransaction",yw="database.abortTransaction",el=function(){function e(t){this._db=t,this._request=new je.reqClass(this._db.config),this.aborted=!1,this.commited=!1,this.inited=!1}return e.prototype.init=function(){return rn(this,void 0,void 0,function(){var t;return nn(this,function(r){switch(r.label){case 0:return[4,this._request.send(dw)];case 1:if(t=r.sent(),t.code)throw t;return this.inited=!0,this._id=t.transactionId,[2]}})})},e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new hw(this,t)},e.prototype.getTransactionId=function(){return this._id},e.prototype.getRequestMethod=function(){return this._request},e.prototype.commit=function(){return rn(this,void 0,void 0,function(){var t,r;return nn(this,function(n){switch(n.label){case 0:return t={transactionId:this._id},[4,this._request.send(pw,t)];case 1:if(r=n.sent(),r.code)throw r;return this.commited=!0,[2,r]}})})},e.prototype.rollback=function(t){return rn(this,void 0,void 0,function(){var r,n;return nn(this,function(s){switch(s.label){case 0:return r={transactionId:this._id},[4,this._request.send(yw,r)];case 1:if(n=s.sent(),n.code)throw n;return this.aborted=!0,this.abortReason=t,[2,n]}})})},e}();function gw(){return rn(this,void 0,void 0,function(){var e;return nn(this,function(t){switch(t.label){case 0:return e=new el(this),[4,e.init()];case 1:return t.sent(),[2,e]}})})}function tl(e,t){return t===void 0&&(t=3),rn(this,void 0,void 0,function(){var r,n,s,i,o=this;return nn(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,10]),r=new el(this),[4,r.init()];case 1:return u.sent(),[4,e(r)];case 2:if(n=u.sent(),r.aborted===!0)throw r.abortReason;return[4,r.commit()];case 3:return u.sent(),[2,n];case 4:if(s=u.sent(),r.inited===!1)throw s;return i=function(h){return rn(o,void 0,void 0,function(){return nn(this,function(a){switch(a.label){case 0:if(!(!r.aborted&&!r.commited))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.rollback()];case 2:return a.sent(),[3,4];case 3:return a.sent(),[3,4];case 4:throw h;case 5:throw r.aborted===!0?r.abortReason:h}})})},t<=0?[4,i(s)]:[3,6];case 5:u.sent(),u.label=6;case 6:return s&&s.code===Qf.DATABASE_TRANSACTION_CONFLICT.code?[4,tl.bind(this)(e,--t)]:[3,8];case 7:return[2,u.sent()];case 8:return[4,i(s)];case 9:return u.sent(),[3,10];case 10:return[2]}})})}var je=function(){function e(t){this.config=t,this.Geo=nv,this.serverDate=Q_,this.command=iw,this.RegExp=ow,this.startTransaction=gw,this.runTransaction=tl,this.logicCommand=Sr,this.updateCommand=Oe,this.queryCommand=De}return e.prototype.collection=function(t){if(!t)throw new Error("Collection name is required");return new nw(this,t)},e.prototype.createCollection=function(t){var r=new e.reqClass(this.config),n={collectionName:t};return r.send("database.addCollection",n)},e}(),Gi=function(){return Gi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Gi.apply(this,arguments)},mw="database";function _w(e){var t=this.platform,r=t.adapter,n=t.runtime;return je.reqClass=this.request.constructor,je.getAccessToken=this.authInstance?this.authInstance.getAccessToken.bind(this.authInstance):function(){return""},je.runtime=n,this.wsClientClass&&(je.wsClass=r.wsClass,je.wsClientClass=this.wsClientClass),je.ws||(je.ws=null),new je(Gi(Gi({},this.config),e))}var vw={name:mw,entity:{database:_w}};try{cloudbase.registerComponent(vw)}catch{}var ww="Expected a function",rl="__lodash_hash_undefined__",nl=1/0,Ew=9007199254740991,bw="[object Function]",Sw="[object GeneratorFunction]",Aw="[object Symbol]",Iw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tw=/^\w*$/,Ow=/^\./,xw=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Nw=/[\\^$.*+?()[\]{}|]/g,Rw=/\\(\\)?/g,Dw=/^\[object .+?Constructor\]$/,Cw=/^(?:0|[1-9]\d*)$/,Pw=typeof U=="object"&&U&&U.Object===Object&&U,kw=typeof self=="object"&&self&&self.Object===Object&&self,Na=Pw||kw||Function("return this")();function Mw(e,t){return e==null?void 0:e[t]}function Fw(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var Lw=Array.prototype,Uw=Function.prototype,il=Object.prototype,bo=Na["__core-js_shared__"],Qu=function(){var e=/[^.]+$/.exec(bo&&bo.keys&&bo.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),sl=Uw.toString,_s=il.hasOwnProperty,ol=il.toString,Bw=RegExp("^"+sl.call(_s).replace(Nw,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ec=Na.Symbol,$w=Lw.splice,Ww=al(Na,"Map"),Kn=al(Object,"create"),tc=ec?ec.prototype:void 0,rc=tc?tc.toString:void 0;function Nr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function jw(){this.__data__=Kn?Kn(null):{}}function Yw(e){return this.has(e)&&delete this.__data__[e]}function Hw(e){var t=this.__data__;if(Kn){var r=t[e];return r===rl?void 0:r}return _s.call(t,e)?t[e]:void 0}function qw(e){var t=this.__data__;return Kn?t[e]!==void 0:_s.call(t,e)}function Gw(e,t){var r=this.__data__;return r[e]=Kn&&t===void 0?rl:t,this}Nr.prototype.clear=jw;Nr.prototype.delete=Yw;Nr.prototype.get=Hw;Nr.prototype.has=qw;Nr.prototype.set=Gw;function hn(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Kw(){this.__data__=[]}function Vw(e){var t=this.__data__,r=vs(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():$w.call(t,r,1),!0}function Jw(e){var t=this.__data__,r=vs(t,e);return r<0?void 0:t[r][1]}function zw(e){return vs(this.__data__,e)>-1}function Zw(e,t){var r=this.__data__,n=vs(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}hn.prototype.clear=Kw;hn.prototype.delete=Vw;hn.prototype.get=Jw;hn.prototype.has=zw;hn.prototype.set=Zw;function Pr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Xw(){this.__data__={hash:new Nr,map:new(Ww||hn),string:new Nr}}function Qw(e){return ws(this,e).delete(e)}function eE(e){return ws(this,e).get(e)}function tE(e){return ws(this,e).has(e)}function rE(e,t){return ws(this,e).set(e,t),this}Pr.prototype.clear=Xw;Pr.prototype.delete=Qw;Pr.prototype.get=eE;Pr.prototype.has=tE;Pr.prototype.set=rE;function nE(e,t,r){var n=e[t];(!(_s.call(e,t)&&ul(n,r))||r===void 0&&!(t in e))&&(e[t]=r)}function vs(e,t){for(var r=e.length;r--;)if(ul(e[r][0],t))return r;return-1}function iE(e){if(!Ki(e)||lE(e))return!1;var t=yE(e)||Fw(e)?Bw:Dw;return t.test(pE(e))}function sE(e,t,r,n){if(!Ki(e))return e;t=cE(t,e)?[t]:aE(t);for(var s=-1,i=t.length,o=i-1,u=e;u!=null&&++s<i;){var h=dE(t[s]),a=r;if(s!=o){var c=u[h];a=void 0,a===void 0&&(a=Ki(c)?c:uE(t[s+1])?[]:{})}nE(u,h,a),u=u[h]}return e}function oE(e){if(typeof e=="string")return e;if(Da(e))return rc?rc.call(e):"";var t=e+"";return t=="0"&&1/e==-nl?"-0":t}function aE(e){return cl(e)?e:hE(e)}function ws(e,t){var r=e.__data__;return fE(t)?r[typeof t=="string"?"string":"hash"]:r.map}function al(e,t){var r=Mw(e,t);return iE(r)?r:void 0}function uE(e,t){return t=t??Ew,!!t&&(typeof e=="number"||Cw.test(e))&&e>-1&&e%1==0&&e<t}function cE(e,t){if(cl(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Da(e)?!0:Tw.test(e)||!Iw.test(e)||t!=null&&e in Object(t)}function fE(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function lE(e){return!!Qu&&Qu in e}var hE=Ra(function(e){e=mE(e);var t=[];return Ow.test(e)&&t.push(""),e.replace(xw,function(r,n,s,i){t.push(s?i.replace(Rw,"$1"):n||r)}),t});function dE(e){if(typeof e=="string"||Da(e))return e;var t=e+"";return t=="0"&&1/e==-nl?"-0":t}function pE(e){if(e!=null){try{return sl.call(e)}catch{}try{return e+""}catch{}}return""}function Ra(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(ww);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,n);return r.cache=i.set(s,o),o};return r.cache=new(Ra.Cache||Pr),r}Ra.Cache=Pr;function ul(e,t){return e===t||e!==e&&t!==t}var cl=Array.isArray;function yE(e){var t=Ki(e)?ol.call(e):"";return t==bw||t==Sw}function Ki(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function gE(e){return!!e&&typeof e=="object"}function Da(e){return typeof e=="symbol"||gE(e)&&ol.call(e)==Aw}function mE(e){return e==null?"":oE(e)}function _E(e,t,r){return e==null?e:sE(e,t,r)}var vE=_E;const wE=Vo(vE);var EE="Expected a function",fl="__lodash_hash_undefined__",ll=1/0,bE="[object Function]",SE="[object GeneratorFunction]",AE="[object Symbol]",IE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,TE=/^\w*$/,OE=/^\./,xE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,NE=/[\\^$.*+?()[\]{}|]/g,RE=/\\(\\)?/g,DE=/^\[object .+?Constructor\]$/,CE=typeof U=="object"&&U&&U.Object===Object&&U,PE=typeof self=="object"&&self&&self.Object===Object&&self,Ca=CE||PE||Function("return this")();function kE(e,t){return e==null?void 0:e[t]}function ME(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var FE=Array.prototype,LE=Function.prototype,hl=Object.prototype,So=Ca["__core-js_shared__"],nc=function(){var e=/[^.]+$/.exec(So&&So.keys&&So.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),dl=LE.toString,Es=hl.hasOwnProperty,pl=hl.toString,UE=RegExp("^"+dl.call(Es).replace(NE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ic=Ca.Symbol,BE=FE.splice,$E=gl(Ca,"Map"),Vn=gl(Object,"create"),sc=ic?ic.prototype:void 0,oc=sc?sc.toString:void 0;function Rr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function WE(){this.__data__=Vn?Vn(null):{}}function jE(e){return this.has(e)&&delete this.__data__[e]}function YE(e){var t=this.__data__;if(Vn){var r=t[e];return r===fl?void 0:r}return Es.call(t,e)?t[e]:void 0}function HE(e){var t=this.__data__;return Vn?t[e]!==void 0:Es.call(t,e)}function qE(e,t){var r=this.__data__;return r[e]=Vn&&t===void 0?fl:t,this}Rr.prototype.clear=WE;Rr.prototype.delete=jE;Rr.prototype.get=YE;Rr.prototype.has=HE;Rr.prototype.set=qE;function dn(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function GE(){this.__data__=[]}function KE(e){var t=this.__data__,r=bs(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():BE.call(t,r,1),!0}function VE(e){var t=this.__data__,r=bs(t,e);return r<0?void 0:t[r][1]}function JE(e){return bs(this.__data__,e)>-1}function zE(e,t){var r=this.__data__,n=bs(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}dn.prototype.clear=GE;dn.prototype.delete=KE;dn.prototype.get=VE;dn.prototype.has=JE;dn.prototype.set=zE;function kr(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ZE(){this.__data__={hash:new Rr,map:new($E||dn),string:new Rr}}function XE(e){return Ss(this,e).delete(e)}function QE(e){return Ss(this,e).get(e)}function e1(e){return Ss(this,e).has(e)}function t1(e,t){return Ss(this,e).set(e,t),this}kr.prototype.clear=ZE;kr.prototype.delete=XE;kr.prototype.get=QE;kr.prototype.has=e1;kr.prototype.set=t1;function bs(e,t){for(var r=e.length;r--;)if(d1(e[r][0],t))return r;return-1}function r1(e,t){t=ml(t,e)?[t]:yl(t);for(var r=0,n=t.length;e!=null&&r<n;)e=e[_l(t[r++])];return r&&r==n?e:void 0}function n1(e){if(!wl(e)||u1(e))return!1;var t=p1(e)||ME(e)?UE:DE;return t.test(l1(e))}function i1(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(s);++n<s;)i[n]=e[n+t];return i}function s1(e){if(typeof e=="string")return e;if(ka(e))return oc?oc.call(e):"";var t=e+"";return t=="0"&&1/e==-ll?"-0":t}function o1(e,t){t=ml(t,e)?[t]:yl(t),e=c1(e,t);var r=_l(h1(t));return!(e!=null&&Es.call(e,r))||delete e[r]}function yl(e){return vl(e)?e:f1(e)}function Ss(e,t){var r=e.__data__;return a1(t)?r[typeof t=="string"?"string":"hash"]:r.map}function gl(e,t){var r=kE(e,t);return n1(r)?r:void 0}function ml(e,t){if(vl(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||ka(e)?!0:TE.test(e)||!IE.test(e)||t!=null&&e in Object(t)}function a1(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function u1(e){return!!nc&&nc in e}function c1(e,t){return t.length==1?e:r1(e,i1(t,0,-1))}var f1=Pa(function(e){e=g1(e);var t=[];return OE.test(e)&&t.push(""),e.replace(xE,function(r,n,s,i){t.push(s?i.replace(RE,"$1"):n||r)}),t});function _l(e){if(typeof e=="string"||ka(e))return e;var t=e+"";return t=="0"&&1/e==-ll?"-0":t}function l1(e){if(e!=null){try{return dl.call(e)}catch{}try{return e+""}catch{}}return""}function h1(e){var t=e?e.length:0;return t?e[t-1]:void 0}function Pa(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(EE);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,n);return r.cache=i.set(s,o),o};return r.cache=new(Pa.Cache||kr),r}Pa.Cache=kr;function d1(e,t){return e===t||e!==e&&t!==t}var vl=Array.isArray;function p1(e){var t=wl(e)?pl.call(e):"";return t==bE||t==SE}function wl(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function y1(e){return!!e&&typeof e=="object"}function ka(e){return typeof e=="symbol"||y1(e)&&pl.call(e)==AE}function g1(e){return e==null?"":s1(e)}function m1(e,t){return e==null?!0:o1(e,t)}var _1=m1;const v1=Vo(_1);var Vi={exports:{}};Vi.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",s=9007199254740991,i="[object Arguments]",o="[object Array]",u="[object Boolean]",h="[object Date]",a="[object Error]",c="[object Function]",d="[object GeneratorFunction]",m="[object Map]",w="[object Number]",A="[object Object]",S="[object Promise]",_="[object RegExp]",v="[object Set]",N="[object String]",O="[object Symbol]",I="[object WeakMap]",k="[object ArrayBuffer]",M="[object DataView]",j="[object Float32Array]",G="[object Float64Array]",ee="[object Int8Array]",_e="[object Int16Array]",be="[object Int32Array]",Ne="[object Uint8Array]",ne="[object Uint8ClampedArray]",Me="[object Uint16Array]",Be="[object Uint32Array]",At=/[\\^$.*+?()[\]{}|]/g,fe=/\w*$/,$e=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,L={};L[i]=L[o]=L[k]=L[M]=L[u]=L[h]=L[j]=L[G]=L[ee]=L[_e]=L[be]=L[m]=L[w]=L[A]=L[_]=L[v]=L[N]=L[O]=L[Ne]=L[ne]=L[Me]=L[Be]=!0,L[a]=L[c]=L[I]=!1;var Le=typeof U=="object"&&U&&U.Object===Object&&U,ri=typeof self=="object"&&self&&self.Object===Object&&self,nt=Le||ri||Function("return this")(),pn=t&&!t.nodeType&&t,ni=pn&&!0&&e&&!e.nodeType&&e,Is=ni&&ni.exports===pn;function yn(p,b){return p.set(b[0],b[1]),p}function Ts(p,b){return p.add(b),p}function Os(p,b){for(var T=-1,B=p?p.length:0;++T<B&&b(p[T],T,p)!==!1;);return p}function ii(p,b){for(var T=-1,B=b.length,Fe=p.length;++T<B;)p[Fe+T]=b[T];return p}function fr(p,b,T,B){for(var Fe=-1,He=p?p.length:0;++Fe<He;)T=b(T,p[Fe],Fe,p);return T}function it(p,b){for(var T=-1,B=Array(p);++T<p;)B[T]=b(T);return B}function gn(p,b){return p==null?void 0:p[b]}function si(p){var b=!1;if(p!=null&&typeof p.toString!="function")try{b=!!(p+"")}catch{}return b}function y(p){var b=-1,T=Array(p.size);return p.forEach(function(B,Fe){T[++b]=[Fe,B]}),T}function f(p,b){return function(T){return p(b(T))}}function l(p){var b=-1,T=Array(p.size);return p.forEach(function(B){T[++b]=B}),T}var g=Array.prototype,E=Function.prototype,x=Object.prototype,R=nt["__core-js_shared__"],V=function(){var p=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),se=E.toString,Q=x.hasOwnProperty,Se=x.toString,ye=RegExp("^"+se.call(Q).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lr=Is?nt.Buffer:void 0,mn=nt.Symbol,_n=nt.Uint8Array,Al=f(Object.getPrototypeOf,Object),Il=Object.create,Tl=x.propertyIsEnumerable,Ol=g.splice,Fa=Object.getOwnPropertySymbols,xl=lr?lr.isBuffer:void 0,Nl=f(Object.keys,Object),xs=Lr(nt,"DataView"),vn=Lr(nt,"Map"),Ns=Lr(nt,"Promise"),Rs=Lr(nt,"Set"),Ds=Lr(nt,"WeakMap"),wn=Lr(Object,"create"),Rl=pr(xs),Dl=pr(vn),Cl=pr(Ns),Pl=pr(Rs),kl=pr(Ds),La=mn?mn.prototype:void 0,Ua=La?La.valueOf:void 0;function hr(p){var b=-1,T=p?p.length:0;for(this.clear();++b<T;){var B=p[b];this.set(B[0],B[1])}}function Ml(){this.__data__=wn?wn(null):{}}function Fl(p){return this.has(p)&&delete this.__data__[p]}function Ll(p){var b=this.__data__;if(wn){var T=b[p];return T===n?void 0:T}return Q.call(b,p)?b[p]:void 0}function Ul(p){var b=this.__data__;return wn?b[p]!==void 0:Q.call(b,p)}function Bl(p,b){var T=this.__data__;return T[p]=wn&&b===void 0?n:b,this}hr.prototype.clear=Ml,hr.prototype.delete=Fl,hr.prototype.get=Ll,hr.prototype.has=Ul,hr.prototype.set=Bl;function Lt(p){var b=-1,T=p?p.length:0;for(this.clear();++b<T;){var B=p[b];this.set(B[0],B[1])}}function $l(){this.__data__=[]}function Wl(p){var b=this.__data__,T=oi(b,p);if(T<0)return!1;var B=b.length-1;return T==B?b.pop():Ol.call(b,T,1),!0}function jl(p){var b=this.__data__,T=oi(b,p);return T<0?void 0:b[T][1]}function Yl(p){return oi(this.__data__,p)>-1}function Hl(p,b){var T=this.__data__,B=oi(T,p);return B<0?T.push([p,b]):T[B][1]=b,this}Lt.prototype.clear=$l,Lt.prototype.delete=Wl,Lt.prototype.get=jl,Lt.prototype.has=Yl,Lt.prototype.set=Hl;function Mr(p){var b=-1,T=p?p.length:0;for(this.clear();++b<T;){var B=p[b];this.set(B[0],B[1])}}function ql(){this.__data__={hash:new hr,map:new(vn||Lt),string:new hr}}function Gl(p){return ai(this,p).delete(p)}function Kl(p){return ai(this,p).get(p)}function Vl(p){return ai(this,p).has(p)}function Jl(p,b){return ai(this,p).set(p,b),this}Mr.prototype.clear=ql,Mr.prototype.delete=Gl,Mr.prototype.get=Kl,Mr.prototype.has=Vl,Mr.prototype.set=Jl;function Fr(p){this.__data__=new Lt(p)}function zl(){this.__data__=new Lt}function Zl(p){return this.__data__.delete(p)}function Xl(p){return this.__data__.get(p)}function Ql(p){return this.__data__.has(p)}function eh(p,b){var T=this.__data__;if(T instanceof Lt){var B=T.__data__;if(!vn||B.length<r-1)return B.push([p,b]),this;T=this.__data__=new Mr(B)}return T.set(p,b),this}Fr.prototype.clear=zl,Fr.prototype.delete=Zl,Fr.prototype.get=Xl,Fr.prototype.has=Ql,Fr.prototype.set=eh;function th(p,b){var T=ks(p)||Ih(p)?it(p.length,String):[],B=T.length,Fe=!!B;for(var He in p)Q.call(p,He)&&!(Fe&&(He=="length"||Eh(He,B)))&&T.push(He);return T}function Ba(p,b,T){var B=p[b];(!(Q.call(p,b)&&Ya(B,T))||T===void 0&&!(b in p))&&(p[b]=T)}function oi(p,b){for(var T=p.length;T--;)if(Ya(p[T][0],b))return T;return-1}function rh(p,b){return p&&$a(b,Ms(b),p)}function Cs(p,b,T,B,Fe,He,Ut){var qe;if(B&&(qe=He?B(p,Fe,He,Ut):B(p)),qe!==void 0)return qe;if(!ui(p))return p;var Ga=ks(p);if(Ga){if(qe=_h(p),!b)return yh(p,qe)}else{var Ur=dr(p),Ka=Ur==c||Ur==d;if(Oh(p))return uh(p,b);if(Ur==A||Ur==i||Ka&&!He){if(si(p))return He?p:{};if(qe=vh(Ka?{}:p),!b)return gh(p,rh(qe,p))}else{if(!L[Ur])return He?p:{};qe=wh(p,Ur,Cs,b)}}Ut||(Ut=new Fr);var Va=Ut.get(p);if(Va)return Va;if(Ut.set(p,qe),!Ga)var Ja=T?mh(p):Ms(p);return Os(Ja||p,function(Fs,ci){Ja&&(ci=Fs,Fs=p[ci]),Ba(qe,ci,Cs(Fs,b,T,B,ci,p,Ut))}),qe}function nh(p){return ui(p)?Il(p):{}}function ih(p,b,T){var B=b(p);return ks(p)?B:ii(B,T(p))}function sh(p){return Se.call(p)}function oh(p){if(!ui(p)||Sh(p))return!1;var b=qa(p)||si(p)?ye:$e;return b.test(pr(p))}function ah(p){if(!ja(p))return Nl(p);var b=[];for(var T in Object(p))Q.call(p,T)&&T!="constructor"&&b.push(T);return b}function uh(p,b){if(b)return p.slice();var T=new p.constructor(p.length);return p.copy(T),T}function Ps(p){var b=new p.constructor(p.byteLength);return new _n(b).set(new _n(p)),b}function ch(p,b){var T=b?Ps(p.buffer):p.buffer;return new p.constructor(T,p.byteOffset,p.byteLength)}function fh(p,b,T){var B=b?T(y(p),!0):y(p);return fr(B,yn,new p.constructor)}function lh(p){var b=new p.constructor(p.source,fe.exec(p));return b.lastIndex=p.lastIndex,b}function hh(p,b,T){var B=b?T(l(p),!0):l(p);return fr(B,Ts,new p.constructor)}function dh(p){return Ua?Object(Ua.call(p)):{}}function ph(p,b){var T=b?Ps(p.buffer):p.buffer;return new p.constructor(T,p.byteOffset,p.length)}function yh(p,b){var T=-1,B=p.length;for(b||(b=Array(B));++T<B;)b[T]=p[T];return b}function $a(p,b,T,B){T||(T={});for(var Fe=-1,He=b.length;++Fe<He;){var Ut=b[Fe],qe=void 0;Ba(T,Ut,qe===void 0?p[Ut]:qe)}return T}function gh(p,b){return $a(p,Wa(p),b)}function mh(p){return ih(p,Ms,Wa)}function ai(p,b){var T=p.__data__;return bh(b)?T[typeof b=="string"?"string":"hash"]:T.map}function Lr(p,b){var T=gn(p,b);return oh(T)?T:void 0}var Wa=Fa?f(Fa,Object):Rh,dr=sh;(xs&&dr(new xs(new ArrayBuffer(1)))!=M||vn&&dr(new vn)!=m||Ns&&dr(Ns.resolve())!=S||Rs&&dr(new Rs)!=v||Ds&&dr(new Ds)!=I)&&(dr=function(p){var b=Se.call(p),T=b==A?p.constructor:void 0,B=T?pr(T):void 0;if(B)switch(B){case Rl:return M;case Dl:return m;case Cl:return S;case Pl:return v;case kl:return I}return b});function _h(p){var b=p.length,T=p.constructor(b);return b&&typeof p[0]=="string"&&Q.call(p,"index")&&(T.index=p.index,T.input=p.input),T}function vh(p){return typeof p.constructor=="function"&&!ja(p)?nh(Al(p)):{}}function wh(p,b,T,B){var Fe=p.constructor;switch(b){case k:return Ps(p);case u:case h:return new Fe(+p);case M:return ch(p,B);case j:case G:case ee:case _e:case be:case Ne:case ne:case Me:case Be:return ph(p,B);case m:return fh(p,B,T);case w:case N:return new Fe(p);case _:return lh(p);case v:return hh(p,B,T);case O:return dh(p)}}function Eh(p,b){return b=b??s,!!b&&(typeof p=="number"||X.test(p))&&p>-1&&p%1==0&&p<b}function bh(p){var b=typeof p;return b=="string"||b=="number"||b=="symbol"||b=="boolean"?p!=="__proto__":p===null}function Sh(p){return!!V&&V in p}function ja(p){var b=p&&p.constructor,T=typeof b=="function"&&b.prototype||x;return p===T}function pr(p){if(p!=null){try{return se.call(p)}catch{}try{return p+""}catch{}}return""}function Ah(p){return Cs(p,!0,!0)}function Ya(p,b){return p===b||p!==p&&b!==b}function Ih(p){return Th(p)&&Q.call(p,"callee")&&(!Tl.call(p,"callee")||Se.call(p)==i)}var ks=Array.isArray;function Ha(p){return p!=null&&xh(p.length)&&!qa(p)}function Th(p){return Nh(p)&&Ha(p)}var Oh=xl||Dh;function qa(p){var b=ui(p)?Se.call(p):"";return b==c||b==d}function xh(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=s}function ui(p){var b=typeof p;return!!p&&(b=="object"||b=="function")}function Nh(p){return!!p&&typeof p=="object"}function Ms(p){return Ha(p)?th(p):ah(p)}function Rh(){return[]}function Dh(){return!1}e.exports=Ah})(Vi,Vi.exports);var w1=Vi.exports;const E1=Vo(w1);function Zr(e){return e===void 0&&(e=""),(e?e+"_":"")+ +new Date+"_"+Math.random()}var b1=function(){function e(t){this.close=t.close,this.onChange=t.onChange,this.onError=t.onError,t.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return t.virtualClient}})}return e}(),ac=function(){function e(t){var r=t.id,n=t.docChanges,s=t.docs,i=t.msgType,o=t.type,u,h;Object.defineProperties(this,{id:{get:function(){return r},enumerable:!0},docChanges:{get:function(){return u||(u=JSON.parse(JSON.stringify(n))),u},enumerable:!0},docs:{get:function(){return h||(h=JSON.parse(JSON.stringify(s))),h},enumerable:!0},msgType:{get:function(){return i},enumerable:!0},type:{get:function(){return o},enumerable:!0}})}return e}(),As=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),S1=function(e){As(t,e);function t(r){var n=e.call(this,"Watch Error "+JSON.stringify(r.msgData)+" (requestid: "+r.requestId+")")||this;return n.isRealtimeErrorMessageError=!0,n.payload=r,n}return t}(Error),uc=function(e){return e==null?void 0:e.isRealtimeErrorMessageError},A1=function(e){As(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="timeout",r.payload=null,r.generic=!0,r}return t}(Error),I1=function(e){return e.type==="timeout"},T1=function(e){As(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cancelled",r.payload=null,r.generic=!0,r}return t}(Error),O1=function(e){return e.type==="cancelled"},ft=function(e){As(t,e);function t(r){var n=e.call(this,r.errMsg)||this;return n.errCode="UNKNOWN_ERROR",Object.defineProperties(n,{message:{get:function(){return"errCode: "+this.errCode+" "+(Ve[this.errCode]||"")+" | errMsg: "+this.errMsg},set:function(s){this.errMsg=s}}}),n.errCode=r.errCode||"UNKNOWN_ERROR",n.errMsg=r.errMsg,n}return Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: "+this.errCode+" | errMsg: "+this.errMsg},set:function(r){this.errMsg=r},enumerable:!1,configurable:!0}),t}(Error),Ve={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"},Ko=function(e){return e===void 0&&(e=0),new Promise(function(t){return setTimeout(t,e)})},ze=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},Ge=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},cc=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,s++)n[s]=i[o];return n},le;(function(e){e.LOGGINGIN="LOGGINGIN",e.INITING="INITING",e.REBUILDING="REBUILDING",e.ACTIVE="ACTIVE",e.ERRORED="ERRORED",e.CLOSING="CLOSING",e.CLOSED="CLOSED",e.PAUSED="PAUSED",e.RESUMING="RESUMING"})(le||(le={}));var x1=100,Si=2,N1=2,R1=10*1e3,D1=10*1e3,C1=10*1e3,P1=function(){function e(t){var r=this;this.watchStatus=le.INITING,this._login=function(n,s){return ze(r,void 0,void 0,function(){var i;return Ge(this,function(o){switch(o.label){case 0:return this.watchStatus=le.LOGGINGIN,[4,this.login(n,s)];case 1:return i=o.sent(),this.envId||(this.envId=i.envId),[2,i]}})})},this.initWatch=function(n){return ze(r,void 0,void 0,function(){var s,i=this;return Ge(this,function(o){switch(o.label){case 0:if(this._initWatchPromise)return[2,this._initWatchPromise];this._initWatchPromise=new Promise(function(u,h){return ze(i,void 0,void 0,function(){var a,c,d,m,w,A,S,_,v,N,O;return Ge(this,function(I){switch(I.label){case 0:return I.trys.push([0,3,,4]),this.watchStatus===le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):[4,this._login(this.envId,n)];case 1:return a=I.sent().envId,this.watchStatus===le.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,u()]):(this.watchStatus=le.INITING,c={watchId:this.watchId,requestId:Zr(),msgType:"INIT_WATCH",msgData:{envId:a,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!0,timeout:D1})]);case 2:if(d=I.sent(),m=d.msgData,w=m.events,A=m.currEvent,this.sessionInfo={queryID:d.msgData.queryID,currentEventId:A-1,currentDocs:[]},w.length>0){for(S=0,_=w;S<_.length;S++)v=_[S],v.ID=A;this.handleServerEvents(d)}else this.sessionInfo.currentEventId=A,N=new ac({id:A,docChanges:[],docs:[],type:"init"}),this.listener.onChange(N),this.scheduleSendACK();return this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=le.ACTIVE,this._availableRetries.INIT_WATCH=Si,u(),[3,4];case 3:return O=I.sent(),this.handleWatchEstablishmentError(O,{operationName:"INIT_WATCH",resolve:u,reject:h}),[3,4];case 4:return[2]}})})}),s=!1,o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this._initWatchPromise];case 2:return o.sent(),s=!0,[3,4];case 3:return this._initWatchPromise=void 0,[7];case 4:return console.log("[realtime] initWatch "+(s?"success":"fail")),[2]}})})},this.rebuildWatch=function(n){return ze(r,void 0,void 0,function(){var s,i=this;return Ge(this,function(o){switch(o.label){case 0:if(this._rebuildWatchPromise)return[2,this._rebuildWatchPromise];this._rebuildWatchPromise=new Promise(function(u,h){return ze(i,void 0,void 0,function(){var a,c,d,m;return Ge(this,function(w){switch(w.label){case 0:return w.trys.push([0,3,,4]),this.watchStatus===le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):[4,this._login(this.envId,n)];case 1:if(a=w.sent().envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");return this.watchStatus===le.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,u()]):(this.watchStatus=le.REBUILDING,c={watchId:this.watchId,requestId:Zr(),msgType:"REBUILD_WATCH",msgData:{envId:a,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:c,waitResponse:!0,skipOnMessage:!1,timeout:C1})]);case 2:return d=w.sent(),this.handleServerEvents(d),this.watchStatus=le.ACTIVE,this._availableRetries.REBUILD_WATCH=Si,u(),[3,4];case 3:return m=w.sent(),this.handleWatchEstablishmentError(m,{operationName:"REBUILD_WATCH",resolve:u,reject:h}),[3,4];case 4:return[2]}})})}),s=!1,o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this._rebuildWatchPromise];case 2:return o.sent(),s=!0,[3,4];case 3:return this._rebuildWatchPromise=void 0,[7];case 4:return console.log("[realtime] rebuildWatch "+(s?"success":"fail")),[2]}})})},this.handleWatchEstablishmentError=function(n,s){return ze(r,void 0,void 0,function(){var i,o,u,h=this;return Ge(this,function(a){return i=s.operationName==="INIT_WATCH",o=function(){h.closeWithError(new ft({errCode:i?Ve.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:Ve.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:n})),s.reject(n)},u=function(c){h.useRetryTicket(s.operationName)?i?(h._initWatchPromise=void 0,s.resolve(h.initWatch(c))):(h._rebuildWatchPromise=void 0,s.resolve(h.rebuildWatch(c))):o()},this.handleCommonError(n,{onSignError:function(){return u(!0)},onTimeoutError:function(){return u(!1)},onNotRetryableError:o,onCancelledError:s.reject,onUnknownError:function(){return ze(h,void 0,void 0,function(){var c,d=this;return Ge(this,function(m){switch(m.label){case 0:return m.trys.push([0,8,,9]),c=function(){return ze(d,void 0,void 0,function(){return Ge(this,function(w){switch(w.label){case 0:return this.pause(),[4,this.onceWSConnected()];case 1:return w.sent(),u(!0),[2]}})})},this.isWSConnected()?[3,2]:[4,c()];case 1:return m.sent(),[3,7];case 2:return[4,Ko(x1)];case 3:return m.sent(),this.watchStatus!==le.PAUSED?[3,4]:(s.reject(new T1(s.operationName+" cancelled due to pause after unknownError")),[3,7]);case 4:return this.isWSConnected()?[3,6]:[4,c()];case 5:return m.sent(),[3,7];case 6:u(!1),m.label=7;case 7:return[3,9];case 8:return m.sent(),u(!0),[3,9];case 9:return[2]}})})}}),[2]})})},this.closeWatch=function(){return ze(r,void 0,void 0,function(){var n,s,i;return Ge(this,function(o){switch(o.label){case 0:if(n=this.sessionInfo?this.sessionInfo.queryID:"",this.watchStatus!==le.ACTIVE)return this.watchStatus=le.CLOSED,this.onWatchClose(this,n),[2];o.label=1;case 1:return o.trys.push([1,3,4,5]),this.watchStatus=le.CLOSING,s={watchId:this.watchId,requestId:Zr(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:s})];case 2:return o.sent(),this.sessionInfo=void 0,this.watchStatus=le.CLOSED,[3,5];case 3:return i=o.sent(),this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:i})),[3,5];case 4:return this.onWatchClose(this,n),[7];case 5:return[2]}})})},this.scheduleSendACK=function(){r.clearACKSchedule(),r._ackTimeoutId=setTimeout(function(){r._waitExpectedTimeoutId?r.scheduleSendACK():r.sendACK()},R1)},this.clearACKSchedule=function(){r._ackTimeoutId&&clearTimeout(r._ackTimeoutId)},this.sendACK=function(){return ze(r,void 0,void 0,function(){var n,s,i;return Ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.watchStatus!==le.ACTIVE?(this.scheduleSendACK(),[2]):this.sessionInfo?(n={watchId:this.watchId,requestId:Zr(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:n})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return o.sent(),this.scheduleSendACK(),[3,3];case 2:if(s=o.sent(),uc(s))switch(i=s.payload,i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this.rebuildWatch(),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:i.msgData.code})),[2]}return this._availableRetries.CHECK_LAST&&this._availableRetries.CHECK_LAST>0?(this._availableRetries.CHECK_LAST--,this.scheduleSendACK()):this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:s})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(n,s){if(uc(n)){var i=n.payload;switch(i.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":{s.onSignError(n);return}case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":{s.onNotRetryableError(n);return}default:{s.onNotRetryableError(n);return}}}else if(I1(n)){s.onTimeoutError(n);return}else if(O1(n)){s.onCancelledError(n);return}s.onUnknownError(n)},this.watchId="watchid_"+ +new Date+"_"+Math.random(),this.envId=t.envId,this.collectionName=t.collectionName,this.query=t.query,this.limit=t.limit,this.orderBy=t.orderBy,this.send=t.send,this.login=t.login,this.isWSConnected=t.isWSConnected,this.onceWSConnected=t.onceWSConnected,this.getWaitExpectedTimeoutLength=t.getWaitExpectedTimeoutLength,this.onWatchStart=t.onWatchStart,this.onWatchClose=t.onWatchClose,this.debug=t.debug,this._availableRetries={INIT_WATCH:Si,REBUILD_WATCH:Si,CHECK_LAST:N1},this.listener=new b1({close:this.closeWatch,onChange:t.onChange,onError:t.onError,debug:this.debug,virtualClient:this}),this.initWatch()}return e.prototype.onMessage=function(t){var r=this;switch(this.watchStatus){case le.PAUSED:{if(t.msgType!=="ERROR")return;break}case le.LOGGINGIN:case le.INITING:case le.REBUILDING:{console.warn("[realtime listener] internal non-fatal error: unexpected message received while "+this.watchStatus);return}case le.CLOSED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");return}case le.ERRORED:{console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error");return}}if(!this.sessionInfo){console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.");return}switch(this.scheduleSendACK(),t.msgType){case"NEXT_EVENT":{console.warn("nextevent "+t.msgData.currEvent+" ignored",t),this.handleServerEvents(t);break}case"CHECK_EVENT":{this.sessionInfo.currentEventId<t.msgData.currEvent&&(this.sessionInfo.expectEventId=t.msgData.currEvent,this.clearWaitExpectedEvent(),this._waitExpectedTimeoutId=setTimeout(function(){r.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log("[realtime] waitExpectedTimeoutLength "+this.getWaitExpectedTimeoutLength()));break}case"ERROR":{this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:t.msgData.code+" - "+t.msgData.message}));break}default:{console.warn("[realtime listener] virtual client receive unexpected msg "+t.msgType+": ",t);break}}},e.prototype.closeWithError=function(t){this.watchStatus=le.ERRORED,this.clearACKSchedule(),this.listener.onError(t),this.onWatchClose(this,this.sessionInfo&&this.sessionInfo.queryID||""),console.log("[realtime] client closed ("+this.collectionName+" "+this.query+") (watchId "+this.watchId+")")},e.prototype.pause=function(){this.watchStatus=le.PAUSED,console.log("[realtime] client paused ("+this.collectionName+" "+this.query+") (watchId "+this.watchId+")")},e.prototype.resume=function(){return ze(this,void 0,void 0,function(){var t;return Ge(this,function(r){switch(r.label){case 0:this.watchStatus=le.RESUMING,console.log("[realtime] client resuming with "+(this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH")+" ("+this.collectionName+" "+this.query+") ("+this.watchId+")"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.sessionInfo?this.rebuildWatch():this.initWatch()];case 2:return r.sent(),console.log("[realtime] client successfully resumed ("+this.collectionName+" "+this.query+") ("+this.watchId+")"),[3,4];case 3:return t=r.sent(),console.error("[realtime] client resume failed ("+this.collectionName+" "+this.query+") ("+this.watchId+")",t),[3,4];case 4:return[2]}})})},e.prototype.useRetryTicket=function(t){return this._availableRetries[t]&&this._availableRetries[t]>0?(this._availableRetries[t]--,console.log("[realtime] "+t+" use a retry ticket, now only "+this._availableRetries[t]+" retry left"),!0):!1},e.prototype.handleServerEvents=function(t){return ze(this,void 0,void 0,function(){var r;return Ge(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this._handleServerEvents(t)];case 1:return n.sent(),this._postHandleServerEventsValidityCheck(t),[3,3];case 2:throw r=n.sent(),console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",r),r;case 3:return[2]}})})},e.prototype._handleServerEvents=function(t){return ze(this,void 0,void 0,function(){var r,n,s,i,o,u,h,a,c,d,m,w;return Ge(this,function(A){switch(A.label){case 0:if(r=t.requestId,n=t.msgData.events,s=t.msgType,!n.length||!this.sessionInfo)return[2];i=this.sessionInfo;try{o=n.map(k1)}catch(S){return this.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:S})),[2]}u=cc(i.currentDocs),h=!1,a=function(S,_){var v,N,M,k,O,I,k,j,j,M,M,j,G,G,ee,_e,be;return Ge(this,function(Ne){switch(Ne.label){case 0:return v=o[S],i.currentEventId>=v.id?(!o[S-1]||v.id>o[S-1].id?console.warn("[realtime] duplicate event received, cur "+i.currentEventId+" but got "+v.id):console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId "+r+")"),[2,"continue"]):[3,1];case 1:if(i.currentEventId!==v.id-1)return[3,2];switch(v.dataType){case"update":{if(!v.doc)switch(v.queueType){case"update":case"dequeue":{if(N=u.find(function(ne){return ne._id===v.docId}),N){if(M=E1(N),v.updatedFields)for(k in v.updatedFields)wE(M,k,v.updatedFields[k]);if(v.removedFields)for(O=0,I=v.removedFields;O<I.length;O++)k=I[O],v1(M,k);v.doc=M}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break}case"enqueue":throw j=new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '+t.requestId+")"}),c.closeWithError(j),j}break}case"replace":{if(!v.doc)throw j=new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '+t.requestId+")"}),c.closeWithError(j),j;break}case"remove":{M=u.find(function(ne){return ne._id===v.docId}),M?v.doc=M:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break}case"limit":{if(!v.doc)switch(v.queueType){case"dequeue":{M=u.find(function(ne){return ne._id===v.docId}),M?v.doc=M:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType event where no doc is associated.");break}case"enqueue":throw j=new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="limit" and queueType="enqueue" (requestId '+t.requestId+")"}),c.closeWithError(j),j}break}}switch(v.queueType){case"init":{h?u.push(v.doc):(h=!0,u=[v.doc]);break}case"enqueue":{u.push(v.doc);break}case"dequeue":{G=u.findIndex(function(ne){return ne._id===v.docId}),G>-1?u.splice(G,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break}case"update":{G=u.findIndex(function(ne){return ne._id===v.docId}),G>-1?u[G]=v.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.");break}}return(S===_-1||o[S+1]&&o[S+1].id!==v.id)&&(ee=cc(u),_e=o.slice(0,S+1).filter(function(ne){return ne.id===v.id}),c.sessionInfo.currentEventId=v.id,c.sessionInfo.currentDocs=u,be=new ac({id:v.id,docChanges:_e,docs:ee,msgType:s}),c.listener.onChange(be)),[3,4];case 2:return console.warn("[realtime listener] event received is out of order, cur "+c.sessionInfo.currentEventId+" but got "+v.id),[4,c.rebuildWatch()];case 3:return Ne.sent(),[2,{value:void 0}];case 4:return[2]}})},c=this,d=0,m=o.length,A.label=1;case 1:return d<m?[5,a(d,m)]:[3,4];case 2:if(w=A.sent(),typeof w=="object")return[2,w.value];A.label=3;case 3:return d++,[3,1];case 4:return[2]}})})},e.prototype._postHandleServerEventsValidityCheck=function(t){if(!this.sessionInfo){console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur");return}if(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<t.msgData.currEvent){console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling");return}},e.prototype.clearWaitExpectedEvent=function(){this._waitExpectedTimeoutId&&(clearTimeout(this._waitExpectedTimeoutId),this._waitExpectedTimeoutId=void 0)},e}();function k1(e){var t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&e.Doc!=="{}"?JSON.parse(e.Doc):void 0};return e.DataType==="update"&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=JSON.parse(e.removedFields))),t}var El={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}},ut;(function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.GoingAway=1001]="GoingAway",e[e.ProtocolError=1002]="ProtocolError",e[e.UnsupportedData=1003]="UnsupportedData",e[e.NoStatusReceived=1005]="NoStatusReceived",e[e.AbnormalClosure=1006]="AbnormalClosure",e[e.InvalidFramePayloadData=1007]="InvalidFramePayloadData",e[e.PolicyViolation=1008]="PolicyViolation",e[e.MessageTooBig=1009]="MessageTooBig",e[e.MissingExtension=1010]="MissingExtension",e[e.InternalError=1011]="InternalError",e[e.ServiceRestart=1012]="ServiceRestart",e[e.TryAgainLater=1013]="TryAgainLater",e[e.BadGateway=1014]="BadGateway",e[e.TLSHandshake=1015]="TLSHandshake",e[e.ReconnectWebSocket=3e3]="ReconnectWebSocket",e[e.NoRealtimeListeners=3001]="NoRealtimeListeners",e[e.HeartbeatPingError=3002]="HeartbeatPingError",e[e.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",e[e.NoAuthentication=3050]="NoAuthentication"})(ut||(ut={}));var Ao=function(e,t){var r=El[e],n=r?r.name+", code "+e+", reason "+(t||r.description):"code "+e;return new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:n})},bl=null,Sl="web";function M1(){return bl}function F1(e){bl=e}function fc(){return Sl}function L1(e){Sl=e}var Ji=function(){return Ji=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ji.apply(this,arguments)},mt=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function u(c){try{a(n.next(c))}catch(d){o(d)}}function h(c){try{a(n.throw(c))}catch(d){o(d)}}function a(c){c.done?i(c.value):s(c.value).then(u,h)}a((n=n.apply(e,t||[])).next())})},_t=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(c){return h([a,c])}}function h(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,s=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(a[0]===6&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Io={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},lc=3,U1=5e3,B1=1e4,$1=5,W1=1e4,j1=2,Y1=2,H1=5e3,q1=function(){function e(t){var r=this;this._virtualWSClient=new Set,this._queryIdClientMap=new Map,this._watchIdClientMap=new Map,this._pingFailed=0,this._pongMissed=0,this._logins=new Map,this._wsReadySubsribers=[],this._wsResponseWait=new Map,this._rttObserved=[],this.send=function(n){return mt(r,void 0,void 0,function(){var s=this;return _t(this,function(i){return[2,new Promise(function(o,u){return mt(s,void 0,void 0,function(){var h,a,c,d,m,w,A,S=this;return _t(this,function(_){switch(_.label){case 0:a=!1,c=!1,d=function(v){a=!0,h&&clearTimeout(h),o(v)},m=function(v){c=!0,h&&clearTimeout(h),u(v)},n.timeout&&(h=setTimeout(function(){return mt(S,void 0,void 0,function(){return _t(this,function(v){switch(v.label){case 0:return!a||!c?[4,Ko(0)]:[3,2];case 1:v.sent(),(!a||!c)&&m(new A1("wsclient.send timedout")),v.label=2;case 2:return[2]}})})},n.timeout)),_.label=1;case 1:return _.trys.push([1,8,,9]),this._wsInitPromise?[4,this._wsInitPromise]:[3,3];case 2:_.sent(),_.label=3;case 3:if(!this._ws)return m(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this._ws.readyState!==Io.OPEN)return m(new Error("ws readyState invalid: "+this._ws.readyState+", can not send message")),[2];n.waitResponse&&this._wsResponseWait.set(n.msg.requestId,{resolve:d,reject:m,skipOnMessage:n.skipOnMessage}),_.label=4;case 4:return _.trys.push([4,6,,7]),[4,this._ws.send(JSON.stringify(n.msg))];case 5:return _.sent(),n.waitResponse||d(),[3,7];case 6:return w=_.sent(),w&&(m(w),n.waitResponse&&this._wsResponseWait.delete(n.msg.requestId)),[3,7];case 7:return[3,9];case 8:return A=_.sent(),m(A),[3,9];case 9:return[2]}})})})]})})},this.closeAllClients=function(n){r._virtualWSClient.forEach(function(s){s.closeWithError(n)})},this.pauseClients=function(n){(n||r._virtualWSClient).forEach(function(s){s.pause()})},this.resumeClients=function(n){(n||r._virtualWSClient).forEach(function(s){s.resume()})},this.initWebSocketConnection=function(n,s){return s===void 0&&(s=r._maxReconnect),mt(r,void 0,void 0,function(){var i=this;return _t(this,function(o){switch(o.label){case 0:if(n&&this._reconnectState)return[2];if(n&&(this._reconnectState=!0),this._wsInitPromise)return[2,this._wsInitPromise];n&&this.pauseClients(),this.close(ut.ReconnectWebSocket),this._wsInitPromise=new Promise(function(u,h){return mt(i,void 0,void 0,function(){var a,c,d,m=this;return _t(this,function(w){switch(w.label){case 0:return w.trys.push([0,6,,11]),[4,this.getWsSign()];case 1:return a=w.sent(),[4,new Promise(function(A){var S=a.wsUrl||"wss://tcb-ws.tencentcloudapi.com",_=M1();m._ws=_?new _(S):new WebSocket(S),A()})];case 2:return w.sent(),this._ws.connect?[4,this._ws.connect()]:[3,4];case 3:w.sent(),w.label=4;case 4:return[4,this.initWebSocketEvent()];case 5:return w.sent(),u(),n&&(this.resumeClients(),this._reconnectState=!1),[3,11];case 6:return c=w.sent(),console.error("[realtime] initWebSocketConnection connect fail",c),s>0?(d=!0,this._wsInitPromise=void 0,d?[4,Ko(this._reconnectInterval)]:[3,8]):[3,9];case 7:w.sent(),n&&(this._reconnectState=!1),w.label=8;case 8:return u(this.initWebSocketConnection(n,s-1)),[3,10];case 9:h(c),n&&this.closeAllClients(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:c})),w.label=10;case 10:return[3,11];case 11:return[2]}})})}),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this._wsInitPromise];case 2:return o.sent(),this._wsReadySubsribers.forEach(function(u){var h=u.resolve;return h()}),[3,5];case 3:return o.sent(),this._wsReadySubsribers.forEach(function(u){var h=u.reject;return h()}),[3,5];case 4:return this._wsInitPromise=void 0,this._wsReadySubsribers=[],[7];case 5:return[2]}})})},this.initWebSocketEvent=function(){return new Promise(function(n,s){if(!r._ws)throw new Error("can not initWebSocketEvent, ws not exists");var i=!1;r._ws.onopen=function(o){console.warn("[realtime] ws event: open",o),i=!0,n()},r._ws.onerror=function(o){r._logins=new Map,i?(console.error("[realtime] ws event: error",o),r.clearHeartbeat(),r._virtualWSClient.forEach(function(u){return u.closeWithError(new ft({errCode:Ve.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:o}))})):(console.error("[realtime] ws open failed with ws event: error",o),s(o))},r._ws.onclose=function(o){switch(console.warn("[realtime] ws event: close",o),r._logins=new Map,r.clearHeartbeat(),o.code){case ut.ReconnectWebSocket:break;case ut.NoRealtimeListeners:break;case ut.HeartbeatPingError:case ut.HeartbeatPongTimeoutError:case ut.NormalClosure:case ut.AbnormalClosure:{r._maxReconnect>0?r.initWebSocketConnection(!0,r._maxReconnect):r.closeAllClients(Ao(o.code));break}case ut.NoAuthentication:{r.closeAllClients(Ao(o.code,o.reason));break}default:r._maxReconnect>0?r.initWebSocketConnection(!0,r._maxReconnect):r.closeAllClients(Ao(o.code))}},r._ws.onmessage=function(o){var u=o.data;r.heartbeat();var h;try{h=JSON.parse(u)}catch(v){throw new Error("[realtime] onMessage parse res.data error: "+v)}if(h.msgType==="ERROR"){var a=null;r._virtualWSClient.forEach(function(v){v.watchId===h.watchId&&(a=v)}),a&&a.listener.onError(h)}var c=r._wsResponseWait.get(h.requestId);if(c){try{h.msgType==="ERROR"?c.reject(new S1(h)):c.resolve(h)}catch(v){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",v)}finally{r._wsResponseWait.delete(h.requestId)}if(c.skipOnMessage)return}if(h.msgType==="PONG"){if(r._lastPingSendTS){var d=Date.now()-r._lastPingSendTS;if(d>B1){console.warn("[realtime] untrusted rtt observed: "+d);return}r._rttObserved.length>=lc&&r._rttObserved.splice(0,r._rttObserved.length-lc+1),r._rttObserved.push(d)}return}var m=h.watchId&&r._watchIdClientMap.get(h.watchId);if(m)m.onMessage(h);else switch(console.error("[realtime] no realtime listener found responsible for watchId "+h.watchId+": ",h),h.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":{m=r._queryIdClientMap.get(h.msgData.queryID),m&&m.onMessage(h);break}default:for(var w=0,A=Array.from(r._watchIdClientMap.entries());w<A.length;w++){var S=A[w],_=S[1];_.onMessage(h);break}}},r.heartbeat()})},this.isWSConnected=function(){return!!(r._ws&&r._ws.readyState===Io.OPEN)},this.onceWSConnected=function(){return mt(r,void 0,void 0,function(){var n=this;return _t(this,function(s){return this.isWSConnected()?[2]:this._wsInitPromise?[2,this._wsInitPromise]:[2,new Promise(function(i,o){n._wsReadySubsribers.push({resolve:i,reject:o})})]})})},this.webLogin=function(n,s){return mt(r,void 0,void 0,function(){var i,o,u,h,a,c,d,m,w=this;return _t(this,function(A){switch(A.label){case 0:if(!s){if(n){if(i=this._logins.get(n),i){if(i.loggedIn&&i.loginResult)return[2,i.loginResult];if(i.loggingInPromise)return[2,i.loggingInPromise]}}else if(o=this._logins.get(""),o!=null&&o.loggingInPromise)return[2,o.loggingInPromise]}u=new Promise(function(S,_){return mt(w,void 0,void 0,function(){var v,N,O,I,k;return _t(this,function(M){switch(M.label){case 0:return M.trys.push([0,3,,4]),[4,this.getWsSign()];case 1:return v=M.sent(),N={envId:v.envId||"",accessToken:"",referrer:"web",sdkVersion:"",dataVersion:""},O={watchId:void 0,requestId:Zr(),msgType:"LOGIN",msgData:N,exMsgData:{runtime:fc(),signStr:v.signStr,secretVersion:v.secretVersion}},[4,this.send({msg:O,waitResponse:!0,skipOnMessage:!0,timeout:H1})];case 2:return I=M.sent(),I.msgData.code?_(new Error(I.msgData.code+" "+I.msgData.message)):S({envId:v.envId}),[3,4];case 3:return k=M.sent(),_(k),[3,4];case 4:return[2]}})})}),h=n&&this._logins.get(n),a=Date.now(),h?(h.loggedIn=!1,h.loggingInPromise=u,h.loginStartTS=a):(h={loggedIn:!1,loggingInPromise:u,loginStartTS:a},this._logins.set(n||"",h)),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,u];case 2:if(c=A.sent(),d=n&&this._logins.get(n),d&&d===h&&d.loginStartTS===a)return h.loggedIn=!0,h.loggingInPromise=void 0,h.loginStartTS=void 0,h.loginResult=c,[2,c];if(d){if(d.loggedIn&&d.loginResult)return[2,d.loginResult];if(d.loggingInPromise)return[2,d.loggingInPromise];throw new Error("ws unexpected login info")}else throw new Error("ws login info reset");case 3:throw m=A.sent(),h.loggedIn=!1,h.loggingInPromise=void 0,h.loginStartTS=void 0,h.loginResult=void 0,m;case 4:return[2]}})})},this.getWsSign=function(){return mt(r,void 0,void 0,function(){var n,s,i,o,u,h,a;return _t(this,function(c){switch(c.label){case 0:return this._wsSign&&this._wsSign.expiredTs>Date.now()?[2,this._wsSign]:(n=Date.now()+6e4,[4,this._context.appConfig.request.send("auth.wsWebSign",{runtime:fc()})]);case 1:if(s=c.sent(),s.code)throw new Error("[tcb-js-sdk] : "+s.code);if(s.data)return i=s.data,o=i.signStr,u=i.wsUrl,h=i.secretVersion,a=i.envId,[2,{signStr:o,wsUrl:u,secretVersion:h,envId:a,expiredTs:n}];throw new Error("[tcb-js-sdk] ")}})})},this.getWaitExpectedTimeoutLength=function(){return r._rttObserved.length?r._rttObserved.reduce(function(n,s){return n+s})/r._rttObserved.length*1.5:U1},this.ping=function(){return mt(r,void 0,void 0,function(){var n;return _t(this,function(s){switch(s.label){case 0:return n={watchId:void 0,requestId:Zr(),msgType:"PING",msgData:null},[4,this.send({msg:n})];case 1:return s.sent(),[2]}})})},this.onWatchStart=function(n,s){r._queryIdClientMap.set(s,n)},this.onWatchClose=function(n,s){s&&r._queryIdClientMap.delete(s),r._watchIdClientMap.delete(n.watchId),r._virtualWSClient.delete(n),r._virtualWSClient.size||r.close(ut.NoRealtimeListeners)},this._maxReconnect=t.maxReconnect||$1,this._reconnectInterval=t.reconnectInterval||W1,this._context=t.context}return e.prototype.clearHeartbeat=function(){this._pingTimeoutId&&clearTimeout(this._pingTimeoutId),this._pongTimeoutId&&clearTimeout(this._pongTimeoutId)},e.prototype.close=function(t){this.clearHeartbeat(),this._ws&&(this._ws.close(t,El[t].name),this._ws=void 0)},e.prototype.watch=function(t){!this._ws&&!this._wsInitPromise&&this.initWebSocketConnection(!1);var r=new P1(Ji(Ji({},t),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this._virtualWSClient.add(r),this._watchIdClientMap.set(r.watchId,r),r.listener},e.prototype.heartbeat=function(t){var r=this;this.clearHeartbeat(),this._pingTimeoutId=setTimeout(function(){return mt(r,void 0,void 0,function(){var n=this;return _t(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),!this._ws||this._ws.readyState!==Io.OPEN?[2]:(this._lastPingSendTS=Date.now(),[4,this.ping()]);case 1:return s.sent(),this._pingFailed=0,this._pongTimeoutId=setTimeout(function(){console.error("pong timed out"),n._pongMissed<Y1?(n._pongMissed++,n.heartbeat(!0)):n.initWebSocketConnection(!0)},this._context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return s.sent(),this._pingFailed<j1?(this._pingFailed++,this.heartbeat()):this.close(ut.HeartbeatPingError),[3,3];case 3:return[2]}})})},t?0:this._context.appConfig.realtimePingInterval)},e}(),G1={target:"database",entity:function(){var e=this.platform,t=e.adapter,r=e.runtime;F1(t.wsClass),L1(r)}},K1={name:"realtime",IIFE:!0,entity:function(){this.prototype.wsClientClass=q1}};try{cloudbase.registerComponent(K1),cloudbase.registerHook(G1)}catch{}const V1="walle-quant-website-2cg83b3402af",Ai="pms",Ma=on.init({env:V1}),Ii=Ma.database(),To=Ma.auth();class J1{async login(){return To.anonymousAuthProvider().signIn()}hasLoginState(){return To.hasLoginState()}uid(){return void 0||To.currentUser.uid}}class z1{create({uid:t="",order:r={},key:n=""}){return Ii.collection(Ai).add({uid:t,order:r,key:n})}query(t){return Ii.collection(Ai).where({uid:t}).get()}delete(t){return Ii.collection(Ai).where({uid:t}).delete()}watch(t,r=()=>{},n=()=>{}){return Ii.collection(Ai).where({uid:t}).watch({onChange:r,onError:n})}}class Z1{async native({amount:t,id:r,title:n,attach:s}){const i=location.hostname==="localhost"?"/s/pay/native":"https://s.one-quant.com/pay/native";return{result:await(await fetch(i,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({total_fee:t,out_trade_no:r,body:n,attach:s})})).json()}}}const vr={app:Ma,user:new J1,db:new z1,pay:new Z1},X1={props:["visible","price","title","message","messageTip","messageSucc","messageFail","orderTitle","orderAttach","orderPrefix"],components:{ElDialog:hc},data(){return{isVisible:this.$props.visible,isShowClose:!1,isSubmiting:!1,amount:0,order:{qrcode:"",out_trade_no:"",pay_order_id:""},elmessage:this.$props.message||Lh}},mounted(){this.$props.visible&&this.payment(this.$props.price)},unmounted(){this.hide()},methods:{show(){this.isVisible=!0,this.isSubmiting=!1},hide(){this.isVisible=!1,this.isSubmiting=!1,this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.elmessage.closeAll()},async payment(e){if(e&&(this.amount=e),this.isSubmiting=!1,this.amount<=0){this.elmessage.info(""),this.$emit("fail");return}try{this.isSubmiting=!0,await vr.user.login();const t=vr.user.uid(),r=P().format("YYYYMMDD"),n=P().format("YYYYMMDD"),s=this.$props.orderPrefix||"9560",i=(this.$props.orderTitle?this.$props.orderTitle+" - ":"")+r.slice(4)+n.slice(4)+P().format("SSS"),o=this.$props.orderAttach||t,u=s+r+n+P().format("HHmmssSSSSSS"),h=+(this.amount*100).toFixed(),a=await vr.pay.native({title:i,amount:h,id:u,attach:o});if(!(a.result.return_code===1&&a.result.qrcode)){this.isSubmiting=!1,this.elmessage.info({message:" "}),this.$emit("fail");return}this.order=a.result,this.isVisible=!0,this.elmessage.closeAll(),this.elmessage.info({message:this.$props.messageTip||" ",duration:0});let c=20;const d=S=>S&&S.order&&S.order.out_trade_no==u?(this.watcher.close(),clearInterval(this.intervalId),this.isVisible=!1,this.elmessage.closeAll(),this.elmessage.info({message:this.$props.messageSucc||""}),this.$emit("succ",S),!0):!1,m=S=>{S.msgType!=="INIT_EVENT"&&d(S.docs[0])},w=()=>{},A=await vr.db.query(t);(!A.data||!A.data.length)&&await vr.db.create({uid:t}),this.watcher=vr.db.watch(t,m,w),this.intervalId=setInterval(async()=>{c--;const S=await vr.db.query(t);S&&S.data&&S.data.length&&d(S.data[0])||c===0&&(this.watcher.close(),clearInterval(this.intervalId),this.elmessage.closeAll(),this.isSubmiting=!1,this.elmessage.info({message:this.$props.messageFail||" "}),this.$emit("fail"))},15*1e3)}catch(t){this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.isSubmiting=!1,this.elmessage.info((" - "+t).toUpperCase()),this.$emit("fail",t)}},async onClose(e){this.watcher&&this.watcher.close(),clearInterval(this.intervalId),this.elmessage.closeAll(),this.isVisible=!1,this.isSubmiting=!1,this.order={},e&&e()}}},Q1={class:"tips"},eb={key:0,class:"qrcode"},tb=["src"],rb={class:"price"},nb=Ar("span",{class:"icon-price"},"",-1),ib=Ar("span",{class:"unit-price"},"",-1),sb=Ar("br",null,null,-1),ob=Ar("br",null,null,-1);function ab(e,t,r,n,s,i){const o=hc;return za(),Ph(o,{class:"payment-dialog-9527",modelValue:s.isVisible,"onUpdate:modelValue":t[0]||(t[0]=u=>s.isVisible=u),modal:!1,"close-on-click-modal":!1,"destroy-on-close":!0,"before-close":i.onClose,"show-close":s.isShowClose},{default:kh(()=>[Za(e.$slots,"header"),Ar("p",Q1,Ls(e.$props.title||""),1),s.order.qrcode?(za(),Mh("div",eb,[Ar("img",{src:s.order.qrcode},null,8,tb),Ar("h3",rb,[nb,Us(" "+Ls(s.amount)+" ",1),ib]),Us("  - "+Ls(s.order.pay_order_id)+" ",1),sb,Us("    "),ob])):Fh("",!0),Za(e.$slots,"footer")]),_:3},8,["modelValue","before-close","show-close"])}const lb=Ch(X1,[["render",ab]]);export{lb as default};
